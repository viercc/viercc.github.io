<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BlockArguments #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="annot"><span class="hs-comment">-- | Discrete category &lt;-&gt; 'Env' comonad</span></span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control.Comonad.Travel.Env</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Comonad.Env</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Control.Comonad.Travel.html"><span class="hs-identifier">Control.Comonad.Travel</span></a></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Singletons</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Singletons.Sigma</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Sigma</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Type.Equality</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">id</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="annot"><span class="hs-comment">-- | @(':~:')@ is a discrete category on kind @k@.</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Control.Comonad.Travel.Env.html#Discrete"><span class="hs-identifier hs-type">Discrete</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679138793"><span class="annot"><a href="#local-6989586621679138793"><span class="hs-identifier hs-type">k</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679138793"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679138793"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">type</span><span> </span><span id="Discrete"><span class="annot"><a href="Control.Comonad.Travel.Env.html#Discrete"><span class="hs-identifier hs-var">Discrete</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-operator hs-type">(:~:)</span></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="annot"><span class="hs-comment">-- | @Travel (Discrete @k) r ~ (k, r) ~ Env k r@</span></span><span>
</span><span id="line-21"></span><span id="local-6989586621679138751"><span id="local-6989586621679138754"><span class="annot"><a href="Control.Comonad.Travel.Env.html#fromEnv"><span class="hs-identifier hs-type">fromEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SingKind</span></span><span> </span><span class="annot"><a href="#local-6989586621679138751"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Env</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Demote</span></span><span> </span><span class="annot"><a href="#local-6989586621679138751"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679138754"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Comonad.Travel.html#Travel"><span class="hs-identifier hs-type">Travel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Comonad.Travel.Env.html#Discrete"><span class="hs-identifier hs-type">Discrete</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679138751"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679138754"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-22"></span><span id="fromEnv"><span class="annot"><span class="annottext">fromEnv :: forall k r. SingKind k =&gt; Env (Demote k) r -&gt; Travel Discrete r
</span><a href="Control.Comonad.Travel.Env.html#fromEnv"><span class="hs-identifier hs-var hs-var">fromEnv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Env (Demote k) r -&gt; (Demote k, r)
forall e a. Env e a -&gt; (e, a)
</span><span class="hs-identifier hs-var">runEnv</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679138798"><span class="annot"><span class="annottext">Demote k
</span><a href="#local-6989586621679138798"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679138799"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679138799"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Demote k -&gt; SomeSing k
forall k. SingKind k =&gt; Demote k -&gt; SomeSing k
</span><span class="hs-identifier hs-var">toSing</span></span><span> </span><span class="annot"><span class="annottext">Demote k
</span><a href="#local-6989586621679138798"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">SomeSing</span></span><span> </span><span id="local-6989586621679138802"><span class="annot"><span class="annottext">Sing a
</span><a href="#local-6989586621679138802"><span class="hs-identifier hs-var">sx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sing a -&gt; (Sigma k (TyCon (Discrete a)) -&gt; r) -&gt; Travel Discrete r
forall k (cat :: k -&gt; k -&gt; *) r (a :: k).
Sing a -&gt; (Sigma k (TyCon (cat a)) -&gt; r) -&gt; Travel cat r
</span><a href="Control.Comonad.Travel.html#MkTravel"><span class="hs-identifier hs-var">MkTravel</span></a></span><span> </span><span class="annot"><span class="annottext">Sing a
</span><a href="#local-6989586621679138802"><span class="hs-identifier hs-var">sx</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sing fst
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;:</span></span><span> </span><span class="annot"><span class="annottext">a :~: fst
TyCon (Discrete a) @@ fst
</span><span class="hs-identifier hs-var">Refl</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679138799"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span id="local-6989586621679138776"><span id="local-6989586621679138777"><span class="annot"><a href="Control.Comonad.Travel.Env.html#toEnv"><span class="hs-identifier hs-type">toEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SingKind</span></span><span> </span><span class="annot"><a href="#local-6989586621679138776"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Comonad.Travel.html#Travel"><span class="hs-identifier hs-type">Travel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Comonad.Travel.Env.html#Discrete"><span class="hs-identifier hs-type">Discrete</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679138776"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679138777"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Env</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Demote</span></span><span> </span><span class="annot"><a href="#local-6989586621679138776"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679138777"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-26"></span><span id="toEnv"><span class="annot"><span class="annottext">toEnv :: forall k r. SingKind k =&gt; Travel Discrete r -&gt; Env (Demote k) r
</span><a href="Control.Comonad.Travel.Env.html#toEnv"><span class="hs-identifier hs-var hs-var">toEnv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Comonad.Travel.html#MkTravel"><span class="hs-identifier hs-type">MkTravel</span></a></span><span> </span><span id="local-6989586621679138810"><span class="annot"><span class="annottext">Sing a
</span><a href="#local-6989586621679138810"><span class="hs-identifier hs-var">sx</span></a></span></span><span> </span><span id="local-6989586621679138811"><span class="annot"><span class="annottext">Sigma k (TyCon (Discrete a)) -&gt; r
</span><a href="#local-6989586621679138811"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Demote k -&gt; r -&gt; EnvT (Demote k) Identity r
forall e a. e -&gt; a -&gt; Env e a
</span><span class="hs-identifier hs-var">env</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sing a -&gt; Demote k
forall (a :: k). Sing a -&gt; Demote k
forall k (a :: k). SingKind k =&gt; Sing a -&gt; Demote k
</span><span class="hs-identifier hs-var">fromSing</span></span><span> </span><span class="annot"><span class="annottext">Sing a
</span><a href="#local-6989586621679138810"><span class="hs-identifier hs-var">sx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sigma k (TyCon (Discrete a)) -&gt; r
</span><a href="#local-6989586621679138811"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sing a
</span><a href="#local-6989586621679138810"><span class="hs-identifier hs-var">sx</span></a></span><span> </span><span class="annot"><span class="annottext">Sing a -&gt; (TyCon (Discrete a) @@ a) -&gt; Sigma k (TyCon (Discrete a))
forall s (a :: s ~&gt; *) (fst :: s).
Sing fst -&gt; (a @@ fst) -&gt; Sigma s a
</span><span class="hs-operator hs-var">:&amp;:</span></span><span> </span><span class="annot"><span class="annottext">a :~: a
TyCon (Discrete a) @@ a
forall {k} (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span></pre></body></html>