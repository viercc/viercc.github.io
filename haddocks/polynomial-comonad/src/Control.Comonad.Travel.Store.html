<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BlockArguments #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="annot"><span class="hs-comment">-- | Indiscrete category &lt;-&gt; 'Store' comonad</span></span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control.Comonad.Travel.Store</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Control.Category.Indiscrete.html"><span class="hs-identifier">Control.Category.Indiscrete</span></a></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Comonad.Store</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Control.Comonad.Travel.html"><span class="hs-identifier">Control.Comonad.Travel</span></a></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Singletons</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Singletons.Sigma</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Sigma</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span id="local-6989586621679139023"><span id="local-6989586621679139026"><span class="annot"><a href="Control.Comonad.Travel.Store.html#fromStore"><span class="hs-identifier hs-type">fromStore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SingKind</span></span><span> </span><span class="annot"><a href="#local-6989586621679139023"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Store</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Demote</span></span><span> </span><span class="annot"><a href="#local-6989586621679139023"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679139026"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Comonad.Travel.html#Travel"><span class="hs-identifier hs-type">Travel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Category.Indiscrete.html#Indiscrete"><span class="hs-identifier hs-type">Indiscrete</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679139023"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679139026"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-14"></span><span id="fromStore"><span class="annot"><span class="annottext">fromStore :: forall k r. SingKind k =&gt; Store (Demote k) r -&gt; Travel Indiscrete r
</span><a href="Control.Comonad.Travel.Store.html#fromStore"><span class="hs-identifier hs-var hs-var">fromStore</span></a></span></span><span> </span><span id="local-6989586621679139077"><span class="annot"><span class="annottext">Store (Demote k) r
</span><a href="#local-6989586621679139077"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Demote k -&gt; SomeSing k
forall k. SingKind k =&gt; Demote k -&gt; SomeSing k
</span><span class="hs-identifier hs-var">toSing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Store (Demote k) r -&gt; Demote k
forall a. StoreT (Demote k) Identity a -&gt; Demote k
forall s (w :: * -&gt; *) a. ComonadStore s w =&gt; w a -&gt; s
</span><span class="hs-identifier hs-var">pos</span></span><span> </span><span class="annot"><span class="annottext">Store (Demote k) r
</span><a href="#local-6989586621679139077"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-15"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">SomeSing</span></span><span> </span><span id="local-6989586621679139081"><span class="annot"><span class="annottext">Sing a
</span><a href="#local-6989586621679139081"><span class="hs-identifier hs-var">sPos</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sing a
-&gt; (Sigma k (TyCon (Indiscrete a)) -&gt; r) -&gt; Travel Indiscrete r
forall k (cat :: k -&gt; k -&gt; *) r (a :: k).
Sing a -&gt; (Sigma k (TyCon (cat a)) -&gt; r) -&gt; Travel cat r
</span><a href="Control.Comonad.Travel.html#MkTravel"><span class="hs-identifier hs-var">MkTravel</span></a></span><span> </span><span class="annot"><span class="annottext">Sing a
</span><a href="#local-6989586621679139081"><span class="hs-identifier hs-var">sPos</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679139085"><span class="annot"><span class="annottext">Sing fst
</span><a href="#local-6989586621679139085"><span class="hs-identifier hs-var">sPos'</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;:</span></span><span> </span><span class="annot"><span class="annottext">TyCon (Indiscrete a) @@ fst
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Demote k -&gt; Store (Demote k) r -&gt; r
forall a. Demote k -&gt; StoreT (Demote k) Identity a -&gt; a
forall s (w :: * -&gt; *) a. ComonadStore s w =&gt; s -&gt; w a -&gt; a
</span><span class="hs-identifier hs-var">peek</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sing fst -&gt; Demote k
forall (a :: k). Sing a -&gt; Demote k
forall k (a :: k). SingKind k =&gt; Sing a -&gt; Demote k
</span><span class="hs-identifier hs-var">fromSing</span></span><span> </span><span class="annot"><span class="annottext">Sing fst
</span><a href="#local-6989586621679139085"><span class="hs-identifier hs-var">sPos'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Store (Demote k) r
</span><a href="#local-6989586621679139077"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span id="local-6989586621679139056"><span id="local-6989586621679139057"><span class="annot"><a href="Control.Comonad.Travel.Store.html#toStore"><span class="hs-identifier hs-type">toStore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SingKind</span></span><span> </span><span class="annot"><a href="#local-6989586621679139056"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Comonad.Travel.html#Travel"><span class="hs-identifier hs-type">Travel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Category.Indiscrete.html#Indiscrete"><span class="hs-identifier hs-type">Indiscrete</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679139056"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679139057"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Store</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Demote</span></span><span> </span><span class="annot"><a href="#local-6989586621679139056"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679139057"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-18"></span><span id="toStore"><span class="annot"><span class="annottext">toStore :: forall k r. SingKind k =&gt; Travel Indiscrete r -&gt; Store (Demote k) r
</span><a href="Control.Comonad.Travel.Store.html#toStore"><span class="hs-identifier hs-var hs-var">toStore</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Comonad.Travel.html#MkTravel"><span class="hs-identifier hs-type">MkTravel</span></a></span><span> </span><span id="local-6989586621679139093"><span class="annot"><span class="annottext">Sing a
</span><a href="#local-6989586621679139093"><span class="hs-identifier hs-var">sp</span></a></span></span><span> </span><span id="local-6989586621679139094"><span class="annot"><span class="annottext">Sigma k (TyCon (Indiscrete a)) -&gt; r
</span><a href="#local-6989586621679139094"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679139095"><span class="annot"><span class="annottext">f :: Demote k -&gt; r
</span><a href="#local-6989586621679139095"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679139096"><span class="annot"><span class="annottext">Demote k
</span><a href="#local-6989586621679139096"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Demote k -&gt; SomeSing k
forall k. SingKind k =&gt; Demote k -&gt; SomeSing k
</span><span class="hs-identifier hs-var">toSing</span></span><span> </span><span class="annot"><span class="annottext">Demote k
</span><a href="#local-6989586621679139096"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-20"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">SomeSing</span></span><span> </span><span id="local-6989586621679139097"><span class="annot"><span class="annottext">Sing a
</span><a href="#local-6989586621679139097"><span class="hs-identifier hs-var">sv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sigma k (TyCon (Indiscrete a)) -&gt; r
</span><a href="#local-6989586621679139094"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sing a
</span><a href="#local-6989586621679139097"><span class="hs-identifier hs-var">sv</span></a></span><span> </span><span class="annot"><span class="annottext">Sing a
-&gt; (TyCon (Indiscrete a) @@ a) -&gt; Sigma k (TyCon (Indiscrete a))
forall s (a :: s ~&gt; *) (fst :: s).
Sing fst -&gt; (a @@ fst) -&gt; Sigma s a
</span><span class="hs-operator hs-var">:&amp;:</span></span><span> </span><span class="annot"><span class="annottext">TyCon (Indiscrete a) @@ a
Indiscrete a a
forall k (a :: k) (b :: k). Indiscrete a b
</span><a href="Control.Category.Indiscrete.html#Indiscrete"><span class="hs-identifier hs-var">Indiscrete</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Demote k -&gt; r) -&gt; Demote k -&gt; StoreT (Demote k) Identity r
forall s a. (s -&gt; a) -&gt; s -&gt; Store s a
</span><span class="hs-identifier hs-var">store</span></span><span> </span><span class="annot"><span class="annottext">Demote k -&gt; r
</span><a href="#local-6989586621679139095"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sing a -&gt; Demote k
forall (a :: k). Sing a -&gt; Demote k
forall k (a :: k). SingKind k =&gt; Sing a -&gt; Demote k
</span><span class="hs-identifier hs-var">fromSing</span></span><span> </span><span class="annot"><span class="annottext">Sing a
</span><a href="#local-6989586621679139093"><span class="hs-identifier hs-var">sp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span></pre></body></html>