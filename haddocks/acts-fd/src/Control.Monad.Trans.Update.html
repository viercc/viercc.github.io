<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveFunctor #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ExplicitNamespaces #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-comment">-- | Update monad and update monad transformer.</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- </span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Based on a blog post by Chris Penner:</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- </span><span>
</span><span id="line-10"></span><span class="hs-comment">-- &quot;Update Monads: Variation on State Monads&quot; https://chrispenner.ca/posts/update-monad</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- (Code included: https://github.com/chrispenner/update-monad)</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- The blog post also references a paper by Danel Ahman and Tarmo Uustalu as a source</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- &quot;Update Monads: Cointerpreting Directed Containers&quot; https://danelahman.github.io/papers/types13postproc.pdf</span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Update.html"><span class="hs-identifier">Control.Monad.Trans.Update</span></a></span><span class="hs-special">(</span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Update.html#Update"><span class="hs-identifier">Update</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><a href="Control.Monad.Trans.Update.html#UpdateT"><span class="hs-identifier">UpdateT</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Update.html#Update"><span class="hs-identifier">Update</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><a href="Control.Monad.Trans.Update.html#getState"><span class="hs-identifier">getState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Update.html#putAction"><span class="hs-identifier">putAction</span></a></span><span>
</span><span id="line-20"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">ap</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Class</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MonadTrans</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Semigroup.Action.html"><span class="hs-identifier">Data.Semigroup.Action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Semigroup.Action.html#Action"><span class="hs-identifier">Action</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Identity</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Identity</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">newtype</span><span> </span><span id="UpdateT"><span class="annot"><a href="Control.Monad.Trans.Update.html#UpdateT"><span class="hs-identifier hs-var">UpdateT</span></a></span></span><span> </span><span id="local-6989586621679069055"><span class="annot"><a href="#local-6989586621679069055"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679069056"><span class="annot"><a href="#local-6989586621679069056"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621679069057"><span class="annot"><a href="#local-6989586621679069057"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679069058"><span class="annot"><a href="#local-6989586621679069058"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-29"></span><span>  </span><span id="UpdateT"><span class="annot"><a href="Control.Monad.Trans.Update.html#UpdateT"><span class="hs-identifier hs-var">UpdateT</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="runUpdateT"><span class="annot"><span class="annottext">forall s x (m :: * -&gt; *) a. UpdateT s x m a -&gt; x -&gt; m (s, a)
</span><a href="Control.Monad.Trans.Update.html#runUpdateT"><span class="hs-identifier hs-var hs-var">runUpdateT</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679069056"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069057"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069055"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679069058"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679069174"><span id="local-6989586621679069177"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; UpdateT s x m a -&gt; UpdateT s x m b)
-&gt; (forall a b. a -&gt; UpdateT s x m b -&gt; UpdateT s x m a)
-&gt; Functor (UpdateT s x m)
forall a b. a -&gt; UpdateT s x m b -&gt; UpdateT s x m a
forall a b. (a -&gt; b) -&gt; UpdateT s x m a -&gt; UpdateT s x m b
forall s x (m :: * -&gt; *) a b.
Functor m =&gt;
a -&gt; UpdateT s x m b -&gt; UpdateT s x m a
forall s x (m :: * -&gt; *) a b.
Functor m =&gt;
(a -&gt; b) -&gt; UpdateT s x m a -&gt; UpdateT s x m b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall s x (m :: * -&gt; *) a b.
Functor m =&gt;
(a -&gt; b) -&gt; UpdateT s x m a -&gt; UpdateT s x m b
fmap :: forall a b. (a -&gt; b) -&gt; UpdateT s x m a -&gt; UpdateT s x m b
$c&lt;$ :: forall s x (m :: * -&gt; *) a b.
Functor m =&gt;
a -&gt; UpdateT s x m b -&gt; UpdateT s x m a
&lt;$ :: forall a b. a -&gt; UpdateT s x m b -&gt; UpdateT s x m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679069091"><span id="local-6989586621679069092"><span id="local-6989586621679069093"><span id="local-6989586621679069191"><span id="local-6989586621679069195"><span id="local-6989586621679069198"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679069091"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Semigroup.Action.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069091"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069092"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679069093"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Update.html#UpdateT"><span class="hs-identifier hs-type">UpdateT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069091"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069092"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069093"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-33"></span><span>  </span><span id="local-6989586621679069206"><span class="annot"><span class="annottext">pure :: forall a. a -&gt; UpdateT s x m a
</span><span class="hs-identifier hs-var hs-var hs-var">pure</span></span></span><span> </span><span id="local-6989586621679069207"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069207"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(x -&gt; m (s, a)) -&gt; UpdateT s x m a
forall s x (m :: * -&gt; *) a. (x -&gt; m (s, a)) -&gt; UpdateT s x m a
</span><a href="Control.Monad.Trans.Update.html#UpdateT"><span class="hs-identifier hs-var">UpdateT</span></a></span><span> </span><span class="annot"><span class="annottext">((x -&gt; m (s, a)) -&gt; UpdateT s x m a)
-&gt; (x -&gt; m (s, a)) -&gt; UpdateT s x m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">m (s, a) -&gt; x -&gt; m (s, a)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(s, a) -&gt; m (s, a)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069207"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>  </span><span id="local-6989586621679069211"><span class="annot"><span class="annottext">&lt;*&gt; :: forall a b.
UpdateT s x m (a -&gt; b) -&gt; UpdateT s x m a -&gt; UpdateT s x m b
</span><span class="hs-operator hs-var hs-var hs-var">(&lt;*&gt;)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UpdateT s x m (a -&gt; b) -&gt; UpdateT s x m a -&gt; UpdateT s x m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m b
</span><span class="hs-identifier hs-var">ap</span></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679069102"><span id="local-6989586621679069103"><span id="local-6989586621679069104"><span id="local-6989586621679069219"><span id="local-6989586621679069222"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679069102"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Semigroup.Action.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069102"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069103"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679069104"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Update.html#UpdateT"><span class="hs-identifier hs-type">UpdateT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069102"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069103"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069104"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-37"></span><span>  </span><span id="local-6989586621679069233"><span class="annot"><span class="annottext">UpdateT s x m a
</span><a href="#local-6989586621679069233"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span id="local-6989586621679069234"><span class="annot"><span class="annottext">&gt;&gt;= :: forall a b.
UpdateT s x m a -&gt; (a -&gt; UpdateT s x m b) -&gt; UpdateT s x m b
</span><span class="hs-operator hs-var hs-var hs-var">&gt;&gt;=</span></span></span><span> </span><span id="local-6989586621679069235"><span class="annot"><span class="annottext">a -&gt; UpdateT s x m b
</span><a href="#local-6989586621679069235"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(x -&gt; m (s, b)) -&gt; UpdateT s x m b
forall s x (m :: * -&gt; *) a. (x -&gt; m (s, a)) -&gt; UpdateT s x m a
</span><a href="Control.Monad.Trans.Update.html#UpdateT"><span class="hs-identifier hs-var">UpdateT</span></a></span><span> </span><span class="annot"><span class="annottext">((x -&gt; m (s, b)) -&gt; UpdateT s x m b)
-&gt; (x -&gt; m (s, b)) -&gt; UpdateT s x m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679069236"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679069236"><span class="hs-identifier hs-var">x0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><span class="annottext">UpdateT s x m a -&gt; x -&gt; m (s, a)
forall s x (m :: * -&gt; *) a. UpdateT s x m a -&gt; x -&gt; m (s, a)
</span><a href="Control.Monad.Trans.Update.html#runUpdateT"><span class="hs-identifier hs-var">runUpdateT</span></a></span><span> </span><span class="annot"><span class="annottext">UpdateT s x m a
</span><a href="#local-6989586621679069233"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679069236"><span class="hs-identifier hs-var">x0</span></a></span><span> </span><span class="annot"><span class="annottext">m (s, a) -&gt; ((s, a) -&gt; m (s, b)) -&gt; m (s, b)
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679069237"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679069237"><span class="hs-identifier hs-var">s0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679069238"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069238"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-39"></span><span>      </span><span class="annot"><span class="annottext">UpdateT s x m b -&gt; x -&gt; m (s, b)
forall s x (m :: * -&gt; *) a. UpdateT s x m a -&gt; x -&gt; m (s, a)
</span><a href="Control.Monad.Trans.Update.html#runUpdateT"><span class="hs-identifier hs-var">runUpdateT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; UpdateT s x m b
</span><a href="#local-6989586621679069235"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069238"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s -&gt; x -&gt; x
forall s x. Action s x =&gt; s -&gt; x -&gt; x
</span><a href="Data.Semigroup.Action.html#act"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679069237"><span class="hs-identifier hs-var">s0</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679069236"><span class="hs-identifier hs-var">x0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (s, b) -&gt; ((s, b) -&gt; m (s, b)) -&gt; m (s, b)
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679069240"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679069240"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679069241"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069241"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-40"></span><span>        </span><span class="annot"><span class="annottext">(s, b) -&gt; m (s, b)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679069240"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; s -&gt; s
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679069237"><span class="hs-identifier hs-var">s0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069241"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679069130"><span id="local-6989586621679069131"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679069130"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Semigroup.Action.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069130"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069131"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadTrans</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Update.html#UpdateT"><span class="hs-identifier hs-type">UpdateT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069130"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069131"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-43"></span><span>  </span><span id="local-6989586621679069254"><span class="annot"><span class="annottext">lift :: forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; UpdateT s x m a
</span><a href="#local-6989586621679069254"><span class="hs-identifier hs-var hs-var hs-var">lift</span></a></span></span><span> </span><span id="local-6989586621679069256"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679069256"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(x -&gt; m (s, a)) -&gt; UpdateT s x m a
forall s x (m :: * -&gt; *) a. (x -&gt; m (s, a)) -&gt; UpdateT s x m a
</span><a href="Control.Monad.Trans.Update.html#UpdateT"><span class="hs-identifier hs-var">UpdateT</span></a></span><span> </span><span class="annot"><span class="annottext">((x -&gt; m (s, a)) -&gt; UpdateT s x m a)
-&gt; (x -&gt; m (s, a)) -&gt; UpdateT s x m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">m (s, a) -&gt; x -&gt; m (s, a)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">s
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (s, a)) -&gt; m a -&gt; m (s, a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679069256"><span class="hs-identifier hs-var">ma</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span id="local-6989586621679069139"><span id="local-6989586621679069140"><span id="local-6989586621679069141"><span class="annot"><a href="Control.Monad.Trans.Update.html#getState"><span class="hs-identifier hs-type">getState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679069139"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679069140"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Update.html#UpdateT"><span class="hs-identifier hs-type">UpdateT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069139"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069141"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069140"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069141"><span class="hs-identifier hs-type">x</span></a></span></span></span></span><span>
</span><span id="line-46"></span><span id="getState"><span class="annot"><span class="annottext">getState :: forall s (m :: * -&gt; *) x. (Monoid s, Monad m) =&gt; UpdateT s x m x
</span><a href="Control.Monad.Trans.Update.html#getState"><span class="hs-identifier hs-var hs-var">getState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(x -&gt; m (s, x)) -&gt; UpdateT s x m x
forall s x (m :: * -&gt; *) a. (x -&gt; m (s, a)) -&gt; UpdateT s x m a
</span><a href="Control.Monad.Trans.Update.html#UpdateT"><span class="hs-identifier hs-var">UpdateT</span></a></span><span> </span><span class="annot"><span class="annottext">((x -&gt; m (s, x)) -&gt; UpdateT s x m x)
-&gt; (x -&gt; m (s, x)) -&gt; UpdateT s x m x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679069263"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679069263"><span class="hs-identifier hs-var">x0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(s, x) -&gt; m (s, x)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679069263"><span class="hs-identifier hs-var">x0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span id="local-6989586621679069145"><span id="local-6989586621679069146"><span id="local-6989586621679069147"><span class="annot"><a href="Control.Monad.Trans.Update.html#putAction"><span class="hs-identifier hs-type">putAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679069145"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069146"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Update.html#UpdateT"><span class="hs-identifier hs-type">UpdateT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069146"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069147"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069145"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-49"></span><span id="putAction"><span class="annot"><span class="annottext">putAction :: forall (m :: * -&gt; *) s x. Monad m =&gt; s -&gt; UpdateT s x m ()
</span><a href="Control.Monad.Trans.Update.html#putAction"><span class="hs-identifier hs-var hs-var">putAction</span></a></span></span><span> </span><span id="local-6989586621679069267"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679069267"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(x -&gt; m (s, ())) -&gt; UpdateT s x m ()
forall s x (m :: * -&gt; *) a. (x -&gt; m (s, a)) -&gt; UpdateT s x m a
</span><a href="Control.Monad.Trans.Update.html#UpdateT"><span class="hs-identifier hs-var">UpdateT</span></a></span><span> </span><span class="annot"><span class="annottext">((x -&gt; m (s, ())) -&gt; UpdateT s x m ())
-&gt; (x -&gt; m (s, ())) -&gt; UpdateT s x m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">m (s, ()) -&gt; x -&gt; m (s, ())
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(s, ()) -&gt; m (s, ())
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679069267"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">type</span><span> </span><span id="Update"><span class="annot"><a href="Control.Monad.Trans.Update.html#Update"><span class="hs-identifier hs-var">Update</span></a></span></span><span> </span><span id="local-6989586621679069268"><span class="annot"><a href="#local-6989586621679069268"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679069269"><span class="annot"><a href="#local-6989586621679069269"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Update.html#UpdateT"><span class="hs-identifier hs-type">UpdateT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069268"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069269"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="annot"><span class="hs-comment">-- | Pattern synonym for non-transformer version</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Update.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679069152"><span id="local-6989586621679069153"><span id="local-6989586621679069154"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069153"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069152"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679069154"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Update.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069152"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069153"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069154"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">pattern</span><span> </span><span id="Update"><span id="%24mUpdate"><span id="%24bUpdate"><span class="annot"><span class="annottext">$mUpdate :: forall {r} {x} {s} {a}.
Update s x a -&gt; ((x -&gt; (s, a)) -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bUpdate :: forall x s a. (x -&gt; (s, a)) -&gt; Update s x a
</span><a href="Control.Monad.Trans.Update.html#Update"><span class="hs-identifier hs-var hs-var hs-var">Update</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679069272"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Update.html#UpdateT"><span class="hs-identifier hs-type">UpdateT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">runIdentity</span></span><span> </span><span class="annot"><span class="hs-operator">.</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679069272"><span class="annot"><a href="#local-6989586621679069272"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-56"></span><span>  </span><span class="annot"><a href="Control.Monad.Trans.Update.html#Update"><span class="hs-identifier hs-var">Update</span></a></span><span> </span><span id="local-6989586621679069275"><span class="annot"><span class="annottext">x -&gt; (s, a)
</span><a href="#local-6989586621679069275"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(x -&gt; Identity (s, a)) -&gt; UpdateT s x Identity a
forall s x (m :: * -&gt; *) a. (x -&gt; m (s, a)) -&gt; UpdateT s x m a
</span><a href="Control.Monad.Trans.Update.html#UpdateT"><span class="hs-identifier hs-var">UpdateT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(s, a) -&gt; Identity (s, a)
forall a. a -&gt; Identity a
</span><span class="hs-identifier hs-var">Identity</span></span><span> </span><span class="annot"><span class="annottext">((s, a) -&gt; Identity (s, a))
-&gt; (x -&gt; (s, a)) -&gt; x -&gt; Identity (s, a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">x -&gt; (s, a)
</span><a href="#local-6989586621679069275"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-pragma">{-# COMPLETE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Update.html#Update"><span class="hs-pragma hs-type">Update</span></a></span><span> </span><span class="hs-pragma">#-}</span></pre></body></html>