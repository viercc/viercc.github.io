<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveTraversable #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ImportQualifiedPost #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">ApplicativeGen</span><span class="hs-special">(</span><span>
</span><span id="line-7"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Dict</span></span><span>
</span><span id="line-8"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeDict"><span class="hs-identifier">ApplicativeDict</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#makeApplicativeDict"><span class="hs-identifier">makeApplicativeDict</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Data</span></span><span>
</span><span id="line-12"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier">ApplicativeData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#genApplicativeData"><span class="hs-identifier">genApplicativeData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#genApplicativeDataFrom"><span class="hs-identifier">genApplicativeDataFrom</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Raw</span></span><span>
</span><span id="line-17"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier">RawApplicativeData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#prettyRawApplicativeData"><span class="hs-identifier">prettyRawApplicativeData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#genRawApplicativeData"><span class="hs-identifier">genRawApplicativeData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#genRawApplicativeDataFrom"><span class="hs-identifier">genRawApplicativeDataFrom</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Applicative laws for Raw</span></span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#prop_LeftUnit"><span class="hs-identifier">prop_LeftUnit</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#prop_RightUnit"><span class="hs-identifier">prop_RightUnit</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#prop_LeftLeft"><span class="hs-identifier">prop_LeftLeft</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#prop_RightRight"><span class="hs-identifier">prop_RightRight</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#prop_LeftRight"><span class="hs-identifier">prop_LeftRight</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Applicative-preserving isomorphisms</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#stabilizingIsomorphisms"><span class="hs-identifier">stabilizingIsomorphisms</span></a></span><span>
</span><span id="line-31"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Array</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Array</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(!)</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Array.Extra.html"><span class="hs-identifier">Data.Array.Extra</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Array</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">for_</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.FunctorShape</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.PTraversable</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.PTraversable.Extra.html"><span class="hs-identifier">Data.PTraversable.Extra</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PTraversable.Extra.html#_indices"><span class="hs-identifier">_indices</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PTraversable.Extra.html#skolem"><span class="hs-identifier">skolem</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Tuple</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">swap</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="MonoidGen.html"><span class="hs-identifier">MonoidGen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonoidGen.html#RawMonoidData"><span class="hs-identifier">RawMonoidData</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonoidGen.html#Signature"><span class="hs-identifier">Signature</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonoidGen.html#genRawMonoidsForApplicative"><span class="hs-identifier">genRawMonoidsForApplicative</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonoidGen.html#makeEnv"><span class="hs-identifier">makeEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonoidGen.html#prettyRawMonoidData"><span class="hs-identifier">prettyRawMonoidData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonoidGen.html#MonoidData"><span class="hs-identifier">MonoidData</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonoidGen.html#stabilizingPermutations"><span class="hs-identifier">stabilizingPermutations</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonoidGen.html#Permutation"><span class="hs-identifier">Permutation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Equivalence.Monad</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">assert</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Isomorphism.html"><span class="hs-identifier">Isomorphism</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sort</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">ModelFinder.Sig.Mono</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">ModelFinder.Expr</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">ModelFinder.Solver</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">data</span><span> </span><span id="ApplicativeDict"><span class="annot"><a href="ApplicativeGen.html#ApplicativeDict"><span class="hs-identifier hs-var">ApplicativeDict</span></a></span></span><span> </span><span id="local-6989586621679179906"><span class="annot"><a href="#local-6989586621679179906"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ApplicativeDict"><span class="annot"><a href="ApplicativeGen.html#ApplicativeDict"><span class="hs-identifier hs-var">ApplicativeDict</span></a></span></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_applicativePure"><span class="annot"><span class="annottext">forall (f :: * -&gt; *). ApplicativeDict f -&gt; forall a. a -&gt; f a
</span><a href="ApplicativeGen.html#_applicativePure"><span class="hs-identifier hs-var hs-var">_applicativePure</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679179908"><span class="annot"><a href="#local-6989586621679179908"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679179908"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679179906"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679179908"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>    </span><span id="_applicativeLiftA2"><span class="annot"><span class="annottext">forall (f :: * -&gt; *).
ApplicativeDict f
-&gt; forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><a href="ApplicativeGen.html#_applicativeLiftA2"><span class="hs-identifier hs-var hs-var">_applicativeLiftA2</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679179911"><span class="annot"><a href="#local-6989586621679179911"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679179912"><span class="annot"><a href="#local-6989586621679179912"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679179913"><span class="annot"><a href="#local-6989586621679179913"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679179911"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679179912"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679179913"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679179906"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679179911"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679179906"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679179912"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679179906"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679179913"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="annot"><a href="ApplicativeGen.html#makeApplicativeDict"><span class="hs-identifier hs-type">makeApplicativeDict</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679179918"><span class="annot"><a href="#local-6989586621679179918"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679179918"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-type">ApplicativeData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679179918"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeDict"><span class="hs-identifier hs-type">ApplicativeDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679179918"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-59"></span><span id="makeApplicativeDict"><span class="annot"><span class="annottext">makeApplicativeDict :: forall (f :: * -&gt; *).
PTraversable f =&gt;
ApplicativeData f -&gt; ApplicativeDict f
</span><a href="ApplicativeGen.html#makeApplicativeDict"><span class="hs-identifier hs-var hs-var">makeApplicativeDict</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-type">ApplicativeData</span></a></span><span> </span><span id="local-6989586621679180297"><span class="annot"><span class="annottext">Vector (Shape f)
</span><a href="#local-6989586621679180297"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span id="local-6989586621679180298"><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180298"><span class="hs-identifier hs-var">raw</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeDict"><span class="hs-identifier hs-type">ApplicativeDict</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">_applicativePure :: forall a. a -&gt; f a
</span><a href="ApplicativeGen.html#_applicativePure"><span class="hs-identifier hs-var">_applicativePure</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; f a
forall a. a -&gt; f a
</span><a href="#local-6989586621679180299"><span class="hs-identifier hs-var">pure'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_applicativeLiftA2 :: forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><a href="ApplicativeGen.html#_applicativeLiftA2"><span class="hs-identifier hs-var">_applicativeLiftA2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><a href="#local-6989586621679180300"><span class="hs-identifier hs-var">liftA2'</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-62"></span><span>    </span><span id="local-6989586621679180301"><span class="annot"><span class="annottext">e :: Int
</span><a href="#local-6989586621679180301"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Int
</span><a href="MonoidGen.html#_unitElem"><span class="hs-identifier hs-var">_unitElem</span></a></span><span> </span><span class="annot"><span class="annottext">(RawMonoidData -&gt; Int) -&gt; RawMonoidData -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; RawMonoidData
</span><a href="ApplicativeGen.html#_baseMonoid"><span class="hs-identifier hs-var">_baseMonoid</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180298"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span id="local-6989586621679180304"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180304"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#monoidOp"><span class="hs-identifier hs-var">monoidOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180298"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span id="local-6989586621679180306"><span class="annot"><span class="annottext">leftFactor :: Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180306"><span class="hs-identifier hs-var hs-var">leftFactor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#leftFactorOp"><span class="hs-identifier hs-var">leftFactorOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180298"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span id="local-6989586621679180308"><span class="annot"><span class="annottext">rightFactor :: Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180308"><span class="hs-identifier hs-var hs-var">rightFactor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#rightFactorOp"><span class="hs-identifier hs-var">rightFactorOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180298"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>    </span><span id="local-6989586621679180320"><span class="annot"><span class="annottext">reverseTable :: Map (Shape f) Int
</span><a href="#local-6989586621679180320"><span class="hs-identifier hs-var hs-var">reverseTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Shape f, Int)] -&gt; Map (Shape f) Int
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Shape f) -&gt; (Shape f, Int)
forall a b. (a, b) -&gt; (b, a)
</span><span class="hs-identifier hs-var">swap</span></span><span> </span><span class="annot"><span class="annottext">((Int, Shape f) -&gt; (Shape f, Int))
-&gt; [(Int, Shape f)] -&gt; [(Shape f, Int)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector (Int, Shape f) -&gt; [(Int, Shape f)]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (Shape f) -&gt; Vector (Int, Shape f)
forall a. Vector a -&gt; Vector (Int, a)
</span><span class="hs-identifier hs-var">V.indexed</span></span><span> </span><span class="annot"><span class="annottext">Vector (Shape f)
</span><a href="#local-6989586621679180297"><span class="hs-identifier hs-var">table</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><a href="#local-6989586621679180299"><span class="hs-identifier hs-type">pure'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679180325"><span class="annot"><a href="#local-6989586621679180325"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679180325"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679179918"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180325"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span id="local-6989586621679180299"><span class="annot"><span class="annottext">pure' :: forall a. a -&gt; f a
</span><a href="#local-6989586621679180299"><span class="hs-identifier hs-var hs-var">pure'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Vector (Shape f)
</span><a href="#local-6989586621679180297"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Shape f) -&gt; Int -&gt; Shape f
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180301"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-70"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span id="local-6989586621679180329"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679180329"><span class="hs-identifier hs-var">u1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; f a -&gt; f a
forall a b. a -&gt; f b -&gt; f a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679180329"><span class="hs-identifier hs-var">u1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><a href="#local-6989586621679180300"><span class="hs-identifier hs-type">liftA2'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679180331"><span class="annot"><a href="#local-6989586621679180331"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679180332"><span class="annot"><a href="#local-6989586621679180332"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679180333"><span class="annot"><a href="#local-6989586621679180333"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679180331"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679180332"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679180333"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679179918"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180331"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679179918"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180332"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679179918"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180333"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span id="local-6989586621679180300"><span class="annot"><span class="annottext">liftA2' :: forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><a href="#local-6989586621679180300"><span class="hs-identifier hs-var hs-var">liftA2'</span></a></span></span><span> </span><span id="local-6989586621679180334"><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679180334"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679180335"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679180335"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679180336"><span class="annot"><span class="annottext">f b
</span><a href="#local-6989586621679180336"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f c
</span><a href="#local-6989586621679180337"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-74"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-75"></span><span>        </span><span id="local-6989586621679180339"><span class="annot"><span class="annottext">as :: [a]
</span><a href="#local-6989586621679180339"><span class="hs-keyword hs-var hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f a -&gt; [a]
forall a. f a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679180335"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-76"></span><span>        </span><span id="local-6989586621679180341"><span class="annot"><span class="annottext">bs :: [b]
</span><a href="#local-6989586621679180341"><span class="hs-identifier hs-var hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f b -&gt; [b]
forall a. f a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">f b
</span><a href="#local-6989586621679180336"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-77"></span><span>        </span><span id="local-6989586621679180347"><span class="annot"><span class="annottext">mx :: Int
</span><a href="#local-6989586621679180347"><span class="hs-identifier hs-var hs-var">mx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) Int
</span><a href="#local-6989586621679180320"><span class="hs-identifier hs-var">reverseTable</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Shape f) Int -&gt; Shape f -&gt; Int
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span> </span><span class="annot"><span class="annottext">f a -&gt; Shape f
forall (f :: * -&gt; *) a. f a -&gt; Shape f
</span><span class="hs-identifier hs-var">Shape</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679180335"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-78"></span><span>        </span><span id="local-6989586621679180354"><span class="annot"><span class="annottext">my :: Int
</span><a href="#local-6989586621679180354"><span class="hs-identifier hs-var hs-var">my</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) Int
</span><a href="#local-6989586621679180320"><span class="hs-identifier hs-var">reverseTable</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Shape f) Int -&gt; Shape f -&gt; Int
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span> </span><span class="annot"><span class="annottext">f b -&gt; Shape f
forall (f :: * -&gt; *) a. f a -&gt; Shape f
</span><span class="hs-identifier hs-var">Shape</span></span><span> </span><span class="annot"><span class="annottext">f b
</span><a href="#local-6989586621679180336"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-79"></span><span>        </span><span id="local-6989586621679180355"><span class="annot"><span class="annottext">mz :: Int
</span><a href="#local-6989586621679180355"><span class="hs-identifier hs-var hs-var">mz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180304"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180347"><span class="hs-identifier hs-var">mx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180354"><span class="hs-identifier hs-var">my</span></a></span><span>
</span><span id="line-80"></span><span>        </span><span id="local-6989586621679180356"><span class="annot"><span class="annottext">zi :: f Int
</span><a href="#local-6989586621679180356"><span class="hs-identifier hs-var hs-var">zi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Vector (Shape f)
</span><a href="#local-6989586621679180297"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Shape f) -&gt; Int -&gt; Shape f
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180355"><span class="hs-identifier hs-var">mz</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-81"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span id="local-6989586621679180360"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679180360"><span class="hs-identifier hs-var">z1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f a -&gt; f Int
forall (t :: * -&gt; *) a. Traversable t =&gt; t a -&gt; t Int
</span><a href="Data.PTraversable.Extra.html#_indices"><span class="hs-identifier hs-var">_indices</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679180360"><span class="hs-identifier hs-var">z1</span></a></span><span>
</span><span id="line-82"></span><span>        </span><span id="local-6989586621679180365"><span class="annot"><span class="annottext">cs :: Int -&gt; c
</span><a href="#local-6989586621679180365"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621679180366"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180366"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-83"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679180367"><span class="annot"><span class="annottext">j :: Int
</span><a href="#local-6989586621679180367"><span class="hs-identifier hs-var hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180306"><span class="hs-identifier hs-var">leftFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180347"><span class="hs-identifier hs-var">mx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180354"><span class="hs-identifier hs-var">my</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180366"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-84"></span><span>              </span><span id="local-6989586621679180368"><span class="annot"><span class="annottext">k :: Int
</span><a href="#local-6989586621679180368"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180308"><span class="hs-identifier hs-var">rightFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180347"><span class="hs-identifier hs-var">mx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180354"><span class="hs-identifier hs-var">my</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180366"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-85"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679180334"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679180339"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int -&gt; a
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180367"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679180341"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; Int -&gt; b
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180368"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>        </span><span id="local-6989586621679180337"><span class="annot"><span class="annottext">z :: f c
</span><a href="#local-6989586621679180337"><span class="hs-identifier hs-var hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; c
</span><a href="#local-6989586621679180365"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; c) -&gt; f Int -&gt; f c
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679180356"><span class="hs-identifier hs-var">zi</span></a></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-keyword">data</span><span> </span><span id="ApplicativeData"><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-var">ApplicativeData</span></a></span></span><span> </span><span id="local-6989586621679179973"><span class="annot"><a href="#local-6989586621679179973"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ApplicativeData"><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-var">ApplicativeData</span></a></span></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_applicativeShapeTable"><span class="annot"><span class="annottext">forall (f :: * -&gt; *). ApplicativeData f -&gt; Vector (Shape f)
</span><a href="ApplicativeGen.html#_applicativeShapeTable"><span class="hs-identifier hs-var hs-var">_applicativeShapeTable</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span class="annot"><a href="#local-6989586621679179973"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-90"></span><span>    </span><span id="_rawApplicative"><span class="annot"><span class="annottext">forall (f :: * -&gt; *). ApplicativeData f -&gt; RawApplicativeData
</span><a href="ApplicativeGen.html#_rawApplicative"><span class="hs-identifier hs-var hs-var">_rawApplicative</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span id="local-6989586621679179976"><span class="annot"><a href="ApplicativeGen.html#genApplicativeData"><span class="hs-identifier hs-type">genApplicativeData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679179976"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-type">ApplicativeData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679179976"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-94"></span><span id="genApplicativeData"><span class="annot"><span class="annottext">genApplicativeData :: forall (f :: * -&gt; *). PTraversable f =&gt; [ApplicativeData f]
</span><a href="ApplicativeGen.html#genApplicativeData"><span class="hs-identifier hs-var hs-var">genApplicativeData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Shape f) -&gt; RawApplicativeData -&gt; ApplicativeData f
forall (f :: * -&gt; *).
Vector (Shape f) -&gt; RawApplicativeData -&gt; ApplicativeData f
</span><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-var">ApplicativeData</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Shape f)
</span><a href="#local-6989586621679180382"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">(RawApplicativeData -&gt; ApplicativeData f)
-&gt; [RawApplicativeData] -&gt; [ApplicativeData f]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; [RawApplicativeData]
</span><a href="ApplicativeGen.html#genRawApplicativeData"><span class="hs-identifier hs-var">genRawApplicativeData</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180383"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679180382"><span class="annot"><span class="annottext">Vector (Shape f)
</span><a href="#local-6989586621679180382"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679180383"><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180383"><span class="hs-identifier hs-var">sig</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Shape f -&gt; Int) -&gt; (Vector (Shape f), Vector Int)
forall a. Enum a =&gt; (a -&gt; Int) -&gt; (Vector a, Vector Int)
</span><a href="MonoidGen.html#makeEnv"><span class="hs-identifier hs-var">makeEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f Ignored -&gt; Int
forall a. f a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">(f Ignored -&gt; Int) -&gt; (Shape f -&gt; f Ignored) -&gt; Shape f -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Shape f -&gt; f Ignored
forall (f :: * -&gt; *). Shape f -&gt; f Ignored
</span><span class="hs-identifier hs-var">unShape</span></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span id="local-6989586621679179986"><span class="annot"><a href="ApplicativeGen.html#genApplicativeDataFrom"><span class="hs-identifier hs-type">genApplicativeDataFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679179986"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MonoidGen.html#MonoidData"><span class="hs-identifier hs-type">MonoidData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span class="annot"><a href="#local-6989586621679179986"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-type">ApplicativeData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679179986"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-99"></span><span id="genApplicativeDataFrom"><span class="annot"><span class="annottext">genApplicativeDataFrom :: forall (f :: * -&gt; *).
Foldable f =&gt;
MonoidData (Shape f) -&gt; [ApplicativeData f]
</span><a href="ApplicativeGen.html#genApplicativeDataFrom"><span class="hs-identifier hs-var hs-var">genApplicativeDataFrom</span></a></span></span><span> </span><span id="local-6989586621679180400"><span class="annot"><span class="annottext">MonoidData (Shape f)
</span><a href="#local-6989586621679180400"><span class="hs-identifier hs-var">monData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Shape f) -&gt; RawApplicativeData -&gt; ApplicativeData f
forall (f :: * -&gt; *).
Vector (Shape f) -&gt; RawApplicativeData -&gt; ApplicativeData f
</span><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-var">ApplicativeData</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Shape f)
</span><a href="#local-6989586621679180401"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">(RawApplicativeData -&gt; ApplicativeData f)
-&gt; [RawApplicativeData] -&gt; [ApplicativeData f]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; RawMonoidData -&gt; [RawApplicativeData]
</span><a href="ApplicativeGen.html#genRawApplicativeDataFrom"><span class="hs-identifier hs-var">genRawApplicativeDataFrom</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180402"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180403"><span class="hs-identifier hs-var">mon</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-101"></span><span>    </span><span id="local-6989586621679180401"><span class="annot"><span class="annottext">env :: Vector (Shape f)
</span><a href="#local-6989586621679180401"><span class="hs-identifier hs-var hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MonoidData (Shape f) -&gt; Vector (Shape f)
forall a. MonoidData a -&gt; Vector a
</span><a href="MonoidGen.html#_elemTable"><span class="hs-identifier hs-var">_elemTable</span></a></span><span> </span><span class="annot"><span class="annottext">MonoidData (Shape f)
</span><a href="#local-6989586621679180400"><span class="hs-identifier hs-var">monData</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679180402"><span class="annot"><span class="annottext">sig :: Vector Int
</span><a href="#local-6989586621679180402"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f Ignored -&gt; Int
forall a. f a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">(f Ignored -&gt; Int) -&gt; (Shape f -&gt; f Ignored) -&gt; Shape f -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Shape f -&gt; f Ignored
forall (f :: * -&gt; *). Shape f -&gt; f Ignored
</span><span class="hs-identifier hs-var">unShape</span></span><span> </span><span class="annot"><span class="annottext">(Shape f -&gt; Int) -&gt; Vector (Shape f) -&gt; Vector Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector (Shape f)
</span><a href="#local-6989586621679180401"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621679180403"><span class="annot"><span class="annottext">mon :: RawMonoidData
</span><a href="#local-6989586621679180403"><span class="hs-identifier hs-var hs-var">mon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MonoidData (Shape f) -&gt; RawMonoidData
forall a. MonoidData a -&gt; RawMonoidData
</span><a href="MonoidGen.html#_rawMonoidData"><span class="hs-identifier hs-var">_rawMonoidData</span></a></span><span> </span><span class="annot"><span class="annottext">MonoidData (Shape f)
</span><a href="#local-6989586621679180400"><span class="hs-identifier hs-var">monData</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="annot"><span class="hs-comment">-- * Raw applicatives</span></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-keyword">data</span><span> </span><span id="RawApplicativeData"><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-var">RawApplicativeData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RawApplicativeData"><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-var">RawApplicativeData</span></a></span></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_signature"><span class="annot"><span class="annottext">RawApplicativeData -&gt; Vector Int
</span><a href="ApplicativeGen.html#_signature"><span class="hs-identifier hs-var hs-var">_signature</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-109"></span><span>    </span><span id="_baseMonoid"><span class="annot"><span class="annottext">RawApplicativeData -&gt; RawMonoidData
</span><a href="ApplicativeGen.html#_baseMonoid"><span class="hs-identifier hs-var hs-var">_baseMonoid</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonoidGen.html#RawMonoidData"><span class="hs-identifier hs-type">RawMonoidData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-110"></span><span>    </span><span id="_leftFactorTable"><span class="annot"><span class="annottext">RawApplicativeData -&gt; FactorTable
</span><a href="ApplicativeGen.html#_leftFactorTable"><span class="hs-identifier hs-var hs-var">_leftFactorTable</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-111"></span><span>    </span><span id="_rightFactorTable"><span class="annot"><span class="annottext">RawApplicativeData -&gt; FactorTable
</span><a href="ApplicativeGen.html#_rightFactorTable"><span class="hs-identifier hs-var hs-var">_rightFactorTable</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679180414"><span id="local-6989586621679180425"><span id="local-6989586621679180429"><span class="annot"><span class="annottext">Int -&gt; RawApplicativeData -&gt; ShowS
[RawApplicativeData] -&gt; ShowS
RawApplicativeData -&gt; String
(Int -&gt; RawApplicativeData -&gt; ShowS)
-&gt; (RawApplicativeData -&gt; String)
-&gt; ([RawApplicativeData] -&gt; ShowS)
-&gt; Show RawApplicativeData
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; RawApplicativeData -&gt; ShowS
showsPrec :: Int -&gt; RawApplicativeData -&gt; ShowS
$cshow :: RawApplicativeData -&gt; String
show :: RawApplicativeData -&gt; String
$cshowList :: [RawApplicativeData] -&gt; ShowS
showList :: [RawApplicativeData] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-keyword">type</span><span> </span><span id="FactorTable"><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-var">FactorTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="annot"><a href="ApplicativeGen.html#prettyRawApplicativeData"><span class="hs-identifier hs-type">prettyRawApplicativeData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-118"></span><span id="prettyRawApplicativeData"><span class="annot"><span class="annottext">prettyRawApplicativeData :: String -&gt; RawApplicativeData -&gt; [String]
</span><a href="ApplicativeGen.html#prettyRawApplicativeData"><span class="hs-identifier hs-var hs-var">prettyRawApplicativeData</span></a></span></span><span> </span><span id="local-6989586621679180433"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679180433"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679180434"><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180434"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679180433"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = RawApplicative{&quot;</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-120"></span><span>  </span><span class="annot"><span class="annottext">ShowS -&gt; [String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679180435"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Signature: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Vector Int
</span><a href="ApplicativeGen.html#_signature"><span class="hs-identifier hs-var">_signature</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180434"><span class="hs-identifier hs-var">raw</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; RawMonoidData -&gt; [String]
</span><a href="MonoidGen.html#prettyRawMonoidData"><span class="hs-identifier hs-var">prettyRawMonoidData</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;base&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RawApplicativeData -&gt; RawMonoidData
</span><a href="ApplicativeGen.html#_baseMonoid"><span class="hs-identifier hs-var">_baseMonoid</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180434"><span class="hs-identifier hs-var">raw</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LeftFactor:&quot;</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><span class="annottext">ShowS -&gt; [String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679180435"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FactorTable -&gt; [String]
forall i j a.
(Ix i, Ix j, Show i, Show j, Show a) =&gt;
Array (i, j) a -&gt; [String]
</span><a href="Data.Array.Extra.html#prettyArray"><span class="hs-identifier hs-var">Array.prettyArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RawApplicativeData -&gt; FactorTable
</span><a href="ApplicativeGen.html#_leftFactorTable"><span class="hs-identifier hs-var">_leftFactorTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180434"><span class="hs-identifier hs-var">raw</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RightFactor:&quot;</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><span class="annottext">ShowS -&gt; [String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679180435"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FactorTable -&gt; [String]
forall i j a.
(Ix i, Ix j, Show i, Show j, Show a) =&gt;
Array (i, j) a -&gt; [String]
</span><a href="Data.Array.Extra.html#prettyArray"><span class="hs-identifier hs-var">Array.prettyArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RawApplicativeData -&gt; FactorTable
</span><a href="ApplicativeGen.html#_rightFactorTable"><span class="hs-identifier hs-var">_rightFactorTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180434"><span class="hs-identifier hs-var">raw</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>    </span><span id="local-6989586621679180435"><span class="annot"><span class="annottext">indent :: ShowS
</span><a href="#local-6989586621679180435"><span class="hs-identifier hs-var hs-var">indent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="annot"><a href="ApplicativeGen.html#monoidOp"><span class="hs-identifier hs-type">monoidOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-133"></span><span id="monoidOp"><span class="annot"><span class="annottext">monoidOp :: RawApplicativeData -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#monoidOp"><span class="hs-identifier hs-var hs-var">monoidOp</span></a></span></span><span> </span><span id="local-6989586621679180438"><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180438"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180439"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621679180440"><span class="annot"><span class="annottext">table :: Array (Int, Int) Int
</span><a href="#local-6989586621679180440"><span class="hs-identifier hs-var hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Array (Int, Int) Int
</span><a href="MonoidGen.html#_multTable"><span class="hs-identifier hs-var">_multTable</span></a></span><span> </span><span class="annot"><span class="annottext">(RawMonoidData -&gt; Array (Int, Int) Int)
-&gt; (RawApplicativeData -&gt; RawMonoidData)
-&gt; RawApplicativeData
-&gt; Array (Int, Int) Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; RawMonoidData
</span><a href="ApplicativeGen.html#_baseMonoid"><span class="hs-identifier hs-var">_baseMonoid</span></a></span><span> </span><span class="annot"><span class="annottext">(RawApplicativeData -&gt; Array (Int, Int) Int)
-&gt; RawApplicativeData -&gt; Array (Int, Int) Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180438"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-136"></span><span>    </span><span id="local-6989586621679180439"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180439"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679180445"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180445"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679180446"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180446"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) Int
</span><a href="#local-6989586621679180440"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) Int -&gt; (Int, Int) -&gt; Int
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180445"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180446"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="annot"><a href="ApplicativeGen.html#leftFactorOp"><span class="hs-identifier hs-type">leftFactorOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-139"></span><span id="leftFactorOp"><span class="annot"><span class="annottext">leftFactorOp :: RawApplicativeData -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#leftFactorOp"><span class="hs-identifier hs-var hs-var">leftFactorOp</span></a></span></span><span> </span><span id="local-6989586621679180447"><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180447"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180448"><span class="hs-identifier hs-var">leftFactor</span></a></span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-141"></span><span>    </span><span id="local-6989586621679180449"><span class="annot"><span class="annottext">table :: FactorTable
</span><a href="#local-6989586621679180449"><span class="hs-identifier hs-var hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; FactorTable
</span><a href="ApplicativeGen.html#_leftFactorTable"><span class="hs-identifier hs-var">_leftFactorTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180447"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span id="local-6989586621679180448"><span class="annot"><span class="annottext">leftFactor :: Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180448"><span class="hs-identifier hs-var hs-var">leftFactor</span></a></span></span><span> </span><span id="local-6989586621679180453"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180453"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679180454"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180454"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679180455"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180455"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679180449"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">FactorTable -&gt; (Int, Int) -&gt; Vector Int
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180453"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180454"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180455"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="annot"><a href="ApplicativeGen.html#rightFactorOp"><span class="hs-identifier hs-type">rightFactorOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-145"></span><span id="rightFactorOp"><span class="annot"><span class="annottext">rightFactorOp :: RawApplicativeData -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#rightFactorOp"><span class="hs-identifier hs-var hs-var">rightFactorOp</span></a></span></span><span> </span><span id="local-6989586621679180456"><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180456"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180457"><span class="hs-identifier hs-var">rightFactor</span></a></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-147"></span><span>    </span><span id="local-6989586621679180458"><span class="annot"><span class="annottext">table :: FactorTable
</span><a href="#local-6989586621679180458"><span class="hs-identifier hs-var hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; FactorTable
</span><a href="ApplicativeGen.html#_rightFactorTable"><span class="hs-identifier hs-var">_rightFactorTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180456"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span id="local-6989586621679180457"><span class="annot"><span class="annottext">rightFactor :: Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180457"><span class="hs-identifier hs-var hs-var">rightFactor</span></a></span></span><span> </span><span id="local-6989586621679180462"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180462"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679180463"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180463"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679180464"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180464"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679180458"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">FactorTable -&gt; (Int, Int) -&gt; Vector Int
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180462"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180463"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180464"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="annot"><a href="ApplicativeGen.html#prop_LeftUnit"><span class="hs-identifier hs-type">prop_LeftUnit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-151"></span><span id="prop_LeftUnit"><span class="annot"><span class="annottext">prop_LeftUnit :: RawApplicativeData -&gt; Bool
</span><a href="ApplicativeGen.html#prop_LeftUnit"><span class="hs-identifier hs-var hs-var">prop_LeftUnit</span></a></span></span><span> </span><span id="local-6989586621679180465"><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180465"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679180467"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>    </span><span id="local-6989586621679180468"><span class="annot"><span class="annottext">sig :: Vector Int
</span><a href="#local-6989586621679180468"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Vector Int
</span><a href="ApplicativeGen.html#_signature"><span class="hs-identifier hs-var">_signature</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180465"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span id="local-6989586621679180469"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679180469"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180468"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span id="local-6989586621679180471"><span class="annot"><span class="annottext">e :: Int
</span><a href="#local-6989586621679180471"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Int
</span><a href="MonoidGen.html#_unitElem"><span class="hs-identifier hs-var">_unitElem</span></a></span><span> </span><span class="annot"><span class="annottext">(RawMonoidData -&gt; Int)
-&gt; (RawApplicativeData -&gt; RawMonoidData)
-&gt; RawApplicativeData
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; RawMonoidData
</span><a href="ApplicativeGen.html#_baseMonoid"><span class="hs-identifier hs-var">_baseMonoid</span></a></span><span> </span><span class="annot"><span class="annottext">(RawApplicativeData -&gt; Int) -&gt; RawApplicativeData -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180465"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-156"></span><span>    </span><span id="local-6989586621679180472"><span class="annot"><span class="annottext">leftFactor :: Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180472"><span class="hs-identifier hs-var hs-var">leftFactor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#leftFactorOp"><span class="hs-identifier hs-var">leftFactorOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180465"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span id="local-6989586621679180467"><span class="annot"><span class="annottext">result :: [Bool]
</span><a href="#local-6989586621679180467"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-158"></span><span>      </span><span id="local-6989586621679180485"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180485"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180469"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-159"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679180486"><span class="annot"><span class="annottext">numX :: Int
</span><a href="#local-6989586621679180486"><span class="hs-identifier hs-var hs-var">numX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180468"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180485"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-160"></span><span>      </span><span id="local-6989586621679180487"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180487"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180486"><span class="hs-identifier hs-var">numX</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-161"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; [Bool]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; [Bool]) -&gt; Bool -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180472"><span class="hs-identifier hs-var">leftFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180485"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180471"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180487"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180487"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="annot"><a href="ApplicativeGen.html#prop_RightUnit"><span class="hs-identifier hs-type">prop_RightUnit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-164"></span><span id="prop_RightUnit"><span class="annot"><span class="annottext">prop_RightUnit :: RawApplicativeData -&gt; Bool
</span><a href="ApplicativeGen.html#prop_RightUnit"><span class="hs-identifier hs-var hs-var">prop_RightUnit</span></a></span></span><span> </span><span id="local-6989586621679180488"><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180488"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679180489"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621679180490"><span class="annot"><span class="annottext">sig :: Vector Int
</span><a href="#local-6989586621679180490"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Vector Int
</span><a href="ApplicativeGen.html#_signature"><span class="hs-identifier hs-var">_signature</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180488"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span id="local-6989586621679180491"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679180491"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180490"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-168"></span><span>    </span><span id="local-6989586621679180492"><span class="annot"><span class="annottext">e :: Int
</span><a href="#local-6989586621679180492"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Int
</span><a href="MonoidGen.html#_unitElem"><span class="hs-identifier hs-var">_unitElem</span></a></span><span> </span><span class="annot"><span class="annottext">(RawMonoidData -&gt; Int)
-&gt; (RawApplicativeData -&gt; RawMonoidData)
-&gt; RawApplicativeData
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; RawMonoidData
</span><a href="ApplicativeGen.html#_baseMonoid"><span class="hs-identifier hs-var">_baseMonoid</span></a></span><span> </span><span class="annot"><span class="annottext">(RawApplicativeData -&gt; Int) -&gt; RawApplicativeData -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180488"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621679180493"><span class="annot"><span class="annottext">rightFactor :: Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180493"><span class="hs-identifier hs-var hs-var">rightFactor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#rightFactorOp"><span class="hs-identifier hs-var">rightFactorOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180488"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span id="local-6989586621679180489"><span class="annot"><span class="annottext">result :: [Bool]
</span><a href="#local-6989586621679180489"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-171"></span><span>      </span><span id="local-6989586621679180506"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180506"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180491"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-172"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679180507"><span class="annot"><span class="annottext">numX :: Int
</span><a href="#local-6989586621679180507"><span class="hs-identifier hs-var hs-var">numX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180490"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180506"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-173"></span><span>      </span><span id="local-6989586621679180508"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180508"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180507"><span class="hs-identifier hs-var">numX</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-174"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; [Bool]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; [Bool]) -&gt; Bool -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180493"><span class="hs-identifier hs-var">rightFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180492"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180506"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180508"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180508"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="annot"><a href="ApplicativeGen.html#prop_LeftLeft"><span class="hs-identifier hs-type">prop_LeftLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-177"></span><span id="prop_LeftLeft"><span class="annot"><span class="annottext">prop_LeftLeft :: RawApplicativeData -&gt; Bool
</span><a href="ApplicativeGen.html#prop_LeftLeft"><span class="hs-identifier hs-var hs-var">prop_LeftLeft</span></a></span></span><span> </span><span id="local-6989586621679180509"><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180509"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679180510"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621679180511"><span class="annot"><span class="annottext">sig :: Vector Int
</span><a href="#local-6989586621679180511"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Vector Int
</span><a href="ApplicativeGen.html#_signature"><span class="hs-identifier hs-var">_signature</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180509"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span id="local-6989586621679180512"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679180512"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180511"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-181"></span><span>    </span><span id="local-6989586621679180513"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180513"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#monoidOp"><span class="hs-identifier hs-var">monoidOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180509"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621679180514"><span class="annot"><span class="annottext">leftFactor :: Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180514"><span class="hs-identifier hs-var hs-var">leftFactor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#leftFactorOp"><span class="hs-identifier hs-var">leftFactorOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180509"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621679180510"><span class="annot"><span class="annottext">result :: [Bool]
</span><a href="#local-6989586621679180510"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-184"></span><span>      </span><span id="local-6989586621679180537"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180537"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180512"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span>      </span><span id="local-6989586621679180538"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180538"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180512"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-186"></span><span>      </span><span id="local-6989586621679180539"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180539"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180512"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-187"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679180540"><span class="annot"><span class="annottext">ij :: Int
</span><a href="#local-6989586621679180540"><span class="hs-identifier hs-var hs-var">ij</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180513"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180537"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180538"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-188"></span><span>          </span><span id="local-6989586621679180541"><span class="annot"><span class="annottext">jk :: Int
</span><a href="#local-6989586621679180541"><span class="hs-identifier hs-var hs-var">jk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180513"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180538"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180539"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-189"></span><span>          </span><span id="local-6989586621679180542"><span class="annot"><span class="annottext">numX :: Int
</span><a href="#local-6989586621679180542"><span class="hs-identifier hs-var hs-var">numX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180511"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180513"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180540"><span class="hs-identifier hs-var">ij</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180539"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-190"></span><span>      </span><span id="local-6989586621679180543"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180543"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180542"><span class="hs-identifier hs-var">numX</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-191"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; [Bool]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; [Bool]) -&gt; Bool -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180514"><span class="hs-identifier hs-var">leftFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180537"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180538"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180514"><span class="hs-identifier hs-var">leftFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180540"><span class="hs-identifier hs-var">ij</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180539"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180543"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180514"><span class="hs-identifier hs-var">leftFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180537"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180541"><span class="hs-identifier hs-var">jk</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180543"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="annot"><a href="ApplicativeGen.html#prop_RightRight"><span class="hs-identifier hs-type">prop_RightRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-194"></span><span id="prop_RightRight"><span class="annot"><span class="annottext">prop_RightRight :: RawApplicativeData -&gt; Bool
</span><a href="ApplicativeGen.html#prop_RightRight"><span class="hs-identifier hs-var hs-var">prop_RightRight</span></a></span></span><span> </span><span id="local-6989586621679180544"><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180544"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679180545"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-196"></span><span>    </span><span id="local-6989586621679180546"><span class="annot"><span class="annottext">sig :: Vector Int
</span><a href="#local-6989586621679180546"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Vector Int
</span><a href="ApplicativeGen.html#_signature"><span class="hs-identifier hs-var">_signature</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180544"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span id="local-6989586621679180547"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679180547"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180546"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span id="local-6989586621679180548"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180548"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#monoidOp"><span class="hs-identifier hs-var">monoidOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180544"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span id="local-6989586621679180549"><span class="annot"><span class="annottext">rightFactor :: Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180549"><span class="hs-identifier hs-var hs-var">rightFactor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#rightFactorOp"><span class="hs-identifier hs-var">rightFactorOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180544"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span id="local-6989586621679180545"><span class="annot"><span class="annottext">result :: [Bool]
</span><a href="#local-6989586621679180545"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-201"></span><span>      </span><span id="local-6989586621679180572"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180572"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180547"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-202"></span><span>      </span><span id="local-6989586621679180573"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180573"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180547"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-203"></span><span>      </span><span id="local-6989586621679180574"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180574"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180547"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-204"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679180575"><span class="annot"><span class="annottext">ij :: Int
</span><a href="#local-6989586621679180575"><span class="hs-identifier hs-var hs-var">ij</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180548"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180572"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180573"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-205"></span><span>          </span><span id="local-6989586621679180576"><span class="annot"><span class="annottext">jk :: Int
</span><a href="#local-6989586621679180576"><span class="hs-identifier hs-var hs-var">jk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180548"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180573"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180574"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-206"></span><span>          </span><span id="local-6989586621679180577"><span class="annot"><span class="annottext">numX :: Int
</span><a href="#local-6989586621679180577"><span class="hs-identifier hs-var hs-var">numX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180546"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180548"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180575"><span class="hs-identifier hs-var">ij</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180574"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-207"></span><span>      </span><span id="local-6989586621679180578"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180578"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180577"><span class="hs-identifier hs-var">numX</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-208"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; [Bool]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; [Bool]) -&gt; Bool -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180549"><span class="hs-identifier hs-var">rightFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180573"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180574"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180549"><span class="hs-identifier hs-var">rightFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180572"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180576"><span class="hs-identifier hs-var">jk</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180578"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180549"><span class="hs-identifier hs-var">rightFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180575"><span class="hs-identifier hs-var">ij</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180574"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180578"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="annot"><a href="ApplicativeGen.html#prop_LeftRight"><span class="hs-identifier hs-type">prop_LeftRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-211"></span><span id="prop_LeftRight"><span class="annot"><span class="annottext">prop_LeftRight :: RawApplicativeData -&gt; Bool
</span><a href="ApplicativeGen.html#prop_LeftRight"><span class="hs-identifier hs-var hs-var">prop_LeftRight</span></a></span></span><span> </span><span id="local-6989586621679180579"><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180579"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679180580"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621679180581"><span class="annot"><span class="annottext">sig :: Vector Int
</span><a href="#local-6989586621679180581"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Vector Int
</span><a href="ApplicativeGen.html#_signature"><span class="hs-identifier hs-var">_signature</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180579"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621679180582"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679180582"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180581"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span id="local-6989586621679180583"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180583"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#monoidOp"><span class="hs-identifier hs-var">monoidOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180579"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span id="local-6989586621679180584"><span class="annot"><span class="annottext">leftFactor :: Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180584"><span class="hs-identifier hs-var hs-var">leftFactor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#leftFactorOp"><span class="hs-identifier hs-var">leftFactorOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180579"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-217"></span><span>    </span><span id="local-6989586621679180585"><span class="annot"><span class="annottext">rightFactor :: Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180585"><span class="hs-identifier hs-var hs-var">rightFactor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#rightFactorOp"><span class="hs-identifier hs-var">rightFactorOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180579"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-218"></span><span>    </span><span id="local-6989586621679180580"><span class="annot"><span class="annottext">result :: [Bool]
</span><a href="#local-6989586621679180580"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-219"></span><span>      </span><span id="local-6989586621679180608"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180608"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180582"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-220"></span><span>      </span><span id="local-6989586621679180609"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180609"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180582"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-221"></span><span>      </span><span id="local-6989586621679180610"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180610"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180582"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-222"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679180611"><span class="annot"><span class="annottext">ij :: Int
</span><a href="#local-6989586621679180611"><span class="hs-identifier hs-var hs-var">ij</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180583"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180608"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180609"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-223"></span><span>          </span><span id="local-6989586621679180612"><span class="annot"><span class="annottext">jk :: Int
</span><a href="#local-6989586621679180612"><span class="hs-identifier hs-var hs-var">jk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180583"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180609"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180610"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-224"></span><span>          </span><span id="local-6989586621679180613"><span class="annot"><span class="annottext">numX :: Int
</span><a href="#local-6989586621679180613"><span class="hs-identifier hs-var hs-var">numX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180581"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180583"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180611"><span class="hs-identifier hs-var">ij</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180610"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-225"></span><span>      </span><span id="local-6989586621679180614"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180614"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180613"><span class="hs-identifier hs-var">numX</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-226"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; [Bool]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; [Bool]) -&gt; Bool -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180585"><span class="hs-identifier hs-var">rightFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180608"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180609"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180584"><span class="hs-identifier hs-var">leftFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180611"><span class="hs-identifier hs-var">ij</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180610"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180614"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180584"><span class="hs-identifier hs-var">leftFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180609"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180610"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180585"><span class="hs-identifier hs-var">rightFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180608"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180612"><span class="hs-identifier hs-var">jk</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180614"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="annot"><a href="ApplicativeGen.html#genRawApplicativeData"><span class="hs-identifier hs-type">genRawApplicativeData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonoidGen.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-229"></span><span id="genRawApplicativeData"><span class="annot"><span class="annottext">genRawApplicativeData :: Vector Int -&gt; [RawApplicativeData]
</span><a href="ApplicativeGen.html#genRawApplicativeData"><span class="hs-identifier hs-var hs-var">genRawApplicativeData</span></a></span></span><span> </span><span id="local-6989586621679180615"><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180615"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-230"></span><span>  </span><span id="local-6989586621679180616"><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180616"><span class="hs-identifier hs-var">mon</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; [RawMonoidData]
</span><a href="MonoidGen.html#genRawMonoidsForApplicative"><span class="hs-identifier hs-var">genRawMonoidsForApplicative</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180615"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><span class="annottext">Vector Int -&gt; RawMonoidData -&gt; [RawApplicativeData]
</span><a href="ApplicativeGen.html#genRawApplicativeDataFrom"><span class="hs-identifier hs-var">genRawApplicativeDataFrom</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180615"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180616"><span class="hs-identifier hs-var">mon</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="annot"><a href="ApplicativeGen.html#genRawApplicativeDataFrom"><span class="hs-identifier hs-type">genRawApplicativeDataFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonoidGen.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonoidGen.html#RawMonoidData"><span class="hs-identifier hs-type">RawMonoidData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-234"></span><span id="genRawApplicativeDataFrom"><span class="annot"><span class="annottext">genRawApplicativeDataFrom :: Vector Int -&gt; RawMonoidData -&gt; [RawApplicativeData]
</span><a href="ApplicativeGen.html#genRawApplicativeDataFrom"><span class="hs-identifier hs-var hs-var">genRawApplicativeDataFrom</span></a></span></span><span> </span><span id="local-6989586621679180617"><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180617"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span id="local-6989586621679180618"><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180618"><span class="hs-identifier hs-var">mon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679180620"><span class="annot"><span class="annottext">tables :: [(FactorTable, FactorTable)]
</span><a href="#local-6989586621679180620"><span class="hs-identifier hs-var hs-var">tables</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
-&gt; RawMonoidData -&gt; DefTable Fn Int -&gt; (FactorTable, FactorTable)
</span><a href="ApplicativeGen.html#completeTable"><span class="hs-identifier hs-var">completeTable</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180617"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180618"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">(DefTable Fn Int -&gt; (FactorTable, FactorTable))
-&gt; [DefTable Fn Int] -&gt; [(FactorTable, FactorTable)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; RawMonoidData -&gt; [DefTable Fn Int]
</span><a href="ApplicativeGen.html#gen"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180617"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180618"><span class="hs-identifier hs-var">mon</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679180623"><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679180623"><span class="hs-identifier hs-var">leftFactorTable</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679180624"><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679180624"><span class="hs-identifier hs-var">rightFactorTable</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Vector Int
-&gt; RawMonoidData
-&gt; [(FactorTable, FactorTable)]
-&gt; [(FactorTable, FactorTable)]
</span><a href="ApplicativeGen.html#upToIso"><span class="hs-identifier hs-var">upToIso</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180617"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180618"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">[(FactorTable, FactorTable)]
</span><a href="#local-6989586621679180620"><span class="hs-identifier hs-var">tables</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679180626"><span class="annot"><span class="annottext">result :: RawApplicativeData
</span><a href="#local-6989586621679180626"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-238"></span><span>        </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span>
</span><span id="line-239"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_signature :: Vector Int
</span><a href="ApplicativeGen.html#_signature"><span class="hs-identifier hs-var">_signature</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180617"><span class="hs-identifier hs-var">sig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-240"></span><span>            </span><span class="annot"><span class="annottext">_baseMonoid :: RawMonoidData
</span><a href="ApplicativeGen.html#_baseMonoid"><span class="hs-identifier hs-var">_baseMonoid</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180618"><span class="hs-identifier hs-var">mon</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-241"></span><span>            </span><span class="annot"><span class="annottext">_leftFactorTable :: FactorTable
</span><a href="ApplicativeGen.html#_leftFactorTable"><span class="hs-identifier hs-var">_leftFactorTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679180623"><span class="hs-identifier hs-var">leftFactorTable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-242"></span><span>            </span><span class="annot"><span class="annottext">_rightFactorTable :: FactorTable
</span><a href="ApplicativeGen.html#_rightFactorTable"><span class="hs-identifier hs-var">_rightFactorTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679180624"><span class="hs-identifier hs-var">rightFactorTable</span></a></span><span>
</span><span id="line-243"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-comment">-- sanity check</span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679180627"><span class="annot"><span class="annottext">checkAll :: Bool
</span><a href="#local-6989586621679180627"><span class="hs-identifier hs-var hs-var">checkAll</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Bool
</span><a href="ApplicativeGen.html#prop_LeftUnit"><span class="hs-identifier hs-var">prop_LeftUnit</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180626"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Bool
</span><a href="ApplicativeGen.html#prop_RightUnit"><span class="hs-identifier hs-var">prop_RightUnit</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180626"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-246"></span><span>        </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Bool
</span><a href="ApplicativeGen.html#prop_LeftLeft"><span class="hs-identifier hs-var">prop_LeftLeft</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180626"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Bool
</span><a href="ApplicativeGen.html#prop_LeftRight"><span class="hs-identifier hs-var">prop_LeftRight</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180626"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Bool
</span><a href="ApplicativeGen.html#prop_RightRight"><span class="hs-identifier hs-var">prop_RightRight</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180626"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-247"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; [()] -&gt; [()]
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><span class="hs-identifier hs-var hs-var">assert</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679180627"><span class="hs-identifier hs-var">checkAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; [()]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>  </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; [RawApplicativeData]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679180626"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-keyword">data</span><span> </span><span id="Fn"><span class="annot"><a href="ApplicativeGen.html#Fn"><span class="hs-identifier hs-var">Fn</span></a></span></span><span> </span><span id="local-6989586621679180061"><span class="annot"><a href="#local-6989586621679180061"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LeftFactor"><span class="annot"><a href="ApplicativeGen.html#LeftFactor"><span class="hs-identifier hs-var">LeftFactor</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="#local-6989586621679180061"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="RightFactor"><span class="annot"><a href="ApplicativeGen.html#RightFactor"><span class="hs-identifier hs-var">RightFactor</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="#local-6989586621679180061"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679180633"><span id="local-6989586621679180643"><span id="local-6989586621679180647"><span class="annot"><span class="annottext">Int -&gt; Fn a -&gt; ShowS
[Fn a] -&gt; ShowS
Fn a -&gt; String
(Int -&gt; Fn a -&gt; ShowS)
-&gt; (Fn a -&gt; String) -&gt; ([Fn a] -&gt; ShowS) -&gt; Show (Fn a)
forall a. Show a =&gt; Int -&gt; Fn a -&gt; ShowS
forall a. Show a =&gt; [Fn a] -&gt; ShowS
forall a. Show a =&gt; Fn a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Fn a -&gt; ShowS
showsPrec :: Int -&gt; Fn a -&gt; ShowS
$cshow :: forall a. Show a =&gt; Fn a -&gt; String
show :: Fn a -&gt; String
$cshowList :: forall a. Show a =&gt; [Fn a] -&gt; ShowS
showList :: [Fn a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679180651"><span id="local-6989586621679180659"><span class="annot"><span class="annottext">Fn a -&gt; Fn a -&gt; Bool
(Fn a -&gt; Fn a -&gt; Bool) -&gt; (Fn a -&gt; Fn a -&gt; Bool) -&gt; Eq (Fn a)
forall a. Eq a =&gt; Fn a -&gt; Fn a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall a. Eq a =&gt; Fn a -&gt; Fn a -&gt; Bool
== :: Fn a -&gt; Fn a -&gt; Bool
$c/= :: forall a. Eq a =&gt; Fn a -&gt; Fn a -&gt; Bool
/= :: Fn a -&gt; Fn a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679180668"><span id="local-6989586621679180676"><span id="local-6989586621679180684"><span id="local-6989586621679180687"><span id="local-6989586621679180690"><span id="local-6989586621679180693"><span id="local-6989586621679180696"><span class="annot"><span class="annottext">Eq (Fn a)
Eq (Fn a) =&gt;
(Fn a -&gt; Fn a -&gt; Ordering)
-&gt; (Fn a -&gt; Fn a -&gt; Bool)
-&gt; (Fn a -&gt; Fn a -&gt; Bool)
-&gt; (Fn a -&gt; Fn a -&gt; Bool)
-&gt; (Fn a -&gt; Fn a -&gt; Bool)
-&gt; (Fn a -&gt; Fn a -&gt; Fn a)
-&gt; (Fn a -&gt; Fn a -&gt; Fn a)
-&gt; Ord (Fn a)
Fn a -&gt; Fn a -&gt; Bool
Fn a -&gt; Fn a -&gt; Ordering
Fn a -&gt; Fn a -&gt; Fn a
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall a. Ord a =&gt; Eq (Fn a)
forall a. Ord a =&gt; Fn a -&gt; Fn a -&gt; Bool
forall a. Ord a =&gt; Fn a -&gt; Fn a -&gt; Ordering
forall a. Ord a =&gt; Fn a -&gt; Fn a -&gt; Fn a
$ccompare :: forall a. Ord a =&gt; Fn a -&gt; Fn a -&gt; Ordering
compare :: Fn a -&gt; Fn a -&gt; Ordering
$c&lt; :: forall a. Ord a =&gt; Fn a -&gt; Fn a -&gt; Bool
&lt; :: Fn a -&gt; Fn a -&gt; Bool
$c&lt;= :: forall a. Ord a =&gt; Fn a -&gt; Fn a -&gt; Bool
&lt;= :: Fn a -&gt; Fn a -&gt; Bool
$c&gt; :: forall a. Ord a =&gt; Fn a -&gt; Fn a -&gt; Bool
&gt; :: Fn a -&gt; Fn a -&gt; Bool
$c&gt;= :: forall a. Ord a =&gt; Fn a -&gt; Fn a -&gt; Bool
&gt;= :: Fn a -&gt; Fn a -&gt; Bool
$cmax :: forall a. Ord a =&gt; Fn a -&gt; Fn a -&gt; Fn a
max :: Fn a -&gt; Fn a -&gt; Fn a
$cmin :: forall a. Ord a =&gt; Fn a -&gt; Fn a -&gt; Fn a
min :: Fn a -&gt; Fn a -&gt; Fn a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679180701"><span id="local-6989586621679180703"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; Fn a -&gt; Fn b)
-&gt; (forall a b. a -&gt; Fn b -&gt; Fn a) -&gt; Functor Fn
forall a b. a -&gt; Fn b -&gt; Fn a
forall a b. (a -&gt; b) -&gt; Fn a -&gt; Fn b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; Fn a -&gt; Fn b
fmap :: forall a b. (a -&gt; b) -&gt; Fn a -&gt; Fn b
$c&lt;$ :: forall a b. a -&gt; Fn b -&gt; Fn a
&lt;$ :: forall a b. a -&gt; Fn b -&gt; Fn a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679180707"><span id="local-6989586621679180713"><span id="local-6989586621679180716"><span id="local-6989586621679180721"><span id="local-6989586621679180723"><span id="local-6989586621679180726"><span id="local-6989586621679180729"><span id="local-6989586621679180732"><span id="local-6989586621679180735"><span id="local-6989586621679180738"><span id="local-6989586621679180741"><span id="local-6989586621679180743"><span id="local-6989586621679180746"><span id="local-6989586621679180751"><span id="local-6989586621679180756"><span id="local-6989586621679180761"><span id="local-6989586621679180766"><span class="annot"><span class="annottext">(forall m. Monoid m =&gt; Fn m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Fn a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Fn a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Fn a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Fn a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Fn a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Fn a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; Fn a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; Fn a -&gt; a)
-&gt; (forall a. Fn a -&gt; [a])
-&gt; (forall a. Fn a -&gt; Bool)
-&gt; (forall a. Fn a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; Fn a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; Fn a -&gt; a)
-&gt; (forall a. Ord a =&gt; Fn a -&gt; a)
-&gt; (forall a. Num a =&gt; Fn a -&gt; a)
-&gt; (forall a. Num a =&gt; Fn a -&gt; a)
-&gt; Foldable Fn
forall a. Eq a =&gt; a -&gt; Fn a -&gt; Bool
forall a. Num a =&gt; Fn a -&gt; a
forall a. Ord a =&gt; Fn a -&gt; a
forall m. Monoid m =&gt; Fn m -&gt; m
forall a. Fn a -&gt; Bool
forall a. Fn a -&gt; Int
forall a. Fn a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; Fn a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Fn a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Fn a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Fn a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
$cfold :: forall m. Monoid m =&gt; Fn m -&gt; m
fold :: forall m. Monoid m =&gt; Fn m -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Fn a -&gt; m
foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Fn a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Fn a -&gt; m
foldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Fn a -&gt; m
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Fn a -&gt; b
foldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Fn a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Fn a -&gt; b
foldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Fn a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Fn a -&gt; b
foldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Fn a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Fn a -&gt; b
foldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Fn a -&gt; b
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; Fn a -&gt; a
foldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; Fn a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; Fn a -&gt; a
foldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; Fn a -&gt; a
$ctoList :: forall a. Fn a -&gt; [a]
toList :: forall a. Fn a -&gt; [a]
$cnull :: forall a. Fn a -&gt; Bool
null :: forall a. Fn a -&gt; Bool
$clength :: forall a. Fn a -&gt; Int
length :: forall a. Fn a -&gt; Int
$celem :: forall a. Eq a =&gt; a -&gt; Fn a -&gt; Bool
elem :: forall a. Eq a =&gt; a -&gt; Fn a -&gt; Bool
$cmaximum :: forall a. Ord a =&gt; Fn a -&gt; a
maximum :: forall a. Ord a =&gt; Fn a -&gt; a
$cminimum :: forall a. Ord a =&gt; Fn a -&gt; a
minimum :: forall a. Ord a =&gt; Fn a -&gt; a
$csum :: forall a. Num a =&gt; Fn a -&gt; a
sum :: forall a. Num a =&gt; Fn a -&gt; a
$cproduct :: forall a. Num a =&gt; Fn a -&gt; a
product :: forall a. Num a =&gt; Fn a -&gt; a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679180776"><span id="local-6989586621679180782"><span id="local-6989586621679180788"><span id="local-6989586621679180793"><span class="annot"><span class="annottext">Functor Fn
Foldable Fn
(Functor Fn, Foldable Fn) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; Fn a -&gt; f (Fn b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; Fn (f a) -&gt; f (Fn a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; Fn a -&gt; m (Fn b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; Fn (m a) -&gt; m (Fn a))
-&gt; Traversable Fn
forall (t :: * -&gt; *).
(Functor t, Foldable t) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a. Monad m =&gt; Fn (m a) -&gt; m (Fn a)
forall (f :: * -&gt; *) a. Applicative f =&gt; Fn (f a) -&gt; f (Fn a)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; Fn a -&gt; m (Fn b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Fn a -&gt; f (Fn b)
$ctraverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Fn a -&gt; f (Fn b)
traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Fn a -&gt; f (Fn b)
$csequenceA :: forall (f :: * -&gt; *) a. Applicative f =&gt; Fn (f a) -&gt; f (Fn a)
sequenceA :: forall (f :: * -&gt; *) a. Applicative f =&gt; Fn (f a) -&gt; f (Fn a)
$cmapM :: forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; Fn a -&gt; m (Fn b)
mapM :: forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; Fn a -&gt; m (Fn b)
$csequence :: forall (m :: * -&gt; *) a. Monad m =&gt; Fn (m a) -&gt; m (Fn a)
sequence :: forall (m :: * -&gt; *) a. Monad m =&gt; Fn (m a) -&gt; m (Fn a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-keyword">type</span><span> </span><span id="Expr%27"><span class="annot"><a href="ApplicativeGen.html#Expr%27"><span class="hs-identifier hs-var">Expr'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Expr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Sig</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="hs-keyword">type</span><span> </span><span id="Equation%27"><span class="annot"><a href="ApplicativeGen.html#Equation%27"><span class="hs-identifier hs-var">Equation'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Sig</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-keyword">type</span><span> </span><span id="DefTable"><span class="annot"><a href="ApplicativeGen.html#DefTable"><span class="hs-identifier hs-var">DefTable</span></a></span></span><span> </span><span id="local-6989586621679180799"><span class="annot"><a href="#local-6989586621679180799"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679180800"><span class="annot"><a href="#local-6989586621679180800"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679180799"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180800"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679180800"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="annot"><a href="ApplicativeGen.html#leftE"><span class="hs-identifier hs-type">leftE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#rightE"><span class="hs-identifier hs-type">rightE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#Expr%27"><span class="hs-identifier hs-type">Expr'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#Expr%27"><span class="hs-identifier hs-type">Expr'</span></a></span><span>
</span><span id="line-260"></span><span id="leftE"><span class="annot"><span class="annottext">leftE :: Int -&gt; Int -&gt; Expr' -&gt; Expr'
</span><a href="ApplicativeGen.html#leftE"><span class="hs-identifier hs-var hs-var">leftE</span></a></span></span><span> </span><span id="local-6989586621679180803"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180803"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679180804"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180804"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Sig (Fn Int) Int Int) -&gt; Expr' -&gt; Expr'
forall x (f :: * -&gt; *) y. (x -&gt; f y) -&gt; Expr f x -&gt; Expr f y
</span><span class="hs-identifier hs-var">lift1</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679180806"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180806"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Fn Int -&gt; Sig (Fn Int) Int Int
forall args ret. args -&gt; Sig args ret ret
</span><span class="hs-identifier hs-var">Sig</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Fn Int
forall a. Int -&gt; Int -&gt; a -&gt; Fn a
</span><a href="ApplicativeGen.html#LeftFactor"><span class="hs-identifier hs-var">LeftFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180803"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180804"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180806"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span id="rightE"><span class="annot"><span class="annottext">rightE :: Int -&gt; Int -&gt; Expr' -&gt; Expr'
</span><a href="ApplicativeGen.html#rightE"><span class="hs-identifier hs-var hs-var">rightE</span></a></span></span><span> </span><span id="local-6989586621679180808"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180808"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679180809"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180809"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Sig (Fn Int) Int Int) -&gt; Expr' -&gt; Expr'
forall x (f :: * -&gt; *) y. (x -&gt; f y) -&gt; Expr f x -&gt; Expr f y
</span><span class="hs-identifier hs-var">lift1</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679180810"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180810"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Fn Int -&gt; Sig (Fn Int) Int Int
forall args ret. args -&gt; Sig args ret ret
</span><span class="hs-identifier hs-var">Sig</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Fn Int
forall a. Int -&gt; Int -&gt; a -&gt; Fn a
</span><a href="ApplicativeGen.html#RightFactor"><span class="hs-identifier hs-var">RightFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180808"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180809"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180810"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="annot"><a href="ApplicativeGen.html#makeEqUnitL"><span class="hs-identifier hs-type">makeEqUnitL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#makeEqUnitR"><span class="hs-identifier hs-type">makeEqUnitR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonoidGen.html#RawMonoidData"><span class="hs-identifier hs-type">RawMonoidData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#Equation%27"><span class="hs-identifier hs-type">Equation'</span></a></span><span>
</span><span id="line-264"></span><span id="makeEqUnitL"><span class="annot"><span class="annottext">makeEqUnitL :: RawMonoidData -&gt; Int -&gt; Int -&gt; Equation'
</span><a href="ApplicativeGen.html#makeEqUnitL"><span class="hs-identifier hs-var hs-var">makeEqUnitL</span></a></span></span><span> </span><span id="local-6989586621679180813"><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180813"><span class="hs-identifier hs-var">mon</span></a></span></span><span> </span><span id="local-6989586621679180814"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180814"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679180815"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180815"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Expr' -&gt; Expr'
</span><a href="ApplicativeGen.html#leftE"><span class="hs-identifier hs-var">leftE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180814"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180816"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Expr'
forall a. a -&gt; Expr (Sig (Fn Int) Int) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180815"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr' -&gt; Int -&gt; Equation'
forall x (f :: * -&gt; *). Eq x =&gt; Expr f x -&gt; x -&gt; Property f
</span><span class="hs-operator hs-var">`evaluatesTo`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180815"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-266"></span><span>    </span><span id="local-6989586621679180816"><span class="annot"><span class="annottext">e :: Int
</span><a href="#local-6989586621679180816"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Int
</span><a href="MonoidGen.html#_unitElem"><span class="hs-identifier hs-var">_unitElem</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180813"><span class="hs-identifier hs-var">mon</span></a></span><span>
</span><span id="line-267"></span><span id="makeEqUnitR"><span class="annot"><span class="annottext">makeEqUnitR :: RawMonoidData -&gt; Int -&gt; Int -&gt; Equation'
</span><a href="ApplicativeGen.html#makeEqUnitR"><span class="hs-identifier hs-var hs-var">makeEqUnitR</span></a></span></span><span> </span><span id="local-6989586621679180818"><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180818"><span class="hs-identifier hs-var">mon</span></a></span></span><span> </span><span id="local-6989586621679180819"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180819"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679180820"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180820"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Expr' -&gt; Expr'
</span><a href="ApplicativeGen.html#rightE"><span class="hs-identifier hs-var">rightE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180821"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180819"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Expr'
forall a. a -&gt; Expr (Sig (Fn Int) Int) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180820"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr' -&gt; Int -&gt; Equation'
forall x (f :: * -&gt; *). Eq x =&gt; Expr f x -&gt; x -&gt; Property f
</span><span class="hs-operator hs-var">`evaluatesTo`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180820"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621679180821"><span class="annot"><span class="annottext">e :: Int
</span><a href="#local-6989586621679180821"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Int
</span><a href="MonoidGen.html#_unitElem"><span class="hs-identifier hs-var">_unitElem</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180818"><span class="hs-identifier hs-var">mon</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="annot"><a href="ApplicativeGen.html#makeEqAssocLL"><span class="hs-identifier hs-type">makeEqAssocLL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#makeEqAssocLR"><span class="hs-identifier hs-type">makeEqAssocLR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#makeEqAssocRR"><span class="hs-identifier hs-type">makeEqAssocRR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonoidGen.html#RawMonoidData"><span class="hs-identifier hs-type">RawMonoidData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#Equation%27"><span class="hs-identifier hs-type">Equation'</span></a></span><span>
</span><span id="line-272"></span><span id="makeEqAssocLL"><span class="annot"><span class="annottext">makeEqAssocLL :: RawMonoidData -&gt; (Int, Int, Int) -&gt; Int -&gt; Equation'
</span><a href="ApplicativeGen.html#makeEqAssocLL"><span class="hs-identifier hs-var hs-var">makeEqAssocLL</span></a></span></span><span> </span><span id="local-6989586621679180825"><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180825"><span class="hs-identifier hs-var">mon</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679180826"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180826"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679180827"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180827"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679180828"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180828"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679180829"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180829"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Expr' -&gt; Expr'
</span><a href="ApplicativeGen.html#leftE"><span class="hs-identifier hs-var">leftE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180826"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180830"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180827"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180828"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Expr'
forall a. a -&gt; Expr (Sig (Fn Int) Int) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180829"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr' -&gt; Expr' -&gt; Equation'
forall x (f :: * -&gt; *). Eq x =&gt; Expr f x -&gt; Expr f x -&gt; Property f
</span><span class="hs-operator hs-var">`equals`</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Expr' -&gt; Expr'
</span><a href="ApplicativeGen.html#leftE"><span class="hs-identifier hs-var">leftE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180826"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180827"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Expr' -&gt; Expr'
</span><a href="ApplicativeGen.html#leftE"><span class="hs-identifier hs-var">leftE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180830"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180826"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180827"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180828"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Expr'
forall a. a -&gt; Expr (Sig (Fn Int) Int) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180829"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-274"></span><span>    </span><span id="local-6989586621679180830"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180830"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679180835"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180835"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679180836"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180836"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Array (Int, Int) Int
</span><a href="MonoidGen.html#_multTable"><span class="hs-identifier hs-var">_multTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180825"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) Int -&gt; (Int, Int) -&gt; Int
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180835"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180836"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span id="makeEqAssocRR"><span class="annot"><span class="annottext">makeEqAssocRR :: RawMonoidData -&gt; (Int, Int, Int) -&gt; Int -&gt; Equation'
</span><a href="ApplicativeGen.html#makeEqAssocRR"><span class="hs-identifier hs-var hs-var">makeEqAssocRR</span></a></span></span><span> </span><span id="local-6989586621679180837"><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180837"><span class="hs-identifier hs-var">mon</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679180838"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180838"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679180839"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180839"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679180840"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180840"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679180841"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180841"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Expr' -&gt; Expr'
</span><a href="ApplicativeGen.html#rightE"><span class="hs-identifier hs-var">rightE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180842"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180838"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180839"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180840"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Expr'
forall a. a -&gt; Expr (Sig (Fn Int) Int) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180841"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr' -&gt; Expr' -&gt; Equation'
forall x (f :: * -&gt; *). Eq x =&gt; Expr f x -&gt; Expr f x -&gt; Property f
</span><span class="hs-operator hs-var">`equals`</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Expr' -&gt; Expr'
</span><a href="ApplicativeGen.html#rightE"><span class="hs-identifier hs-var">rightE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180839"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180840"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Expr' -&gt; Expr'
</span><a href="ApplicativeGen.html#rightE"><span class="hs-identifier hs-var">rightE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180838"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180842"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180839"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180840"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Expr'
forall a. a -&gt; Expr (Sig (Fn Int) Int) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180841"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-277"></span><span>    </span><span id="local-6989586621679180842"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180842"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679180846"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180846"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679180847"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180847"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Array (Int, Int) Int
</span><a href="MonoidGen.html#_multTable"><span class="hs-identifier hs-var">_multTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180837"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) Int -&gt; (Int, Int) -&gt; Int
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180846"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180847"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span id="makeEqAssocLR"><span class="annot"><span class="annottext">makeEqAssocLR :: RawMonoidData -&gt; (Int, Int, Int) -&gt; Int -&gt; Equation'
</span><a href="ApplicativeGen.html#makeEqAssocLR"><span class="hs-identifier hs-var hs-var">makeEqAssocLR</span></a></span></span><span> </span><span id="local-6989586621679180848"><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180848"><span class="hs-identifier hs-var">mon</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679180849"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180849"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679180850"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180850"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679180851"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180851"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679180852"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180852"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-279"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Expr' -&gt; Expr'
</span><a href="ApplicativeGen.html#leftE"><span class="hs-identifier hs-var">leftE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180850"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180851"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Expr' -&gt; Expr'
</span><a href="ApplicativeGen.html#rightE"><span class="hs-identifier hs-var">rightE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180849"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180853"><span class="hs-identifier hs-var">jk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Expr'
forall a. a -&gt; Expr (Sig (Fn Int) Int) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180852"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><span class="annottext">Expr' -&gt; Expr' -&gt; Equation'
forall x (f :: * -&gt; *). Eq x =&gt; Expr f x -&gt; Expr f x -&gt; Property f
</span><span class="hs-operator hs-var">`equals`</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Expr' -&gt; Expr'
</span><a href="ApplicativeGen.html#rightE"><span class="hs-identifier hs-var">rightE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180849"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180850"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Expr' -&gt; Expr'
</span><a href="ApplicativeGen.html#leftE"><span class="hs-identifier hs-var">leftE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180854"><span class="hs-identifier hs-var">ij</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180851"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Expr'
forall a. a -&gt; Expr (Sig (Fn Int) Int) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180852"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-282"></span><span>    </span><span id="local-6989586621679180858"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180858"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679180859"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180859"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679180860"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180860"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Array (Int, Int) Int
</span><a href="MonoidGen.html#_multTable"><span class="hs-identifier hs-var">_multTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180848"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) Int -&gt; (Int, Int) -&gt; Int
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180859"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180860"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>    </span><span id="local-6989586621679180854"><span class="annot"><span class="annottext">ij :: Int
</span><a href="#local-6989586621679180854"><span class="hs-identifier hs-var hs-var">ij</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180858"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180849"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180850"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-284"></span><span>    </span><span id="local-6989586621679180853"><span class="annot"><span class="annottext">jk :: Int
</span><a href="#local-6989586621679180853"><span class="hs-identifier hs-var hs-var">jk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180858"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180850"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180851"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="annot"><a href="ApplicativeGen.html#genDefTables"><span class="hs-identifier hs-type">genDefTables</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Model</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Sig</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApplicativeGen.html#Equation%27"><span class="hs-identifier hs-type">Equation'</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApplicativeGen.html#DefTable"><span class="hs-identifier hs-type">DefTable</span></a></span><span> </span><span class="annot"><a href="ApplicativeGen.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-287"></span><span id="genDefTables"><span class="annot"><span class="annottext">genDefTables :: Model (Sig (Fn Int) Int) -&gt; [Equation'] -&gt; [DefTable Fn Int]
</span><a href="ApplicativeGen.html#genDefTables"><span class="hs-identifier hs-var hs-var">genDefTables</span></a></span></span><span> </span><span id="local-6989586621679180862"><span class="annot"><span class="annottext">Model (Sig (Fn Int) Int)
</span><a href="#local-6989586621679180862"><span class="hs-identifier hs-var">model</span></a></span></span><span> </span><span id="local-6989586621679180863"><span class="annot"><span class="annottext">[Equation']
</span><a href="#local-6989586621679180863"><span class="hs-identifier hs-var">props</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Model (Sig (Fn Int) Int)
-&gt; Map Int Equation'
-&gt; [Model (Sig (Fn Int) Int)]
forall (f :: * -&gt; *) k.
(GCompare f, Has Ord f, Ord k) =&gt;
Int -&gt; Model f -&gt; Map k (Property f) -&gt; [Model f]
</span><span class="hs-identifier hs-var">solve</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Model (Sig (Fn Int) Int)
</span><a href="#local-6989586621679180862"><span class="hs-identifier hs-var">model</span></a></span><span> </span><span class="annot"><span class="annottext">Map Int Equation'
</span><a href="#local-6989586621679180865"><span class="hs-identifier hs-var">propsMap</span></a></span><span> </span><span class="annot"><span class="annottext">[Model (Sig (Fn Int) Int)]
-&gt; (Model (Sig (Fn Int) Int) -&gt; [Solution (Sig (Fn Int) Int)])
-&gt; [Solution (Sig (Fn Int) Int)]
forall a b. [a] -&gt; (a -&gt; [b]) -&gt; [b]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Model (Sig (Fn Int) Int) -&gt; [Solution (Sig (Fn Int) Int)]
forall (f :: * -&gt; *). Model f -&gt; [Solution f]
</span><span class="hs-identifier hs-var">constraintToSolution</span></span><span> </span><span class="annot"><span class="annottext">[Solution (Sig (Fn Int) Int)]
-&gt; (Solution (Sig (Fn Int) Int) -&gt; [DefTable Fn Int])
-&gt; [DefTable Fn Int]
forall a b. [a] -&gt; (a -&gt; [b]) -&gt; [b]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">DefTable Fn Int -&gt; [DefTable Fn Int]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(DefTable Fn Int -&gt; [DefTable Fn Int])
-&gt; (Solution (Sig (Fn Int) Int) -&gt; DefTable Fn Int)
-&gt; Solution (Sig (Fn Int) Int)
-&gt; [DefTable Fn Int]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Solution (Sig (Fn Int) Int) -&gt; DefTable Fn Int
forall args ret.
Ord args =&gt;
Solution (Sig args ret) -&gt; Map args ret
</span><span class="hs-identifier hs-var">monoSolutionToMap</span></span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-289"></span><span>    </span><span id="local-6989586621679180865"><span class="annot"><span class="annottext">propsMap :: Map Int Equation'
</span><a href="#local-6989586621679180865"><span class="hs-identifier hs-var hs-var">propsMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Int, Equation')] -&gt; Map Int Equation'
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; [Equation'] -&gt; [(Int, Equation')]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Equation']
</span><a href="#local-6989586621679180863"><span class="hs-identifier hs-var">props</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="annot"><a href="ApplicativeGen.html#makeModel"><span class="hs-identifier hs-type">makeModel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonoidGen.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonoidGen.html#RawMonoidData"><span class="hs-identifier hs-type">RawMonoidData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Model</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Sig</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span id="makeModel"><span class="annot"><span class="annottext">makeModel :: Vector Int
-&gt; RawMonoidData -&gt; (Fn Int -&gt; [Int]) -&gt; Model (Sig (Fn Int) Int)
</span><a href="ApplicativeGen.html#makeModel"><span class="hs-identifier hs-var hs-var">makeModel</span></a></span></span><span> </span><span id="local-6989586621679180871"><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180871"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span id="local-6989586621679180872"><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180872"><span class="hs-identifier hs-var">mon</span></a></span></span><span> </span><span id="local-6989586621679180873"><span class="annot"><span class="annottext">Fn Int -&gt; [Int]
</span><a href="#local-6989586621679180873"><span class="hs-identifier hs-var">guess</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Fn Int) (Set Int) -&gt; Model (Sig (Fn Int) Int)
forall args ret.
Ord args =&gt;
Map args (Set ret) -&gt; Model (Sig args ret)
</span><span class="hs-identifier hs-var">monoMakeModel</span></span><span> </span><span class="annot"><span class="annottext">(Map (Fn Int) (Set Int) -&gt; Model (Sig (Fn Int) Int))
-&gt; ([(Fn Int, Set Int)] -&gt; Map (Fn Int) (Set Int))
-&gt; [(Fn Int, Set Int)]
-&gt; Model (Sig (Fn Int) Int)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Fn Int, Set Int)] -&gt; Map (Fn Int) (Set Int)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Fn Int, Set Int)] -&gt; Model (Sig (Fn Int) Int))
-&gt; [(Fn Int, Set Int)] -&gt; Model (Sig (Fn Int) Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Fn Int, Set Int)]
</span><a href="#local-6989586621679180875"><span class="hs-identifier hs-var">modelList</span></a></span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-294"></span><span>    </span><span id="local-6989586621679180876"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679180876"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Int
</span><a href="MonoidGen.html#_monoidSize"><span class="hs-identifier hs-var">_monoidSize</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180872"><span class="hs-identifier hs-var">mon</span></a></span><span>
</span><span id="line-295"></span><span>    </span><span id="local-6989586621679180881"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180881"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679180882"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180882"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679180883"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180883"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Array (Int, Int) Int
</span><a href="MonoidGen.html#_multTable"><span class="hs-identifier hs-var">_multTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180872"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) Int -&gt; (Int, Int) -&gt; Int
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180882"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180883"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>    </span><span id="local-6989586621679180875"><span class="annot"><span class="annottext">modelList :: [(Fn Int, Set Int)]
</span><a href="#local-6989586621679180875"><span class="hs-identifier hs-var hs-var">modelList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-297"></span><span>      </span><span id="local-6989586621679180901"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180901"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180876"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-298"></span><span>      </span><span id="local-6989586621679180902"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180902"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180876"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-299"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679180903"><span class="annot"><span class="annottext">numK :: Int
</span><a href="#local-6989586621679180903"><span class="hs-identifier hs-var hs-var">numK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180871"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180881"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180901"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180902"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-300"></span><span>      </span><span id="local-6989586621679180904"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180904"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180903"><span class="hs-identifier hs-var">numK</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-301"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679180905"><span class="annot"><span class="annottext">leftF :: Fn Int
</span><a href="#local-6989586621679180905"><span class="hs-identifier hs-var hs-var">leftF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Fn Int
forall a. Int -&gt; Int -&gt; a -&gt; Fn a
</span><a href="ApplicativeGen.html#LeftFactor"><span class="hs-identifier hs-var">LeftFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180901"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180902"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180904"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-302"></span><span>          </span><span id="local-6989586621679180906"><span class="annot"><span class="annottext">rightF :: Fn Int
</span><a href="#local-6989586621679180906"><span class="hs-identifier hs-var hs-var">rightF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Fn Int
forall a. Int -&gt; Int -&gt; a -&gt; Fn a
</span><a href="ApplicativeGen.html#RightFactor"><span class="hs-identifier hs-var">RightFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180901"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180902"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180904"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-303"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fn Int
</span><a href="#local-6989586621679180905"><span class="hs-identifier hs-var">leftF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Set Int
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fn Int -&gt; [Int]
</span><a href="#local-6989586621679180873"><span class="hs-identifier hs-var">guess</span></a></span><span> </span><span class="annot"><span class="annottext">Fn Int
</span><a href="#local-6989586621679180905"><span class="hs-identifier hs-var">leftF</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-304"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fn Int
</span><a href="#local-6989586621679180906"><span class="hs-identifier hs-var">rightF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Set Int
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fn Int -&gt; [Int]
</span><a href="#local-6989586621679180873"><span class="hs-identifier hs-var">guess</span></a></span><span> </span><span class="annot"><span class="annottext">Fn Int
</span><a href="#local-6989586621679180906"><span class="hs-identifier hs-var">rightF</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="annot"><a href="ApplicativeGen.html#gen"><span class="hs-identifier hs-type">gen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonoidGen.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonoidGen.html#RawMonoidData"><span class="hs-identifier hs-type">RawMonoidData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApplicativeGen.html#DefTable"><span class="hs-identifier hs-type">DefTable</span></a></span><span> </span><span class="annot"><a href="ApplicativeGen.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-307"></span><span id="gen"><span class="annot"><span class="annottext">gen :: Vector Int -&gt; RawMonoidData -&gt; [DefTable Fn Int]
</span><a href="ApplicativeGen.html#gen"><span class="hs-identifier hs-var hs-var">gen</span></a></span></span><span> </span><span id="local-6989586621679180908"><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180908"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span id="local-6989586621679180909"><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180909"><span class="hs-identifier hs-var">mon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Model (Sig (Fn Int) Int) -&gt; [Equation'] -&gt; [DefTable Fn Int]
</span><a href="ApplicativeGen.html#genDefTables"><span class="hs-identifier hs-var">genDefTables</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Int
-&gt; RawMonoidData -&gt; (Fn Int -&gt; [Int]) -&gt; Model (Sig (Fn Int) Int)
</span><a href="ApplicativeGen.html#makeModel"><span class="hs-identifier hs-var">makeModel</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180908"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180909"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">Fn Int -&gt; [Int]
forall {a}. Fn a -&gt; [Int]
</span><a href="#local-6989586621679180910"><span class="hs-identifier hs-var">guess</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Equation']
</span><a href="#local-6989586621679180911"><span class="hs-identifier hs-var">equations</span></a></span><span>
</span><span id="line-308"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-309"></span><span>    </span><span id="local-6989586621679180912"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679180912"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Int
</span><a href="MonoidGen.html#_monoidSize"><span class="hs-identifier hs-var">_monoidSize</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180909"><span class="hs-identifier hs-var">mon</span></a></span><span>
</span><span id="line-310"></span><span>    </span><span id="local-6989586621679180916"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180916"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679180917"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180917"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679180918"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180918"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Array (Int, Int) Int
</span><a href="MonoidGen.html#_multTable"><span class="hs-identifier hs-var">_multTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180909"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) Int -&gt; (Int, Int) -&gt; Int
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180917"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180918"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>    </span><span id="local-6989586621679180911"><span class="annot"><span class="annottext">equations :: [Equation']
</span><a href="#local-6989586621679180911"><span class="hs-identifier hs-var hs-var">equations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Equation']
</span><a href="#local-6989586621679180919"><span class="hs-identifier hs-var">unitEquations</span></a></span><span> </span><span class="annot"><span class="annottext">[Equation'] -&gt; [Equation'] -&gt; [Equation']
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Equation']
</span><a href="#local-6989586621679180920"><span class="hs-identifier hs-var">assocEquations</span></a></span><span>
</span><span id="line-312"></span><span>    </span><span id="local-6989586621679180919"><span class="annot"><span class="annottext">unitEquations :: [Equation']
</span><a href="#local-6989586621679180919"><span class="hs-identifier hs-var hs-var">unitEquations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-313"></span><span>      </span><span id="local-6989586621679180931"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180931"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180912"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-314"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679180932"><span class="annot"><span class="annottext">numX :: Int
</span><a href="#local-6989586621679180932"><span class="hs-identifier hs-var hs-var">numX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180908"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180931"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-315"></span><span>      </span><span id="local-6989586621679180933"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180933"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180932"><span class="hs-identifier hs-var">numX</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-316"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RawMonoidData -&gt; Int -&gt; Int -&gt; Equation'
</span><a href="ApplicativeGen.html#makeEqUnitL"><span class="hs-identifier hs-var">makeEqUnitL</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180909"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180931"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180933"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Int -&gt; Int -&gt; Equation'
</span><a href="ApplicativeGen.html#makeEqUnitR"><span class="hs-identifier hs-var">makeEqUnitR</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180909"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180931"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180933"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-317"></span><span>    </span><span id="local-6989586621679180920"><span class="annot"><span class="annottext">assocEquations :: [Equation']
</span><a href="#local-6989586621679180920"><span class="hs-identifier hs-var hs-var">assocEquations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-318"></span><span>      </span><span id="local-6989586621679180954"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180954"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180912"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-319"></span><span>      </span><span id="local-6989586621679180955"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180955"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180912"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-320"></span><span>      </span><span id="local-6989586621679180956"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180956"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180912"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-321"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679180957"><span class="annot"><span class="annottext">ijk :: Int
</span><a href="#local-6989586621679180957"><span class="hs-identifier hs-var hs-var">ijk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180916"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180954"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180916"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180955"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180956"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>          </span><span id="local-6989586621679180958"><span class="annot"><span class="annottext">numX :: Int
</span><a href="#local-6989586621679180958"><span class="hs-identifier hs-var hs-var">numX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180908"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180957"><span class="hs-identifier hs-var">ijk</span></a></span><span>
</span><span id="line-323"></span><span>      </span><span id="local-6989586621679180959"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180959"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180958"><span class="hs-identifier hs-var">numX</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-324"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RawMonoidData -&gt; (Int, Int, Int) -&gt; Int -&gt; Equation'
</span><a href="ApplicativeGen.html#makeEqAssocLL"><span class="hs-identifier hs-var">makeEqAssocLL</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180909"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180954"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180955"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180956"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180959"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; (Int, Int, Int) -&gt; Int -&gt; Equation'
</span><a href="ApplicativeGen.html#makeEqAssocRR"><span class="hs-identifier hs-var">makeEqAssocRR</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180909"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180954"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180955"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180956"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180959"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; (Int, Int, Int) -&gt; Int -&gt; Equation'
</span><a href="ApplicativeGen.html#makeEqAssocLR"><span class="hs-identifier hs-var">makeEqAssocLR</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180909"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180954"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180955"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180956"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180959"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span>    </span><span id="local-6989586621679180910"><span class="annot"><span class="annottext">guess :: Fn a -&gt; [Int]
</span><a href="#local-6989586621679180910"><span class="hs-identifier hs-var hs-var">guess</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#LeftFactor"><span class="hs-identifier hs-type">LeftFactor</span></a></span><span> </span><span id="local-6989586621679180968"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180968"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180908"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180968"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-327"></span><span>    </span><span class="annot"><a href="#local-6989586621679180910"><span class="hs-identifier hs-var">guess</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#RightFactor"><span class="hs-identifier hs-type">RightFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679180969"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180969"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180908"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180969"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="annot"><a href="ApplicativeGen.html#completeTable"><span class="hs-identifier hs-type">completeTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonoidGen.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonoidGen.html#RawMonoidData"><span class="hs-identifier hs-type">RawMonoidData</span></a></span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#DefTable"><span class="hs-identifier hs-type">DefTable</span></a></span><span> </span><span class="annot"><a href="ApplicativeGen.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-331"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span id="completeTable"><span class="annot"><span class="annottext">completeTable :: Vector Int
-&gt; RawMonoidData -&gt; DefTable Fn Int -&gt; (FactorTable, FactorTable)
</span><a href="ApplicativeGen.html#completeTable"><span class="hs-identifier hs-var hs-var">completeTable</span></a></span></span><span> </span><span id="local-6989586621679180970"><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180970"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span id="local-6989586621679180971"><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180971"><span class="hs-identifier hs-var">mon</span></a></span></span><span> </span><span id="local-6989586621679180972"><span class="annot"><span class="annottext">DefTable Fn Int
</span><a href="#local-6989586621679180972"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FactorTable -&gt; FactorTable -&gt; (FactorTable, FactorTable))
-&gt; Maybe FactorTable
-&gt; Maybe (FactorTable -&gt; (FactorTable, FactorTable))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe FactorTable
</span><a href="#local-6989586621679180973"><span class="hs-identifier hs-var">leftTable</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (FactorTable -&gt; (FactorTable, FactorTable))
-&gt; Maybe FactorTable -&gt; Maybe (FactorTable, FactorTable)
forall a b. Maybe (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe FactorTable
</span><a href="#local-6989586621679180974"><span class="hs-identifier hs-var">rightTable</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-333"></span><span>    </span><span class="annot"><span class="annottext">Maybe (FactorTable, FactorTable)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (FactorTable, FactorTable)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;incomplete table?&quot;</span></span><span>
</span><span id="line-334"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679180976"><span class="annot"><span class="annottext">(FactorTable, FactorTable)
</span><a href="#local-6989586621679180976"><span class="hs-identifier hs-var">tabs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(FactorTable, FactorTable)
</span><a href="#local-6989586621679180976"><span class="hs-identifier hs-var">tabs</span></a></span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-336"></span><span>    </span><span id="local-6989586621679180977"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679180977"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Int
</span><a href="MonoidGen.html#_monoidSize"><span class="hs-identifier hs-var">_monoidSize</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180971"><span class="hs-identifier hs-var">mon</span></a></span><span>
</span><span id="line-337"></span><span>    </span><span id="local-6989586621679180981"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180981"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679180982"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180982"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679180983"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180983"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Array (Int, Int) Int
</span><a href="MonoidGen.html#_multTable"><span class="hs-identifier hs-var">_multTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679180971"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) Int -&gt; (Int, Int) -&gt; Int
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180982"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180983"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>    </span><span id="local-6989586621679180990"><span class="annot"><span class="annottext">arrayRange :: ((Int, Int), (Int, Int))
</span><a href="#local-6989586621679180990"><span class="hs-identifier hs-var hs-var">arrayRange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180977"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180977"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span>    </span><span id="local-6989586621679180973"><span class="annot"><span class="annottext">leftTable :: Maybe FactorTable
</span><a href="#local-6989586621679180973"><span class="hs-identifier hs-var hs-var">leftTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Int), (Int, Int))
-&gt; ((Int, Int) -&gt; Maybe (Vector Int)) -&gt; Maybe FactorTable
forall i (f :: * -&gt; *) a.
(Ix i, Monad f) =&gt;
(i, i) -&gt; (i -&gt; f a) -&gt; f (Array i a)
</span><a href="Data.Array.Extra.html#genArrayM"><span class="hs-identifier hs-var">Array.genArrayM</span></a></span><span> </span><span class="annot"><span class="annottext">((Int, Int), (Int, Int))
</span><a href="#local-6989586621679180990"><span class="hs-identifier hs-var">arrayRange</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679181000"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181000"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679181001"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181001"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; Maybe Int) -&gt; Maybe (Vector Int)
forall (m :: * -&gt; *) a.
Monad m =&gt;
Int -&gt; (Int -&gt; m a) -&gt; m (Vector a)
</span><span class="hs-identifier hs-var">V.generateM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180970"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180981"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181000"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181001"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679181003"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181003"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Fn Int -&gt; DefTable Fn Int -&gt; Maybe Int
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Fn Int
forall a. Int -&gt; Int -&gt; a -&gt; Fn a
</span><a href="ApplicativeGen.html#LeftFactor"><span class="hs-identifier hs-var">LeftFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181000"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181001"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181003"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DefTable Fn Int
</span><a href="#local-6989586621679180972"><span class="hs-identifier hs-var">table</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>    </span><span id="local-6989586621679180974"><span class="annot"><span class="annottext">rightTable :: Maybe FactorTable
</span><a href="#local-6989586621679180974"><span class="hs-identifier hs-var hs-var">rightTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Int), (Int, Int))
-&gt; ((Int, Int) -&gt; Maybe (Vector Int)) -&gt; Maybe FactorTable
forall i (f :: * -&gt; *) a.
(Ix i, Monad f) =&gt;
(i, i) -&gt; (i -&gt; f a) -&gt; f (Array i a)
</span><a href="Data.Array.Extra.html#genArrayM"><span class="hs-identifier hs-var">Array.genArrayM</span></a></span><span> </span><span class="annot"><span class="annottext">((Int, Int), (Int, Int))
</span><a href="#local-6989586621679180990"><span class="hs-identifier hs-var">arrayRange</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679181012"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181012"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679181013"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181013"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; Maybe Int) -&gt; Maybe (Vector Int)
forall (m :: * -&gt; *) a.
Monad m =&gt;
Int -&gt; (Int -&gt; m a) -&gt; m (Vector a)
</span><span class="hs-identifier hs-var">V.generateM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679180970"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679180981"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181012"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181013"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679181014"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181014"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Fn Int -&gt; DefTable Fn Int -&gt; Maybe Int
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Fn Int
forall a. Int -&gt; Int -&gt; a -&gt; Fn a
</span><a href="ApplicativeGen.html#RightFactor"><span class="hs-identifier hs-var">RightFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181012"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181013"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181014"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DefTable Fn Int
</span><a href="#local-6989586621679180972"><span class="hs-identifier hs-var">table</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="annot"><a href="ApplicativeGen.html#upToIso"><span class="hs-identifier hs-type">upToIso</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonoidGen.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonoidGen.html#RawMonoidData"><span class="hs-identifier hs-type">RawMonoidData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-345"></span><span id="upToIso"><span class="annot"><span class="annottext">upToIso :: Vector Int
-&gt; RawMonoidData
-&gt; [(FactorTable, FactorTable)]
-&gt; [(FactorTable, FactorTable)]
</span><a href="ApplicativeGen.html#upToIso"><span class="hs-identifier hs-var hs-var">upToIso</span></a></span></span><span> </span><span id="local-6989586621679181015"><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679181015"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span id="local-6989586621679181016"><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679181016"><span class="hs-identifier hs-var">mon</span></a></span></span><span> </span><span id="local-6989586621679181017"><span class="annot"><span class="annottext">[(FactorTable, FactorTable)]
</span><a href="#local-6989586621679181017"><span class="hs-identifier hs-var">tabs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((FactorTable, FactorTable) -&gt; (FactorTable, FactorTable))
-&gt; ((FactorTable, FactorTable)
    -&gt; (FactorTable, FactorTable) -&gt; (FactorTable, FactorTable))
-&gt; (forall {s}.
    EquivM
      s
      (FactorTable, FactorTable)
      (FactorTable, FactorTable)
      [(FactorTable, FactorTable)])
-&gt; [(FactorTable, FactorTable)]
forall v c a.
(v -&gt; c) -&gt; (c -&gt; c -&gt; c) -&gt; (forall s. EquivM s c v a) -&gt; a
</span><span class="hs-identifier hs-var">runEquivM</span></span><span> </span><span class="annot"><span class="annottext">(FactorTable, FactorTable) -&gt; (FactorTable, FactorTable)
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(FactorTable, FactorTable)
-&gt; (FactorTable, FactorTable) -&gt; (FactorTable, FactorTable)
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">((forall {s}.
  EquivM
    s
    (FactorTable, FactorTable)
    (FactorTable, FactorTable)
    [(FactorTable, FactorTable)])
 -&gt; [(FactorTable, FactorTable)])
-&gt; (forall {s}.
    EquivM
      s
      (FactorTable, FactorTable)
      (FactorTable, FactorTable)
      [(FactorTable, FactorTable)])
-&gt; [(FactorTable, FactorTable)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-346"></span><span>  </span><span class="annot"><span class="annottext">[(FactorTable, FactorTable)]
-&gt; ((FactorTable, FactorTable)
    -&gt; EquivT
         s
         (FactorTable, FactorTable)
         (FactorTable, FactorTable)
         Identity
         ())
-&gt; EquivT
     s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="annot"><span class="annottext">[(FactorTable, FactorTable)]
</span><a href="#local-6989586621679181017"><span class="hs-identifier hs-var">tabs</span></a></span><span> </span><span class="annot"><span class="annottext">(((FactorTable, FactorTable)
  -&gt; EquivT
       s
       (FactorTable, FactorTable)
       (FactorTable, FactorTable)
       Identity
       ())
 -&gt; EquivT
      s
      (FactorTable, FactorTable)
      (FactorTable, FactorTable)
      Identity
      ())
-&gt; ((FactorTable, FactorTable)
    -&gt; EquivT
         s
         (FactorTable, FactorTable)
         (FactorTable, FactorTable)
         Identity
         ())
-&gt; EquivT
     s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679181055"><span class="annot"><span class="annottext">(FactorTable, FactorTable)
</span><a href="#local-6989586621679181055"><span class="hs-identifier hs-var">mm</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-347"></span><span>    </span><span class="annot"><span class="annottext">(FactorTable, FactorTable)
-&gt; (FactorTable, FactorTable)
-&gt; EquivT
     s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity ()
forall c v d (m :: * -&gt; *). MonadEquiv c v d m =&gt; v -&gt; v -&gt; m ()
</span><span class="hs-identifier hs-var">equate</span></span><span> </span><span class="annot"><span class="annottext">(FactorTable, FactorTable)
</span><a href="#local-6989586621679181055"><span class="hs-identifier hs-var">mm</span></a></span><span> </span><span class="annot"><span class="annottext">(FactorTable, FactorTable)
</span><a href="#local-6989586621679181055"><span class="hs-identifier hs-var">mm</span></a></span><span>
</span><span id="line-348"></span><span>  </span><span class="annot"><span class="annottext">[(FactorTable, FactorTable)]
-&gt; ((FactorTable, FactorTable)
    -&gt; EquivT
         s
         (FactorTable, FactorTable)
         (FactorTable, FactorTable)
         Identity
         ())
-&gt; EquivT
     s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="annot"><span class="annottext">[(FactorTable, FactorTable)]
</span><a href="#local-6989586621679181017"><span class="hs-identifier hs-var">tabs</span></a></span><span> </span><span class="annot"><span class="annottext">(((FactorTable, FactorTable)
  -&gt; EquivT
       s
       (FactorTable, FactorTable)
       (FactorTable, FactorTable)
       Identity
       ())
 -&gt; EquivT
      s
      (FactorTable, FactorTable)
      (FactorTable, FactorTable)
      Identity
      ())
-&gt; ((FactorTable, FactorTable)
    -&gt; EquivT
         s
         (FactorTable, FactorTable)
         (FactorTable, FactorTable)
         Identity
         ())
-&gt; EquivT
     s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679181057"><span class="annot"><span class="annottext">(FactorTable, FactorTable)
</span><a href="#local-6989586621679181057"><span class="hs-identifier hs-var">mm</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-349"></span><span>    </span><span class="annot"><span class="annottext">[[Permutation]]
-&gt; ([Permutation]
    -&gt; EquivT
         s
         (FactorTable, FactorTable)
         (FactorTable, FactorTable)
         Identity
         ())
-&gt; EquivT
     s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Int -&gt; RawMonoidData -&gt; [[Permutation]]
</span><a href="MonoidGen.html#stabilizingPermutations"><span class="hs-identifier hs-var">stabilizingPermutations</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679181015"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679181016"><span class="hs-identifier hs-var">mon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([Permutation]
  -&gt; EquivT
       s
       (FactorTable, FactorTable)
       (FactorTable, FactorTable)
       Identity
       ())
 -&gt; EquivT
      s
      (FactorTable, FactorTable)
      (FactorTable, FactorTable)
      Identity
      ())
-&gt; ([Permutation]
    -&gt; EquivT
         s
         (FactorTable, FactorTable)
         (FactorTable, FactorTable)
         Identity
         ())
-&gt; EquivT
     s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679181058"><span class="annot"><span class="annottext">[Permutation]
</span><a href="#local-6989586621679181058"><span class="hs-identifier hs-var">perms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-350"></span><span>      </span><span class="annot"><span class="annottext">[(FactorTable, FactorTable)]
-&gt; EquivT
     s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity ()
forall c v d (m :: * -&gt; *). MonadEquiv c v d m =&gt; [v] -&gt; m ()
</span><span class="hs-identifier hs-var">equateAll</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Permutation
-&gt; (FactorTable, FactorTable) -&gt; (FactorTable, FactorTable)
</span><a href="ApplicativeGen.html#applyShapePermutation"><span class="hs-identifier hs-var">applyShapePermutation</span></a></span><span> </span><span class="annot"><span class="annottext">(Permutation
 -&gt; (FactorTable, FactorTable) -&gt; (FactorTable, FactorTable))
-&gt; [Permutation]
-&gt; [(FactorTable, FactorTable) -&gt; (FactorTable, FactorTable)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Permutation]
</span><a href="#local-6989586621679181058"><span class="hs-identifier hs-var">perms</span></a></span><span> </span><span class="annot"><span class="annottext">[(FactorTable, FactorTable) -&gt; (FactorTable, FactorTable)]
-&gt; [(FactorTable, FactorTable)] -&gt; [(FactorTable, FactorTable)]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(FactorTable, FactorTable)
</span><a href="#local-6989586621679181057"><span class="hs-identifier hs-var">mm</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>    </span><span class="annot"><span class="annottext">[(FactorTable, FactorTable)]
-&gt; EquivT
     s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity ()
forall c v d (m :: * -&gt; *). MonadEquiv c v d m =&gt; [v] -&gt; m ()
</span><span class="hs-identifier hs-var">equateAll</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FactorTable, FactorTable)
</span><a href="#local-6989586621679181057"><span class="hs-identifier hs-var">mm</span></a></span><span> </span><span class="annot"><span class="annottext">(FactorTable, FactorTable)
-&gt; [(FactorTable, FactorTable)] -&gt; [(FactorTable, FactorTable)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int)
-&gt; Transposition
-&gt; (FactorTable, FactorTable)
-&gt; (FactorTable, FactorTable)
</span><a href="ApplicativeGen.html#applyTransposition"><span class="hs-identifier hs-var">applyTransposition</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679181062"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">(Transposition
 -&gt; (FactorTable, FactorTable) -&gt; (FactorTable, FactorTable))
-&gt; [Transposition]
-&gt; [(FactorTable, FactorTable) -&gt; (FactorTable, FactorTable)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; [Transposition]
</span><a href="ApplicativeGen.html#isoGenerators"><span class="hs-identifier hs-var">isoGenerators</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679181015"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">[(FactorTable, FactorTable) -&gt; (FactorTable, FactorTable)]
-&gt; [(FactorTable, FactorTable)] -&gt; [(FactorTable, FactorTable)]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(FactorTable, FactorTable)
</span><a href="#local-6989586621679181057"><span class="hs-identifier hs-var">mm</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>  </span><span class="annot"><span class="annottext">EquivT
  s
  (FactorTable, FactorTable)
  (FactorTable, FactorTable)
  Identity
  [Class s (FactorTable, FactorTable) (FactorTable, FactorTable)]
forall c v d (m :: * -&gt; *). MonadEquiv c v d m =&gt; m [c]
</span><span class="hs-identifier hs-var">classes</span></span><span> </span><span class="annot"><span class="annottext">EquivT
  s
  (FactorTable, FactorTable)
  (FactorTable, FactorTable)
  Identity
  [Class s (FactorTable, FactorTable) (FactorTable, FactorTable)]
-&gt; ([Class s (FactorTable, FactorTable) (FactorTable, FactorTable)]
    -&gt; EquivM
         s
         (FactorTable, FactorTable)
         (FactorTable, FactorTable)
         [(FactorTable, FactorTable)])
-&gt; EquivM
     s
     (FactorTable, FactorTable)
     (FactorTable, FactorTable)
     [(FactorTable, FactorTable)]
forall a b.
EquivT
  s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity a
-&gt; (a
    -&gt; EquivT
         s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity b)
-&gt; EquivT
     s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(Class s (FactorTable, FactorTable) (FactorTable, FactorTable)
 -&gt; EquivT
      s
      (FactorTable, FactorTable)
      (FactorTable, FactorTable)
      Identity
      (FactorTable, FactorTable))
-&gt; [Class s (FactorTable, FactorTable) (FactorTable, FactorTable)]
-&gt; EquivM
     s
     (FactorTable, FactorTable)
     (FactorTable, FactorTable)
     [(FactorTable, FactorTable)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Class s (FactorTable, FactorTable) (FactorTable, FactorTable)
-&gt; EquivT
     s
     (FactorTable, FactorTable)
     (FactorTable, FactorTable)
     Identity
     (FactorTable, FactorTable)
forall c v d (m :: * -&gt; *). MonadEquiv c v d m =&gt; c -&gt; m d
</span><span class="hs-identifier hs-var">desc</span></span><span>
</span><span id="line-353"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-354"></span><span>    </span><span id="local-6989586621679181062"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679181062"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679181070"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181070"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679181071"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181071"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Array (Int, Int) Int
</span><a href="MonoidGen.html#_multTable"><span class="hs-identifier hs-var">_multTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679181016"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) Int -&gt; (Int, Int) -&gt; Int
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181070"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181071"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="annot"><a href="ApplicativeGen.html#applyShapePermutation"><span class="hs-identifier hs-type">applyShapePermutation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonoidGen.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span id="applyShapePermutation"><span class="annot"><span class="annottext">applyShapePermutation :: Permutation
-&gt; (FactorTable, FactorTable) -&gt; (FactorTable, FactorTable)
</span><a href="ApplicativeGen.html#applyShapePermutation"><span class="hs-identifier hs-var hs-var">applyShapePermutation</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonoidGen.html#MkPermutation"><span class="hs-identifier hs-type">MkPermutation</span></a></span><span> </span><span id="local-6989586621679181073"><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679181073"><span class="hs-identifier hs-var">permVector</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FactorTable, FactorTable) -&gt; (FactorTable, FactorTable)
forall {e} {e}.
(Array (Int, Int) e, Array (Int, Int) e)
-&gt; (Array (Int, Int) e, Array (Int, Int) e)
</span><a href="#local-6989586621679181074"><span class="hs-identifier hs-var">applyBoth</span></a></span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-359"></span><span>    </span><span id="local-6989586621679181075"><span class="annot"><span class="annottext">p :: Int -&gt; Int
</span><a href="#local-6989586621679181075"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679181073"><span class="hs-identifier hs-var">permVector</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>    </span><span id="local-6989586621679181080"><span class="annot"><span class="annottext">apply :: Array (Int, Int) e -&gt; Array (Int, Int) e
</span><a href="#local-6989586621679181080"><span class="hs-identifier hs-var hs-var">apply</span></a></span></span><span> </span><span id="local-6989586621679181081"><span class="annot"><span class="annottext">Array (Int, Int) e
</span><a href="#local-6989586621679181081"><span class="hs-identifier hs-var">tab</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Int), (Int, Int)) -&gt; [((Int, Int), e)] -&gt; Array (Int, Int) e
forall i e. Ix i =&gt; (i, i) -&gt; [(i, e)] -&gt; Array i e
</span><span class="hs-identifier hs-var">Array.array</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Array (Int, Int) e -&gt; ((Int, Int), (Int, Int))
forall i e. Array i e -&gt; (i, i)
</span><span class="hs-identifier hs-var">Array.bounds</span></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) e
</span><a href="#local-6989586621679181081"><span class="hs-identifier hs-var">tab</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679181075"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181084"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679181075"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181085"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679181086"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679181084"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181084"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679181085"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181085"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679181086"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679181086"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) e -&gt; [((Int, Int), e)]
forall i e. Ix i =&gt; Array i e -&gt; [(i, e)]
</span><span class="hs-identifier hs-var">Array.assocs</span></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) e
</span><a href="#local-6989586621679181081"><span class="hs-identifier hs-var">tab</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-361"></span><span>    </span><span id="local-6989586621679181074"><span class="annot"><span class="annottext">applyBoth :: (Array (Int, Int) e, Array (Int, Int) e)
-&gt; (Array (Int, Int) e, Array (Int, Int) e)
</span><a href="#local-6989586621679181074"><span class="hs-identifier hs-var hs-var">applyBoth</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679181088"><span class="annot"><span class="annottext">Array (Int, Int) e
</span><a href="#local-6989586621679181088"><span class="hs-identifier hs-var">tabL</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679181089"><span class="annot"><span class="annottext">Array (Int, Int) e
</span><a href="#local-6989586621679181089"><span class="hs-identifier hs-var">tabR</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Array (Int, Int) e -&gt; Array (Int, Int) e
forall {e}. Array (Int, Int) e -&gt; Array (Int, Int) e
</span><a href="#local-6989586621679181080"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) e
</span><a href="#local-6989586621679181088"><span class="hs-identifier hs-var">tabL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) e -&gt; Array (Int, Int) e
forall {e}. Array (Int, Int) e -&gt; Array (Int, Int) e
</span><a href="#local-6989586621679181080"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) e
</span><a href="#local-6989586621679181089"><span class="hs-identifier hs-var">tabR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-keyword">data</span><span> </span><span id="Transposition"><span class="annot"><a href="ApplicativeGen.html#Transposition"><span class="hs-identifier hs-var">Transposition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Transpose"><span class="annot"><a href="ApplicativeGen.html#Transpose"><span class="hs-identifier hs-var">Transpose</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-364"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679181092"><span id="local-6989586621679181098"><span id="local-6989586621679181102"><span class="annot"><span class="annottext">Int -&gt; Transposition -&gt; ShowS
[Transposition] -&gt; ShowS
Transposition -&gt; String
(Int -&gt; Transposition -&gt; ShowS)
-&gt; (Transposition -&gt; String)
-&gt; ([Transposition] -&gt; ShowS)
-&gt; Show Transposition
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Transposition -&gt; ShowS
showsPrec :: Int -&gt; Transposition -&gt; ShowS
$cshow :: Transposition -&gt; String
show :: Transposition -&gt; String
$cshowList :: [Transposition] -&gt; ShowS
showList :: [Transposition] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="annot"><a href="ApplicativeGen.html#isoGenerators"><span class="hs-identifier hs-type">isoGenerators</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonoidGen.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApplicativeGen.html#Transposition"><span class="hs-identifier hs-type">Transposition</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-367"></span><span id="isoGenerators"><span class="annot"><span class="annottext">isoGenerators :: Vector Int -&gt; [Transposition]
</span><a href="ApplicativeGen.html#isoGenerators"><span class="hs-identifier hs-var hs-var">isoGenerators</span></a></span></span><span> </span><span id="local-6989586621679181104"><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679181104"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-368"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Transposition
</span><a href="ApplicativeGen.html#Transpose"><span class="hs-identifier hs-var">Transpose</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181105"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181106"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181106"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679181105"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181105"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679181108"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181108"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679181109"><span class="hs-identifier hs-var">lengths</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679181106"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181106"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181108"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-369"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-370"></span><span>    </span><span id="local-6989586621679181109"><span class="annot"><span class="annottext">lengths :: [(Int, Int)]
</span><a href="#local-6989586621679181109"><span class="hs-identifier hs-var hs-var">lengths</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Int, Int) -&gt; [(Int, Int)]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Int, Int) -&gt; [(Int, Int)])
-&gt; Vector (Int, Int) -&gt; [(Int, Int)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Vector (Int, Int)
forall a. Vector a -&gt; Vector (Int, a)
</span><span class="hs-identifier hs-var">V.indexed</span></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679181104"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span class="annot"><a href="ApplicativeGen.html#applyTransposition"><span class="hs-identifier hs-type">applyTransposition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#Transposition"><span class="hs-identifier hs-type">Transposition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span id="applyTransposition"><span class="annot"><span class="annottext">applyTransposition :: (Int -&gt; Int -&gt; Int)
-&gt; Transposition
-&gt; (FactorTable, FactorTable)
-&gt; (FactorTable, FactorTable)
</span><a href="ApplicativeGen.html#applyTransposition"><span class="hs-identifier hs-var hs-var">applyTransposition</span></a></span></span><span> </span><span id="local-6989586621679181110"><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679181110"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#Transpose"><span class="hs-identifier hs-type">Transpose</span></a></span><span> </span><span id="local-6989586621679181111"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181111"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679181112"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181112"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679181113"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181113"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679181114"><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679181114"><span class="hs-identifier hs-var">leftTable</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679181115"><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679181115"><span class="hs-identifier hs-var">rightTable</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679181116"><span class="hs-identifier hs-var">leftTable'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679181117"><span class="hs-identifier hs-var">rightTable'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-375"></span><span>    </span><span id="local-6989586621679181120"><span class="annot"><span class="annottext">tr :: Int -&gt; Int
</span><a href="#local-6989586621679181120"><span class="hs-identifier hs-var hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679181121"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181121"><span class="hs-identifier hs-var">z</span></a></span></span><span>
</span><span id="line-376"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181121"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181112"><span class="hs-identifier hs-var">x</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181113"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-377"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181121"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181113"><span class="hs-identifier hs-var">y</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181112"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-378"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181121"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-379"></span><span>    </span><span id="local-6989586621679181122"><span class="annot"><span class="annottext">swapVector :: Vector a -&gt; Vector a
</span><a href="#local-6989586621679181122"><span class="hs-identifier hs-var hs-var">swapVector</span></a></span></span><span> </span><span id="local-6989586621679181123"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679181123"><span class="hs-identifier hs-var">vec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679181123"><span class="hs-identifier hs-var">vec</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; [(Int, a)] -&gt; Vector a
forall a. Vector a -&gt; [(Int, a)] -&gt; Vector a
</span><span class="hs-operator hs-var">V.//</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181112"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679181123"><span class="hs-identifier hs-var">vec</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Int -&gt; a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181113"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181113"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679181123"><span class="hs-identifier hs-var">vec</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Int -&gt; a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181112"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span>    </span><span id="local-6989586621679181125"><span class="annot"><span class="annottext">leftTrans :: (Int, Int) -&gt; Vector Int -&gt; Vector Int
</span><a href="#local-6989586621679181125"><span class="hs-identifier hs-var hs-var">leftTrans</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679181126"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181126"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679181127"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181127"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Vector Int
</span><a href="#local-6989586621679181128"><span class="hs-identifier hs-var">onRange</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector Int -&gt; Vector Int)
-&gt; (Vector Int -&gt; Vector Int) -&gt; Vector Int -&gt; Vector Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Vector Int
forall {a}. Vector a -&gt; Vector a
</span><a href="#local-6989586621679181129"><span class="hs-identifier hs-var">onDomain</span></a></span><span>
</span><span id="line-382"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-383"></span><span>        </span><span id="local-6989586621679181129"><span class="annot"><span class="annottext">onDomain :: Vector a -&gt; Vector a
</span><a href="#local-6989586621679181129"><span class="hs-identifier hs-var hs-var">onDomain</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679181110"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181126"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181127"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181111"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Vector a
forall {a}. Vector a -&gt; Vector a
</span><a href="#local-6989586621679181122"><span class="hs-identifier hs-var">swapVector</span></a></span><span>
</span><span id="line-384"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Vector a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-385"></span><span>        </span><span id="local-6989586621679181128"><span class="annot"><span class="annottext">onRange :: Vector Int -&gt; Vector Int
</span><a href="#local-6989586621679181128"><span class="hs-identifier hs-var hs-var">onRange</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181126"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181111"><span class="hs-identifier hs-var">k</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Vector Int -&gt; Vector Int
forall a b. (a -&gt; b) -&gt; Vector a -&gt; Vector b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679181120"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-386"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Vector Int
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-387"></span><span>    </span><span>
</span><span id="line-388"></span><span>    </span><span id="local-6989586621679181133"><span class="annot"><span class="annottext">rightTrans :: (Int, Int) -&gt; Vector Int -&gt; Vector Int
</span><a href="#local-6989586621679181133"><span class="hs-identifier hs-var hs-var">rightTrans</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679181134"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181134"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679181135"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181135"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Vector Int
</span><a href="#local-6989586621679181136"><span class="hs-identifier hs-var">onRange</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector Int -&gt; Vector Int)
-&gt; (Vector Int -&gt; Vector Int) -&gt; Vector Int -&gt; Vector Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Vector Int
forall {a}. Vector a -&gt; Vector a
</span><a href="#local-6989586621679181137"><span class="hs-identifier hs-var">onDomain</span></a></span><span>
</span><span id="line-389"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-390"></span><span>        </span><span id="local-6989586621679181137"><span class="annot"><span class="annottext">onDomain :: Vector a -&gt; Vector a
</span><a href="#local-6989586621679181137"><span class="hs-identifier hs-var hs-var">onDomain</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679181110"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181134"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181135"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181111"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Vector a
forall {a}. Vector a -&gt; Vector a
</span><a href="#local-6989586621679181122"><span class="hs-identifier hs-var">swapVector</span></a></span><span>
</span><span id="line-391"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Vector a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-392"></span><span>        </span><span id="local-6989586621679181136"><span class="annot"><span class="annottext">onRange :: Vector Int -&gt; Vector Int
</span><a href="#local-6989586621679181136"><span class="hs-identifier hs-var hs-var">onRange</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181135"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181111"><span class="hs-identifier hs-var">k</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Vector Int -&gt; Vector Int
forall a b. (a -&gt; b) -&gt; Vector a -&gt; Vector b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679181120"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-393"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Vector Int
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-394"></span><span>    </span><span id="local-6989586621679181116"><span class="annot"><span class="annottext">leftTable' :: FactorTable
</span><a href="#local-6989586621679181116"><span class="hs-identifier hs-var hs-var">leftTable'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Vector Int -&gt; Vector Int)
-&gt; FactorTable -&gt; FactorTable
forall i a b. Ix i =&gt; (i -&gt; a -&gt; b) -&gt; Array i a -&gt; Array i b
</span><a href="Data.Array.Extra.html#imap"><span class="hs-identifier hs-var">Array.imap</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Vector Int -&gt; Vector Int
</span><a href="#local-6989586621679181125"><span class="hs-identifier hs-var">leftTrans</span></a></span><span> </span><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679181114"><span class="hs-identifier hs-var">leftTable</span></a></span><span>
</span><span id="line-395"></span><span>    </span><span id="local-6989586621679181117"><span class="annot"><span class="annottext">rightTable' :: FactorTable
</span><a href="#local-6989586621679181117"><span class="hs-identifier hs-var hs-var">rightTable'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Vector Int -&gt; Vector Int)
-&gt; FactorTable -&gt; FactorTable
forall i a b. Ix i =&gt; (i -&gt; a -&gt; b) -&gt; Array i a -&gt; Array i b
</span><a href="Data.Array.Extra.html#imap"><span class="hs-identifier hs-var">Array.imap</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Vector Int -&gt; Vector Int
</span><a href="#local-6989586621679181133"><span class="hs-identifier hs-var">rightTrans</span></a></span><span> </span><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679181115"><span class="hs-identifier hs-var">rightTable</span></a></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span id="local-6989586621679180148"><span class="annot"><a href="ApplicativeGen.html#stabilizingIsomorphisms"><span class="hs-identifier hs-type">stabilizingIsomorphisms</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679180148"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeDict"><span class="hs-identifier hs-type">ApplicativeDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180148"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Isomorphism.html#Iso"><span class="hs-identifier hs-type">Iso</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180148"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-398"></span><span id="stabilizingIsomorphisms"><span class="annot"><span class="annottext">stabilizingIsomorphisms :: forall (f :: * -&gt; *).
PTraversable f =&gt;
ApplicativeDict f -&gt; [Iso f]
</span><a href="ApplicativeGen.html#stabilizingIsomorphisms"><span class="hs-identifier hs-var hs-var">stabilizingIsomorphisms</span></a></span></span><span> </span><span id="local-6989586621679181156"><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679181156"><span class="hs-identifier hs-var">apDict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Iso f]
</span><a href="#local-6989586621679181157"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-400"></span><span>    </span><span id="local-6989586621679181158"><span class="annot"><span class="annottext">pureData :: f ()
</span><a href="#local-6989586621679181158"><span class="hs-identifier hs-var hs-var">pureData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f -&gt; forall a. a -&gt; f a
forall (f :: * -&gt; *). ApplicativeDict f -&gt; forall a. a -&gt; f a
</span><a href="ApplicativeGen.html#_applicativePure"><span class="hs-identifier hs-var">_applicativePure</span></a></span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679181156"><span class="hs-identifier hs-var">apDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>    </span><span id="local-6989586621679181171"><span class="annot"><span class="annottext">fk :: [f Int]
</span><a href="#local-6989586621679181171"><span class="hs-identifier hs-var hs-var">fk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[f Int] -&gt; [f Int]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (f Int) -&gt; [f Int]
forall a. Vector a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">Vector (f Int)
forall (m :: * -&gt; *). PTraversable m =&gt; Vector (m Int)
</span><a href="Data.PTraversable.Extra.html#skolem"><span class="hs-identifier hs-var">skolem</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>    </span><span class="hs-comment">-- lhs is sorted, since fk is sorted</span><span>
</span><span id="line-403"></span><span>    </span><span id="local-6989586621679181174"><span class="annot"><span class="annottext">lhs :: [(f Int, f Int)]
</span><a href="#local-6989586621679181174"><span class="hs-identifier hs-var hs-var">lhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(f Int -&gt; f Int -&gt; (f Int, f Int))
-&gt; [f Int] -&gt; [f Int -&gt; (f Int, f Int)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[f Int]
</span><a href="#local-6989586621679181171"><span class="hs-identifier hs-var">fk</span></a></span><span> </span><span class="annot"><span class="annottext">[f Int -&gt; (f Int, f Int)] -&gt; [f Int] -&gt; [(f Int, f Int)]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[f Int]
</span><a href="#local-6989586621679181171"><span class="hs-identifier hs-var">fk</span></a></span><span>
</span><span id="line-404"></span><span>    </span><span id="local-6989586621679181176"><span class="annot"><span class="annottext">rhs :: [f (Int, Int)]
</span><a href="#local-6989586621679181176"><span class="hs-identifier hs-var hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(f Int -&gt; f Int -&gt; f (Int, Int)) -&gt; (f Int, f Int) -&gt; f (Int, Int)
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApplicativeDict f
-&gt; forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
forall (f :: * -&gt; *).
ApplicativeDict f
-&gt; forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><a href="ApplicativeGen.html#_applicativeLiftA2"><span class="hs-identifier hs-var">_applicativeLiftA2</span></a></span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679181156"><span class="hs-identifier hs-var">apDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((f Int, f Int) -&gt; f (Int, Int))
-&gt; [(f Int, f Int)] -&gt; [f (Int, Int)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(f Int, f Int)]
</span><a href="#local-6989586621679181174"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span>    </span><span id="local-6989586621679181186"><span class="annot"><span class="annottext">isFixing :: Iso f -&gt; Bool
</span><a href="#local-6989586621679181186"><span class="hs-identifier hs-var hs-var">isFixing</span></a></span></span><span> </span><span id="local-6989586621679181187"><span class="annot"><span class="annottext">Iso f
</span><a href="#local-6989586621679181187"><span class="hs-identifier hs-var">iso</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Iso f -&gt; forall a. f a -&gt; f a
forall (f :: * -&gt; *). Iso f -&gt; forall a. f a -&gt; f a
</span><a href="Isomorphism.html#iso1"><span class="hs-identifier hs-var">iso1</span></a></span><span> </span><span class="annot"><span class="annottext">Iso f
</span><a href="#local-6989586621679181187"><span class="hs-identifier hs-var">iso</span></a></span><span> </span><span class="annot"><span class="annottext">f ()
</span><a href="#local-6989586621679181158"><span class="hs-identifier hs-var">pureData</span></a></span><span> </span><span class="annot"><span class="annottext">f () -&gt; f () -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">f ()
</span><a href="#local-6989586621679181158"><span class="hs-identifier hs-var">pureData</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[f (Int, Int)]
</span><a href="#local-6989586621679181176"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">[f (Int, Int)] -&gt; [f (Int, Int)] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[f (Int, Int)]
</span><a href="#local-6989586621679181189"><span class="hs-identifier hs-var">rhs'</span></a></span><span>
</span><span id="line-407"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-408"></span><span>        </span><span id="local-6989586621679181189"><span class="annot"><span class="annottext">rhs' :: [f (Int, Int)]
</span><a href="#local-6989586621679181189"><span class="hs-identifier hs-var hs-var">rhs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(f Int, f Int) -&gt; f (Int, Int)
forall {a} {b}. (f a, f b) -&gt; f (a, b)
</span><a href="#local-6989586621679181191"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="annot"><span class="annottext">((f Int, f Int) -&gt; f (Int, Int))
-&gt; [(f Int, f Int)] -&gt; [f (Int, Int)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(f Int, f Int)]
</span><a href="#local-6989586621679181174"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-409"></span><span>        </span><span id="local-6989586621679181191"><span class="annot"><span class="annottext">op' :: (f a, f b) -&gt; f (a, b)
</span><a href="#local-6989586621679181191"><span class="hs-identifier hs-var hs-var">op'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679181192"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679181192"><span class="hs-identifier hs-var">fa</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679181193"><span class="annot"><span class="annottext">f b
</span><a href="#local-6989586621679181193"><span class="hs-identifier hs-var">fb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Iso f -&gt; forall a. f a -&gt; f a
forall (f :: * -&gt; *). Iso f -&gt; forall a. f a -&gt; f a
</span><a href="Isomorphism.html#iso2"><span class="hs-identifier hs-var">iso2</span></a></span><span> </span><span class="annot"><span class="annottext">Iso f
</span><a href="#local-6989586621679181187"><span class="hs-identifier hs-var">iso</span></a></span><span> </span><span class="annot"><span class="annottext">(f (a, b) -&gt; f (a, b)) -&gt; f (a, b) -&gt; f (a, b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f
-&gt; forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
forall (f :: * -&gt; *).
ApplicativeDict f
-&gt; forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><a href="ApplicativeGen.html#_applicativeLiftA2"><span class="hs-identifier hs-var">_applicativeLiftA2</span></a></span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679181156"><span class="hs-identifier hs-var">apDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Iso f -&gt; forall a. f a -&gt; f a
forall (f :: * -&gt; *). Iso f -&gt; forall a. f a -&gt; f a
</span><a href="Isomorphism.html#iso1"><span class="hs-identifier hs-var">iso1</span></a></span><span> </span><span class="annot"><span class="annottext">Iso f
</span><a href="#local-6989586621679181187"><span class="hs-identifier hs-var">iso</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679181192"><span class="hs-identifier hs-var">fa</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Iso f -&gt; forall a. f a -&gt; f a
forall (f :: * -&gt; *). Iso f -&gt; forall a. f a -&gt; f a
</span><a href="Isomorphism.html#iso1"><span class="hs-identifier hs-var">iso1</span></a></span><span> </span><span class="annot"><span class="annottext">Iso f
</span><a href="#local-6989586621679181187"><span class="hs-identifier hs-var">iso</span></a></span><span> </span><span class="annot"><span class="annottext">f b
</span><a href="#local-6989586621679181193"><span class="hs-identifier hs-var">fb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span>    </span><span id="local-6989586621679181204"><span class="annot"><span class="annottext">allSubIsos :: [[Iso f]]
</span><a href="#local-6989586621679181204"><span class="hs-identifier hs-var hs-var">allSubIsos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Iso f]]
forall (f :: * -&gt; *). PTraversable f =&gt; [[Iso f]]
</span><a href="Isomorphism.html#makePositionIso"><span class="hs-identifier hs-var">makePositionIso</span></a></span><span> </span><span class="annot"><span class="annottext">[[Iso f]] -&gt; [[Iso f]] -&gt; [[Iso f]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[[Iso f]]
forall (f :: * -&gt; *). PTraversable f =&gt; [[Iso f]]
</span><a href="Isomorphism.html#makeShapeIso"><span class="hs-identifier hs-var">makeShapeIso</span></a></span><span>
</span><span id="line-412"></span><span>    </span><span id="local-6989586621679181213"><span class="annot"><span class="annottext">allIsos :: [Iso f]
</span><a href="#local-6989586621679181213"><span class="hs-identifier hs-var hs-var">allIsos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Iso f] -&gt; [Iso f] -&gt; [Iso f]) -&gt; [Iso f] -&gt; [[Iso f]] -&gt; [Iso f]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Iso f -&gt; Iso f -&gt; Iso f) -&gt; [Iso f] -&gt; [Iso f] -&gt; [Iso f]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><span class="hs-identifier hs-var">liftA2</span></span><span> </span><span class="annot"><span class="annottext">Iso f -&gt; Iso f -&gt; Iso f
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Iso f
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[[Iso f]]
</span><a href="#local-6989586621679181204"><span class="hs-identifier hs-var">allSubIsos</span></a></span><span>
</span><span id="line-413"></span><span>    </span><span class="hs-comment">-- numAllIsos = product (length &lt;$&gt; allSubIsos)</span><span>
</span><span id="line-414"></span><span>    </span><span id="local-6989586621679181157"><span class="annot"><span class="annottext">result :: [Iso f]
</span><a href="#local-6989586621679181157"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Iso f -&gt; Bool) -&gt; [Iso f] -&gt; [Iso f]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Iso f -&gt; Bool
</span><a href="#local-6989586621679181186"><span class="hs-identifier hs-var">isFixing</span></a></span><span> </span><span class="annot"><span class="annottext">[Iso f]
</span><a href="#local-6989586621679181213"><span class="hs-identifier hs-var">allIsos</span></a></span></pre></body></html>