<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts    #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE RoleAnnotations     #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications    #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes          #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures      #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving  #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE QuantifiedConstraints #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.NatMap</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier">NatMap</span></a></span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Entry</span></span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#Entry"><span class="hs-identifier">Entry</span></a></span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#getKeyValue"><span class="hs-identifier">getKeyValue</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#makeEntry"><span class="hs-identifier">makeEntry</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#makeIdEntry"><span class="hs-identifier">makeIdEntry</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#unsafeMakeEntry"><span class="hs-identifier">unsafeMakeEntry</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Construction</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#empty"><span class="hs-identifier">empty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.NatMap.html#singleton"><span class="hs-identifier">singleton</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#partialIdentity"><span class="hs-identifier">partialIdentity</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#fromEntries"><span class="hs-identifier">fromEntries</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#insert"><span class="hs-identifier">insert</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.NatMap.html#delete"><span class="hs-identifier">delete</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Queries</span></span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#size"><span class="hs-identifier">size</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#member"><span class="hs-identifier">member</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.NatMap.html#notMember"><span class="hs-identifier">notMember</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#lookup"><span class="hs-identifier">lookup</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.NatMap.html#lookup_"><span class="hs-identifier">lookup_</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#keys"><span class="hs-identifier">keys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#toEntries"><span class="hs-identifier">toEntries</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Map, Filter, Traversal</span></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#map1"><span class="hs-identifier">map1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.NatMap.html#mapMaybe1"><span class="hs-identifier">mapMaybe1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.NatMap.html#traverse1"><span class="hs-identifier">traverse1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.NatMap.html#wither1"><span class="hs-identifier">wither1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#mapWithKey1"><span class="hs-identifier">mapWithKey1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.NatMap.html#mapMaybeWithKey1"><span class="hs-identifier">mapMaybeWithKey1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.NatMap.html#traverseWithKey1"><span class="hs-identifier">traverseWithKey1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.NatMap.html#witherWithKey1"><span class="hs-identifier">witherWithKey1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Combinators</span></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#union"><span class="hs-identifier">union</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.NatMap.html#unionWith"><span class="hs-identifier">unionWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.NatMap.html#consistentUnion"><span class="hs-identifier">consistentUnion</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><span class="hs-comment">-- * As partial natural transformation</span></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#identity"><span class="hs-identifier">identity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.NatMap.html#compose"><span class="hs-identifier">compose</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#outerNat"><span class="hs-identifier">outerNat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.NatMap.html#innerNat"><span class="hs-identifier">innerNat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.NatMap.html#horizontalCompose"><span class="hs-identifier">horizontalCompose</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Totality</span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#fullSize"><span class="hs-identifier">fullSize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.NatMap.html#isTotal"><span class="hs-identifier">isTotal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#toTotal"><span class="hs-identifier">toTotal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Re-exports</span></span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="hs-operator">(:~&gt;)</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">wrapNT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unwrapNT</span></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Utility</span></span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><a href="Data.NatMap.html#Var"><span class="hs-identifier">Var</span></a></span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.NatMap.html#indices"><span class="hs-identifier">indices</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lookup</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Type</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Proxy</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Compose</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Compose</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapAccumL</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Coerce</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">coerce</span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Merge.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.PTraversable</span></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.FunctorShape</span></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Natural</span></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- | Data structure which represents partial natural transformations,</span><span>
</span><span id="line-82"></span><span class="hs-comment">--   like usual 'Map' which represents partial functions.</span><span>
</span><span id="line-83"></span><span class="hs-comment">--</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- @'Map' k v@ can be seen as a partial function.</span><span>
</span><span id="line-85"></span><span class="hs-comment">--</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- m :: Map k v</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- (\k -&gt; Data.Map.lookup k m) :: k -&gt; Maybe v</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- </span><span>
</span><span id="line-91"></span><span class="hs-comment">-- Analogically, a @'NatMap' f g@ can be seen as a partial natural transformation,</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- in the same sense @Map@ represents a partial function.</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- </span><span>
</span><span id="line-94"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- nm :: NatMap f g</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- (\fa -&gt; 'lookup' fa nm) :: forall a. f a -&gt; Maybe (g a)</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- </span><span>
</span><span id="line-99"></span><span class="hs-keyword">newtype</span><span> </span><span id="NatMap"><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-var">NatMap</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679116858"><span class="annot"><a href="#local-6989586621679116858"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679116859"><span class="annot"><a href="#local-6989586621679116859"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Mk"><span class="annot"><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-var">Mk</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span class="annot"><a href="#local-6989586621679116858"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116859"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="Data.NatMap.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">role</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier">nominal</span></span><span> </span><span class="annot"><span class="hs-identifier">representational</span></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span id="local-6989586621679116773"><span id="local-6989586621679116774"><span id="local-6989586621679117215"><span id="local-6989586621679117221"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WeakEq</span></span><span> </span><span class="annot"><a href="#local-6989586621679116773"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116774"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="Data.NatMap.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116773"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116774"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-104"></span><span id="local-6989586621679116783"><span id="local-6989586621679116784"><span id="local-6989586621679117235"><span id="local-6989586621679117241"><span id="local-6989586621679117246"><span id="local-6989586621679117251"><span id="local-6989586621679117256"><span id="local-6989586621679117261"><span id="local-6989586621679117266"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WeakOrd</span></span><span> </span><span class="annot"><a href="#local-6989586621679116783"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116784"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="Data.NatMap.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116783"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116784"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="annot"><span class="hs-comment">-- * Entry</span></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-keyword">data</span><span> </span><span id="Entry"><span class="annot"><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-var">Entry</span></a></span></span><span> </span><span id="local-6989586621679116823"><span class="annot"><a href="#local-6989586621679116823"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679116824"><span class="annot"><a href="#local-6989586621679116824"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Entry"><span class="annot"><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-var">Entry</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span class="annot"><a href="#local-6989586621679116823"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116824"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="Data.NatMap.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span id="local-6989586621679116791"><span id="local-6989586621679116792"><span id="local-6989586621679117278"><span id="local-6989586621679117285"><span id="local-6989586621679117289"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116791"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ignored</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116792"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="Data.NatMap.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116791"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116792"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-111"></span><span id="local-6989586621679116796"><span id="local-6989586621679116797"><span id="local-6989586621679117295"><span id="local-6989586621679117299"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WeakEq</span></span><span> </span><span class="annot"><a href="#local-6989586621679116796"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116797"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="Data.NatMap.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116796"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116797"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-112"></span><span id="local-6989586621679116800"><span id="local-6989586621679116801"><span id="local-6989586621679117309"><span id="local-6989586621679117313"><span id="local-6989586621679117317"><span id="local-6989586621679117321"><span id="local-6989586621679117324"><span id="local-6989586621679117327"><span id="local-6989586621679117330"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WeakOrd</span></span><span> </span><span class="annot"><a href="#local-6989586621679116800"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116801"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="Data.NatMap.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116800"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116801"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span id="local-6989586621679116802"><span id="local-6989586621679116803"><span class="annot"><a href="Data.NatMap.html#getKeyValue"><span class="hs-identifier hs-type">getKeyValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116802"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116803"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span class="annot"><a href="#local-6989586621679116802"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679116803"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="Data.NatMap.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-115"></span><span id="getKeyValue"><span class="annot"><span class="annottext">getKeyValue :: forall (f :: * -&gt; *) (g :: * -&gt; *). Entry f g -&gt; (Shape f, g Var)
</span><a href="Data.NatMap.html#getKeyValue"><span class="hs-identifier hs-var hs-var">getKeyValue</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span id="local-6989586621679117332"><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117332"><span class="hs-identifier hs-var">fx</span></a></span></span><span> </span><span id="local-6989586621679117333"><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117333"><span class="hs-identifier hs-var">gx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117332"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117333"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span id="local-6989586621679116806"><span id="local-6989586621679116807"><span id="local-6989586621679116808"><span class="annot"><a href="Data.NatMap.html#makeEntry"><span class="hs-identifier hs-type">makeEntry</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679116806"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679116807"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679116808"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116806"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116808"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116807"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116808"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116806"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116807"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-118"></span><span id="makeEntry"><span class="annot"><span class="annottext">makeEntry :: forall (f :: * -&gt; *) (g :: * -&gt; *) k.
(Traversable f, Traversable g, Ord k) =&gt;
f k -&gt; g k -&gt; Maybe (Entry f g)
</span><a href="Data.NatMap.html#makeEntry"><span class="hs-identifier hs-var hs-var">makeEntry</span></a></span></span><span> </span><span id="local-6989586621679117349"><span class="annot"><span class="annottext">f k
</span><a href="#local-6989586621679117349"><span class="hs-identifier hs-var">fk</span></a></span></span><span> </span><span id="local-6989586621679117350"><span class="annot"><span class="annottext">g k
</span><a href="#local-6989586621679117350"><span class="hs-identifier hs-var">gk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679117351"><span class="annot"><span class="annottext">Map k Var
</span><a href="#local-6989586621679117351"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[k] -&gt; Maybe (Map k Var)
forall k. Ord k =&gt; [k] -&gt; Maybe (Map k Var)
</span><a href="Data.NatMap.html#makeKeyTable"><span class="hs-identifier hs-var">makeKeyTable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k -&gt; [k]
forall a. f a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">f k
</span><a href="#local-6989586621679117349"><span class="hs-identifier hs-var">fk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>     </span><span id="local-6989586621679117353"><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117353"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(k -&gt; Maybe Var) -&gt; g k -&gt; Maybe (g Var)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; g a -&gt; f (g b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679117355"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679117355"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k Var -&gt; Maybe Var
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679117355"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k Var
</span><a href="#local-6989586621679117351"><span class="hs-identifier hs-var">table</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g k
</span><a href="#local-6989586621679117350"><span class="hs-identifier hs-var">gk</span></a></span><span>
</span><span id="line-121"></span><span>     </span><span class="annot"><span class="annottext">Entry f g -&gt; Maybe (Entry f g)
forall a. a -&gt; Maybe a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Shape f -&gt; g Var -&gt; Entry f g
forall (f :: * -&gt; *) (g :: * -&gt; *). Shape f -&gt; g Var -&gt; Entry f g
</span><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-var">Entry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k -&gt; Shape f
forall (f :: * -&gt; *) a. f a -&gt; Shape f
</span><span class="hs-identifier hs-var">Shape</span></span><span> </span><span class="annot"><span class="annottext">f k
</span><a href="#local-6989586621679117349"><span class="hs-identifier hs-var">fk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117353"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span id="local-6989586621679116827"><span id="local-6989586621679116828"><span class="annot"><a href="Data.NatMap.html#makeIdEntry"><span class="hs-identifier hs-type">makeIdEntry</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679116827"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116827"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116828"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116827"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116827"><span class="hs-identifier hs-type">f</span></a></span></span></span><span>
</span><span id="line-124"></span><span id="makeIdEntry"><span class="annot"><span class="annottext">makeIdEntry :: forall (f :: * -&gt; *) k. Traversable f =&gt; f k -&gt; Entry f f
</span><a href="Data.NatMap.html#makeIdEntry"><span class="hs-identifier hs-var hs-var">makeIdEntry</span></a></span></span><span> </span><span id="local-6989586621679117360"><span class="annot"><span class="annottext">f k
</span><a href="#local-6989586621679117360"><span class="hs-identifier hs-var">fk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Shape f -&gt; f Var -&gt; Entry f f
forall (f :: * -&gt; *) (g :: * -&gt; *). Shape f -&gt; g Var -&gt; Entry f g
</span><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-var">Entry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k -&gt; Shape f
forall (f :: * -&gt; *) a. f a -&gt; Shape f
</span><span class="hs-identifier hs-var">Shape</span></span><span> </span><span class="annot"><span class="annottext">f k
</span><a href="#local-6989586621679117360"><span class="hs-identifier hs-var">fk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Shape f -&gt; f Var
forall (f :: * -&gt; *). Traversable f =&gt; Shape f -&gt; f Var
</span><a href="Data.NatMap.html#indices"><span class="hs-identifier hs-var">indices</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k -&gt; Shape f
forall (f :: * -&gt; *) a. f a -&gt; Shape f
</span><span class="hs-identifier hs-var">Shape</span></span><span> </span><span class="annot"><span class="annottext">f k
</span><a href="#local-6989586621679117360"><span class="hs-identifier hs-var">fk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span id="local-6989586621679116813"><span class="annot"><a href="Data.NatMap.html#makeKeyTable"><span class="hs-identifier hs-type">makeKeyTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679116813"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679116813"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679116813"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="Data.NatMap.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-127"></span><span id="makeKeyTable"><span class="annot"><span class="annottext">makeKeyTable :: forall k. Ord k =&gt; [k] -&gt; Maybe (Map k Var)
</span><a href="Data.NatMap.html#makeKeyTable"><span class="hs-identifier hs-var hs-var">makeKeyTable</span></a></span></span><span> </span><span id="local-6989586621679117365"><span class="annot"><span class="annottext">[k]
</span><a href="#local-6989586621679117365"><span class="hs-identifier hs-var">ks</span></a></span></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679117366"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Map k Var -&gt; Int
forall k a. Map k a -&gt; Int
</span><span class="hs-identifier hs-var">Map.size</span></span><span> </span><span class="annot"><span class="annottext">Map k Var
</span><a href="#local-6989586621679117368"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k Var -&gt; Maybe (Map k Var)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Map k Var
</span><a href="#local-6989586621679117368"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Map k Var)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-131"></span><span>    </span><span id="local-6989586621679117366"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679117366"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[k] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[k]
</span><a href="#local-6989586621679117365"><span class="hs-identifier hs-var">ks</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span id="local-6989586621679117368"><span class="annot"><span class="annottext">table :: Map k Var
</span><a href="#local-6989586621679117368"><span class="hs-identifier hs-var hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, Var)] -&gt; Map k Var
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[k] -&gt; [Var] -&gt; [(k, Var)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[k]
</span><a href="#local-6989586621679117365"><span class="hs-identifier hs-var">ks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Var
</span><a href="Data.NatMap.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Var) -&gt; [Int] -&gt; [Var]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span id="local-6989586621679116843"><span id="local-6989586621679116844"><span id="local-6989586621679116845"><span class="annot"><a href="Data.NatMap.html#unsafeMakeEntry"><span class="hs-identifier hs-type">unsafeMakeEntry</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679116843"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679116844"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679116845"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116843"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116845"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116844"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116845"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116843"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116844"><span class="hs-identifier hs-type">g</span></a></span></span></span></span><span>
</span><span id="line-135"></span><span id="unsafeMakeEntry"><span class="annot"><span class="annottext">unsafeMakeEntry :: forall (f :: * -&gt; *) (g :: * -&gt; *) k.
(Traversable f, Functor g, Ord k) =&gt;
f k -&gt; g k -&gt; Entry f g
</span><a href="Data.NatMap.html#unsafeMakeEntry"><span class="hs-identifier hs-var hs-var">unsafeMakeEntry</span></a></span></span><span> </span><span id="local-6989586621679117393"><span class="annot"><span class="annottext">f k
</span><a href="#local-6989586621679117393"><span class="hs-identifier hs-var">fk</span></a></span></span><span> </span><span id="local-6989586621679117394"><span class="annot"><span class="annottext">g k
</span><a href="#local-6989586621679117394"><span class="hs-identifier hs-var">gk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[k] -&gt; Maybe (Map k Var)
forall k. Ord k =&gt; [k] -&gt; Maybe (Map k Var)
</span><a href="Data.NatMap.html#makeKeyTable"><span class="hs-identifier hs-var">makeKeyTable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k -&gt; [k]
forall a. f a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">f k
</span><a href="#local-6989586621679117393"><span class="hs-identifier hs-var">fk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679117395"><span class="annot"><span class="annottext">Map k Var
</span><a href="#local-6989586621679117395"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Shape f -&gt; g Var -&gt; Entry f g
forall (f :: * -&gt; *) (g :: * -&gt; *). Shape f -&gt; g Var -&gt; Entry f g
</span><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-var">Entry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k -&gt; Shape f
forall (f :: * -&gt; *) a. f a -&gt; Shape f
</span><span class="hs-identifier hs-var">Shape</span></span><span> </span><span class="annot"><span class="annottext">f k
</span><a href="#local-6989586621679117393"><span class="hs-identifier hs-var">fk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map k Var
</span><a href="#local-6989586621679117395"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">Map k Var -&gt; k -&gt; Var
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(k -&gt; Var) -&gt; g k -&gt; g Var
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">g k
</span><a href="#local-6989586621679117394"><span class="hs-identifier hs-var">gk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Map k Var)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Entry f g
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bad LHS functor!&quot;</span></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="annot"><span class="hs-comment">-- * Construction</span></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span id="local-6989586621679116854"><span id="local-6989586621679116855"><span class="annot"><a href="Data.NatMap.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116854"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116855"><span class="hs-identifier hs-type">g</span></a></span></span></span><span>
</span><span id="line-143"></span><span id="empty"><span class="annot"><span class="annottext">empty :: forall (f :: * -&gt; *) (g :: * -&gt; *). NatMap f g
</span><a href="Data.NatMap.html#empty"><span class="hs-identifier hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var) -&gt; NatMap f g
forall (f :: * -&gt; *) (g :: * -&gt; *).
Map (Shape f) (g Var) -&gt; NatMap f g
</span><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-var">Mk</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var)
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span id="local-6989586621679116862"><span id="local-6989586621679116863"><span class="annot"><a href="Data.NatMap.html#singleton"><span class="hs-identifier hs-type">singleton</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116862"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116863"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116862"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116863"><span class="hs-identifier hs-type">g</span></a></span></span></span><span>
</span><span id="line-146"></span><span id="singleton"><span class="annot"><span class="annottext">singleton :: forall (f :: * -&gt; *) (g :: * -&gt; *). Entry f g -&gt; NatMap f g
</span><a href="Data.NatMap.html#singleton"><span class="hs-identifier hs-var hs-var">singleton</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span id="local-6989586621679117399"><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117399"><span class="hs-identifier hs-var">f1</span></a></span></span><span> </span><span id="local-6989586621679117400"><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117400"><span class="hs-identifier hs-var">gx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var) -&gt; NatMap f g
forall (f :: * -&gt; *) (g :: * -&gt; *).
Map (Shape f) (g Var) -&gt; NatMap f g
</span><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-var">Mk</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Shape f) (g Var) -&gt; NatMap f g)
-&gt; Map (Shape f) (g Var) -&gt; NatMap f g
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Shape f -&gt; g Var -&gt; Map (Shape f) (g Var)
forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.singleton</span></span><span> </span><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117399"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117400"><span class="hs-identifier hs-var">gx</span></a></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span id="local-6989586621679116872"><span id="local-6989586621679116873"><span class="annot"><a href="Data.NatMap.html#partialIdentity"><span class="hs-identifier hs-type">partialIdentity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WeakOrd</span></span><span> </span><span class="annot"><a href="#local-6989586621679116872"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679116872"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679116872"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116873"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116872"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116872"><span class="hs-identifier hs-type">f</span></a></span></span></span><span>
</span><span id="line-149"></span><span id="partialIdentity"><span class="annot"><span class="annottext">partialIdentity :: forall (f :: * -&gt; *) a.
(WeakOrd f, Traversable f) =&gt;
[f a] -&gt; NatMap f f
</span><a href="Data.NatMap.html#partialIdentity"><span class="hs-identifier hs-var hs-var">partialIdentity</span></a></span></span><span> </span><span id="local-6989586621679117406"><span class="annot"><span class="annottext">[f a]
</span><a href="#local-6989586621679117406"><span class="hs-identifier hs-var">fShapes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (f Var) -&gt; NatMap f f
forall (f :: * -&gt; *) (g :: * -&gt; *).
Map (Shape f) (g Var) -&gt; NatMap f g
</span><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-var">Mk</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Shape f) (f Var) -&gt; NatMap f f)
-&gt; Map (Shape f) (f Var) -&gt; NatMap f f
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Shape f, f Var)] -&gt; Map (Shape f) (f Var)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a -&gt; Shape f
forall (f :: * -&gt; *) a. f a -&gt; Shape f
</span><span class="hs-identifier hs-var">Shape</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679117407"><span class="hs-identifier hs-var">f1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Shape f -&gt; f Var
forall (f :: * -&gt; *). Traversable f =&gt; Shape f -&gt; f Var
</span><a href="Data.NatMap.html#indices"><span class="hs-identifier hs-var">indices</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a -&gt; Shape f
forall (f :: * -&gt; *) a. f a -&gt; Shape f
</span><span class="hs-identifier hs-var">Shape</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679117407"><span class="hs-identifier hs-var">f1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679117407"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679117407"><span class="hs-identifier hs-var">f1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[f a]
</span><a href="#local-6989586621679117406"><span class="hs-identifier hs-var">fShapes</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span id="local-6989586621679116876"><span id="local-6989586621679116877"><span class="annot"><a href="Data.NatMap.html#fromEntries"><span class="hs-identifier hs-type">fromEntries</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WeakOrd</span></span><span> </span><span class="annot"><a href="#local-6989586621679116876"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116876"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116877"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116876"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116877"><span class="hs-identifier hs-type">g</span></a></span></span></span><span>
</span><span id="line-152"></span><span id="fromEntries"><span class="annot"><span class="annottext">fromEntries :: forall (f :: * -&gt; *) (g :: * -&gt; *).
WeakOrd f =&gt;
[Entry f g] -&gt; NatMap f g
</span><a href="Data.NatMap.html#fromEntries"><span class="hs-identifier hs-var hs-var">fromEntries</span></a></span></span><span> </span><span id="local-6989586621679117411"><span class="annot"><span class="annottext">[Entry f g]
</span><a href="#local-6989586621679117411"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var) -&gt; NatMap f g
forall (f :: * -&gt; *) (g :: * -&gt; *).
Map (Shape f) (g Var) -&gt; NatMap f g
</span><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-var">Mk</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Shape f) (g Var) -&gt; NatMap f g)
-&gt; Map (Shape f) (g Var) -&gt; NatMap f g
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Shape f, g Var)] -&gt; Map (Shape f) (g Var)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Entry f g -&gt; (Shape f, g Var)
forall (f :: * -&gt; *) (g :: * -&gt; *). Entry f g -&gt; (Shape f, g Var)
</span><a href="Data.NatMap.html#getKeyValue"><span class="hs-identifier hs-var">getKeyValue</span></a></span><span> </span><span class="annot"><span class="annottext">(Entry f g -&gt; (Shape f, g Var))
-&gt; [Entry f g] -&gt; [(Shape f, g Var)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Entry f g]
</span><a href="#local-6989586621679117411"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span id="local-6989586621679116880"><span id="local-6989586621679116881"><span class="annot"><a href="Data.NatMap.html#insert"><span class="hs-identifier hs-type">insert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WeakOrd</span></span><span> </span><span class="annot"><a href="#local-6989586621679116880"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116880"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116881"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116880"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116881"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116880"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116881"><span class="hs-identifier hs-type">g</span></a></span></span></span><span>
</span><span id="line-155"></span><span id="insert"><span class="annot"><span class="annottext">insert :: forall (f :: * -&gt; *) (g :: * -&gt; *).
WeakOrd f =&gt;
Entry f g -&gt; NatMap f g -&gt; NatMap f g
</span><a href="Data.NatMap.html#insert"><span class="hs-identifier hs-var hs-var">insert</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span id="local-6989586621679117414"><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117414"><span class="hs-identifier hs-var">f1</span></a></span></span><span> </span><span id="local-6989586621679117415"><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117415"><span class="hs-identifier hs-var">gx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-type">Mk</span></a></span><span> </span><span id="local-6989586621679117416"><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117416"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var) -&gt; NatMap f g
forall (f :: * -&gt; *) (g :: * -&gt; *).
Map (Shape f) (g Var) -&gt; NatMap f g
</span><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-var">Mk</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Shape f) (g Var) -&gt; NatMap f g)
-&gt; Map (Shape f) (g Var) -&gt; NatMap f g
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Shape f -&gt; g Var -&gt; Map (Shape f) (g Var) -&gt; Map (Shape f) (g Var)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117414"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117415"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117416"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span id="local-6989586621679116886"><span id="local-6989586621679116887"><span id="local-6989586621679116888"><span class="annot"><a href="Data.NatMap.html#delete"><span class="hs-identifier hs-type">delete</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WeakOrd</span></span><span> </span><span class="annot"><a href="#local-6989586621679116886"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116886"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116887"><span class="hs-identifier hs-type">any</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116886"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116888"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116886"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116888"><span class="hs-identifier hs-type">g</span></a></span></span></span></span><span>
</span><span id="line-158"></span><span id="delete"><span class="annot"><span class="annottext">delete :: forall (f :: * -&gt; *) any (g :: * -&gt; *).
WeakOrd f =&gt;
f any -&gt; NatMap f g -&gt; NatMap f g
</span><a href="Data.NatMap.html#delete"><span class="hs-identifier hs-var hs-var">delete</span></a></span></span><span> </span><span id="local-6989586621679117420"><span class="annot"><span class="annottext">f any
</span><a href="#local-6989586621679117420"><span class="hs-identifier hs-var">fx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-type">Mk</span></a></span><span> </span><span id="local-6989586621679117421"><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117421"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var) -&gt; NatMap f g
forall (f :: * -&gt; *) (g :: * -&gt; *).
Map (Shape f) (g Var) -&gt; NatMap f g
</span><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-var">Mk</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Shape f) (g Var) -&gt; NatMap f g)
-&gt; Map (Shape f) (g Var) -&gt; NatMap f g
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Shape f -&gt; Map (Shape f) (g Var) -&gt; Map (Shape f) (g Var)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.delete</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f any -&gt; Shape f
forall (f :: * -&gt; *) a. f a -&gt; Shape f
</span><span class="hs-identifier hs-var">Shape</span></span><span> </span><span class="annot"><span class="annottext">f any
</span><a href="#local-6989586621679117420"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117421"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="annot"><span class="hs-comment">-- * Queries</span></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span id="local-6989586621679116894"><span id="local-6989586621679116895"><span class="annot"><a href="Data.NatMap.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116894"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116895"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span><span>
</span><span id="line-163"></span><span id="size"><span class="annot"><span class="annottext">size :: forall (f :: * -&gt; *) (g :: * -&gt; *). NatMap f g -&gt; Int
</span><a href="Data.NatMap.html#size"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-type">Mk</span></a></span><span> </span><span id="local-6989586621679117423"><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117423"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var) -&gt; Int
forall k a. Map k a -&gt; Int
</span><span class="hs-identifier hs-var">Map.size</span></span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117423"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span id="local-6989586621679116898"><span id="local-6989586621679116899"><span id="local-6989586621679116900"><span class="annot"><a href="Data.NatMap.html#member"><span class="hs-identifier hs-type">member</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.NatMap.html#notMember"><span class="hs-identifier hs-type">notMember</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WeakOrd</span></span><span> </span><span class="annot"><a href="#local-6989586621679116898"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116898"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116899"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116898"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116900"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span><span>
</span><span id="line-166"></span><span id="member"><span class="annot"><span class="annottext">member :: forall (f :: * -&gt; *) a (g :: * -&gt; *).
WeakOrd f =&gt;
f a -&gt; NatMap f g -&gt; Bool
</span><a href="Data.NatMap.html#member"><span class="hs-identifier hs-var hs-var">member</span></a></span></span><span> </span><span id="local-6989586621679117426"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679117426"><span class="hs-identifier hs-var">fa</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-type">Mk</span></a></span><span> </span><span id="local-6989586621679117427"><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117427"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Shape f -&gt; Map (Shape f) (g Var) -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">Map.member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a -&gt; Shape f
forall (f :: * -&gt; *) a. f a -&gt; Shape f
</span><span class="hs-identifier hs-var">Shape</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679117426"><span class="hs-identifier hs-var">fa</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117427"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-167"></span><span id="notMember"><span class="annot"><span class="annottext">notMember :: forall (f :: * -&gt; *) a (g :: * -&gt; *).
WeakOrd f =&gt;
f a -&gt; NatMap f g -&gt; Bool
</span><a href="Data.NatMap.html#notMember"><span class="hs-identifier hs-var hs-var">notMember</span></a></span></span><span> </span><span id="local-6989586621679117431"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679117431"><span class="hs-identifier hs-var">fa</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (NatMap f g -&gt; Bool) -&gt; NatMap f g -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">f a -&gt; NatMap f g -&gt; Bool
forall (f :: * -&gt; *) a (g :: * -&gt; *).
WeakOrd f =&gt;
f a -&gt; NatMap f g -&gt; Bool
</span><a href="Data.NatMap.html#member"><span class="hs-identifier hs-var">member</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679117431"><span class="hs-identifier hs-var">fa</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span id="local-6989586621679116912"><span id="local-6989586621679116913"><span id="local-6989586621679116914"><span class="annot"><a href="Data.NatMap.html#lookup"><span class="hs-identifier hs-type">lookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WeakOrd</span></span><span> </span><span class="annot"><a href="#local-6989586621679116912"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679116912"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679116913"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116912"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116914"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116912"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116913"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116913"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116914"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-170"></span><span id="lookup"><span class="annot"><span class="annottext">lookup :: forall (f :: * -&gt; *) (g :: * -&gt; *) a.
(WeakOrd f, Foldable f, Functor g) =&gt;
f a -&gt; NatMap f g -&gt; Maybe (g a)
</span><a href="Data.NatMap.html#lookup"><span class="hs-identifier hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679117441"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679117441"><span class="hs-identifier hs-var">fa</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-type">Mk</span></a></span><span> </span><span id="local-6989586621679117442"><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117442"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; a) -&gt; g Var -&gt; g a
forall a b. (a -&gt; b) -&gt; g a -&gt; g b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector a -&gt; Int -&gt; a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">V.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679117444"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a) -&gt; (Var -&gt; Int) -&gt; Var -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Int
</span><a href="Data.NatMap.html#unVar"><span class="hs-identifier hs-var">unVar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(g Var -&gt; g a) -&gt; Maybe (g Var) -&gt; Maybe (g a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Shape f -&gt; Map (Shape f) (g Var) -&gt; Maybe (g Var)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a -&gt; Shape f
forall (f :: * -&gt; *) a. f a -&gt; Shape f
</span><span class="hs-identifier hs-var">Shape</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679117441"><span class="hs-identifier hs-var">fa</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117442"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-172"></span><span>    </span><span id="local-6989586621679117444"><span class="annot"><span class="annottext">as :: Vector a
</span><a href="#local-6989586621679117444"><span class="hs-keyword hs-var hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Vector a
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a -&gt; [a]
forall a. f a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679117441"><span class="hs-identifier hs-var">fa</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span id="local-6989586621679116924"><span id="local-6989586621679116925"><span class="annot"><a href="Data.NatMap.html#lookup_"><span class="hs-identifier hs-type">lookup_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WeakOrd</span></span><span> </span><span class="annot"><a href="#local-6989586621679116924"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679116925"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span class="annot"><a href="#local-6989586621679116924"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116924"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116925"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116925"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="Data.NatMap.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-175"></span><span id="lookup_"><span class="annot"><span class="annottext">lookup_ :: forall (f :: * -&gt; *) (g :: * -&gt; *).
(WeakOrd f, Functor g) =&gt;
Shape f -&gt; NatMap f g -&gt; Maybe (g Var)
</span><a href="Data.NatMap.html#lookup_"><span class="hs-identifier hs-var hs-var">lookup_</span></a></span></span><span> </span><span id="local-6989586621679117451"><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117451"><span class="hs-identifier hs-var">f1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-type">Mk</span></a></span><span> </span><span id="local-6989586621679117452"><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117452"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Shape f -&gt; Map (Shape f) (g Var) -&gt; Maybe (g Var)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117451"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117452"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span id="local-6989586621679116928"><span id="local-6989586621679116929"><span class="annot"><a href="Data.NatMap.html#keys"><span class="hs-identifier hs-type">keys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116928"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116929"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span class="annot"><a href="#local-6989586621679116928"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-178"></span><span id="keys"><span class="annot"><span class="annottext">keys :: forall (f :: * -&gt; *) (g :: * -&gt; *). NatMap f g -&gt; [Shape f]
</span><a href="Data.NatMap.html#keys"><span class="hs-identifier hs-var hs-var">keys</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-type">Mk</span></a></span><span> </span><span id="local-6989586621679117453"><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117453"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var) -&gt; [Shape f]
forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">Map.keys</span></span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117453"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span id="local-6989586621679116934"><span id="local-6989586621679116935"><span class="annot"><a href="Data.NatMap.html#toEntries"><span class="hs-identifier hs-type">toEntries</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679116934"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116934"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116935"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116934"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116935"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-181"></span><span id="toEntries"><span class="annot"><span class="annottext">toEntries :: forall (f :: * -&gt; *) (g :: * -&gt; *).
Traversable f =&gt;
NatMap f g -&gt; [Entry f g]
</span><a href="Data.NatMap.html#toEntries"><span class="hs-identifier hs-var hs-var">toEntries</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-type">Mk</span></a></span><span> </span><span id="local-6989586621679117456"><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117456"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Shape f -&gt; g Var -&gt; Entry f g
forall (f :: * -&gt; *) (g :: * -&gt; *). Shape f -&gt; g Var -&gt; Entry f g
</span><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-var">Entry</span></a></span><span> </span><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117457"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117458"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679117457"><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117457"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117458"><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117458"><span class="hs-identifier hs-var">gx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var) -&gt; [(Shape f, g Var)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toAscList</span></span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117456"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">-- keysSet :: NatMap f g -&gt; ShapeSet f</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="annot"><span class="hs-comment">-- * Mapping, Filtering, Traversing</span></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span id="local-6989586621679116940"><span id="local-6989586621679116942"><span id="local-6989586621679116943"><span class="annot"><a href="Data.NatMap.html#map1"><span class="hs-identifier hs-type">map1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679116941"><span class="annot"><a href="#local-6989586621679116941"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679116940"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116941"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116942"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116941"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116943"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116940"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116943"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116942"><span class="hs-identifier hs-type">h</span></a></span></span></span></span><span>
</span><span id="line-188"></span><span id="map1"><span class="annot"><span class="annottext">map1 :: forall (g :: * -&gt; *) (h :: * -&gt; *) (f :: * -&gt; *).
(forall a. g a -&gt; h a) -&gt; NatMap f g -&gt; NatMap f h
</span><a href="Data.NatMap.html#map1"><span class="hs-identifier hs-var hs-var">map1</span></a></span></span><span> </span><span id="local-6989586621679117460"><span class="annot"><span class="annottext">forall a. g a -&gt; h a
</span><a href="#local-6989586621679117460"><span class="hs-identifier hs-var">gh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-type">Mk</span></a></span><span> </span><span id="local-6989586621679117461"><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117461"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (h Var) -&gt; NatMap f h
forall (f :: * -&gt; *) (g :: * -&gt; *).
Map (Shape f) (g Var) -&gt; NatMap f g
</span><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-var">Mk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(g Var -&gt; h Var) -&gt; Map (Shape f) (g Var) -&gt; Map (Shape f) (h Var)
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="annot"><span class="annottext">g Var -&gt; h Var
forall a. g a -&gt; h a
</span><a href="#local-6989586621679117460"><span class="hs-identifier hs-var">gh</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117461"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span id="local-6989586621679116950"><span id="local-6989586621679116952"><span id="local-6989586621679116953"><span class="annot"><a href="Data.NatMap.html#mapMaybe1"><span class="hs-identifier hs-type">mapMaybe1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679116951"><span class="annot"><a href="#local-6989586621679116951"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679116950"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116951"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116952"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116951"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116953"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116950"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116953"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116952"><span class="hs-identifier hs-type">h</span></a></span></span></span></span><span>
</span><span id="line-191"></span><span id="mapMaybe1"><span class="annot"><span class="annottext">mapMaybe1 :: forall (g :: * -&gt; *) (h :: * -&gt; *) (f :: * -&gt; *).
(forall a. g a -&gt; Maybe (h a)) -&gt; NatMap f g -&gt; NatMap f h
</span><a href="Data.NatMap.html#mapMaybe1"><span class="hs-identifier hs-var hs-var">mapMaybe1</span></a></span></span><span> </span><span id="local-6989586621679117463"><span class="annot"><span class="annottext">forall a. g a -&gt; Maybe (h a)
</span><a href="#local-6989586621679117463"><span class="hs-identifier hs-var">gh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-type">Mk</span></a></span><span> </span><span id="local-6989586621679117464"><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117464"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (h Var) -&gt; NatMap f h
forall (f :: * -&gt; *) (g :: * -&gt; *).
Map (Shape f) (g Var) -&gt; NatMap f g
</span><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-var">Mk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(g Var -&gt; Maybe (h Var))
-&gt; Map (Shape f) (g Var) -&gt; Map (Shape f) (h Var)
forall a b k. (a -&gt; Maybe b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">g Var -&gt; Maybe (h Var)
forall a. g a -&gt; Maybe (h a)
</span><a href="#local-6989586621679117463"><span class="hs-identifier hs-var">gh</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117464"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span id="local-6989586621679116960"><span id="local-6989586621679116961"><span id="local-6989586621679116963"><span id="local-6989586621679116964"><span class="annot"><a href="Data.NatMap.html#traverse1"><span class="hs-identifier hs-type">traverse1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679116960"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679116962"><span class="annot"><a href="#local-6989586621679116962"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679116961"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116962"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116960"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116963"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116962"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116964"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116961"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116960"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116964"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116963"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-194"></span><span id="traverse1"><span class="annot"><span class="annottext">traverse1 :: forall (m :: * -&gt; *) (g :: * -&gt; *) (h :: * -&gt; *) (f :: * -&gt; *).
Applicative m =&gt;
(forall a. g a -&gt; m (h a)) -&gt; NatMap f g -&gt; m (NatMap f h)
</span><a href="Data.NatMap.html#traverse1"><span class="hs-identifier hs-var hs-var">traverse1</span></a></span></span><span> </span><span id="local-6989586621679117473"><span class="annot"><span class="annottext">forall a. g a -&gt; m (h a)
</span><a href="#local-6989586621679117473"><span class="hs-identifier hs-var">gh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-type">Mk</span></a></span><span> </span><span id="local-6989586621679117474"><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117474"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (h Var) -&gt; NatMap f h
forall (f :: * -&gt; *) (g :: * -&gt; *).
Map (Shape f) (g Var) -&gt; NatMap f g
</span><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-var">Mk</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Shape f) (h Var) -&gt; NatMap f h)
-&gt; m (Map (Shape f) (h Var)) -&gt; m (NatMap f h)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(g Var -&gt; m (h Var))
-&gt; Map (Shape f) (g Var) -&gt; m (Map (Shape f) (h Var))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Map (Shape f) a -&gt; f (Map (Shape f) b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">g Var -&gt; m (h Var)
forall a. g a -&gt; m (h a)
</span><a href="#local-6989586621679117473"><span class="hs-identifier hs-var">gh</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117474"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span id="local-6989586621679116970"><span id="local-6989586621679116971"><span id="local-6989586621679116973"><span id="local-6989586621679116974"><span class="annot"><a href="Data.NatMap.html#wither1"><span class="hs-identifier hs-type">wither1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679116970"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679116972"><span class="annot"><a href="#local-6989586621679116972"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679116971"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116972"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116970"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116973"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116972"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116974"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116971"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116970"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116974"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116973"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-197"></span><span id="wither1"><span class="annot"><span class="annottext">wither1 :: forall (m :: * -&gt; *) (g :: * -&gt; *) (h :: * -&gt; *) (f :: * -&gt; *).
Applicative m =&gt;
(forall a. g a -&gt; m (Maybe (h a))) -&gt; NatMap f g -&gt; m (NatMap f h)
</span><a href="Data.NatMap.html#wither1"><span class="hs-identifier hs-var hs-var">wither1</span></a></span></span><span> </span><span id="local-6989586621679117480"><span class="annot"><span class="annottext">forall a. g a -&gt; m (Maybe (h a))
</span><a href="#local-6989586621679117480"><span class="hs-identifier hs-var">gh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-type">Mk</span></a></span><span> </span><span id="local-6989586621679117481"><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117481"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (h Var) -&gt; NatMap f h
forall (f :: * -&gt; *) (g :: * -&gt; *).
Map (Shape f) (g Var) -&gt; NatMap f g
</span><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-var">Mk</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Shape f) (h Var) -&gt; NatMap f h)
-&gt; (Map (Shape f) (Maybe (h Var)) -&gt; Map (Shape f) (h Var))
-&gt; Map (Shape f) (Maybe (h Var))
-&gt; NatMap f h
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (h Var) -&gt; Maybe (h Var))
-&gt; Map (Shape f) (Maybe (h Var)) -&gt; Map (Shape f) (h Var)
forall a b k. (a -&gt; Maybe b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">Maybe (h Var) -&gt; Maybe (h Var)
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(Map (Shape f) (Maybe (h Var)) -&gt; NatMap f h)
-&gt; m (Map (Shape f) (Maybe (h Var))) -&gt; m (NatMap f h)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(g Var -&gt; m (Maybe (h Var)))
-&gt; Map (Shape f) (g Var) -&gt; m (Map (Shape f) (Maybe (h Var)))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Map (Shape f) a -&gt; f (Map (Shape f) b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">g Var -&gt; m (Maybe (h Var))
forall a. g a -&gt; m (Maybe (h a))
</span><a href="#local-6989586621679117480"><span class="hs-identifier hs-var">gh</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117481"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span id="local-6989586621679116980"><span id="local-6989586621679116982"><span id="local-6989586621679116983"><span class="annot"><a href="Data.NatMap.html#mapWithKey1"><span class="hs-identifier hs-type">mapWithKey1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679116980"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679116981"><span class="annot"><a href="#local-6989586621679116981"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679116981"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116980"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116981"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116982"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116981"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116983"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116981"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116980"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116982"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116980"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116983"><span class="hs-identifier hs-type">h</span></a></span></span></span></span><span>
</span><span id="line-200"></span><span id="mapWithKey1"><span class="annot"><span class="annottext">mapWithKey1 :: forall (f :: * -&gt; *) (g :: * -&gt; *) (h :: * -&gt; *).
Traversable f =&gt;
(forall a. Ord a =&gt; f a -&gt; g a -&gt; h a) -&gt; NatMap f g -&gt; NatMap f h
</span><a href="Data.NatMap.html#mapWithKey1"><span class="hs-identifier hs-var hs-var">mapWithKey1</span></a></span></span><span> </span><span id="local-6989586621679117487"><span class="annot"><span class="annottext">forall a. Ord a =&gt; f a -&gt; g a -&gt; h a
</span><a href="#local-6989586621679117487"><span class="hs-identifier hs-var">fgh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-type">Mk</span></a></span><span> </span><span id="local-6989586621679117488"><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117488"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (h Var) -&gt; NatMap f h
forall (f :: * -&gt; *) (g :: * -&gt; *).
Map (Shape f) (g Var) -&gt; NatMap f g
</span><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-var">Mk</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Shape f) (h Var) -&gt; NatMap f h)
-&gt; Map (Shape f) (h Var) -&gt; NatMap f h
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Shape f -&gt; g Var -&gt; h Var)
-&gt; Map (Shape f) (g Var) -&gt; Map (Shape f) (h Var)
forall k a b. (k -&gt; a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.mapWithKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679117490"><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117490"><span class="hs-identifier hs-var">f1</span></a></span></span><span> </span><span id="local-6989586621679117491"><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117491"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f Var -&gt; g Var -&gt; h Var
forall a. Ord a =&gt; f a -&gt; g a -&gt; h a
</span><a href="#local-6989586621679117487"><span class="hs-identifier hs-var">fgh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Shape f -&gt; f Var
forall (f :: * -&gt; *). Traversable f =&gt; Shape f -&gt; f Var
</span><a href="Data.NatMap.html#indices"><span class="hs-identifier hs-var">indices</span></a></span><span> </span><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117490"><span class="hs-identifier hs-var">f1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117491"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117488"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span id="local-6989586621679116990"><span id="local-6989586621679116992"><span id="local-6989586621679116993"><span class="annot"><a href="Data.NatMap.html#mapMaybeWithKey1"><span class="hs-identifier hs-type">mapMaybeWithKey1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679116990"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679116991"><span class="annot"><a href="#local-6989586621679116991"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679116991"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116990"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116991"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116992"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116991"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116993"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116991"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116990"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116992"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116990"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116993"><span class="hs-identifier hs-type">h</span></a></span></span></span></span><span>
</span><span id="line-203"></span><span id="mapMaybeWithKey1"><span class="annot"><span class="annottext">mapMaybeWithKey1 :: forall (f :: * -&gt; *) (g :: * -&gt; *) (h :: * -&gt; *).
Traversable f =&gt;
(forall a. Ord a =&gt; f a -&gt; g a -&gt; Maybe (h a))
-&gt; NatMap f g -&gt; NatMap f h
</span><a href="Data.NatMap.html#mapMaybeWithKey1"><span class="hs-identifier hs-var hs-var">mapMaybeWithKey1</span></a></span></span><span> </span><span id="local-6989586621679117495"><span class="annot"><span class="annottext">forall a. Ord a =&gt; f a -&gt; g a -&gt; Maybe (h a)
</span><a href="#local-6989586621679117495"><span class="hs-identifier hs-var">fgh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-type">Mk</span></a></span><span> </span><span id="local-6989586621679117496"><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117496"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (h Var) -&gt; NatMap f h
forall (f :: * -&gt; *) (g :: * -&gt; *).
Map (Shape f) (g Var) -&gt; NatMap f g
</span><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-var">Mk</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Shape f) (h Var) -&gt; NatMap f h)
-&gt; Map (Shape f) (h Var) -&gt; NatMap f h
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Shape f -&gt; g Var -&gt; Maybe (h Var))
-&gt; Map (Shape f) (g Var) -&gt; Map (Shape f) (h Var)
forall k a b. (k -&gt; a -&gt; Maybe b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.mapMaybeWithKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679117498"><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117498"><span class="hs-identifier hs-var">f1</span></a></span></span><span> </span><span id="local-6989586621679117499"><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117499"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f Var -&gt; g Var -&gt; Maybe (h Var)
forall a. Ord a =&gt; f a -&gt; g a -&gt; Maybe (h a)
</span><a href="#local-6989586621679117495"><span class="hs-identifier hs-var">fgh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Shape f -&gt; f Var
forall (f :: * -&gt; *). Traversable f =&gt; Shape f -&gt; f Var
</span><a href="Data.NatMap.html#indices"><span class="hs-identifier hs-var">indices</span></a></span><span> </span><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117498"><span class="hs-identifier hs-var">f1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117499"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117496"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span id="local-6989586621679117000"><span id="local-6989586621679117001"><span id="local-6989586621679117003"><span id="local-6989586621679117004"><span class="annot"><a href="Data.NatMap.html#traverseWithKey1"><span class="hs-identifier hs-type">traverseWithKey1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679117000"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679117001"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679117002"><span class="annot"><a href="#local-6989586621679117002"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679117002"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679117000"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117002"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679117003"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117002"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679117001"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679117004"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117002"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117000"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117003"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679117001"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117000"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117004"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-206"></span><span id="traverseWithKey1"><span class="annot"><span class="annottext">traverseWithKey1 :: forall (f :: * -&gt; *) (m :: * -&gt; *) (g :: * -&gt; *) (h :: * -&gt; *).
(Traversable f, Applicative m) =&gt;
(forall a. Ord a =&gt; f a -&gt; g a -&gt; m (h a))
-&gt; NatMap f g -&gt; m (NatMap f h)
</span><a href="Data.NatMap.html#traverseWithKey1"><span class="hs-identifier hs-var hs-var">traverseWithKey1</span></a></span></span><span> </span><span id="local-6989586621679117507"><span class="annot"><span class="annottext">forall a. Ord a =&gt; f a -&gt; g a -&gt; m (h a)
</span><a href="#local-6989586621679117507"><span class="hs-identifier hs-var">fgh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-type">Mk</span></a></span><span> </span><span id="local-6989586621679117508"><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117508"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (h Var) -&gt; NatMap f h
forall (f :: * -&gt; *) (g :: * -&gt; *).
Map (Shape f) (g Var) -&gt; NatMap f g
</span><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-var">Mk</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Shape f) (h Var) -&gt; NatMap f h)
-&gt; m (Map (Shape f) (h Var)) -&gt; m (NatMap f h)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Shape f -&gt; g Var -&gt; m (h Var))
-&gt; Map (Shape f) (g Var) -&gt; m (Map (Shape f) (h Var))
forall (t :: * -&gt; *) k a b.
Applicative t =&gt;
(k -&gt; a -&gt; t b) -&gt; Map k a -&gt; t (Map k b)
</span><span class="hs-identifier hs-var">Map.traverseWithKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679117510"><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117510"><span class="hs-identifier hs-var">f1</span></a></span></span><span> </span><span id="local-6989586621679117511"><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117511"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f Var -&gt; g Var -&gt; m (h Var)
forall a. Ord a =&gt; f a -&gt; g a -&gt; m (h a)
</span><a href="#local-6989586621679117507"><span class="hs-identifier hs-var">fgh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Shape f -&gt; f Var
forall (f :: * -&gt; *). Traversable f =&gt; Shape f -&gt; f Var
</span><a href="Data.NatMap.html#indices"><span class="hs-identifier hs-var">indices</span></a></span><span> </span><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117510"><span class="hs-identifier hs-var">f1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117511"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117508"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span id="local-6989586621679117013"><span id="local-6989586621679117014"><span id="local-6989586621679117016"><span id="local-6989586621679117017"><span class="annot"><a href="Data.NatMap.html#witherWithKey1"><span class="hs-identifier hs-type">witherWithKey1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679117013"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679117014"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679117015"><span class="annot"><a href="#local-6989586621679117015"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679117015"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679117013"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117015"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679117016"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117015"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679117014"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679117017"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117015"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117013"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117016"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679117014"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117013"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117017"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-209"></span><span id="witherWithKey1"><span class="annot"><span class="annottext">witherWithKey1 :: forall (f :: * -&gt; *) (m :: * -&gt; *) (g :: * -&gt; *) (h :: * -&gt; *).
(Traversable f, Applicative m) =&gt;
(forall a. Ord a =&gt; f a -&gt; g a -&gt; m (Maybe (h a)))
-&gt; NatMap f g -&gt; m (NatMap f h)
</span><a href="Data.NatMap.html#witherWithKey1"><span class="hs-identifier hs-var hs-var">witherWithKey1</span></a></span></span><span> </span><span id="local-6989586621679117519"><span class="annot"><span class="annottext">forall a. Ord a =&gt; f a -&gt; g a -&gt; m (Maybe (h a))
</span><a href="#local-6989586621679117519"><span class="hs-identifier hs-var">fgh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-type">Mk</span></a></span><span> </span><span id="local-6989586621679117520"><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117520"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (h Var) -&gt; NatMap f h
forall (f :: * -&gt; *) (g :: * -&gt; *).
Map (Shape f) (g Var) -&gt; NatMap f g
</span><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-var">Mk</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Shape f) (h Var) -&gt; NatMap f h)
-&gt; (Map (Shape f) (Maybe (h Var)) -&gt; Map (Shape f) (h Var))
-&gt; Map (Shape f) (Maybe (h Var))
-&gt; NatMap f h
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (h Var) -&gt; Maybe (h Var))
-&gt; Map (Shape f) (Maybe (h Var)) -&gt; Map (Shape f) (h Var)
forall a b k. (a -&gt; Maybe b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">Maybe (h Var) -&gt; Maybe (h Var)
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(Map (Shape f) (Maybe (h Var)) -&gt; NatMap f h)
-&gt; m (Map (Shape f) (Maybe (h Var))) -&gt; m (NatMap f h)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Shape f -&gt; g Var -&gt; m (Maybe (h Var)))
-&gt; Map (Shape f) (g Var) -&gt; m (Map (Shape f) (Maybe (h Var)))
forall (t :: * -&gt; *) k a b.
Applicative t =&gt;
(k -&gt; a -&gt; t b) -&gt; Map k a -&gt; t (Map k b)
</span><span class="hs-identifier hs-var">Map.traverseWithKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679117521"><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117521"><span class="hs-identifier hs-var">f1</span></a></span></span><span> </span><span id="local-6989586621679117522"><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117522"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f Var -&gt; g Var -&gt; m (Maybe (h Var))
forall a. Ord a =&gt; f a -&gt; g a -&gt; m (Maybe (h a))
</span><a href="#local-6989586621679117519"><span class="hs-identifier hs-var">fgh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Shape f -&gt; f Var
forall (f :: * -&gt; *). Traversable f =&gt; Shape f -&gt; f Var
</span><a href="Data.NatMap.html#indices"><span class="hs-identifier hs-var">indices</span></a></span><span> </span><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117521"><span class="hs-identifier hs-var">f1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117522"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (g Var)
</span><a href="#local-6989586621679117520"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="annot"><span class="hs-comment">-- * Combinators</span></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="annot"><a href="Data.NatMap.html#union"><span class="hs-identifier hs-type">union</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679117022"><span class="annot"><a href="#local-6989586621679117022"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679117023"><span class="annot"><a href="#local-6989586621679117023"><span class="hs-identifier hs-type">g</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WeakOrd</span></span><span> </span><span class="annot"><a href="#local-6989586621679117022"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117022"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117023"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117022"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117023"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117022"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117023"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-214"></span><span id="union"><span class="annot"><span class="annottext">union :: forall (f :: * -&gt; *) (g :: * -&gt; *).
WeakOrd f =&gt;
NatMap f g -&gt; NatMap f g -&gt; NatMap f g
</span><a href="Data.NatMap.html#union"><span class="hs-identifier hs-var hs-var">union</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Map (Shape f) (g Var)
 -&gt; Map (Shape f) (g Var) -&gt; Map (Shape f) (g Var))
-&gt; NatMap f g -&gt; NatMap f g -&gt; NatMap f g
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.union</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span class="annot"><a href="#local-6989586621679117022"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679117023"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="Data.NatMap.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="annot"><a href="Data.NatMap.html#unionWith"><span class="hs-identifier hs-type">unionWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679117028"><span class="annot"><a href="#local-6989586621679117028"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679117029"><span class="annot"><a href="#local-6989586621679117029"><span class="hs-identifier hs-type">g</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WeakOrd</span></span><span> </span><span class="annot"><a href="#local-6989586621679117028"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679117030"><span class="annot"><a href="#local-6989586621679117030"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679117029"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117030"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679117029"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117030"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679117029"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117030"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117028"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117029"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117028"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117029"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117028"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117029"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-217"></span><span id="unionWith"><span class="annot"><span class="annottext">unionWith :: forall (f :: * -&gt; *) (g :: * -&gt; *).
WeakOrd f =&gt;
(forall a. g a -&gt; g a -&gt; g a)
-&gt; NatMap f g -&gt; NatMap f g -&gt; NatMap f g
</span><a href="Data.NatMap.html#unionWith"><span class="hs-identifier hs-var hs-var">unionWith</span></a></span></span><span> </span><span id="local-6989586621679117530"><span class="annot"><span class="annottext">forall a. g a -&gt; g a -&gt; g a
</span><a href="#local-6989586621679117530"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Map (Shape f) (g Var)
 -&gt; Map (Shape f) (g Var) -&gt; Map (Shape f) (g Var))
-&gt; NatMap f g -&gt; NatMap f g -&gt; NatMap f g
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(g Var -&gt; g Var -&gt; g Var)
-&gt; Map (Shape f) (g Var)
-&gt; Map (Shape f) (g Var)
-&gt; Map (Shape f) (g Var)
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.unionWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. g a -&gt; g a -&gt; g a
</span><a href="#local-6989586621679117530"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Data.NatMap.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="annot"><a href="Data.NatMap.html#consistentUnion"><span class="hs-identifier hs-type">consistentUnion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679117035"><span class="annot"><a href="#local-6989586621679117035"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679117036"><span class="annot"><a href="#local-6989586621679117036"><span class="hs-identifier hs-type">g</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WeakOrd</span></span><span> </span><span class="annot"><a href="#local-6989586621679117035"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679117036"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="Data.NatMap.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117035"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117036"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117035"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117036"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117035"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117036"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span id="consistentUnion"><span class="annot"><span class="annottext">consistentUnion :: forall (f :: * -&gt; *) (g :: * -&gt; *).
(WeakOrd f, Eq (g Var)) =&gt;
NatMap f g -&gt; NatMap f g -&gt; Maybe (NatMap f g)
</span><a href="Data.NatMap.html#consistentUnion"><span class="hs-identifier hs-var hs-var">consistentUnion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Map (Shape f) (g Var)
 -&gt; Map (Shape f) (g Var) -&gt; Maybe (Map (Shape f) (g Var)))
-&gt; NatMap f g -&gt; NatMap f g -&gt; Maybe (NatMap f g)
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k v. (Ord k, Eq v) =&gt; Map k v -&gt; Map k v -&gt; Maybe (Map k v)
</span><a href="Data.NatMap.html#consistentUnionImpl"><span class="hs-identifier hs-var">consistentUnionImpl</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span class="annot"><a href="#local-6989586621679117035"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679117036"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="Data.NatMap.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="annot"><a href="Data.NatMap.html#consistentUnionImpl"><span class="hs-identifier hs-type">consistentUnionImpl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679117039"><span class="annot"><a href="#local-6989586621679117039"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679117040"><span class="annot"><a href="#local-6989586621679117040"><span class="hs-identifier hs-type">v</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679117039"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679117040"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679117039"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117040"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679117039"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117040"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679117039"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117040"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span id="consistentUnionImpl"><span class="annot"><span class="annottext">consistentUnionImpl :: forall k v. (Ord k, Eq v) =&gt; Map k v -&gt; Map k v -&gt; Maybe (Map k v)
</span><a href="Data.NatMap.html#consistentUnionImpl"><span class="hs-identifier hs-var hs-var">consistentUnionImpl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><span class="annottext">WhenMissing Maybe k v v
-&gt; WhenMissing Maybe k v v
-&gt; WhenMatched Maybe k v v v
-&gt; Map k v
-&gt; Map k v
-&gt; Maybe (Map k v)
forall (f :: * -&gt; *) k a c b.
(Applicative f, Ord k) =&gt;
WhenMissing f k a c
-&gt; WhenMissing f k b c
-&gt; WhenMatched f k a b c
-&gt; Map k a
-&gt; Map k b
-&gt; f (Map k c)
</span><span class="hs-identifier hs-var">Map.mergeA</span></span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><span class="annottext">WhenMissing Maybe k v v
forall (f :: * -&gt; *) k x. Applicative f =&gt; WhenMissing f k x x
</span><span class="hs-identifier hs-var">Map.preserveMissing</span></span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><span class="annottext">WhenMissing Maybe k v v
forall (f :: * -&gt; *) k x. Applicative f =&gt; WhenMissing f k x x
</span><span class="hs-identifier hs-var">Map.preserveMissing</span></span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k -&gt; v -&gt; v -&gt; Maybe v) -&gt; WhenMatched Maybe k v v v
forall (f :: * -&gt; *) k x y z.
Applicative f =&gt;
(k -&gt; x -&gt; y -&gt; f z) -&gt; WhenMatched f k x y z
</span><span class="hs-identifier hs-var">Map.zipWithAMatched</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679117549"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679117549"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span id="local-6989586621679117550"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679117550"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679117549"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679117550"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">v -&gt; Maybe v
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679117549"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe v
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="annot"><span class="hs-comment">-- * Combinators as partial natural transformations</span></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span id="local-6989586621679117058"><span class="annot"><a href="Data.NatMap.html#identity"><span class="hs-identifier hs-type">identity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679117058"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117058"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117058"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-232"></span><span id="identity"><span class="annot"><span class="annottext">identity :: forall (f :: * -&gt; *). PTraversable f =&gt; NatMap f f
</span><a href="Data.NatMap.html#identity"><span class="hs-identifier hs-var hs-var">identity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) (f Var) -&gt; NatMap f f
forall (f :: * -&gt; *) (g :: * -&gt; *).
Map (Shape f) (g Var) -&gt; NatMap f g
</span><a href="Data.NatMap.html#Mk"><span class="hs-identifier hs-var">Mk</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Shape f) (f Var) -&gt; NatMap f f)
-&gt; Map (Shape f) (f Var) -&gt; NatMap f f
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Shape f, f Var)] -&gt; Map (Shape f) (f Var)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117567"><span class="hs-identifier hs-var">f1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Shape f -&gt; f Var
forall (f :: * -&gt; *). Traversable f =&gt; Shape f -&gt; f Var
</span><a href="Data.NatMap.html#indices"><span class="hs-identifier hs-var">indices</span></a></span><span> </span><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117567"><span class="hs-identifier hs-var">f1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679117567"><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117567"><span class="hs-identifier hs-var">f1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f () -&gt; Shape f
forall (f :: * -&gt; *) a. f a -&gt; Shape f
</span><span class="hs-identifier hs-var">Shape</span></span><span> </span><span class="annot"><span class="annottext">(f () -&gt; Shape f) -&gt; [f ()] -&gt; [Shape f]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[()] -&gt; [f ()]
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(PTraversable t, Alternative f) =&gt;
f a -&gt; f (t a)
</span><span class="hs-identifier hs-var">enum1</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span id="local-6989586621679117069"><span id="local-6989586621679117070"><span id="local-6989586621679117071"><span class="annot"><a href="Data.NatMap.html#compose"><span class="hs-identifier hs-type">compose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WeakOrd</span></span><span> </span><span class="annot"><a href="#local-6989586621679117069"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WeakOrd</span></span><span> </span><span class="annot"><a href="#local-6989586621679117070"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679117070"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679117071"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117070"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117071"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117069"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117070"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117069"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117071"><span class="hs-identifier hs-type">h</span></a></span></span></span></span><span>
</span><span id="line-235"></span><span id="compose"><span class="annot"><span class="annottext">compose :: forall (f :: * -&gt; *) (g :: * -&gt; *) (h :: * -&gt; *).
(WeakOrd f, WeakOrd g, Foldable g, Functor h) =&gt;
NatMap g h -&gt; NatMap f g -&gt; NatMap f h
</span><a href="Data.NatMap.html#compose"><span class="hs-identifier hs-var hs-var">compose</span></a></span></span><span> </span><span id="local-6989586621679117573"><span class="annot"><span class="annottext">NatMap g h
</span><a href="#local-6989586621679117573"><span class="hs-identifier hs-var">nm1</span></a></span></span><span> </span><span id="local-6989586621679117574"><span class="annot"><span class="annottext">NatMap f g
</span><a href="#local-6989586621679117574"><span class="hs-identifier hs-var">nm2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. g a -&gt; Maybe (h a)) -&gt; NatMap f g -&gt; NatMap f h
forall (g :: * -&gt; *) (h :: * -&gt; *) (f :: * -&gt; *).
(forall a. g a -&gt; Maybe (h a)) -&gt; NatMap f g -&gt; NatMap f h
</span><a href="Data.NatMap.html#mapMaybe1"><span class="hs-identifier hs-var">mapMaybe1</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679117578"><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679117578"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">g a -&gt; NatMap g h -&gt; Maybe (h a)
forall (f :: * -&gt; *) (g :: * -&gt; *) a.
(WeakOrd f, Foldable f, Functor g) =&gt;
f a -&gt; NatMap f g -&gt; Maybe (g a)
</span><a href="Data.NatMap.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679117578"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">NatMap g h
</span><a href="#local-6989586621679117573"><span class="hs-identifier hs-var">nm1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NatMap f g
</span><a href="#local-6989586621679117574"><span class="hs-identifier hs-var">nm2</span></a></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span id="local-6989586621679117076"><span id="local-6989586621679117077"><span id="local-6989586621679117078"><span class="annot"><a href="Data.NatMap.html#outerNat"><span class="hs-identifier hs-type">outerNat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679117076"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679117077"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679117078"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679117076"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679117078"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ignored</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117076"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117077"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="#local-6989586621679117076"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117078"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="#local-6989586621679117077"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117078"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-238"></span><span id="outerNat"><span class="annot"><span class="annottext">outerNat :: forall (f :: * -&gt; *) (g :: * -&gt; *) (h :: * -&gt; *).
(Traversable f, Traversable g, PTraversable h,
 Ord (f (h Ignored))) =&gt;
NatMap f g -&gt; NatMap (Compose f h) (Compose g h)
</span><a href="Data.NatMap.html#outerNat"><span class="hs-identifier hs-var hs-var">outerNat</span></a></span></span><span> </span><span id="local-6989586621679117603"><span class="annot"><span class="annottext">NatMap f g
</span><a href="#local-6989586621679117603"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Entry (Compose f h) (Compose g h)]
-&gt; NatMap (Compose f h) (Compose g h)
forall (f :: * -&gt; *) (g :: * -&gt; *).
WeakOrd f =&gt;
[Entry f g] -&gt; NatMap f g
</span><a href="Data.NatMap.html#fromEntries"><span class="hs-identifier hs-var">fromEntries</span></a></span><span> </span><span class="annot"><span class="annottext">([Entry (Compose f h) (Compose g h)]
 -&gt; NatMap (Compose f h) (Compose g h))
-&gt; [Entry (Compose f h) (Compose g h)]
-&gt; NatMap (Compose f h) (Compose g h)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="annot"><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span id="local-6989586621679117609"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679117609"><span class="hs-identifier hs-var">f_</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679117610"><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117610"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatMap f g -&gt; [Entry f g]
forall (f :: * -&gt; *) (g :: * -&gt; *).
Traversable f =&gt;
NatMap f g -&gt; [Entry f g]
</span><a href="Data.NatMap.html#toEntries"><span class="hs-identifier hs-var">toEntries</span></a></span><span> </span><span class="annot"><span class="annottext">NatMap f g
</span><a href="#local-6989586621679117603"><span class="hs-identifier hs-var">nm</span></a></span><span>
</span><span id="line-240"></span><span>     </span><span id="local-6989586621679117611"><span class="annot"><span class="annottext">f (h ())
</span><a href="#local-6989586621679117611"><span class="hs-identifier hs-var">fh_</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(a -&gt; [h ()]) -&gt; f a -&gt; [f (h ())]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; f a -&gt; f (f b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[h ()] -&gt; a -&gt; [h ()]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">[h ()]
</span><a href="#local-6989586621679117613"><span class="hs-identifier hs-var">hShapes</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679117609"><span class="hs-identifier hs-var">f_</span></a></span><span>
</span><span id="line-241"></span><span>     </span><span class="hs-keyword">let</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span id="local-6989586621679117623"><span class="annot"><span class="annottext">f (h Var)
</span><a href="#local-6989586621679117623"><span class="hs-identifier hs-var">fhy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Shape (Compose f h) -&gt; Compose f h Var
forall (f :: * -&gt; *). Traversable f =&gt; Shape f -&gt; f Var
</span><a href="Data.NatMap.html#indices"><span class="hs-identifier hs-var">indices</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Compose f h () -&gt; Shape (Compose f h)
forall (f :: * -&gt; *) a. f a -&gt; Shape f
</span><span class="hs-identifier hs-var">Shape</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f (h ()) -&gt; Compose f h ()
forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><span class="hs-identifier hs-var">Compose</span></span><span> </span><span class="annot"><span class="annottext">f (h ())
</span><a href="#local-6989586621679117611"><span class="hs-identifier hs-var">fh_</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>         </span><span id="local-6989586621679117625"><span class="annot"><span class="annottext">hyVec :: Vector (h Var)
</span><a href="#local-6989586621679117625"><span class="hs-identifier hs-var hs-var">hyVec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[h Var] -&gt; Vector (h Var)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f (h Var) -&gt; [h Var]
forall a. f a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">f (h Var)
</span><a href="#local-6989586621679117623"><span class="hs-identifier hs-var">fhy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>         </span><span id="local-6989586621679117627"><span class="annot"><span class="annottext">ghy :: g (h Var)
</span><a href="#local-6989586621679117627"><span class="hs-identifier hs-var hs-var">ghy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679117628"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621679117628"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Vector (h Var) -&gt; Int -&gt; h Var
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">V.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector (h Var)
</span><a href="#local-6989586621679117625"><span class="hs-identifier hs-var">hyVec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Int
</span><a href="Data.NatMap.html#unVar"><span class="hs-identifier hs-var">unVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621679117628"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; h Var) -&gt; g Var -&gt; g (h Var)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117610"><span class="hs-identifier hs-var">gx</span></a></span><span>
</span><span id="line-244"></span><span>     </span><span class="annot"><span class="annottext">Entry (Compose f h) (Compose g h)
-&gt; [Entry (Compose f h) (Compose g h)]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Shape (Compose f h)
-&gt; Compose g h Var -&gt; Entry (Compose f h) (Compose g h)
forall (f :: * -&gt; *) (g :: * -&gt; *). Shape f -&gt; g Var -&gt; Entry f g
</span><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-var">Entry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Compose f h Var -&gt; Shape (Compose f h)
forall (f :: * -&gt; *) a. f a -&gt; Shape f
</span><span class="hs-identifier hs-var">Shape</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f (h Var) -&gt; Compose f h Var
forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><span class="hs-identifier hs-var">Compose</span></span><span> </span><span class="annot"><span class="annottext">f (h Var)
</span><a href="#local-6989586621679117623"><span class="hs-identifier hs-var">fhy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g (h Var) -&gt; Compose g h Var
forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><span class="hs-identifier hs-var">Compose</span></span><span> </span><span class="annot"><span class="annottext">g (h Var)
</span><a href="#local-6989586621679117627"><span class="hs-identifier hs-var">ghy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679117613"><span class="annot"><span class="annottext">hShapes :: [h ()]
</span><a href="#local-6989586621679117613"><span class="hs-identifier hs-var hs-var">hShapes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[()] -&gt; [h ()]
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(PTraversable t, Alternative f) =&gt;
f a -&gt; f (t a)
</span><span class="hs-identifier hs-var">enum1</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span id="local-6989586621679117101"><span id="local-6989586621679117102"><span id="local-6989586621679117103"><span class="annot"><a href="Data.NatMap.html#innerNat"><span class="hs-identifier hs-type">innerNat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679117101"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679117102"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679117103"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WeakOrd</span></span><span> </span><span class="annot"><a href="#local-6989586621679117101"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117101"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117102"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="#local-6989586621679117103"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117101"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="#local-6989586621679117103"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117102"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-248"></span><span id="innerNat"><span class="annot"><span class="annottext">innerNat :: forall (f :: * -&gt; *) (g :: * -&gt; *) (h :: * -&gt; *).
(Traversable f, Traversable g, PTraversable h, WeakOrd f) =&gt;
NatMap f g -&gt; NatMap (Compose h f) (Compose h g)
</span><a href="Data.NatMap.html#innerNat"><span class="hs-identifier hs-var hs-var">innerNat</span></a></span></span><span> </span><span id="local-6989586621679117670"><span class="annot"><span class="annottext">NatMap f g
</span><a href="#local-6989586621679117670"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Entry (Compose h f) (Compose h g)]
-&gt; NatMap (Compose h f) (Compose h g)
forall (f :: * -&gt; *) (g :: * -&gt; *).
WeakOrd f =&gt;
[Entry f g] -&gt; NatMap f g
</span><a href="Data.NatMap.html#fromEntries"><span class="hs-identifier hs-var">fromEntries</span></a></span><span> </span><span class="annot"><span class="annottext">([Entry (Compose h f) (Compose h g)]
 -&gt; NatMap (Compose h f) (Compose h g))
-&gt; [Entry (Compose h f) (Compose h g)]
-&gt; NatMap (Compose h f) (Compose h g)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679117671"><span class="annot"><span class="annottext">h Var
</span><a href="#local-6989586621679117671"><span class="hs-identifier hs-var">hx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Shape h -&gt; h Var
forall (f :: * -&gt; *). Traversable f =&gt; Shape f -&gt; f Var
</span><a href="Data.NatMap.html#indices"><span class="hs-identifier hs-var">indices</span></a></span><span> </span><span class="annot"><span class="annottext">(Shape h -&gt; h Var) -&gt; (h () -&gt; Shape h) -&gt; h () -&gt; h Var
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">h () -&gt; Shape h
forall (f :: * -&gt; *) a. f a -&gt; Shape f
</span><span class="hs-identifier hs-var">Shape</span></span><span> </span><span class="annot"><span class="annottext">(h () -&gt; h Var) -&gt; [h ()] -&gt; [h Var]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[()] -&gt; [h ()]
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(PTraversable t, Alternative f) =&gt;
f a -&gt; f (t a)
</span><span class="hs-identifier hs-var">enum1</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-250"></span><span>     </span><span id="local-6989586621679117672"><span class="annot"><span class="annottext">h (f (Var, Var), g (Var, Var))
</span><a href="#local-6989586621679117672"><span class="hs-identifier hs-var">hEntry</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; [(f (Var, Var), g (Var, Var))])
-&gt; h Var -&gt; [h (f (Var, Var), g (Var, Var))]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; h a -&gt; f (h b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679117673"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621679117673"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; (f Var, g Var) -&gt; (f (Var, Var), g (Var, Var))
forall {f :: * -&gt; *} {f :: * -&gt; *} {a} {a} {a}.
(Functor f, Functor f) =&gt;
a -&gt; (f a, f a) -&gt; (f (a, a), f (a, a))
</span><a href="#local-6989586621679117674"><span class="hs-identifier hs-var">appendVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621679117673"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((f Var, g Var) -&gt; (f (Var, Var), g (Var, Var)))
-&gt; [(f Var, g Var)] -&gt; [(f (Var, Var), g (Var, Var))]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(f Var, g Var)]
</span><a href="#local-6989586621679117675"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">h Var
</span><a href="#local-6989586621679117671"><span class="hs-identifier hs-var">hx</span></a></span><span>
</span><span id="line-251"></span><span>     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679117677"><span class="annot"><span class="annottext">hf_xy :: h (f (Var, Var))
</span><a href="#local-6989586621679117677"><span class="hs-identifier hs-var hs-var">hf_xy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(f (Var, Var), g (Var, Var)) -&gt; f (Var, Var)
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((f (Var, Var), g (Var, Var)) -&gt; f (Var, Var))
-&gt; h (f (Var, Var), g (Var, Var)) -&gt; h (f (Var, Var))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">h (f (Var, Var), g (Var, Var))
</span><a href="#local-6989586621679117672"><span class="hs-identifier hs-var">hEntry</span></a></span><span>
</span><span id="line-252"></span><span>         </span><span id="local-6989586621679117680"><span class="annot"><span class="annottext">hg_xy :: h (g (Var, Var))
</span><a href="#local-6989586621679117680"><span class="hs-identifier hs-var hs-var">hg_xy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(f (Var, Var), g (Var, Var)) -&gt; g (Var, Var)
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((f (Var, Var), g (Var, Var)) -&gt; g (Var, Var))
-&gt; h (f (Var, Var), g (Var, Var)) -&gt; h (g (Var, Var))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">h (f (Var, Var), g (Var, Var))
</span><a href="#local-6989586621679117672"><span class="hs-identifier hs-var">hEntry</span></a></span><span>
</span><span id="line-253"></span><span>     </span><span class="annot"><span class="annottext">Entry (Compose h f) (Compose h g)
-&gt; [Entry (Compose h f) (Compose h g)]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Entry (Compose h f) (Compose h g)
 -&gt; [Entry (Compose h f) (Compose h g)])
-&gt; Entry (Compose h f) (Compose h g)
-&gt; [Entry (Compose h f) (Compose h g)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Compose h f (Var, Var)
-&gt; Compose h g (Var, Var) -&gt; Entry (Compose h f) (Compose h g)
forall (f :: * -&gt; *) (g :: * -&gt; *) k.
(Traversable f, Functor g, Ord k) =&gt;
f k -&gt; g k -&gt; Entry f g
</span><a href="Data.NatMap.html#unsafeMakeEntry"><span class="hs-identifier hs-var">unsafeMakeEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">h (f (Var, Var)) -&gt; Compose h f (Var, Var)
forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><span class="hs-identifier hs-var">Compose</span></span><span> </span><span class="annot"><span class="annottext">h (f (Var, Var))
</span><a href="#local-6989586621679117677"><span class="hs-identifier hs-var">hf_xy</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">h (g (Var, Var)) -&gt; Compose h g (Var, Var)
forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><span class="hs-identifier hs-var">Compose</span></span><span> </span><span class="annot"><span class="annottext">h (g (Var, Var))
</span><a href="#local-6989586621679117680"><span class="hs-identifier hs-var">hg_xy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-255"></span><span>    </span><span id="local-6989586621679117675"><span class="annot"><span class="annottext">es :: [(f Var, g Var)]
</span><a href="#local-6989586621679117675"><span class="hs-identifier hs-var hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Shape f -&gt; f Var
forall (f :: * -&gt; *). Traversable f =&gt; Shape f -&gt; f Var
</span><a href="Data.NatMap.html#indices"><span class="hs-identifier hs-var">indices</span></a></span><span> </span><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117686"><span class="hs-identifier hs-var">f1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117687"><span class="hs-identifier hs-var">gy</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span id="local-6989586621679117686"><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117686"><span class="hs-identifier hs-var">f1</span></a></span></span><span> </span><span id="local-6989586621679117687"><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117687"><span class="hs-identifier hs-var">gy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatMap f g -&gt; [Entry f g]
forall (f :: * -&gt; *) (g :: * -&gt; *).
Traversable f =&gt;
NatMap f g -&gt; [Entry f g]
</span><a href="Data.NatMap.html#toEntries"><span class="hs-identifier hs-var">toEntries</span></a></span><span> </span><span class="annot"><span class="annottext">NatMap f g
</span><a href="#local-6989586621679117670"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-256"></span><span>    </span><span id="local-6989586621679117674"><span class="annot"><span class="annottext">appendVar :: a -&gt; (f a, f a) -&gt; (f (a, a), f (a, a))
</span><a href="#local-6989586621679117674"><span class="hs-identifier hs-var hs-var">appendVar</span></a></span></span><span> </span><span id="local-6989586621679117692"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117692"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679117693"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679117693"><span class="hs-identifier hs-var">fy</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117694"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679117694"><span class="hs-identifier hs-var">gy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117692"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, a)) -&gt; f a -&gt; f (a, a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679117693"><span class="hs-identifier hs-var">fy</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117692"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, a)) -&gt; f a -&gt; f (a, a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679117694"><span class="hs-identifier hs-var">gy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span id="local-6989586621679117120"><span id="local-6989586621679117121"><span id="local-6989586621679117122"><span id="local-6989586621679117123"><span class="annot"><a href="Data.NatMap.html#horizontalCompose"><span class="hs-identifier hs-type">horizontalCompose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679117120"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679117121"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679117122"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679117123"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679117120"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679117122"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ignored</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117120"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117121"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117122"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117123"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="#local-6989586621679117120"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117122"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="#local-6989586621679117121"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117123"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-260"></span><span id="horizontalCompose"><span class="annot"><span class="annottext">horizontalCompose :: forall (f :: * -&gt; *) (g :: * -&gt; *) (h :: * -&gt; *) (j :: * -&gt; *).
(Traversable f, Functor g, Traversable h, Functor j,
 Ord (f (h Ignored))) =&gt;
NatMap f g -&gt; NatMap h j -&gt; NatMap (Compose f h) (Compose g j)
</span><a href="Data.NatMap.html#horizontalCompose"><span class="hs-identifier hs-var hs-var">horizontalCompose</span></a></span></span><span> </span><span id="local-6989586621679117718"><span class="annot"><span class="annottext">NatMap f g
</span><a href="#local-6989586621679117718"><span class="hs-identifier hs-var">fgMap</span></a></span></span><span> </span><span id="local-6989586621679117719"><span class="annot"><span class="annottext">NatMap h j
</span><a href="#local-6989586621679117719"><span class="hs-identifier hs-var">hjMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Entry (Compose f h) (Compose g j)]
-&gt; NatMap (Compose f h) (Compose g j)
forall (f :: * -&gt; *) (g :: * -&gt; *).
WeakOrd f =&gt;
[Entry f g] -&gt; NatMap f g
</span><a href="Data.NatMap.html#fromEntries"><span class="hs-identifier hs-var">fromEntries</span></a></span><span> </span><span class="annot"><span class="annottext">([Entry (Compose f h) (Compose g j)]
 -&gt; NatMap (Compose f h) (Compose g j))
-&gt; [Entry (Compose f h) (Compose g j)]
-&gt; NatMap (Compose f h) (Compose g j)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679117720"><span class="annot"><span class="annottext">f Var
</span><a href="#local-6989586621679117720"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117721"><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117721"><span class="hs-identifier hs-var">gx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(f Var, g Var)]
</span><a href="#local-6989586621679117722"><span class="hs-identifier hs-var">fgEntries</span></a></span><span>
</span><span id="line-262"></span><span>     </span><span id="local-6989586621679117723"><span class="annot"><span class="annottext">f (h (Var, Var), j (Var, Var))
</span><a href="#local-6989586621679117723"><span class="hs-identifier hs-var">fPairs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; [(h (Var, Var), j (Var, Var))])
-&gt; f Var -&gt; [f (h (Var, Var), j (Var, Var))]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; f a -&gt; f (f b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679117724"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621679117724"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; (h Var, j Var) -&gt; (h (Var, Var), j (Var, Var))
forall {f :: * -&gt; *} {f :: * -&gt; *} {a} {a} {a}.
(Functor f, Functor f) =&gt;
a -&gt; (f a, f a) -&gt; (f (a, a), f (a, a))
</span><a href="#local-6989586621679117725"><span class="hs-identifier hs-var">appendVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621679117724"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((h Var, j Var) -&gt; (h (Var, Var), j (Var, Var)))
-&gt; [(h Var, j Var)] -&gt; [(h (Var, Var), j (Var, Var))]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(h Var, j Var)]
</span><a href="#local-6989586621679117726"><span class="hs-identifier hs-var">hjEntries</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f Var
</span><a href="#local-6989586621679117720"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-263"></span><span>     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679117728"><span class="annot"><span class="annottext">fh_xy :: f (h (Var, Var))
</span><a href="#local-6989586621679117728"><span class="hs-identifier hs-var hs-var">fh_xy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(h (Var, Var), j (Var, Var)) -&gt; h (Var, Var)
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((h (Var, Var), j (Var, Var)) -&gt; h (Var, Var))
-&gt; f (h (Var, Var), j (Var, Var)) -&gt; f (h (Var, Var))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (h (Var, Var), j (Var, Var))
</span><a href="#local-6989586621679117723"><span class="hs-identifier hs-var">fPairs</span></a></span><span>
</span><span id="line-264"></span><span>         </span><span id="local-6989586621679117730"><span class="annot"><span class="annottext">fj_xy :: f (j (Var, Var))
</span><a href="#local-6989586621679117730"><span class="hs-identifier hs-var hs-var">fj_xy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(h (Var, Var), j (Var, Var)) -&gt; j (Var, Var)
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((h (Var, Var), j (Var, Var)) -&gt; j (Var, Var))
-&gt; f (h (Var, Var), j (Var, Var)) -&gt; f (j (Var, Var))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (h (Var, Var), j (Var, Var))
</span><a href="#local-6989586621679117723"><span class="hs-identifier hs-var">fPairs</span></a></span><span>
</span><span id="line-265"></span><span>         </span><span id="local-6989586621679117732"><span class="annot"><span class="annottext">vecj_xy :: Vector (j (Var, Var))
</span><a href="#local-6989586621679117732"><span class="hs-identifier hs-var hs-var">vecj_xy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[j (Var, Var)] -&gt; Vector (j (Var, Var))
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f (j (Var, Var)) -&gt; [j (Var, Var)]
forall a. f a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">f (j (Var, Var))
</span><a href="#local-6989586621679117730"><span class="hs-identifier hs-var">fj_xy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>         </span><span id="local-6989586621679117734"><span class="annot"><span class="annottext">gj_xy :: g (j (Var, Var))
</span><a href="#local-6989586621679117734"><span class="hs-identifier hs-var hs-var">gj_xy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679117735"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621679117735"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Vector (j (Var, Var)) -&gt; Int -&gt; j (Var, Var)
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">V.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector (j (Var, Var))
</span><a href="#local-6989586621679117732"><span class="hs-identifier hs-var">vecj_xy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Int
</span><a href="Data.NatMap.html#unVar"><span class="hs-identifier hs-var">unVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621679117735"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; j (Var, Var)) -&gt; g Var -&gt; g (j (Var, Var))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117721"><span class="hs-identifier hs-var">gx</span></a></span><span>
</span><span id="line-267"></span><span>     </span><span class="annot"><span class="annottext">Entry (Compose f h) (Compose g j)
-&gt; [Entry (Compose f h) (Compose g j)]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Entry (Compose f h) (Compose g j)
 -&gt; [Entry (Compose f h) (Compose g j)])
-&gt; Entry (Compose f h) (Compose g j)
-&gt; [Entry (Compose f h) (Compose g j)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Compose f h (Var, Var)
-&gt; Compose g j (Var, Var) -&gt; Entry (Compose f h) (Compose g j)
forall (f :: * -&gt; *) (g :: * -&gt; *) k.
(Traversable f, Functor g, Ord k) =&gt;
f k -&gt; g k -&gt; Entry f g
</span><a href="Data.NatMap.html#unsafeMakeEntry"><span class="hs-identifier hs-var">unsafeMakeEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f (h (Var, Var)) -&gt; Compose f h (Var, Var)
forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><span class="hs-identifier hs-var">Compose</span></span><span> </span><span class="annot"><span class="annottext">f (h (Var, Var))
</span><a href="#local-6989586621679117728"><span class="hs-identifier hs-var">fh_xy</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g (j (Var, Var)) -&gt; Compose g j (Var, Var)
forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><span class="hs-identifier hs-var">Compose</span></span><span> </span><span class="annot"><span class="annottext">g (j (Var, Var))
</span><a href="#local-6989586621679117734"><span class="hs-identifier hs-var">gj_xy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621679117744"><span class="annot"><span class="annottext">toPairs :: NatMap f g -&gt; [(f Var, g Var)]
</span><a href="#local-6989586621679117744"><span class="hs-identifier hs-var hs-var">toPairs</span></a></span></span><span> </span><span id="local-6989586621679117745"><span class="annot"><span class="annottext">NatMap f g
</span><a href="#local-6989586621679117745"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Entry f g -&gt; (f Var, g Var)) -&gt; [Entry f g] -&gt; [(f Var, g Var)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span id="local-6989586621679117746"><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117746"><span class="hs-identifier hs-var">f1</span></a></span></span><span> </span><span id="local-6989586621679117747"><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117747"><span class="hs-identifier hs-var">gx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Shape f -&gt; f Var
forall (f :: * -&gt; *). Traversable f =&gt; Shape f -&gt; f Var
</span><a href="Data.NatMap.html#indices"><span class="hs-identifier hs-var">indices</span></a></span><span> </span><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679117746"><span class="hs-identifier hs-var">f1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">g Var
</span><a href="#local-6989586621679117747"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NatMap f g -&gt; [Entry f g]
forall (f :: * -&gt; *) (g :: * -&gt; *).
Traversable f =&gt;
NatMap f g -&gt; [Entry f g]
</span><a href="Data.NatMap.html#toEntries"><span class="hs-identifier hs-var">toEntries</span></a></span><span> </span><span class="annot"><span class="annottext">NatMap f g
</span><a href="#local-6989586621679117745"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>    </span><span id="local-6989586621679117722"><span class="annot"><span class="annottext">fgEntries :: [(f Var, g Var)]
</span><a href="#local-6989586621679117722"><span class="hs-identifier hs-var hs-var">fgEntries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NatMap f g -&gt; [(f Var, g Var)]
forall {f :: * -&gt; *} {g :: * -&gt; *}.
Traversable f =&gt;
NatMap f g -&gt; [(f Var, g Var)]
</span><a href="#local-6989586621679117744"><span class="hs-identifier hs-var">toPairs</span></a></span><span> </span><span class="annot"><span class="annottext">NatMap f g
</span><a href="#local-6989586621679117718"><span class="hs-identifier hs-var">fgMap</span></a></span><span>
</span><span id="line-271"></span><span>    </span><span id="local-6989586621679117726"><span class="annot"><span class="annottext">hjEntries :: [(h Var, j Var)]
</span><a href="#local-6989586621679117726"><span class="hs-identifier hs-var hs-var">hjEntries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NatMap h j -&gt; [(h Var, j Var)]
forall {f :: * -&gt; *} {g :: * -&gt; *}.
Traversable f =&gt;
NatMap f g -&gt; [(f Var, g Var)]
</span><a href="#local-6989586621679117744"><span class="hs-identifier hs-var">toPairs</span></a></span><span> </span><span class="annot"><span class="annottext">NatMap h j
</span><a href="#local-6989586621679117719"><span class="hs-identifier hs-var">hjMap</span></a></span><span>
</span><span id="line-272"></span><span>    </span><span id="local-6989586621679117725"><span class="annot"><span class="annottext">appendVar :: a -&gt; (f a, f a) -&gt; (f (a, a), f (a, a))
</span><a href="#local-6989586621679117725"><span class="hs-identifier hs-var hs-var">appendVar</span></a></span></span><span> </span><span id="local-6989586621679117758"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117758"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679117759"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679117759"><span class="hs-identifier hs-var">fy</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117760"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679117760"><span class="hs-identifier hs-var">gy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117758"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, a)) -&gt; f a -&gt; f (a, a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679117759"><span class="hs-identifier hs-var">fy</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117758"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, a)) -&gt; f a -&gt; f (a, a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679117760"><span class="hs-identifier hs-var">gy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="annot"><span class="hs-comment">-- * Totalities</span></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="annot"><a href="Data.NatMap.html#fullSize"><span class="hs-identifier hs-type">fullSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679117135"><span class="annot"><a href="#local-6989586621679117135"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679117136"><span class="annot"><a href="#local-6989586621679117136"><span class="hs-identifier hs-type">g</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679117135"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117135"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117136"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-277"></span><span id="fullSize"><span class="annot"><span class="annottext">fullSize :: forall (f :: * -&gt; *) (g :: * -&gt; *).
PTraversable f =&gt;
NatMap f g -&gt; Int
</span><a href="Data.NatMap.html#fullSize"><span class="hs-identifier hs-var hs-var">fullSize</span></a></span></span><span> </span><span class="annot"><span class="annottext">NatMap f g
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (proxy :: (* -&gt; *) -&gt; *).
PTraversable t =&gt;
proxy t -&gt; Int -&gt; Int
</span><span class="hs-identifier hs-var">cardinality1</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679117135"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy f
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span id="local-6989586621679117144"><span id="local-6989586621679117145"><span class="annot"><a href="Data.NatMap.html#isTotal"><span class="hs-identifier hs-type">isTotal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679117144"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117144"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117145"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-280"></span><span id="isTotal"><span class="annot"><span class="annottext">isTotal :: forall (f :: * -&gt; *) (g :: * -&gt; *).
PTraversable f =&gt;
NatMap f g -&gt; Bool
</span><a href="Data.NatMap.html#isTotal"><span class="hs-identifier hs-var hs-var">isTotal</span></a></span></span><span> </span><span id="local-6989586621679117768"><span class="annot"><span class="annottext">NatMap f g
</span><a href="#local-6989586621679117768"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NatMap f g -&gt; Int
forall (f :: * -&gt; *) (g :: * -&gt; *). NatMap f g -&gt; Int
</span><a href="Data.NatMap.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">NatMap f g
</span><a href="#local-6989586621679117768"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NatMap f g -&gt; Int
forall (f :: * -&gt; *) (g :: * -&gt; *).
PTraversable f =&gt;
NatMap f g -&gt; Int
</span><a href="Data.NatMap.html#fullSize"><span class="hs-identifier hs-var">fullSize</span></a></span><span> </span><span class="annot"><span class="annottext">NatMap f g
</span><a href="#local-6989586621679117768"><span class="hs-identifier hs-var">nm</span></a></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span id="local-6989586621679117148"><span id="local-6989586621679117149"><span class="annot"><a href="Data.NatMap.html#toTotal"><span class="hs-identifier hs-type">toTotal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679117148"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679117149"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.NatMap.html#NatMap"><span class="hs-identifier hs-type">NatMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117148"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117149"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679117148"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:~&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679117149"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-283"></span><span id="toTotal"><span class="annot"><span class="annottext">toTotal :: forall (f :: * -&gt; *) (g :: * -&gt; *).
(PTraversable f, Functor g) =&gt;
NatMap f g -&gt; Maybe (f :~&gt; g)
</span><a href="Data.NatMap.html#toTotal"><span class="hs-identifier hs-var hs-var">toTotal</span></a></span></span><span> </span><span id="local-6989586621679117776"><span class="annot"><span class="annottext">NatMap f g
</span><a href="#local-6989586621679117776"><span class="hs-identifier hs-var">nm</span></a></span></span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">NatMap f g -&gt; Bool
forall (f :: * -&gt; *) (g :: * -&gt; *).
PTraversable f =&gt;
NatMap f g -&gt; Bool
</span><a href="Data.NatMap.html#isTotal"><span class="hs-identifier hs-var">isTotal</span></a></span><span> </span><span class="annot"><span class="annottext">NatMap f g
</span><a href="#local-6989586621679117776"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(f :~&gt; g) -&gt; Maybe (f :~&gt; g)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(f ~&gt; g) -&gt; f :~&gt; g
forall {k} (f :: k -&gt; *) (g :: k -&gt; *). (f ~&gt; g) -&gt; f :~&gt; g
</span><span class="hs-identifier hs-var">NT</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679117782"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679117782"><span class="hs-identifier hs-var">fx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">g x -&gt; Maybe (g x) -&gt; g x
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">g x
forall {a}. a
</span><a href="#local-6989586621679117783"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f x -&gt; NatMap f g -&gt; Maybe (g x)
forall (f :: * -&gt; *) (g :: * -&gt; *) a.
(WeakOrd f, Foldable f, Functor g) =&gt;
f a -&gt; NatMap f g -&gt; Maybe (g a)
</span><a href="Data.NatMap.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679117782"><span class="hs-identifier hs-var">fx</span></a></span><span> </span><span class="annot"><span class="annottext">NatMap f g
</span><a href="#local-6989586621679117776"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (f :~&gt; g)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-287"></span><span>    </span><span id="local-6989586621679117783"><span class="annot"><span class="annottext">err :: a
</span><a href="#local-6989586621679117783"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;isTotal but there's a missed key?&quot;</span></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="annot"><span class="hs-comment">-- * Utility</span></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span id="local-6989586621679116831"><span class="annot"><a href="Data.NatMap.html#indices"><span class="hs-identifier hs-type">indices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679116831"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span class="annot"><a href="#local-6989586621679116831"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116831"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="Data.NatMap.html#Var"><span class="hs-identifier hs-type">Var</span></a></span></span><span>
</span><span id="line-292"></span><span id="indices"><span class="annot"><span class="annottext">indices :: forall (f :: * -&gt; *). Traversable f =&gt; Shape f -&gt; f Var
</span><a href="Data.NatMap.html#indices"><span class="hs-identifier hs-var hs-var">indices</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span id="local-6989586621679117790"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679117790"><span class="hs-identifier hs-var">fk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, f Var) -&gt; f Var
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Int, f Var) -&gt; f Var) -&gt; (f a -&gt; (Int, f Var)) -&gt; f a -&gt; f Var
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a -&gt; (Int, Var)) -&gt; Int -&gt; f a -&gt; (Int, f Var)
forall (t :: * -&gt; *) s a b.
Traversable t =&gt;
(s -&gt; a -&gt; (s, b)) -&gt; s -&gt; t a -&gt; (s, t b)
</span><span class="hs-identifier hs-var">mapAccumL</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679117791"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679117791"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679117791"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Var
</span><a href="Data.NatMap.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679117791"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(f a -&gt; f Var) -&gt; f a -&gt; f Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679117790"><span class="hs-identifier hs-var">fk</span></a></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="annot"><span class="hs-comment">-- | An opaque type representing syntactic variable.</span></span><span>
</span><span id="line-295"></span><span class="hs-keyword">newtype</span><span> </span><span id="Var"><span class="annot"><a href="Data.NatMap.html#Var"><span class="hs-identifier hs-var">Var</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Var"><span class="annot"><a href="Data.NatMap.html#Var"><span class="hs-identifier hs-var">Var</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unVar"><span class="annot"><span class="annottext">Var -&gt; Int
</span><a href="Data.NatMap.html#unVar"><span class="hs-identifier hs-var hs-var">unVar</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679117794"><span id="local-6989586621679117798"><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool
(Var -&gt; Var -&gt; Bool) -&gt; (Var -&gt; Var -&gt; Bool) -&gt; Eq Var
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Var -&gt; Var -&gt; Bool
== :: Var -&gt; Var -&gt; Bool
$c/= :: Var -&gt; Var -&gt; Bool
/= :: Var -&gt; Var -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117805"><span id="local-6989586621679117809"><span id="local-6989586621679117813"><span id="local-6989586621679117817"><span id="local-6989586621679117821"><span id="local-6989586621679117825"><span id="local-6989586621679117829"><span class="annot"><span class="annottext">Eq Var
Eq Var =&gt;
(Var -&gt; Var -&gt; Ordering)
-&gt; (Var -&gt; Var -&gt; Bool)
-&gt; (Var -&gt; Var -&gt; Bool)
-&gt; (Var -&gt; Var -&gt; Bool)
-&gt; (Var -&gt; Var -&gt; Bool)
-&gt; (Var -&gt; Var -&gt; Var)
-&gt; (Var -&gt; Var -&gt; Var)
-&gt; Ord Var
Var -&gt; Var -&gt; Bool
Var -&gt; Var -&gt; Ordering
Var -&gt; Var -&gt; Var
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: Var -&gt; Var -&gt; Ordering
compare :: Var -&gt; Var -&gt; Ordering
$c&lt; :: Var -&gt; Var -&gt; Bool
&lt; :: Var -&gt; Var -&gt; Bool
$c&lt;= :: Var -&gt; Var -&gt; Bool
&lt;= :: Var -&gt; Var -&gt; Bool
$c&gt; :: Var -&gt; Var -&gt; Bool
&gt; :: Var -&gt; Var -&gt; Bool
$c&gt;= :: Var -&gt; Var -&gt; Bool
&gt;= :: Var -&gt; Var -&gt; Bool
$cmax :: Var -&gt; Var -&gt; Var
max :: Var -&gt; Var -&gt; Var
$cmin :: Var -&gt; Var -&gt; Var
min :: Var -&gt; Var -&gt; Var
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679117833"><span id="local-6989586621679117838"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Data.NatMap.html#Var"><span class="hs-identifier hs-type">Var</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-299"></span><span>  </span><span id="local-6989586621679117842"><span class="annot"><span class="annottext">show :: Var -&gt; String
</span><a href="#local-6989586621679117842"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.NatMap.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621679117844"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679117844"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679117844"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-300"></span></pre></body></html>