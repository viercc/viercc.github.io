<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ExistentialQuantification #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE InstanceSigs #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE PolyKinds #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE QuantifiedConstraints #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE DerivingVia #-}</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="annot"><span class="hs-comment">-- | Monads in the cateogory of @Functor@s.</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">FMonad</span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="FFunctor.html#~%3E"><span class="hs-operator">(~&gt;)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><span class="hs-comment">-- * FMonad</span></span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier">FMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="FMonad.html#fjoin"><span class="hs-identifier">fjoin</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><span class="hs-comment">-- * FMonad laws</span></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Laws</span></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><span class="hs-comment">-- $fmonad_laws_in_fbind</span></span><span>
</span><span id="line-26"></span><span>    </span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Laws (in terms of @fjoin@)</span></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><span class="hs-comment">-- $fmonad_laws_in_fjoin</span></span><span>
</span><span id="line-30"></span><span>    </span><span>
</span><span id="line-31"></span><span>    </span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Re-export</span></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="FFunctor.html#FFunctor"><span class="hs-identifier">FFunctor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">where</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Comonad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Comonad</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(=&gt;=)</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">join</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative.Free</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">FreeAp</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative.Free.Final</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">FreeApFinal</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative.Lift</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative.Trans.FreeAp</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">FreeApT</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Free</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">FreeM</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Free.Church</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">FreeMChurch</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Free</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FreeT</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Free.Extra.html"><span class="hs-identifier">Control.Monad.Trans.Free.Extra</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Free.Extra.html#inr"><span class="hs-identifier">inr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Free.Extra.html#fbindFreeT_"><span class="hs-identifier">fbindFreeT_</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Identity</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Reader</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Writer</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Compose</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Day</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Day.Comonoid</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Comonad</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Day.Curried</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Functor.Day.Extra.html"><span class="hs-identifier">Data.Functor.Day.Extra</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Day.Extra.html#uncurried"><span class="hs-identifier">uncurried</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Functor.Flip1.html"><span class="hs-identifier">Data.Functor.Flip1</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Kan.Lan</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Kan.Ran</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Product</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Sum</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="FFunctor.html"><span class="hs-identifier">FFunctor</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bifunctor.Product</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Bi</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.Bifunctor.Product.Extra.html"><span class="hs-identifier">Data.Bifunctor.Product.Extra</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Bi</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="annot"><span class="hs-comment">{- $fmonad_laws_in_fbind

Like 'Monad', there is a set of laws which every instance of 'FMonad' should satisfy.

[fpure is natural in g]

   Let @g, h@ be arbitrary @Functor@s. For any natural transformation @n :: g ~&gt; h@,

   &gt; ffmap n . fpure = fpure . n

[fbind is natural in g,h]

   Let @g, g', h, h'@ be arbitrary @Functor@s. For all natural transformations
   @k :: g ~&gt; ff h@, @nat_g :: g' ~&gt; g@, and @nat_h :: h ~&gt; h'@, the following holds.

   &gt; fbind (ffmap nat_h . k . nat_g) = ffmap nat_h . fbind k . ffmap nat_g

[Left unit]

   &gt; fbind k . fpure = k

[Right unit]

   &gt; fbind fpure = id

[Associativity]

   &gt; fbind k . fbind j = fbind (fbind k . j)
-}</span></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="annot"><span class="hs-comment">{- $fmonad_laws_in_fjoin

Alternatively, 'FMonad' laws can be stated using 'fjoin' instead. 

[fpure is natural in g]

   For all @Functor g@, @Functor h@, and @n :: g ~&gt; h@,

   &gt; ffmap n . fpure = fpure . n

[fjoin is natural in g]

   For all @Functor g@, @Functor h@, and @n :: g ~&gt; h@,

   &gt; ffmap n . fjoin = fjoin . ffmap (ffmap n)

[Left unit]

   &gt; fjoin . fpure = id

[Right unit]

   &gt; fjoin . ffmap fpure = id

[Associativity]

   &gt; fjoin . fjoin = fjoin . ffmap fjoin

-}</span></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="annot"><span class="hs-comment">{- | @FMonad@ is to 'FFunctor' what 'Monad' is to 'Functor'.


+----------------+-----------------------------+------------------------------------+
|                | @'Monad' m@                 | @'FMonad'   mm@                    |
+================+=============================+====================================+
| Superclass     | @'Functor' m@               | @'FFunctor' mm@                    |
+----------------+-----------------------------+------------------------------------+
| Features       | @                           | @                                  |
|                | return = pure               | fpure                              |
|                |   :: a -&gt; m a               |    :: (Functor g)                  |
|                | @                           |    =&gt; g ~&gt; mm g                    |
|                |                             | @                                  |
+----------------+-----------------------------+------------------------------------+
|                | @                           | @                                  |
|                | (=&lt;&lt;)                       | fbind                              |
|                |   :: (a -&gt; m b)             |   :: (Functor g, Functor h)        |
|                |   -&gt; (m a -&gt; m b)           |   =&gt; (g ~&gt; mm h)                   |
|                | @                           |   -&gt; (mm g ~&gt; mm h)                |
|                |                             | @                                  |
+----------------+-----------------------------+------------------------------------+



-}</span></span><span> </span><span>
</span><span id="line-156"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="FFunctor.html#FFunctor"><span class="hs-identifier hs-type">FFunctor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128307"><span class="hs-identifier hs-type">ff</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="FMonad"><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-var">FMonad</span></a></span></span><span> </span><span id="local-6989586621679128307"><span class="annot"><a href="#local-6989586621679128307"><span class="hs-identifier hs-type">ff</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-157"></span><span>  </span><span id="fpure"><span class="annot"><a href="FMonad.html#fpure"><span class="hs-identifier hs-type">fpure</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679128324"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679128324"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679128324"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="FFunctor.html#~%3E"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128307"><span class="hs-identifier hs-type">ff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128324"><span class="hs-identifier hs-type">g</span></a></span></span><span>
</span><span id="line-158"></span><span>  </span><span id="fbind"><span class="annot"><a href="FMonad.html#fbind"><span class="hs-identifier hs-type">fbind</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679128317"><span id="local-6989586621679128318"><span id="local-6989586621679128319"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679128317"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679128318"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679128317"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="FFunctor.html#~%3E"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128307"><span class="hs-identifier hs-type">ff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128318"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679128307"><span class="hs-identifier hs-type">ff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128317"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128319"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679128307"><span class="hs-identifier hs-type">ff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128318"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128319"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="annot"><span class="hs-comment">-- | 'join' but for 'FMonad' instead of 'Monad'.</span></span><span>
</span><span id="line-161"></span><span id="local-6989586621679128309"><span id="local-6989586621679128310"><span class="annot"><a href="FMonad.html#fjoin"><span class="hs-identifier hs-type">fjoin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128309"><span class="hs-identifier hs-type">ff</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679128310"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679128309"><span class="hs-identifier hs-type">ff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679128309"><span class="hs-identifier hs-type">ff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128310"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="FFunctor.html#~%3E"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128309"><span class="hs-identifier hs-type">ff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128310"><span class="hs-identifier hs-type">g</span></a></span></span></span><span>
</span><span id="line-162"></span><span id="fjoin"><span class="annot"><span class="annottext">fjoin :: forall (ff :: FF) (g :: * -&gt; *).
(FMonad ff, Functor g) =&gt;
ff (ff g) ~&gt; ff g
</span><a href="FMonad.html#fjoin"><span class="hs-identifier hs-var hs-var">fjoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ff g ~&gt; ff g) -&gt; ff (ff g) x -&gt; ff g x
forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; ff h) -&gt; ff g a -&gt; ff h a
forall (ff :: FF) (g :: * -&gt; *) (h :: * -&gt; *) a.
(FMonad ff, Functor g, Functor h) =&gt;
(g ~&gt; ff h) -&gt; ff g a -&gt; ff h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var">fbind</span></a></span><span> </span><span class="annot"><span class="annottext">ff g x -&gt; ff g x
forall a. a -&gt; a
ff g ~&gt; ff g
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679128325"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679128325"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Sum</span></span><span> </span><span class="annot"><a href="#local-6989586621679128325"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-165"></span><span>  </span><span id="local-6989586621679128840"><span class="annot"><span class="annottext">fpure :: forall (g :: * -&gt; *). Functor g =&gt; g ~&gt; Sum f g
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var hs-var hs-var hs-var">fpure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g x -&gt; Sum f g x
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k). g a -&gt; Sum f g a
</span><span class="hs-identifier hs-var">InR</span></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span>  </span><span id="local-6989586621679128844"><span class="annot"><span class="annottext">fbind :: forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; Sum f h) -&gt; Sum f g a -&gt; Sum f h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var hs-var hs-var hs-var">fbind</span></a></span></span><span> </span><span class="annot"><span class="annottext">g ~&gt; Sum f h
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InL</span></span><span> </span><span id="local-6989586621679128846"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679128846"><span class="hs-identifier hs-var">fa</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f a -&gt; Sum f h a
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k). f a -&gt; Sum f g a
</span><span class="hs-identifier hs-var">InL</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679128846"><span class="hs-identifier hs-var">fa</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span class="annot"><a href="FMonad.html#fbind"><span class="hs-identifier hs-var">fbind</span></a></span><span> </span><span id="local-6989586621679128847"><span class="annot"><span class="annottext">g ~&gt; Sum f h
</span><a href="#local-6989586621679128847"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InR</span></span><span> </span><span id="local-6989586621679128848"><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679128848"><span class="hs-identifier hs-var">ga</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g a -&gt; Sum f h a
g ~&gt; Sum f h
</span><a href="#local-6989586621679128847"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679128848"><span class="hs-identifier hs-var">ga</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679128340"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679128340"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679128337"><span class="annot"><a href="#local-6989586621679128337"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679128340"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128337"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Product</span></span><span> </span><span class="annot"><a href="#local-6989586621679128340"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-171"></span><span>  </span><span id="local-6989586621679128861"><span class="annot"><span class="annottext">fpure :: forall (g :: * -&gt; *). Functor g =&gt; g ~&gt; Product f g
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var hs-var hs-var hs-var">fpure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f x -&gt; g x -&gt; Product f g x
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
f a -&gt; g a -&gt; Product f g a
</span><span class="hs-identifier hs-var">Pair</span></span><span> </span><span class="annot"><span class="annottext">f x
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-172"></span><span>  </span><span id="local-6989586621679128866"><span class="annot"><span class="annottext">fbind :: forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; Product f h) -&gt; Product f g a -&gt; Product f h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var hs-var hs-var hs-var">fbind</span></a></span></span><span> </span><span id="local-6989586621679128867"><span class="annot"><span class="annottext">g ~&gt; Product f h
</span><a href="#local-6989586621679128867"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pair</span></span><span> </span><span id="local-6989586621679128868"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679128868"><span class="hs-identifier hs-var">fa1</span></a></span></span><span> </span><span id="local-6989586621679128869"><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679128869"><span class="hs-identifier hs-var">ga</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">g a -&gt; Product f h a
g ~&gt; Product f h
</span><a href="#local-6989586621679128867"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679128869"><span class="hs-identifier hs-var">ga</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pair</span></span><span> </span><span id="local-6989586621679128870"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679128870"><span class="hs-identifier hs-var">fa2</span></a></span></span><span> </span><span id="local-6989586621679128871"><span class="annot"><span class="annottext">h a
</span><a href="#local-6989586621679128871"><span class="hs-identifier hs-var">ha</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f a -&gt; h a -&gt; Product f h a
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
f a -&gt; g a -&gt; Product f g a
</span><span class="hs-identifier hs-var">Pair</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679128868"><span class="hs-identifier hs-var">fa1</span></a></span><span> </span><span class="annot"><span class="annottext">f a -&gt; f a -&gt; f a
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679128870"><span class="hs-identifier hs-var">fa2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">h a
</span><a href="#local-6989586621679128871"><span class="hs-identifier hs-var">ha</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679128355"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679128355"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="#local-6989586621679128355"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-176"></span><span>  </span><span id="local-6989586621679128884"><span class="annot"><span class="annottext">fpure :: forall (g :: * -&gt; *). Functor g =&gt; g ~&gt; Compose f g
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var hs-var hs-var hs-var">fpure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (g x) -&gt; Compose f g x
forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><span class="hs-identifier hs-var">Compose</span></span><span> </span><span class="annot"><span class="annottext">(f (g x) -&gt; Compose f g x)
-&gt; (g x -&gt; f (g x)) -&gt; g x -&gt; Compose f g x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">g x -&gt; f (g x)
forall a. a -&gt; f a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-177"></span><span>  </span><span id="local-6989586621679128890"><span class="annot"><span class="annottext">fbind :: forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; Compose f h) -&gt; Compose f g a -&gt; Compose f h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var hs-var hs-var hs-var">fbind</span></a></span></span><span> </span><span id="local-6989586621679128891"><span class="annot"><span class="annottext">g ~&gt; Compose f h
</span><a href="#local-6989586621679128891"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (h a) -&gt; Compose f h a
forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><span class="hs-identifier hs-var">Compose</span></span><span> </span><span class="annot"><span class="annottext">(f (h a) -&gt; Compose f h a)
-&gt; (Compose f g a -&gt; f (h a)) -&gt; Compose f g a -&gt; Compose f h a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f (g a) -&gt; (g a -&gt; f (h a)) -&gt; f (h a)
forall a b. f a -&gt; (a -&gt; f b) -&gt; f b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Compose f h a -&gt; f (h a)
forall {k1} {k2} (f :: k1 -&gt; *) (g :: k2 -&gt; k1) (a :: k2).
Compose f g a -&gt; f (g a)
</span><span class="hs-identifier hs-var">getCompose</span></span><span> </span><span class="annot"><span class="annottext">(Compose f h a -&gt; f (h a))
-&gt; (g a -&gt; Compose f h a) -&gt; g a -&gt; f (h a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">g a -&gt; Compose f h a
g ~&gt; Compose f h
</span><a href="#local-6989586621679128891"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(f (g a) -&gt; f (h a))
-&gt; (Compose f g a -&gt; f (g a)) -&gt; Compose f g a -&gt; f (h a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Compose f g a -&gt; f (g a)
forall {k1} {k2} (f :: k1 -&gt; *) (g :: k2 -&gt; k1) (a :: k2).
Compose f g a -&gt; f (g a)
</span><span class="hs-identifier hs-var">getCompose</span></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679128378"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679128378"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator hs-type">(:+:)</span></span><span> </span><span class="annot"><a href="#local-6989586621679128378"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621679128901"><span class="annot"><span class="annottext">fpure :: forall (g :: * -&gt; *). Functor g =&gt; g ~&gt; (f :+: g)
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var hs-var hs-var hs-var">fpure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g x -&gt; (:+:) f g x
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k). g p -&gt; (:+:) f g p
</span><span class="hs-identifier hs-var">R1</span></span><span>
</span><span id="line-181"></span><span>  </span><span id="local-6989586621679128905"><span class="annot"><span class="annottext">fbind :: forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; (f :+: h)) -&gt; (:+:) f g a -&gt; (:+:) f h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var hs-var hs-var hs-var">fbind</span></a></span></span><span> </span><span id="local-6989586621679128906"><span class="annot"><span class="annottext">g ~&gt; (f :+: h)
</span><a href="#local-6989586621679128906"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679128907"><span class="annot"><span class="annottext">(:+:) f g a
</span><a href="#local-6989586621679128907"><span class="hs-identifier hs-var">ff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(:+:) f g a
</span><a href="#local-6989586621679128907"><span class="hs-identifier hs-var">ff</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">L1</span></span><span> </span><span id="local-6989586621679128909"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679128909"><span class="hs-identifier hs-var">fx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f a -&gt; (:+:) f h a
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k). f p -&gt; (:+:) f g p
</span><span class="hs-identifier hs-var">L1</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679128909"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">R1</span></span><span> </span><span id="local-6989586621679128910"><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679128910"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">g a -&gt; (:+:) f h a
g ~&gt; (f :+: h)
</span><a href="#local-6989586621679128906"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679128910"><span class="hs-identifier hs-var">gx</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679128391"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679128391"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679128389"><span class="annot"><a href="#local-6989586621679128389"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679128391"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128389"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator hs-type">(:*:)</span></span><span> </span><span class="annot"><a href="#local-6989586621679128391"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-186"></span><span>  </span><span id="local-6989586621679128922"><span class="annot"><span class="annottext">fpure :: forall (g :: * -&gt; *). Functor g =&gt; g ~&gt; (f :*: g)
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var hs-var hs-var hs-var">fpure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f x
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">f x -&gt; g x -&gt; (:*:) f g x
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k).
f p -&gt; g p -&gt; (:*:) f g p
</span><span class="hs-operator hs-var">:*:</span></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>  </span><span id="local-6989586621679128927"><span class="annot"><span class="annottext">fbind :: forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; (f :*: h)) -&gt; (:*:) f g a -&gt; (:*:) f h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var hs-var hs-var hs-var">fbind</span></a></span></span><span> </span><span id="local-6989586621679128928"><span class="annot"><span class="annottext">g ~&gt; (f :*: h)
</span><a href="#local-6989586621679128928"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679128929"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679128929"><span class="hs-identifier hs-var">fa</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span id="local-6989586621679128930"><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679128930"><span class="hs-identifier hs-var">ga</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">g a -&gt; (:*:) f h a
g ~&gt; (f :*: h)
</span><a href="#local-6989586621679128928"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679128930"><span class="hs-identifier hs-var">ga</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621679128931"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679128931"><span class="hs-identifier hs-var">fa'</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span id="local-6989586621679128932"><span class="annot"><span class="annottext">h a
</span><a href="#local-6989586621679128932"><span class="hs-identifier hs-var">ha</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679128929"><span class="hs-identifier hs-var">fa</span></a></span><span> </span><span class="annot"><span class="annottext">f a -&gt; f a -&gt; f a
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679128931"><span class="hs-identifier hs-var">fa'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f a -&gt; h a -&gt; (:*:) f h a
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k).
f p -&gt; g p -&gt; (:*:) f g p
</span><span class="hs-operator hs-var">:*:</span></span><span> </span><span class="annot"><span class="annottext">h a
</span><a href="#local-6989586621679128932"><span class="hs-identifier hs-var">ha</span></a></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span id="local-6989586621679128940"><span id="local-6989586621679128947"><span class="hs-keyword">deriving</span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-keyword">via</span><span> </span><span id="local-6989586621679128411"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679128411"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679128411"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator hs-type">(:.:)</span></span><span> </span><span class="annot"><a href="#local-6989586621679128411"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span id="local-6989586621679128962"><span id="local-6989586621679128969"><span class="hs-keyword">deriving</span><span>
</span><span id="line-195"></span><span>  </span><span id="local-6989586621679128421"><span id="local-6989586621679128422"><span class="hs-keyword">via</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IdentityT</span></span></span></span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M1</span></span><span> </span><span class="annot"><a href="#local-6989586621679128421"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128422"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span id="local-6989586621679128983"><span id="local-6989586621679128990"><span class="hs-keyword">deriving</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-keyword">via</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IdentityT</span></span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec1</span></span></span></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lift</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-203"></span><span>  </span><span id="local-6989586621679129005"><span class="annot"><span class="annottext">fpure :: forall (g :: * -&gt; *). Functor g =&gt; g ~&gt; Lift g
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var hs-var hs-var hs-var">fpure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g x -&gt; Lift g x
forall (f :: * -&gt; *) a. f a -&gt; Lift f a
</span><span class="hs-identifier hs-var">Other</span></span><span>
</span><span id="line-204"></span><span>  </span><span id="local-6989586621679129009"><span class="annot"><span class="annottext">fbind :: forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; Lift h) -&gt; Lift g a -&gt; Lift h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var hs-var hs-var hs-var">fbind</span></a></span></span><span> </span><span class="annot"><span class="annottext">g ~&gt; Lift h
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pure</span></span><span> </span><span id="local-6989586621679129011"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129011"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Lift h a
forall (f :: * -&gt; *) a. a -&gt; Lift f a
</span><span class="hs-identifier hs-var">Pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129011"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><a href="FMonad.html#fbind"><span class="hs-identifier hs-var">fbind</span></a></span><span> </span><span id="local-6989586621679129012"><span class="annot"><span class="annottext">g ~&gt; Lift h
</span><a href="#local-6989586621679129012"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Other</span></span><span> </span><span id="local-6989586621679129013"><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679129013"><span class="hs-identifier hs-var">ga</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g a -&gt; Lift h a
g ~&gt; Lift h
</span><a href="#local-6989586621679129012"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679129013"><span class="hs-identifier hs-var">ga</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FreeM.Free</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-208"></span><span>  </span><span id="local-6989586621679129024"><span class="annot"><span class="annottext">fpure :: forall (g :: * -&gt; *). Functor g =&gt; g ~&gt; Free g
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var hs-var hs-var hs-var">fpure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g x -&gt; Free g x
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, MonadFree f m) =&gt;
f a -&gt; m a
</span><span class="hs-identifier hs-var">FreeM.liftF</span></span><span>
</span><span id="line-209"></span><span>  </span><span id="local-6989586621679129030"><span class="annot"><span class="annottext">fbind :: forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; Free h) -&gt; Free g a -&gt; Free h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var hs-var hs-var hs-var">fbind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall x. g x -&gt; Free h x) -&gt; Free g a -&gt; Free h a
forall (m :: * -&gt; *) (f :: * -&gt; *) a.
Monad m =&gt;
(forall x. f x -&gt; m x) -&gt; Free f a -&gt; m a
</span><span class="hs-identifier hs-var">FreeM.foldFree</span></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FreeMChurch.F</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-212"></span><span>  </span><span id="local-6989586621679129042"><span class="annot"><span class="annottext">fpure :: forall (g :: * -&gt; *). Functor g =&gt; g ~&gt; F g
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var hs-var hs-var hs-var">fpure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g x -&gt; F g x
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, MonadFree f m) =&gt;
f a -&gt; m a
</span><span class="hs-identifier hs-var">FreeMChurch.liftF</span></span><span>
</span><span id="line-213"></span><span>  </span><span id="local-6989586621679129047"><span class="annot"><span class="annottext">fbind :: forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; F h) -&gt; F g a -&gt; F h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var hs-var hs-var hs-var">fbind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall x. g x -&gt; F h x) -&gt; F g a -&gt; F h a
forall (m :: * -&gt; *) (f :: * -&gt; *) a.
Monad m =&gt;
(forall x. f x -&gt; m x) -&gt; F f a -&gt; m a
</span><span class="hs-identifier hs-var">FreeMChurch.foldF</span></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FreeAp.Ap</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-216"></span><span>  </span><span id="local-6989586621679129056"><span class="annot"><span class="annottext">fpure :: forall (g :: * -&gt; *). Functor g =&gt; g ~&gt; Ap g
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var hs-var hs-var hs-var">fpure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g x -&gt; Ap g x
forall (f :: * -&gt; *) a. f a -&gt; Ap f a
</span><span class="hs-identifier hs-var">FreeAp.liftAp</span></span><span>
</span><span id="line-217"></span><span>  </span><span id="local-6989586621679129062"><span class="annot"><span class="annottext">fbind :: forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; Ap h) -&gt; Ap g a -&gt; Ap h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var hs-var hs-var hs-var">fbind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall x. g x -&gt; Ap h x) -&gt; Ap g a -&gt; Ap h a
forall (g :: * -&gt; *) (f :: * -&gt; *) a.
Applicative g =&gt;
(forall x. f x -&gt; g x) -&gt; Ap f a -&gt; g a
</span><span class="hs-identifier hs-var">FreeAp.runAp</span></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FreeApFinal.Ap</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-220"></span><span>  </span><span id="local-6989586621679129071"><span class="annot"><span class="annottext">fpure :: forall (g :: * -&gt; *). Functor g =&gt; g ~&gt; Ap g
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var hs-var hs-var hs-var">fpure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g x -&gt; Ap g x
forall (f :: * -&gt; *) a. f a -&gt; Ap f a
</span><span class="hs-identifier hs-var">FreeApFinal.liftAp</span></span><span>
</span><span id="line-221"></span><span>  </span><span id="local-6989586621679129077"><span class="annot"><span class="annottext">fbind :: forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; Ap h) -&gt; Ap g a -&gt; Ap h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var hs-var hs-var hs-var">fbind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall x. g x -&gt; Ap h x) -&gt; Ap g a -&gt; Ap h a
forall (g :: * -&gt; *) (f :: * -&gt; *) a.
Applicative g =&gt;
(forall x. f x -&gt; g x) -&gt; Ap f a -&gt; g a
</span><span class="hs-identifier hs-var">FreeApFinal.runAp</span></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IdentityT</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-224"></span><span>  </span><span id="local-6989586621679129085"><span class="annot"><span class="annottext">fpure :: forall (g :: * -&gt; *). Functor g =&gt; g ~&gt; IdentityT g
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var hs-var hs-var hs-var">fpure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g x -&gt; IdentityT g x
forall {k} (f :: k -&gt; *) (a :: k). f a -&gt; IdentityT f a
</span><span class="hs-identifier hs-var">IdentityT</span></span><span>
</span><span id="line-225"></span><span>  </span><span id="local-6989586621679129089"><span class="annot"><span class="annottext">fbind :: forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; IdentityT h) -&gt; IdentityT g a -&gt; IdentityT h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var hs-var hs-var hs-var">fbind</span></a></span></span><span> </span><span id="local-6989586621679129090"><span class="annot"><span class="annottext">g ~&gt; IdentityT h
</span><a href="#local-6989586621679129090"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g a -&gt; IdentityT h a
g ~&gt; IdentityT h
</span><a href="#local-6989586621679129090"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(g a -&gt; IdentityT h a)
-&gt; (IdentityT g a -&gt; g a) -&gt; IdentityT g a -&gt; IdentityT h a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IdentityT g a -&gt; g a
forall {k} (f :: k -&gt; *) (a :: k). IdentityT f a -&gt; f a
</span><span class="hs-identifier hs-var">runIdentityT</span></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679128504"><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679128504"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-comment">-- See the similarity between 'Compose' @((-&gt;) e)@</span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-comment">-- return :: x -&gt; (e -&gt; x)</span><span>
</span><span id="line-231"></span><span>  </span><span id="local-6989586621679129101"><span class="annot"><span class="annottext">fpure :: forall (g :: * -&gt; *). Functor g =&gt; g ~&gt; ReaderT e g
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var hs-var hs-var hs-var">fpure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(e -&gt; g x) -&gt; ReaderT e g x
forall r (m :: * -&gt; *) a. (r -&gt; m a) -&gt; ReaderT r m a
</span><span class="hs-identifier hs-var">ReaderT</span></span><span> </span><span class="annot"><span class="annottext">((e -&gt; g x) -&gt; ReaderT e g x)
-&gt; (g x -&gt; e -&gt; g x) -&gt; g x -&gt; ReaderT e g x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">g x -&gt; e -&gt; g x
forall a. a -&gt; e -&gt; a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-comment">-- join :: (e -&gt; e -&gt; x) -&gt; (e -&gt; x)</span><span>
</span><span id="line-234"></span><span>  </span><span id="local-6989586621679129106"><span class="annot"><span class="annottext">fbind :: forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; ReaderT e h) -&gt; ReaderT e g a -&gt; ReaderT e h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var hs-var hs-var hs-var">fbind</span></a></span></span><span> </span><span id="local-6989586621679129107"><span class="annot"><span class="annottext">g ~&gt; ReaderT e h
</span><a href="#local-6989586621679129107"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(e -&gt; h a) -&gt; ReaderT e h a
forall r (m :: * -&gt; *) a. (r -&gt; m a) -&gt; ReaderT r m a
</span><span class="hs-identifier hs-var">ReaderT</span></span><span> </span><span class="annot"><span class="annottext">((e -&gt; h a) -&gt; ReaderT e h a)
-&gt; (ReaderT e g a -&gt; e -&gt; h a) -&gt; ReaderT e g a -&gt; ReaderT e h a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(e -&gt; g a) -&gt; (g a -&gt; e -&gt; h a) -&gt; e -&gt; h a
forall a b. (e -&gt; a) -&gt; (a -&gt; e -&gt; b) -&gt; e -&gt; b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ReaderT e h a -&gt; e -&gt; h a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">(ReaderT e h a -&gt; e -&gt; h a)
-&gt; (g a -&gt; ReaderT e h a) -&gt; g a -&gt; e -&gt; h a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">g a -&gt; ReaderT e h a
g ~&gt; ReaderT e h
</span><a href="#local-6989586621679129107"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((e -&gt; g a) -&gt; e -&gt; h a)
-&gt; (ReaderT e g a -&gt; e -&gt; g a) -&gt; ReaderT e g a -&gt; e -&gt; h a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ReaderT e g a -&gt; e -&gt; g a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679128520"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679128520"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679128520"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-comment">-- See the similarity between 'FlipCompose' @(Writer m)@</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-comment">-- fmap return :: f x -&gt; f (Writer m x)</span><span>
</span><span id="line-240"></span><span>  </span><span id="local-6989586621679129120"><span class="annot"><span class="annottext">fpure :: forall (g :: * -&gt; *). Functor g =&gt; g ~&gt; WriterT m g
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var hs-var hs-var hs-var">fpure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g (x, m) -&gt; WriterT m g x
forall w (m :: * -&gt; *) a. m (a, w) -&gt; WriterT w m a
</span><span class="hs-identifier hs-var">WriterT</span></span><span> </span><span class="annot"><span class="annottext">(g (x, m) -&gt; WriterT m g x)
-&gt; (g x -&gt; g (x, m)) -&gt; g x -&gt; WriterT m g x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(x -&gt; (x, m)) -&gt; g x -&gt; g (x, m)
forall a b. (a -&gt; b) -&gt; g a -&gt; g b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">m
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-comment">-- fmap join :: f (Writer m (Writer m x)) -&gt; f (Writer m x)</span><span>
</span><span id="line-243"></span><span>  </span><span id="local-6989586621679129130"><span class="annot"><span class="annottext">fbind :: forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; WriterT m h) -&gt; WriterT m g a -&gt; WriterT m h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var hs-var hs-var hs-var">fbind</span></a></span></span><span> </span><span id="local-6989586621679129131"><span class="annot"><span class="annottext">g ~&gt; WriterT m h
</span><a href="#local-6989586621679129131"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">h (a, m) -&gt; WriterT m h a
forall w (m :: * -&gt; *) a. m (a, w) -&gt; WriterT w m a
</span><span class="hs-identifier hs-var">WriterT</span></span><span> </span><span class="annot"><span class="annottext">(h (a, m) -&gt; WriterT m h a)
-&gt; (WriterT m g a -&gt; h (a, m)) -&gt; WriterT m g a -&gt; WriterT m h a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(((a, m), m) -&gt; (a, m)) -&gt; h ((a, m), m) -&gt; h (a, m)
forall a b. (a -&gt; b) -&gt; h a -&gt; h b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679129132"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129132"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679129133"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679129133"><span class="hs-identifier hs-var">m1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679129134"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679129134"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129132"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679129134"><span class="hs-identifier hs-var">m2</span></a></span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679129133"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(h ((a, m), m) -&gt; h (a, m))
-&gt; (WriterT m g a -&gt; h ((a, m), m)) -&gt; WriterT m g a -&gt; h (a, m)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WriterT m h (a, m) -&gt; h ((a, m), m)
forall w (m :: * -&gt; *) a. WriterT w m a -&gt; m (a, w)
</span><span class="hs-identifier hs-var">runWriterT</span></span><span> </span><span class="annot"><span class="annottext">(WriterT m h (a, m) -&gt; h ((a, m), m))
-&gt; (WriterT m g a -&gt; WriterT m h (a, m))
-&gt; WriterT m g a
-&gt; h ((a, m), m)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WriterT m (WriterT m h) a -&gt; WriterT m h (a, m)
forall w (m :: * -&gt; *) a. WriterT w m a -&gt; m (a, w)
</span><span class="hs-identifier hs-var">runWriterT</span></span><span> </span><span class="annot"><span class="annottext">(WriterT m (WriterT m h) a -&gt; WriterT m h (a, m))
-&gt; (WriterT m g a -&gt; WriterT m (WriterT m h) a)
-&gt; WriterT m g a
-&gt; WriterT m h (a, m)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(g ~&gt; WriterT m h) -&gt; WriterT m g a -&gt; WriterT m (WriterT m h) a
forall (g :: * -&gt; *) (h :: * -&gt; *) x.
(Functor g, Functor h) =&gt;
(g ~&gt; h) -&gt; WriterT m g x -&gt; WriterT m h x
forall (ff :: FF) (g :: * -&gt; *) (h :: * -&gt; *) x.
(FFunctor ff, Functor g, Functor h) =&gt;
(g ~&gt; h) -&gt; ff g x -&gt; ff h x
</span><a href="FFunctor.html#ffmap"><span class="hs-identifier hs-var">ffmap</span></a></span><span> </span><span class="annot"><span class="annottext">g x -&gt; WriterT m h x
g ~&gt; WriterT m h
</span><a href="#local-6989586621679129131"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-comment">{-

If everything is unwrapped, FMonad @(StateT s)@ is

  fpure :: forall f. Functor f =&gt; f x -&gt; s -&gt; f (x, s)
  fjoin :: forall f. Functor f =&gt; (s -&gt; s -&gt; f ((x, s), s)) -&gt; s -&gt; f (x, s)

And if this type was generic in @s@ without any constraint like @Monoid s@,
the only possible implementations are

  -- fpure is uniquely:
  fpure fx s = (,s) &lt;$&gt; fx

  -- fjoin is one of the following three candidates
  fjoin1 stst s = (\((x,_),_) -&gt; (x,s)) &lt;$&gt; stst s s
  fjoin2 stst s = (\((x,_),s) -&gt; (x,s)) &lt;$&gt; stst s s
  fjoin3 stst s = (\((x,s),_) -&gt; (x,s)) &lt;$&gt; stst s s

But none of them satisfy the FMonad law.

  (fjoin1 . fpure) st
    = fjoin1 $ \s1 s2 -&gt; (,s1) &lt;$&gt; st s2
    = \s -&gt; (\((x,_),_) -&gt; (x,s)) &lt;$&gt; ((,s) &lt;$&gt; st s)
    = \s -&gt; (\(x,_) -&gt; (x,s)) &lt;$&gt; st s
    /= st
  (fjoin2 . fpure) st
    = fjoin2 $ \s1 s2 -&gt; (,s1) &lt;$&gt; st s2
    = \s -&gt; (\((x,_),s') -&gt; (x,s')) &lt;$&gt; ((,s) &lt;$&gt; st s)
    = \s -&gt; (\(x,_) -&gt; (x,s)) &lt;$&gt; st s
    /= st
  (fjoin3 . ffmap fpure) st
    = fjoin2 $ \s1 s2 -&gt; fmap (fmap (,s2)) . st s1
    = \s -&gt; ((\((x,s'),_) -&gt; (x,s')) . fmap (,s)) &lt;$&gt; st s
    = \s -&gt; (\(x,_) -&gt; (x,s)) &lt;$&gt; st s
    /= st

So the lawful @FMonad (StateT s)@ will utilize some structure
on @s@.

One way would be seeing StateT as the composision of Reader s and
Writer s:

  StateT s m ~ Reader s &#8728; m &#8728; Writer s
    where (&#8728;) = Compose

By this way

  StateT s (StateT s m) ~ Reader s &#8728; Reader s &#8728; m &#8728; Writer s &#8728; Writer s

And you can collapse the nesting by applying @join@ for @Reader s &#8728; Reader s@
and @Writer s &#8728; Writer s@. To do so, it will need @Monoid s@ for @Monad (Writer s)@.

-}</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679128544"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679128544"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679128544"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-comment">-- Note that this is different to @lift@ in 'MonadTrans',</span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-comment">-- whilst having similar type and actually equal in</span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-comment">-- several other 'FMonad' instances.</span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-304"></span><span>  </span><span class="hs-comment">-- See the discussion below.</span><span>
</span><span id="line-305"></span><span>  </span><span id="local-6989586621679129148"><span class="annot"><span class="annottext">fpure :: forall (g :: * -&gt; *). Functor g =&gt; g ~&gt; StateT s g
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var hs-var hs-var hs-var">fpure</span></a></span></span><span> </span><span id="local-6989586621679129149"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679129149"><span class="hs-identifier hs-var">fa</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(s -&gt; g (x, s)) -&gt; StateT s g x
forall s (m :: * -&gt; *) a. (s -&gt; m (a, s)) -&gt; StateT s m a
</span><span class="hs-identifier hs-var">StateT</span></span><span> </span><span class="annot"><span class="annottext">((s -&gt; g (x, s)) -&gt; StateT s g x)
-&gt; (s -&gt; g (x, s)) -&gt; StateT s g x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">s
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">s
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(x -&gt; (x, s)) -&gt; g x -&gt; g (x, s)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679129149"><span class="hs-identifier hs-var">fa</span></a></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span>  </span><span id="local-6989586621679129161"><span class="annot"><span class="annottext">fbind :: forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; StateT s h) -&gt; StateT s g a -&gt; StateT s h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var hs-var hs-var hs-var">fbind</span></a></span></span><span> </span><span id="local-6989586621679129162"><span class="annot"><span class="annottext">g ~&gt; StateT s h
</span><a href="#local-6989586621679129162"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(s -&gt; h (a, s)) -&gt; StateT s h a
forall s (m :: * -&gt; *) a. (s -&gt; m (a, s)) -&gt; StateT s m a
</span><span class="hs-identifier hs-var">StateT</span></span><span> </span><span class="annot"><span class="annottext">((s -&gt; h (a, s)) -&gt; StateT s h a)
-&gt; (StateT s g a -&gt; s -&gt; h (a, s)) -&gt; StateT s g a -&gt; StateT s h a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(s -&gt; s -&gt; h ((a, s), s)) -&gt; s -&gt; h (a, s)
forall (f :: * -&gt; *) a.
Functor f =&gt;
(s -&gt; s -&gt; f ((a, s), s)) -&gt; s -&gt; f (a, s)
</span><a href="#local-6989586621679129163"><span class="hs-identifier hs-var">fjoin_</span></a></span><span> </span><span class="annot"><span class="annottext">((s -&gt; s -&gt; h ((a, s), s)) -&gt; s -&gt; h (a, s))
-&gt; (StateT s g a -&gt; s -&gt; s -&gt; h ((a, s), s))
-&gt; StateT s g a
-&gt; s
-&gt; h (a, s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(StateT s h (a, s) -&gt; s -&gt; h ((a, s), s))
-&gt; (s -&gt; StateT s h (a, s)) -&gt; s -&gt; s -&gt; h ((a, s), s)
forall a b. (a -&gt; b) -&gt; (s -&gt; a) -&gt; s -&gt; b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">StateT s h (a, s) -&gt; s -&gt; h ((a, s), s)
forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><span class="hs-identifier hs-var">runStateT</span></span><span> </span><span class="annot"><span class="annottext">((s -&gt; StateT s h (a, s)) -&gt; s -&gt; s -&gt; h ((a, s), s))
-&gt; (StateT s g a -&gt; s -&gt; StateT s h (a, s))
-&gt; StateT s g a
-&gt; s
-&gt; s
-&gt; h ((a, s), s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StateT s (StateT s h) a -&gt; s -&gt; StateT s h (a, s)
forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><span class="hs-identifier hs-var">runStateT</span></span><span> </span><span class="annot"><span class="annottext">(StateT s (StateT s h) a -&gt; s -&gt; StateT s h (a, s))
-&gt; (StateT s g a -&gt; StateT s (StateT s h) a)
-&gt; StateT s g a
-&gt; s
-&gt; StateT s h (a, s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(g ~&gt; StateT s h) -&gt; StateT s g a -&gt; StateT s (StateT s h) a
forall (g :: * -&gt; *) (h :: * -&gt; *) x.
(Functor g, Functor h) =&gt;
(g ~&gt; h) -&gt; StateT s g x -&gt; StateT s h x
forall (ff :: FF) (g :: * -&gt; *) (h :: * -&gt; *) x.
(FFunctor ff, Functor g, Functor h) =&gt;
(g ~&gt; h) -&gt; ff g x -&gt; ff h x
</span><a href="FFunctor.html#ffmap"><span class="hs-identifier hs-var">ffmap</span></a></span><span> </span><span class="annot"><span class="annottext">g x -&gt; StateT s h x
g ~&gt; StateT s h
</span><a href="#local-6989586621679129162"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-309"></span><span>      </span><span class="annot"><a href="#local-6989586621679129163"><span class="hs-identifier hs-type">fjoin_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679128563"><span class="annot"><a href="#local-6989586621679128563"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679128564"><span class="annot"><a href="#local-6989586621679128564"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679128563"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679128544"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679128544"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679128563"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679128564"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679128544"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679128544"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679128544"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679128563"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679128564"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679128544"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>      </span><span id="local-6989586621679129163"><span class="annot"><span class="annottext">fjoin_ :: forall (f :: * -&gt; *) a.
Functor f =&gt;
(s -&gt; s -&gt; f ((a, s), s)) -&gt; s -&gt; f (a, s)
</span><a href="#local-6989586621679129163"><span class="hs-identifier hs-var hs-var">fjoin_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(f ((a, s), s) -&gt; f (a, s))
-&gt; (s -&gt; f ((a, s), s)) -&gt; s -&gt; f (a, s)
forall a b. (a -&gt; b) -&gt; (s -&gt; a) -&gt; s -&gt; b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(((a, s), s) -&gt; (a, s)) -&gt; f ((a, s), s) -&gt; f (a, s)
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">((a, s), s) -&gt; (a, s)
forall x. ((x, s), s) -&gt; (x, s)
</span><a href="#local-6989586621679129168"><span class="hs-identifier hs-var">joinWriter</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((s -&gt; f ((a, s), s)) -&gt; s -&gt; f (a, s))
-&gt; ((s -&gt; s -&gt; f ((a, s), s)) -&gt; s -&gt; f ((a, s), s))
-&gt; (s -&gt; s -&gt; f ((a, s), s))
-&gt; s
-&gt; f (a, s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(s -&gt; s -&gt; f ((a, s), s)) -&gt; s -&gt; f ((a, s), s)
forall x. (s -&gt; s -&gt; x) -&gt; s -&gt; x
</span><a href="#local-6989586621679129169"><span class="hs-identifier hs-var">joinReader</span></a></span><span>
</span><span id="line-311"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-312"></span><span>          </span><span class="annot"><a href="#local-6989586621679129169"><span class="hs-identifier hs-type">joinReader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679128572"><span class="annot"><a href="#local-6989586621679128572"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679128544"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679128544"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679128572"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679128544"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679128572"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-313"></span><span>          </span><span id="local-6989586621679129169"><span class="annot"><span class="annottext">joinReader :: forall x. (s -&gt; s -&gt; x) -&gt; s -&gt; x
</span><a href="#local-6989586621679129169"><span class="hs-identifier hs-var hs-var">joinReader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(s -&gt; s -&gt; x) -&gt; s -&gt; x
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span>          </span><span class="annot"><a href="#local-6989586621679129168"><span class="hs-identifier hs-type">joinWriter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679128571"><span class="annot"><a href="#local-6989586621679128571"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679128571"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679128544"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679128544"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679128571"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679128544"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>          </span><span id="local-6989586621679129168"><span class="annot"><span class="annottext">joinWriter :: forall x. ((x, s), s) -&gt; (x, s)
</span><a href="#local-6989586621679129168"><span class="hs-identifier hs-var hs-var">joinWriter</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679129172"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679129172"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679129173"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679129173"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679129174"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679129174"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679129172"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679129174"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; s -&gt; s
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679129173"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="hs-comment">{-

Note [About FMonad (StateT s) instance]

@fpure@ has a similar (Functor instead of Monad) type signature
with 'lift', but due to the different laws expected on them,
they aren't necessarily same.

@lift@ for @StateT s@ must be, by the 'MonadTrans' laws,
the one currently used. And this is not because the parameter @s@
is generic, so it applies if we have @Monoid s =&gt;@ constraints like
the above instance.

One way to have @lift = fpure@ here is requiring @s@ to be a type with
group operations, @Monoid@ + @inv@ for inverse operator,
instead of just being a monoid.

&gt; fpure fa = StateT $ \s -&gt; (,s) &lt;$&gt; fa
&gt; fjoin = StateT . fjoin_ . fmap runStateT . runStateT
&gt;   where fjoin_ mma s = fmap (fmap (joinGroup s)) $ joinReader mma s
&gt;         joinReader = join
&gt;         joinGroup s ((x,s1),s2) = (x, s2 &lt;&gt; inv s &lt;&gt; s1)

-}</span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="annot"><span class="hs-comment">-- | @Ran w (Ran w f) ~ Ran ('Compose' w w) f@</span></span><span>
</span><span id="line-344"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679128581"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Comonad</span></span><span> </span><span class="annot"><a href="#local-6989586621679128581"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ran</span></span><span> </span><span class="annot"><a href="#local-6989586621679128581"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-345"></span><span>  </span><span class="annot"><a href="FMonad.html#fpure"><span class="hs-identifier hs-type">fpure</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679128582"><span class="annot"><a href="#local-6989586621679128582"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679128583"><span class="annot"><a href="#local-6989586621679128583"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679128582"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><a href="#local-6989586621679128582"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128583"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-349"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Ran</span></span><span> </span><span class="annot"><a href="#local-6989586621679128581"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128582"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128583"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-comment">--       f x -&gt; (forall b. (x -&gt; w b) -&gt; f b)</span><span>
</span><span id="line-351"></span><span>  </span><span id="local-6989586621679129185"><span class="annot"><span class="annottext">fpure :: forall (f :: * -&gt; *) x. Functor f =&gt; f x -&gt; Ran w f x
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var hs-var hs-var hs-var">fpure</span></a></span></span><span> </span><span id="local-6989586621679129186"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679129186"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall b. (x -&gt; w b) -&gt; f b) -&gt; Ran w f x
forall {k} (g :: k -&gt; *) (h :: k -&gt; *) a.
(forall (b :: k). (a -&gt; g b) -&gt; h b) -&gt; Ran g h a
</span><span class="hs-identifier hs-var">Ran</span></span><span> </span><span class="annot"><span class="annottext">((forall b. (x -&gt; w b) -&gt; f b) -&gt; Ran w f x)
-&gt; (forall b. (x -&gt; w b) -&gt; f b) -&gt; Ran w f x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679129190"><span class="annot"><span class="annottext">x -&gt; w b
</span><a href="#local-6989586621679129190"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(x -&gt; b) -&gt; f x -&gt; f b
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">w b -&gt; b
forall a. w a -&gt; a
forall (w :: * -&gt; *) a. Comonad w =&gt; w a -&gt; a
</span><span class="hs-identifier hs-var">extract</span></span><span> </span><span class="annot"><span class="annottext">(w b -&gt; b) -&gt; (x -&gt; w b) -&gt; x -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">x -&gt; w b
</span><a href="#local-6989586621679129190"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679129186"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span>  </span><span class="annot"><a href="FMonad.html#fbind"><span class="hs-identifier hs-type">fbind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679128595"><span id="local-6989586621679128596"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679128595"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679128596"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-354"></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679128595"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="FFunctor.html#~%3E"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ran</span></span><span> </span><span class="annot"><a href="#local-6989586621679128581"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128596"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ran</span></span><span> </span><span class="annot"><a href="#local-6989586621679128581"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128595"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="FFunctor.html#~%3E"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ran</span></span><span> </span><span class="annot"><a href="#local-6989586621679128581"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128596"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-355"></span><span>  </span><span id="local-6989586621679129198"><span class="annot"><span class="annottext">fbind :: forall (g :: * -&gt; *) (h :: * -&gt; *).
(Functor g, Functor h) =&gt;
(g ~&gt; Ran w h) -&gt; Ran w g ~&gt; Ran w h
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var hs-var hs-var hs-var">fbind</span></a></span></span><span> </span><span id="local-6989586621679129199"><span class="annot"><span class="annottext">g ~&gt; Ran w h
</span><a href="#local-6989586621679129199"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129200"><span class="annot"><span class="annottext">Ran w g x
</span><a href="#local-6989586621679129200"><span class="hs-identifier hs-var">wg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall b. (x -&gt; w b) -&gt; h b) -&gt; Ran w h x
forall {k} (g :: k -&gt; *) (h :: k -&gt; *) a.
(forall (b :: k). (a -&gt; g b) -&gt; h b) -&gt; Ran g h a
</span><span class="hs-identifier hs-var">Ran</span></span><span> </span><span class="annot"><span class="annottext">((forall b. (x -&gt; w b) -&gt; h b) -&gt; Ran w h x)
-&gt; (forall b. (x -&gt; w b) -&gt; h b) -&gt; Ran w h x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679129202"><span class="annot"><span class="annottext">x -&gt; w b
</span><a href="#local-6989586621679129202"><span class="hs-identifier hs-var">xd</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ran w h (w b) -&gt; forall b. (w b -&gt; w b) -&gt; h b
forall {k} (g :: k -&gt; *) (h :: k -&gt; *) a.
Ran g h a -&gt; forall (b :: k). (a -&gt; g b) -&gt; h b
</span><span class="hs-identifier hs-var">runRan</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g (w b) -&gt; Ran w h (w b)
g ~&gt; Ran w h
</span><a href="#local-6989586621679129199"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ran w g x -&gt; forall b. (x -&gt; w b) -&gt; g b
forall {k} (g :: k -&gt; *) (h :: k -&gt; *) a.
Ran g h a -&gt; forall (b :: k). (a -&gt; g b) -&gt; h b
</span><span class="hs-identifier hs-var">runRan</span></span><span> </span><span class="annot"><span class="annottext">Ran w g x
</span><a href="#local-6989586621679129200"><span class="hs-identifier hs-var">wg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">w b -&gt; w (w b)
forall a. w a -&gt; w (w a)
forall (w :: * -&gt; *) a. Comonad w =&gt; w a -&gt; w (w a)
</span><span class="hs-identifier hs-var">duplicate</span></span><span> </span><span class="annot"><span class="annottext">(w b -&gt; w (w b)) -&gt; (x -&gt; w b) -&gt; x -&gt; w (w b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">x -&gt; w b
</span><a href="#local-6989586621679129202"><span class="hs-identifier hs-var">xd</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">w b -&gt; w b
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="annot"><span class="hs-comment">-- | @Lan w (Lan w f) ~ Lan ('Compose' w w) f@</span></span><span>
</span><span id="line-358"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679128612"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Comonad</span></span><span> </span><span class="annot"><a href="#local-6989586621679128612"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Lan</span></span><span> </span><span class="annot"><a href="#local-6989586621679128612"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-359"></span><span>  </span><span class="annot"><a href="FMonad.html#fpure"><span class="hs-identifier hs-type">fpure</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-360"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679128613"><span class="annot"><a href="#local-6989586621679128613"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679128614"><span class="annot"><a href="#local-6989586621679128614"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679128613"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-362"></span><span>    </span><span class="annot"><a href="#local-6989586621679128613"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128614"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-363"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Lan</span></span><span> </span><span class="annot"><a href="#local-6989586621679128612"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128613"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128614"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-364"></span><span>  </span><span class="hs-comment">--       f x -&gt; exists b. (w b -&gt; x, f b)</span><span>
</span><span id="line-365"></span><span>  </span><span id="local-6989586621679129216"><span class="annot"><span class="annottext">fpure :: forall (f :: * -&gt; *) x. Functor f =&gt; f x -&gt; Lan w f x
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var hs-var hs-var hs-var">fpure</span></a></span></span><span> </span><span id="local-6989586621679129217"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679129217"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(w x -&gt; x) -&gt; f x -&gt; Lan w f x
forall {k} (g :: k -&gt; *) (b :: k) a (h :: k -&gt; *).
(g b -&gt; a) -&gt; h b -&gt; Lan g h a
</span><span class="hs-identifier hs-var">Lan</span></span><span> </span><span class="annot"><span class="annottext">w x -&gt; x
forall a. w a -&gt; a
forall (w :: * -&gt; *) a. Comonad w =&gt; w a -&gt; a
</span><span class="hs-identifier hs-var">extract</span></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679129217"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-366"></span><span>  </span><span>
</span><span id="line-367"></span><span>  </span><span class="annot"><a href="FMonad.html#fbind"><span class="hs-identifier hs-type">fbind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679128623"><span id="local-6989586621679128624"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679128623"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679128624"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-368"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679128623"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="FFunctor.html#~%3E"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lan</span></span><span> </span><span class="annot"><a href="#local-6989586621679128612"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128624"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Lan</span></span><span> </span><span class="annot"><a href="#local-6989586621679128612"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128623"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="FFunctor.html#~%3E"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lan</span></span><span> </span><span class="annot"><a href="#local-6989586621679128612"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128624"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-369"></span><span>  </span><span id="local-6989586621679129225"><span class="annot"><span class="annottext">fbind :: forall (g :: * -&gt; *) (h :: * -&gt; *).
(Functor g, Functor h) =&gt;
(g ~&gt; Lan w h) -&gt; Lan w g ~&gt; Lan w h
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var hs-var hs-var hs-var">fbind</span></a></span></span><span> </span><span id="local-6989586621679129226"><span class="annot"><span class="annottext">g ~&gt; Lan w h
</span><a href="#local-6989586621679129226"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Lan</span></span><span> </span><span id="local-6989586621679129227"><span class="annot"><span class="annottext">w b -&gt; x
</span><a href="#local-6989586621679129227"><span class="hs-identifier hs-var">j1</span></a></span></span><span> </span><span id="local-6989586621679129228"><span class="annot"><span class="annottext">g b
</span><a href="#local-6989586621679129228"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">g b -&gt; Lan w h b
g ~&gt; Lan w h
</span><a href="#local-6989586621679129226"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">g b
</span><a href="#local-6989586621679129228"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-370"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Lan</span></span><span> </span><span id="local-6989586621679129230"><span class="annot"><span class="annottext">w b -&gt; b
</span><a href="#local-6989586621679129230"><span class="hs-identifier hs-var">j2</span></a></span></span><span> </span><span id="local-6989586621679129231"><span class="annot"><span class="annottext">h b
</span><a href="#local-6989586621679129231"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(w b -&gt; x) -&gt; h b -&gt; Lan w h x
forall {k} (g :: k -&gt; *) (b :: k) a (h :: k -&gt; *).
(g b -&gt; a) -&gt; h b -&gt; Lan g h a
</span><span class="hs-identifier hs-var">Lan</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">w b -&gt; b
</span><a href="#local-6989586621679129230"><span class="hs-identifier hs-var">j2</span></a></span><span> </span><span class="annot"><span class="annottext">(w b -&gt; b) -&gt; (w b -&gt; x) -&gt; w b -&gt; x
forall (w :: * -&gt; *) a b c.
Comonad w =&gt;
(w a -&gt; b) -&gt; (w b -&gt; c) -&gt; w a -&gt; c
</span><span class="hs-operator hs-var">=&gt;=</span></span><span> </span><span class="annot"><span class="annottext">w b -&gt; x
</span><a href="#local-6989586621679129227"><span class="hs-identifier hs-var">j1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">h b
</span><a href="#local-6989586621679129231"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679128639"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679128639"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Day</span></span><span> </span><span class="annot"><a href="#local-6989586621679128639"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-373"></span><span>  </span><span class="annot"><a href="FMonad.html#fpure"><span class="hs-identifier hs-type">fpure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679128640"><span class="annot"><a href="#local-6989586621679128640"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="FFunctor.html#~%3E"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Day</span></span><span> </span><span class="annot"><a href="#local-6989586621679128639"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128640"><span class="hs-identifier hs-type">g</span></a></span></span><span>
</span><span id="line-374"></span><span>  </span><span id="local-6989586621679129241"><span class="annot"><span class="annottext">fpure :: forall (g :: * -&gt; *) x. g x -&gt; Day f g x
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var hs-var hs-var hs-var">fpure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (x -&gt; x) -&gt; g x -&gt; Day f g x
forall (f :: * -&gt; *) a b (g :: * -&gt; *).
f (a -&gt; b) -&gt; g a -&gt; Day f g b
</span><span class="hs-identifier hs-var">day</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(x -&gt; x) -&gt; f (x -&gt; x)
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">x -&gt; x
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span>  </span><span class="hs-comment">{-
     day :: f (a -&gt; b) -&gt; g a -&gt; Day f g b
  -}</span><span>
</span><span id="line-379"></span><span>  </span><span>
</span><span id="line-380"></span><span>  </span><span id="local-6989586621679129245"><span class="annot"><span class="annottext">fbind :: forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; Day f h) -&gt; Day f g a -&gt; Day f h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var hs-var hs-var hs-var">fbind</span></a></span></span><span> </span><span id="local-6989586621679129246"><span class="annot"><span class="annottext">g ~&gt; Day f h
</span><a href="#local-6989586621679129246"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall x. Day f f x -&gt; f x) -&gt; Day (Day f f) h a -&gt; Day f h a
forall (f :: * -&gt; *) (g :: * -&gt; *) (h :: * -&gt; *) a.
(forall x. f x -&gt; g x) -&gt; Day f h a -&gt; Day g h a
</span><span class="hs-identifier hs-var">trans1</span></span><span> </span><span class="annot"><span class="annottext">Day f f x -&gt; f x
forall x. Day f f x -&gt; f x
forall (f :: * -&gt; *) a. Applicative f =&gt; Day f f a -&gt; f a
</span><span class="hs-identifier hs-var">dap</span></span><span> </span><span class="annot"><span class="annottext">(Day (Day f f) h a -&gt; Day f h a)
-&gt; (Day f g a -&gt; Day (Day f f) h a) -&gt; Day f g a -&gt; Day f h a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Day f (Day f h) a -&gt; Day (Day f f) h a
forall (f :: * -&gt; *) (g :: * -&gt; *) (h :: * -&gt; *) a.
Day f (Day g h) a -&gt; Day (Day f g) h a
</span><span class="hs-identifier hs-var">assoc</span></span><span> </span><span class="annot"><span class="annottext">(Day f (Day f h) a -&gt; Day (Day f f) h a)
-&gt; (Day f g a -&gt; Day f (Day f h) a)
-&gt; Day f g a
-&gt; Day (Day f f) h a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(g ~&gt; Day f h) -&gt; Day f g a -&gt; Day f (Day f h) a
forall (g :: * -&gt; *) (h :: * -&gt; *) (f :: * -&gt; *) a.
(forall x. g x -&gt; h x) -&gt; Day f g a -&gt; Day f h a
</span><span class="hs-identifier hs-var">trans2</span></span><span> </span><span class="annot"><span class="annottext">g x -&gt; Day f h x
g ~&gt; Day f h
</span><a href="#local-6989586621679129246"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-comment">{-
   trans2 k   :: Day f g ~&gt; Day f (Day f h)
   assoc      ::            Day f (Day f h) ~&gt; Day (Day f f) h
   trans1 dap ::                               Day (Day f f) h ~&gt; Day f h
-}</span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679128676"><span class="annot"><span class="hs-identifier hs-type">Comonoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679128676"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Curried</span></span><span> </span><span class="annot"><a href="#local-6989586621679128676"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-389"></span><span>  </span><span class="annot"><a href="FMonad.html#fpure"><span class="hs-identifier hs-type">fpure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679128677"><span id="local-6989586621679128678"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679128677"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679128677"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128678"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Curried</span></span><span> </span><span class="annot"><a href="#local-6989586621679128676"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128677"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128678"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-390"></span><span>  </span><span id="local-6989586621679129266"><span class="annot"><span class="annottext">fpure :: forall (g :: * -&gt; *) a. Functor g =&gt; g a -&gt; Curried f g a
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var hs-var hs-var hs-var">fpure</span></a></span></span><span> </span><span id="local-6989586621679129267"><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679129267"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall r. f (a -&gt; r) -&gt; g r) -&gt; Curried f g a
forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(forall r. g (a -&gt; r) -&gt; h r) -&gt; Curried g h a
</span><span class="hs-identifier hs-var">Curried</span></span><span> </span><span class="annot"><span class="annottext">((forall r. f (a -&gt; r) -&gt; g r) -&gt; Curried f g a)
-&gt; (forall r. f (a -&gt; r) -&gt; g r) -&gt; Curried f g a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679129271"><span class="annot"><span class="annottext">f (a -&gt; r)
</span><a href="#local-6989586621679129271"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f (a -&gt; r) -&gt; a -&gt; r
forall a. f a -&gt; a
forall (w :: * -&gt; *) a. Comonad w =&gt; w a -&gt; a
</span><span class="hs-identifier hs-var">extract</span></span><span> </span><span class="annot"><span class="annottext">f (a -&gt; r)
</span><a href="#local-6989586621679129271"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; r) -&gt; g a -&gt; g r
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679129267"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span>  </span><span id="local-6989586621679129274"><span class="annot"><span class="annottext">fbind :: forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; Curried f h) -&gt; Curried f g a -&gt; Curried f h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var hs-var hs-var hs-var">fbind</span></a></span></span><span> </span><span id="local-6989586621679129275"><span class="annot"><span class="annottext">g ~&gt; Curried f h
</span><a href="#local-6989586621679129275"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129276"><span class="annot"><span class="annottext">Curried f g a
</span><a href="#local-6989586621679129276"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall r. f (a -&gt; r) -&gt; h r) -&gt; Curried f h a
forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(forall r. g (a -&gt; r) -&gt; h r) -&gt; Curried g h a
</span><span class="hs-identifier hs-var">Curried</span></span><span> </span><span class="annot"><span class="annottext">((forall r. f (a -&gt; r) -&gt; h r) -&gt; Curried f h a)
-&gt; (forall r. f (a -&gt; r) -&gt; h r) -&gt; Curried f h a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679129284"><span class="annot"><span class="annottext">f (a -&gt; r)
</span><a href="#local-6989586621679129284"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Curried (Day f f) h a -&gt; forall r. Day f f (a -&gt; r) -&gt; h r
forall (g :: * -&gt; *) (h :: * -&gt; *) a.
Curried g h a -&gt; forall r. g (a -&gt; r) -&gt; h r
</span><span class="hs-identifier hs-var">runCurried</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Curried f (Curried f h) a -&gt; Curried (Day f f) h a
forall (f :: * -&gt; *) (g :: * -&gt; *) (h :: * -&gt; *) c.
(Functor f, Functor g) =&gt;
Curried f (Curried g h) c -&gt; Curried (Day f g) h c
</span><a href="Data.Functor.Day.Extra.html#uncurried"><span class="hs-identifier hs-var">uncurried</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(g ~&gt; Curried f h) -&gt; Curried f g a -&gt; Curried f (Curried f h) a
forall (g :: * -&gt; *) (h :: * -&gt; *) x.
(Functor g, Functor h) =&gt;
(g ~&gt; h) -&gt; Curried f g x -&gt; Curried f h x
forall (ff :: FF) (g :: * -&gt; *) (h :: * -&gt; *) x.
(FFunctor ff, Functor g, Functor h) =&gt;
(g ~&gt; h) -&gt; ff g x -&gt; ff h x
</span><a href="FFunctor.html#ffmap"><span class="hs-identifier hs-var">ffmap</span></a></span><span> </span><span class="annot"><span class="annottext">g x -&gt; Curried f h x
g ~&gt; Curried f h
</span><a href="#local-6989586621679129275"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Curried f g a
</span><a href="#local-6989586621679129276"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f (a -&gt; r) -&gt; Day f f (a -&gt; r)
forall a. f a -&gt; Day f f a
forall (f :: * -&gt; *) a. Comonoid f =&gt; f a -&gt; Day f f a
</span><span class="hs-identifier hs-var">coapply</span></span><span> </span><span class="annot"><span class="annottext">f (a -&gt; r)
</span><a href="#local-6989586621679129284"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679128705"><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FreeApT.ApT</span></span><span> </span><span class="annot"><a href="#local-6989586621679128705"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-395"></span><span>  </span><span id="local-6989586621679129294"><span class="annot"><span class="annottext">fpure :: forall (g :: * -&gt; *). Functor g =&gt; g ~&gt; ApT f g
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var hs-var hs-var hs-var">fpure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g x -&gt; ApT f g x
forall (g :: * -&gt; *) x (f :: * -&gt; *). g x -&gt; ApT f g x
</span><span class="hs-identifier hs-var">FreeApT.liftT</span></span><span>
</span><span id="line-396"></span><span>  </span><span id="local-6989586621679129302"><span class="annot"><span class="annottext">fbind :: forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; ApT f h) -&gt; ApT f g a -&gt; ApT f h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var hs-var hs-var hs-var">fbind</span></a></span></span><span> </span><span id="local-6989586621679129303"><span class="annot"><span class="annottext">g ~&gt; ApT f h
</span><a href="#local-6989586621679129303"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApT f (ApT f h) a -&gt; ApT f h a
forall (f :: * -&gt; *) (g :: * -&gt; *) x.
ApT f (ApT f g) x -&gt; ApT f g x
</span><span class="hs-identifier hs-var">FreeApT.fjoinApTLeft</span></span><span> </span><span class="annot"><span class="annottext">(ApT f (ApT f h) a -&gt; ApT f h a)
-&gt; (ApT f g a -&gt; ApT f (ApT f h) a) -&gt; ApT f g a -&gt; ApT f h a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(g ~&gt; ApT f h) -&gt; ApT f g a -&gt; ApT f (ApT f h) a
forall (g :: * -&gt; *) (h :: * -&gt; *) x.
(Functor g, Functor h) =&gt;
(g ~&gt; h) -&gt; ApT f g x -&gt; ApT f h x
forall (ff :: FF) (g :: * -&gt; *) (h :: * -&gt; *) x.
(FFunctor ff, Functor g, Functor h) =&gt;
(g ~&gt; h) -&gt; ff g x -&gt; ff h x
</span><a href="FFunctor.html#ffmap"><span class="hs-identifier hs-var">ffmap</span></a></span><span> </span><span class="annot"><span class="annottext">g x -&gt; ApT f h x
g ~&gt; ApT f h
</span><a href="#local-6989586621679129303"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679128723"><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679128723"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Flip1.html#Flip1"><span class="hs-identifier hs-type">Flip1</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FreeApT.ApT</span></span><span> </span><span class="annot"><a href="#local-6989586621679128723"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-399"></span><span>  </span><span id="local-6989586621679129315"><span class="annot"><span class="annottext">fpure :: forall (g :: * -&gt; *). Functor g =&gt; g ~&gt; Flip1 ApT g g
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var hs-var hs-var hs-var">fpure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApT g g x -&gt; Flip1 ApT g g x
forall k1 k2 k3 (t :: k1 -&gt; k2 -&gt; k3 -&gt; *) (a :: k2) (b :: k1)
       (c :: k3).
t b a c -&gt; Flip1 t a b c
</span><a href="Data.Functor.Flip1.html#Flip1"><span class="hs-identifier hs-var">Flip1</span></a></span><span> </span><span class="annot"><span class="annottext">(ApT g g x -&gt; Flip1 ApT g g x)
-&gt; (g x -&gt; ApT g g x) -&gt; g x -&gt; Flip1 ApT g g x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">g x -&gt; ApT g g x
forall (g :: * -&gt; *) (f :: * -&gt; *) x.
Applicative g =&gt;
f x -&gt; ApT f g x
</span><span class="hs-identifier hs-var">FreeApT.liftF</span></span><span>
</span><span id="line-400"></span><span>  </span><span id="local-6989586621679129322"><span class="annot"><span class="annottext">fbind :: forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; Flip1 ApT g h) -&gt; Flip1 ApT g g a -&gt; Flip1 ApT g h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var hs-var hs-var hs-var">fbind</span></a></span></span><span> </span><span id="local-6989586621679129323"><span class="annot"><span class="annottext">g ~&gt; Flip1 ApT g h
</span><a href="#local-6989586621679129323"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApT h g a -&gt; Flip1 ApT g h a
forall k1 k2 k3 (t :: k1 -&gt; k2 -&gt; k3 -&gt; *) (a :: k2) (b :: k1)
       (c :: k3).
t b a c -&gt; Flip1 t a b c
</span><a href="Data.Functor.Flip1.html#Flip1"><span class="hs-identifier hs-var">Flip1</span></a></span><span> </span><span class="annot"><span class="annottext">(ApT h g a -&gt; Flip1 ApT g h a)
-&gt; (Flip1 ApT g g a -&gt; ApT h g a)
-&gt; Flip1 ApT g g a
-&gt; Flip1 ApT g h a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(forall a. g a -&gt; ApT h g a)
-&gt; (forall a. g a -&gt; ApT h g a) -&gt; ApT g g a -&gt; ApT h g a
forall (f :: * -&gt; *) (g :: * -&gt; *) (h :: * -&gt; *) x.
Applicative h =&gt;
(forall a. f a -&gt; h a)
-&gt; (forall a. g a -&gt; h a) -&gt; ApT f g x -&gt; h x
</span><span class="hs-identifier hs-var">FreeApT.foldApT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Flip1 ApT g h a -&gt; ApT h g a
forall k1 k2 k3 (t :: k1 -&gt; k2 -&gt; k3 -&gt; *) (a :: k2) (b :: k1)
       (c :: k3).
Flip1 t a b c -&gt; t b a c
</span><a href="Data.Functor.Flip1.html#unFlip1"><span class="hs-identifier hs-var">unFlip1</span></a></span><span> </span><span class="annot"><span class="annottext">(Flip1 ApT g h a -&gt; ApT h g a)
-&gt; (g a -&gt; Flip1 ApT g h a) -&gt; g a -&gt; ApT h g a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">g a -&gt; Flip1 ApT g h a
g ~&gt; Flip1 ApT g h
</span><a href="#local-6989586621679129323"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g a -&gt; ApT h g a
forall a. g a -&gt; ApT h g a
forall (g :: * -&gt; *) x (f :: * -&gt; *). g x -&gt; ApT f g x
</span><span class="hs-identifier hs-var">FreeApT.liftT</span></span><span> </span><span class="annot"><span class="annottext">(ApT g g a -&gt; ApT h g a)
-&gt; (Flip1 ApT g g a -&gt; ApT g g a) -&gt; Flip1 ApT g g a -&gt; ApT h g a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Flip1 ApT g g a -&gt; ApT g g a
forall k1 k2 k3 (t :: k1 -&gt; k2 -&gt; k3 -&gt; *) (a :: k2) (b :: k1)
       (c :: k3).
Flip1 t a b c -&gt; t b a c
</span><a href="Data.Functor.Flip1.html#unFlip1"><span class="hs-identifier hs-var">unFlip1</span></a></span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679128758"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679128758"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FreeT</span></span><span> </span><span class="annot"><a href="#local-6989586621679128758"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-403"></span><span>  </span><span id="local-6989586621679129335"><span class="annot"><span class="annottext">fpure :: forall (g :: * -&gt; *). Functor g =&gt; g ~&gt; FreeT f g
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var hs-var hs-var hs-var">fpure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g x -&gt; FreeT f g x
g ~&gt; FreeT f g
forall (m :: * -&gt; *) (f :: * -&gt; *). Functor m =&gt; m ~&gt; FreeT f m
</span><a href="Control.Monad.Trans.Free.Extra.html#inr"><span class="hs-identifier hs-var">inr</span></a></span><span>
</span><span id="line-404"></span><span>  </span><span id="local-6989586621679129341"><span class="annot"><span class="annottext">fbind :: forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; FreeT f h) -&gt; FreeT f g a -&gt; FreeT f h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var hs-var hs-var hs-var">fbind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(g ~&gt; FreeT f h) -&gt; FreeT f g a -&gt; FreeT f h a
forall (f :: * -&gt; *) (m :: * -&gt; *) (n :: * -&gt; *) a.
(Functor f, Functor m, Functor n) =&gt;
(m ~&gt; FreeT f n) -&gt; FreeT f m a -&gt; FreeT f n a
</span><a href="Control.Monad.Trans.Free.Extra.html#fbindFreeT_"><span class="hs-identifier hs-var">fbindFreeT_</span></a></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679128775"><span id="local-6989586621679128776"><span class="hs-special">(</span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128775"><span class="hs-identifier hs-type">ff</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128776"><span class="hs-identifier hs-type">gg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="FMonad.html#FMonad"><span class="hs-identifier hs-type">FMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bi.Product</span></span><span> </span><span class="annot"><a href="#local-6989586621679128775"><span class="hs-identifier hs-type">ff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128776"><span class="hs-identifier hs-type">gg</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-407"></span><span>  </span><span id="local-6989586621679129357"><span class="annot"><span class="annottext">fpure :: forall (g :: * -&gt; *). Functor g =&gt; g ~&gt; Product ff gg g
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var hs-var hs-var hs-var">fpure</span></a></span></span><span> </span><span id="local-6989586621679129358"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679129358"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ff g x -&gt; gg g x -&gt; Product ff gg g x
forall {k} {k1} (f :: k -&gt; k1 -&gt; *) (g :: k -&gt; k1 -&gt; *) (a :: k)
       (b :: k1).
f a b -&gt; g a b -&gt; Product f g a b
</span><span class="hs-identifier hs-var">Bi.Pair</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g x -&gt; ff g x
g ~&gt; ff g
forall (g :: * -&gt; *). Functor g =&gt; g ~&gt; ff g
forall (ff :: FF) (g :: * -&gt; *).
(FMonad ff, Functor g) =&gt;
g ~&gt; ff g
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var">fpure</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679129358"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g x -&gt; gg g x
g ~&gt; gg g
forall (g :: * -&gt; *). Functor g =&gt; g ~&gt; gg g
forall (ff :: FF) (g :: * -&gt; *).
(FMonad ff, Functor g) =&gt;
g ~&gt; ff g
</span><a href="FMonad.html#fpure"><span class="hs-identifier hs-var">fpure</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679129358"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>  </span><span id="local-6989586621679129368"><span class="annot"><span class="annottext">fbind :: forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; Product ff gg h) -&gt; Product ff gg g a -&gt; Product ff gg h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var hs-var hs-var hs-var">fbind</span></a></span></span><span> </span><span id="local-6989586621679129369"><span class="annot"><span class="annottext">g ~&gt; Product ff gg h
</span><a href="#local-6989586621679129369"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bi.Pair</span></span><span> </span><span id="local-6989586621679129370"><span class="annot"><span class="annottext">ff g a
</span><a href="#local-6989586621679129370"><span class="hs-identifier hs-var">ff</span></a></span></span><span> </span><span id="local-6989586621679129371"><span class="annot"><span class="annottext">gg g a
</span><a href="#local-6989586621679129371"><span class="hs-identifier hs-var">gg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ff h a -&gt; gg h a -&gt; Product ff gg h a
forall {k} {k1} (f :: k -&gt; k1 -&gt; *) (g :: k -&gt; k1 -&gt; *) (a :: k)
       (b :: k1).
f a b -&gt; g a b -&gt; Product f g a b
</span><span class="hs-identifier hs-var">Bi.Pair</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(g ~&gt; ff h) -&gt; ff g a -&gt; ff h a
forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; ff h) -&gt; ff g a -&gt; ff h a
forall (ff :: FF) (g :: * -&gt; *) (h :: * -&gt; *) a.
(FMonad ff, Functor g, Functor h) =&gt;
(g ~&gt; ff h) -&gt; ff g a -&gt; ff h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var">fbind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Product ff gg h x -&gt; ff h x
forall {k} {k1} (p :: k -&gt; k1 -&gt; *) (q :: k -&gt; k1 -&gt; *) (a :: k)
       (b :: k1).
Product p q a b -&gt; p a b
</span><a href="Data.Bifunctor.Product.Extra.html#proj1"><span class="hs-identifier hs-var">Bi.proj1</span></a></span><span> </span><span class="annot"><span class="annottext">(Product ff gg h x -&gt; ff h x)
-&gt; (g x -&gt; Product ff gg h x) -&gt; g x -&gt; ff h x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">g x -&gt; Product ff gg h x
g ~&gt; Product ff gg h
</span><a href="#local-6989586621679129369"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ff g a
</span><a href="#local-6989586621679129370"><span class="hs-identifier hs-var">ff</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(g ~&gt; gg h) -&gt; gg g a -&gt; gg h a
forall (g :: * -&gt; *) (h :: * -&gt; *) a.
(Functor g, Functor h) =&gt;
(g ~&gt; gg h) -&gt; gg g a -&gt; gg h a
forall (ff :: FF) (g :: * -&gt; *) (h :: * -&gt; *) a.
(FMonad ff, Functor g, Functor h) =&gt;
(g ~&gt; ff h) -&gt; ff g a -&gt; ff h a
</span><a href="FMonad.html#fbind"><span class="hs-identifier hs-var">fbind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Product ff gg h x -&gt; gg h x
forall {k} {k1} (p :: k -&gt; k1 -&gt; *) (q :: k -&gt; k1 -&gt; *) (a :: k)
       (b :: k1).
Product p q a b -&gt; q a b
</span><a href="Data.Bifunctor.Product.Extra.html#proj2"><span class="hs-identifier hs-var">Bi.proj2</span></a></span><span> </span><span class="annot"><span class="annottext">(Product ff gg h x -&gt; gg h x)
-&gt; (g x -&gt; Product ff gg h x) -&gt; g x -&gt; gg h x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">g x -&gt; Product ff gg h x
g ~&gt; Product ff gg h
</span><a href="#local-6989586621679129369"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">gg g a
</span><a href="#local-6989586621679129371"><span class="hs-identifier hs-var">gg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span></pre></body></html>