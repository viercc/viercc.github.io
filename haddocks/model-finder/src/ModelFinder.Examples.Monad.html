<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DerivingVia #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE ImportQualifiedPost #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE DeriveFunctor #-}</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">ModelFinder.Examples.Monad</span><span class="hs-special">(</span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier">M</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier">I</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier">MonadSig</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator">(:-&gt;)</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#searchMonad"><span class="hs-identifier">searchMonad</span></a></span><span>
</span><span id="line-22"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">guard</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Constraint.Extras</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Dependent.Map</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DMap</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Dependent.Sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">DSum</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.GADT.Compare</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.GADT.Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">GShow</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Type.Equality</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html"><span class="hs-identifier">ModelFinder.Solver</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Finitary</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeNats</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">natVal</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Classes</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">showsUnaryWith</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Bifunctor</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="ModelFinder.Expr.html"><span class="hs-identifier">ModelFinder.Expr</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">data</span><span> </span><span id="I"><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-var">I</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="I0"><span class="annot"><a href="ModelFinder.Examples.Monad.html#I0"><span class="hs-identifier hs-var">I0</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="I1"><span class="annot"><a href="ModelFinder.Examples.Monad.html#I1"><span class="hs-identifier hs-var">I1</span></a></span></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679139562"><span id="local-6989586621679139564"><span id="local-6989586621679139567"><span class="annot"><span class="annottext">Int -&gt; I -&gt; ShowS
[I] -&gt; ShowS
I -&gt; String
(Int -&gt; I -&gt; ShowS) -&gt; (I -&gt; String) -&gt; ([I] -&gt; ShowS) -&gt; Show I
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; I -&gt; ShowS
showsPrec :: Int -&gt; I -&gt; ShowS
$cshow :: I -&gt; String
show :: I -&gt; String
$cshowList :: [I] -&gt; ShowS
showList :: [I] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679139571"><span id="local-6989586621679139573"><span class="annot"><span class="annottext">I -&gt; I -&gt; Bool
(I -&gt; I -&gt; Bool) -&gt; (I -&gt; I -&gt; Bool) -&gt; Eq I
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: I -&gt; I -&gt; Bool
== :: I -&gt; I -&gt; Bool
$c/= :: I -&gt; I -&gt; Bool
/= :: I -&gt; I -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679139579"><span id="local-6989586621679139581"><span id="local-6989586621679139583"><span id="local-6989586621679139586"><span id="local-6989586621679139589"><span id="local-6989586621679139592"><span id="local-6989586621679139595"><span class="annot"><span class="annottext">Eq I
Eq I =&gt;
(I -&gt; I -&gt; Ordering)
-&gt; (I -&gt; I -&gt; Bool)
-&gt; (I -&gt; I -&gt; Bool)
-&gt; (I -&gt; I -&gt; Bool)
-&gt; (I -&gt; I -&gt; Bool)
-&gt; (I -&gt; I -&gt; I)
-&gt; (I -&gt; I -&gt; I)
-&gt; Ord I
I -&gt; I -&gt; Bool
I -&gt; I -&gt; Ordering
I -&gt; I -&gt; I
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: I -&gt; I -&gt; Ordering
compare :: I -&gt; I -&gt; Ordering
$c&lt; :: I -&gt; I -&gt; Bool
&lt; :: I -&gt; I -&gt; Bool
$c&lt;= :: I -&gt; I -&gt; Bool
&lt;= :: I -&gt; I -&gt; Bool
$c&gt; :: I -&gt; I -&gt; Bool
&gt; :: I -&gt; I -&gt; Bool
$c&gt;= :: I -&gt; I -&gt; Bool
&gt;= :: I -&gt; I -&gt; Bool
$cmax :: I -&gt; I -&gt; I
max :: I -&gt; I -&gt; I
$cmin :: I -&gt; I -&gt; I
min :: I -&gt; I -&gt; I
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679139599"><span id="local-6989586621679139601"><span class="annot"><span class="annottext">(forall x. I -&gt; Rep I x) -&gt; (forall x. Rep I x -&gt; I) -&gt; Generic I
forall x. Rep I x -&gt; I
forall x. I -&gt; Rep I x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. I -&gt; Rep I x
from :: forall x. I -&gt; Rep I x
$cto :: forall x. Rep I x -&gt; I
to :: forall x. Rep I x -&gt; I
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span id="local-6989586621679139610"><span id="local-6989586621679139618"><span id="local-6989586621679139626"><span id="local-6989586621679139632"><span id="local-6989586621679139638"><span id="local-6989586621679139641"><span class="annot"><span class="annottext">Eq I
KnownNat (Cardinality I)
(Eq I, KnownNat (Cardinality I)) =&gt;
(Finite (Cardinality I) -&gt; I)
-&gt; (I -&gt; Finite (Cardinality I))
-&gt; ((1 &lt;= Cardinality I) =&gt; I)
-&gt; ((1 &lt;= Cardinality I) =&gt; I)
-&gt; (I -&gt; Maybe I)
-&gt; (I -&gt; Maybe I)
-&gt; Finitary I
(1 &lt;= Cardinality I) =&gt; I
Finite (Cardinality I) -&gt; I
I -&gt; Maybe I
I -&gt; Finite (Cardinality I)
forall a.
(Eq a, KnownNat (Cardinality a)) =&gt;
(Finite (Cardinality a) -&gt; a)
-&gt; (a -&gt; Finite (Cardinality a))
-&gt; ((1 &lt;= Cardinality a) =&gt; a)
-&gt; ((1 &lt;= Cardinality a) =&gt; a)
-&gt; (a -&gt; Maybe a)
-&gt; (a -&gt; Maybe a)
-&gt; Finitary a
$cfromFinite :: Finite (Cardinality I) -&gt; I
fromFinite :: Finite (Cardinality I) -&gt; I
$ctoFinite :: I -&gt; Finite (Cardinality I)
toFinite :: I -&gt; Finite (Cardinality I)
$cstart :: (1 &lt;= Cardinality I) =&gt; I
start :: (1 &lt;= Cardinality I) =&gt; I
$cend :: (1 &lt;= Cardinality I) =&gt; I
end :: (1 &lt;= Cardinality I) =&gt; I
$cprevious :: I -&gt; Maybe I
previous :: I -&gt; Maybe I
$cnext :: I -&gt; Maybe I
next :: I -&gt; Maybe I
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Finitary</span></span></span></span></span></span></span></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">data</span><span> </span><span id="M"><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-var">M</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="M0"><span class="annot"><a href="ModelFinder.Examples.Monad.html#M0"><span class="hs-identifier hs-var">M0</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="M1"><span class="annot"><a href="ModelFinder.Examples.Monad.html#M1"><span class="hs-identifier hs-var">M1</span></a></span></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679139658"><span id="local-6989586621679139660"><span id="local-6989586621679139663"><span class="annot"><span class="annottext">Int -&gt; M -&gt; ShowS
[M] -&gt; ShowS
M -&gt; String
(Int -&gt; M -&gt; ShowS) -&gt; (M -&gt; String) -&gt; ([M] -&gt; ShowS) -&gt; Show M
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; M -&gt; ShowS
showsPrec :: Int -&gt; M -&gt; ShowS
$cshow :: M -&gt; String
show :: M -&gt; String
$cshowList :: [M] -&gt; ShowS
showList :: [M] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679139666"><span id="local-6989586621679139668"><span class="annot"><span class="annottext">M -&gt; M -&gt; Bool
(M -&gt; M -&gt; Bool) -&gt; (M -&gt; M -&gt; Bool) -&gt; Eq M
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: M -&gt; M -&gt; Bool
== :: M -&gt; M -&gt; Bool
$c/= :: M -&gt; M -&gt; Bool
/= :: M -&gt; M -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679139673"><span id="local-6989586621679139675"><span id="local-6989586621679139677"><span id="local-6989586621679139680"><span id="local-6989586621679139683"><span id="local-6989586621679139686"><span id="local-6989586621679139689"><span class="annot"><span class="annottext">Eq M
Eq M =&gt;
(M -&gt; M -&gt; Ordering)
-&gt; (M -&gt; M -&gt; Bool)
-&gt; (M -&gt; M -&gt; Bool)
-&gt; (M -&gt; M -&gt; Bool)
-&gt; (M -&gt; M -&gt; Bool)
-&gt; (M -&gt; M -&gt; M)
-&gt; (M -&gt; M -&gt; M)
-&gt; Ord M
M -&gt; M -&gt; Bool
M -&gt; M -&gt; Ordering
M -&gt; M -&gt; M
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: M -&gt; M -&gt; Ordering
compare :: M -&gt; M -&gt; Ordering
$c&lt; :: M -&gt; M -&gt; Bool
&lt; :: M -&gt; M -&gt; Bool
$c&lt;= :: M -&gt; M -&gt; Bool
&lt;= :: M -&gt; M -&gt; Bool
$c&gt; :: M -&gt; M -&gt; Bool
&gt; :: M -&gt; M -&gt; Bool
$c&gt;= :: M -&gt; M -&gt; Bool
&gt;= :: M -&gt; M -&gt; Bool
$cmax :: M -&gt; M -&gt; M
max :: M -&gt; M -&gt; M
$cmin :: M -&gt; M -&gt; M
min :: M -&gt; M -&gt; M
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679139692"><span id="local-6989586621679139694"><span class="annot"><span class="annottext">(forall x. M -&gt; Rep M x) -&gt; (forall x. Rep M x -&gt; M) -&gt; Generic M
forall x. Rep M x -&gt; M
forall x. M -&gt; Rep M x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. M -&gt; Rep M x
from :: forall x. M -&gt; Rep M x
$cto :: forall x. Rep M x -&gt; M
to :: forall x. Rep M x -&gt; M
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span id="local-6989586621679139702"><span id="local-6989586621679139711"><span id="local-6989586621679139719"><span id="local-6989586621679139725"><span id="local-6989586621679139731"><span id="local-6989586621679139734"><span class="annot"><span class="annottext">Eq M
KnownNat (Cardinality M)
(Eq M, KnownNat (Cardinality M)) =&gt;
(Finite (Cardinality M) -&gt; M)
-&gt; (M -&gt; Finite (Cardinality M))
-&gt; ((1 &lt;= Cardinality M) =&gt; M)
-&gt; ((1 &lt;= Cardinality M) =&gt; M)
-&gt; (M -&gt; Maybe M)
-&gt; (M -&gt; Maybe M)
-&gt; Finitary M
(1 &lt;= Cardinality M) =&gt; M
Finite (Cardinality M) -&gt; M
M -&gt; Maybe M
M -&gt; Finite (Cardinality M)
forall a.
(Eq a, KnownNat (Cardinality a)) =&gt;
(Finite (Cardinality a) -&gt; a)
-&gt; (a -&gt; Finite (Cardinality a))
-&gt; ((1 &lt;= Cardinality a) =&gt; a)
-&gt; ((1 &lt;= Cardinality a) =&gt; a)
-&gt; (a -&gt; Maybe a)
-&gt; (a -&gt; Maybe a)
-&gt; Finitary a
$cfromFinite :: Finite (Cardinality M) -&gt; M
fromFinite :: Finite (Cardinality M) -&gt; M
$ctoFinite :: M -&gt; Finite (Cardinality M)
toFinite :: M -&gt; Finite (Cardinality M)
$cstart :: (1 &lt;= Cardinality M) =&gt; M
start :: (1 &lt;= Cardinality M) =&gt; M
$cend :: (1 &lt;= Cardinality M) =&gt; M
end :: (1 &lt;= Cardinality M) =&gt; M
$cprevious :: M -&gt; Maybe M
previous :: M -&gt; Maybe M
$cnext :: M -&gt; Maybe M
next :: M -&gt; Maybe M
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Finitary</span></span></span></span></span></span></span></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="annot"><span class="hs-comment">{- | Signature of data describing Monad on @T a = (M, I -&gt; a)@

Let @T a@ be a functor of the following shape.

&gt; type T a = (M, I -&gt; a)

Any Monad on type can be written as follows:

&gt; pure :: a -&gt; T a
&gt; pure a = (unit, const a)
&gt; 
&gt; join :: T (T a) -&gt; T a
&gt; join (m, f) = (munge m v, \i -&gt; v (index1 m v i) (index2 m v i))
&gt;   where v = fst . f
&gt;         h = snd . f

using these unknown values and functions.

&gt; unit :: M
&gt; munge :: M -&gt; (I -&gt; M) -&gt; M
&gt; index1 :: M -&gt; (I -&gt; M) -&gt; I -&gt; I
&gt; index2 :: M -&gt; (I -&gt; M) -&gt; I -&gt; I

By translating the Monad laws written in terms of @(pure, join)@ to
that of @(unit, munge, index1, index2)@, we can make equational theory
of Monads on T.

@MonadSig@ is the signature of terms, and equations are implemented afterwards.

-}</span></span><span>
</span><span id="line-80"></span><span class="hs-keyword">data</span><span> </span><span id="MonadSig"><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-var">MonadSig</span></a></span></span><span> </span><span id="local-6989586621679139744"><span class="annot"><a href="#local-6989586621679139744"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-81"></span><span>  </span><span id="Unit"><span class="annot"><a href="ModelFinder.Examples.Monad.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span>
</span><span id="line-82"></span><span>  </span><span id="Munge"><span class="annot"><a href="ModelFinder.Examples.Monad.html#Munge"><span class="hs-identifier hs-var">Munge</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span>
</span><span id="line-83"></span><span>  </span><span id="Index1"><span class="annot"><a href="ModelFinder.Examples.Monad.html#Index1"><span class="hs-identifier hs-var">Index1</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span>
</span><span id="line-84"></span><span>  </span><span id="Index2"><span class="annot"><a href="ModelFinder.Examples.Monad.html#Index2"><span class="hs-identifier hs-var">Index2</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="annot"><span class="hs-comment">-- * Monad Laws in terms of @MonadSig@</span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-keyword">type</span><span> </span><span id="Prop"><span class="annot"><a href="ModelFinder.Examples.Monad.html#Prop"><span class="hs-identifier hs-var">Prop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="ModelFinder.Expr.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="annot"><a href="ModelFinder.Examples.Monad.html#unit"><span class="hs-keyword hs-type">unit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span>
</span><span id="line-91"></span><span id="unit"><span class="annot"><span class="annottext">unit :: Expr MonadSig M
</span><a href="ModelFinder.Examples.Monad.html#unit"><span class="hs-keyword hs-var hs-var">unit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MonadSig M -&gt; Expr MonadSig M
forall (f :: * -&gt; *) x. f x -&gt; Expr f x
</span><a href="ModelFinder.Expr.html#call"><span class="hs-identifier hs-var">call</span></a></span><span> </span><span class="annot"><span class="annottext">MonadSig M
</span><a href="ModelFinder.Examples.Monad.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="annot"><a href="ModelFinder.Examples.Monad.html#munge"><span class="hs-identifier hs-type">munge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span>
</span><span id="line-94"></span><span id="munge"><span class="annot"><span class="annottext">munge :: Expr MonadSig M -&gt; Expr MonadSig (I :-&gt; M) -&gt; Expr MonadSig M
</span><a href="ModelFinder.Examples.Monad.html#munge"><span class="hs-identifier hs-var hs-var">munge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(M -&gt; (I :-&gt; M) -&gt; MonadSig M)
-&gt; Expr MonadSig M -&gt; Expr MonadSig (I :-&gt; M) -&gt; Expr MonadSig M
forall x1 x2 (f :: * -&gt; *) y.
(x1 -&gt; x2 -&gt; f y) -&gt; Expr f x1 -&gt; Expr f x2 -&gt; Expr f y
</span><a href="ModelFinder.Expr.html#lift2"><span class="hs-identifier hs-var">lift2</span></a></span><span> </span><span class="annot"><span class="annottext">M -&gt; (I :-&gt; M) -&gt; MonadSig M
</span><a href="ModelFinder.Examples.Monad.html#Munge"><span class="hs-identifier hs-var">Munge</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="annot"><a href="ModelFinder.Examples.Monad.html#index1"><span class="hs-identifier hs-type">index1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#index2"><span class="hs-identifier hs-type">index2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span>
</span><span id="line-97"></span><span id="index1"><span class="annot"><span class="annottext">index1 :: Expr MonadSig M
-&gt; Expr MonadSig (I :-&gt; M) -&gt; Expr MonadSig I -&gt; Expr MonadSig I
</span><a href="ModelFinder.Examples.Monad.html#index1"><span class="hs-identifier hs-var hs-var">index1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(M -&gt; (I :-&gt; M) -&gt; I -&gt; MonadSig I)
-&gt; Expr MonadSig M
-&gt; Expr MonadSig (I :-&gt; M)
-&gt; Expr MonadSig I
-&gt; Expr MonadSig I
forall x1 x2 x3 (f :: * -&gt; *) y.
(x1 -&gt; x2 -&gt; x3 -&gt; f y)
-&gt; Expr f x1 -&gt; Expr f x2 -&gt; Expr f x3 -&gt; Expr f y
</span><a href="ModelFinder.Expr.html#lift3"><span class="hs-identifier hs-var">lift3</span></a></span><span> </span><span class="annot"><span class="annottext">M -&gt; (I :-&gt; M) -&gt; I -&gt; MonadSig I
</span><a href="ModelFinder.Examples.Monad.html#Index1"><span class="hs-identifier hs-var">Index1</span></a></span><span>
</span><span id="line-98"></span><span id="index2"><span class="annot"><span class="annottext">index2 :: Expr MonadSig M
-&gt; Expr MonadSig (I :-&gt; M) -&gt; Expr MonadSig I -&gt; Expr MonadSig I
</span><a href="ModelFinder.Examples.Monad.html#index2"><span class="hs-identifier hs-var hs-var">index2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(M -&gt; (I :-&gt; M) -&gt; I -&gt; MonadSig I)
-&gt; Expr MonadSig M
-&gt; Expr MonadSig (I :-&gt; M)
-&gt; Expr MonadSig I
-&gt; Expr MonadSig I
forall x1 x2 x3 (f :: * -&gt; *) y.
(x1 -&gt; x2 -&gt; x3 -&gt; f y)
-&gt; Expr f x1 -&gt; Expr f x2 -&gt; Expr f x3 -&gt; Expr f y
</span><a href="ModelFinder.Expr.html#lift3"><span class="hs-identifier hs-var">lift3</span></a></span><span> </span><span class="annot"><span class="annottext">M -&gt; (I :-&gt; M) -&gt; I -&gt; MonadSig I
</span><a href="ModelFinder.Examples.Monad.html#Index2"><span class="hs-identifier hs-var">Index2</span></a></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="annot"><a href="ModelFinder.Examples.Monad.html#constFn"><span class="hs-identifier hs-type">constFn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span id="constFn"><span class="annot"><span class="annottext">constFn :: Expr MonadSig M -&gt; Expr MonadSig (I :-&gt; M)
</span><a href="ModelFinder.Examples.Monad.html#constFn"><span class="hs-identifier hs-var hs-var">constFn</span></a></span></span><span> </span><span id="local-6989586621679139757"><span class="annot"><span class="annottext">Expr MonadSig M
</span><a href="#local-6989586621679139757"><span class="hs-identifier hs-var">em</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(I -&gt; M) -&gt; I :-&gt; M
forall a b. (a -&gt; b) -&gt; a :-&gt; b
</span><a href="ModelFinder.Examples.Monad.html#Fn"><span class="hs-identifier hs-var">Fn</span></a></span><span> </span><span class="annot"><span class="annottext">((I -&gt; M) -&gt; I :-&gt; M) -&gt; (M -&gt; I -&gt; M) -&gt; M -&gt; I :-&gt; M
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">M -&gt; I -&gt; M
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(M -&gt; I :-&gt; M) -&gt; Expr MonadSig M -&gt; Expr MonadSig (I :-&gt; M)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr MonadSig M
</span><a href="#local-6989586621679139757"><span class="hs-identifier hs-var">em</span></a></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span id="local-6989586621679139220"><span class="annot"><a href="ModelFinder.Examples.Monad.html#fn"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139220"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139220"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-104"></span><span id="fn"><span class="annot"><span class="annottext">fn :: forall a. (I -&gt; Expr MonadSig a) -&gt; Expr MonadSig (I :-&gt; a)
</span><a href="ModelFinder.Examples.Monad.html#fn"><span class="hs-identifier hs-var hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679139767"><span class="annot"><span class="annottext">I -&gt; Expr MonadSig a
</span><a href="#local-6989586621679139767"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(I :-&gt; Expr MonadSig a) -&gt; Expr MonadSig (I :-&gt; a)
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable t, Applicative f) =&gt;
t (f a) -&gt; f (t a)
forall (f :: * -&gt; *) a. Applicative f =&gt; (I :-&gt; f a) -&gt; f (I :-&gt; a)
</span><span class="hs-identifier hs-var">sequenceA</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(I -&gt; Expr MonadSig a) -&gt; I :-&gt; Expr MonadSig a
forall a b. (a -&gt; b) -&gt; a :-&gt; b
</span><a href="ModelFinder.Examples.Monad.html#Fn"><span class="hs-identifier hs-var">Fn</span></a></span><span> </span><span class="annot"><span class="annottext">I -&gt; Expr MonadSig a
</span><a href="#local-6989586621679139767"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="annot"><a href="ModelFinder.Examples.Monad.html#monadLaw1"><span class="hs-identifier hs-type">monadLaw1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span>
</span><span id="line-107"></span><span id="monadLaw1"><span class="annot"><span class="annottext">monadLaw1 :: M -&gt; Prop
</span><a href="ModelFinder.Examples.Monad.html#monadLaw1"><span class="hs-identifier hs-var hs-var">monadLaw1</span></a></span></span><span> </span><span id="local-6989586621679139770"><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139770"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig M -&gt; Expr MonadSig (I :-&gt; M) -&gt; Expr MonadSig M
</span><a href="ModelFinder.Examples.Monad.html#munge"><span class="hs-identifier hs-var">munge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">M -&gt; Expr MonadSig M
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139770"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr MonadSig M -&gt; Expr MonadSig (I :-&gt; M)
</span><a href="ModelFinder.Examples.Monad.html#constFn"><span class="hs-identifier hs-var">constFn</span></a></span><span> </span><span class="annot"><span class="annottext">Expr MonadSig M
</span><a href="ModelFinder.Examples.Monad.html#unit"><span class="hs-keyword hs-var">unit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig M -&gt; M -&gt; Prop
forall x (f :: * -&gt; *). Eq x =&gt; Expr f x -&gt; x -&gt; Property f
</span><a href="ModelFinder.Expr.html#evaluatesTo"><span class="hs-operator hs-var">`evaluatesTo`</span></a></span><span> </span><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139770"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="annot"><a href="ModelFinder.Examples.Monad.html#monadLaw2"><span class="hs-identifier hs-type">monadLaw2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span>
</span><span id="line-110"></span><span id="monadLaw2"><span class="annot"><span class="annottext">monadLaw2 :: M -&gt; Prop
</span><a href="ModelFinder.Examples.Monad.html#monadLaw2"><span class="hs-identifier hs-var hs-var">monadLaw2</span></a></span></span><span> </span><span id="local-6989586621679139773"><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139773"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig M -&gt; Expr MonadSig (I :-&gt; M) -&gt; Expr MonadSig M
</span><a href="ModelFinder.Examples.Monad.html#munge"><span class="hs-identifier hs-var">munge</span></a></span><span> </span><span class="annot"><span class="annottext">Expr MonadSig M
</span><a href="ModelFinder.Examples.Monad.html#unit"><span class="hs-keyword hs-var">unit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr MonadSig M -&gt; Expr MonadSig (I :-&gt; M)
</span><a href="ModelFinder.Examples.Monad.html#constFn"><span class="hs-identifier hs-var">constFn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">M -&gt; Expr MonadSig M
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139773"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig M -&gt; M -&gt; Prop
forall x (f :: * -&gt; *). Eq x =&gt; Expr f x -&gt; x -&gt; Property f
</span><a href="ModelFinder.Expr.html#evaluatesTo"><span class="hs-operator hs-var">`evaluatesTo`</span></a></span><span> </span><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139773"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="annot"><a href="ModelFinder.Examples.Monad.html#monadLaw3"><span class="hs-identifier hs-type">monadLaw3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span>
</span><span id="line-113"></span><span id="monadLaw3"><span class="annot"><span class="annottext">monadLaw3 :: M -&gt; (I :-&gt; M) -&gt; ((I, I) :-&gt; M) -&gt; Prop
</span><a href="ModelFinder.Examples.Monad.html#monadLaw3"><span class="hs-identifier hs-var hs-var">monadLaw3</span></a></span></span><span> </span><span id="local-6989586621679139775"><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139775"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679139776"><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139776"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679139777"><span class="annot"><span class="annottext">(I, I) :-&gt; M
</span><a href="#local-6989586621679139777"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679139778"><span class="annot"><span class="annottext">w' :: Expr MonadSig (I :-&gt; M)
</span><a href="#local-6989586621679139778"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((I, I) -&gt; M) -&gt; (I :-&gt; (I, I)) -&gt; I :-&gt; M
forall a b. (a -&gt; b) -&gt; (I :-&gt; a) -&gt; I :-&gt; b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(I, I) :-&gt; M
</span><a href="#local-6989586621679139777"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">((I, I) :-&gt; M) -&gt; (I, I) -&gt; M
forall a b. (a :-&gt; b) -&gt; a -&gt; b
</span><a href="ModelFinder.Examples.Monad.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((I :-&gt; (I, I)) -&gt; I :-&gt; M)
-&gt; Expr MonadSig (I :-&gt; (I, I)) -&gt; Expr MonadSig (I :-&gt; M)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">M -&gt; (I :-&gt; M) -&gt; Expr MonadSig (I :-&gt; (I, I))
</span><a href="ModelFinder.Examples.Monad.html#indexBoth"><span class="hs-identifier hs-var">indexBoth</span></a></span><span> </span><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139775"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139776"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig M -&gt; Expr MonadSig (I :-&gt; M) -&gt; Expr MonadSig M
</span><a href="ModelFinder.Examples.Monad.html#munge"><span class="hs-identifier hs-var">munge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr MonadSig M -&gt; Expr MonadSig (I :-&gt; M) -&gt; Expr MonadSig M
</span><a href="ModelFinder.Examples.Monad.html#munge"><span class="hs-identifier hs-var">munge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">M -&gt; Expr MonadSig M
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139775"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(I :-&gt; M) -&gt; Expr MonadSig (I :-&gt; M)
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139776"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig (I :-&gt; M)
</span><a href="#local-6989586621679139778"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr MonadSig M -&gt; Expr MonadSig M -&gt; Prop
forall x (f :: * -&gt; *). Eq x =&gt; Expr f x -&gt; Expr f x -&gt; Property f
</span><a href="ModelFinder.Expr.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">Expr MonadSig M -&gt; Expr MonadSig (I :-&gt; M) -&gt; Expr MonadSig M
</span><a href="ModelFinder.Examples.Monad.html#munge"><span class="hs-identifier hs-var">munge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">M -&gt; Expr MonadSig M
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139775"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(I :-&gt; M) -&gt; ((I, I) :-&gt; M) -&gt; Expr MonadSig (I :-&gt; M)
</span><a href="ModelFinder.Examples.Monad.html#mungeInner"><span class="hs-identifier hs-var">mungeInner</span></a></span><span> </span><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139776"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(I, I) :-&gt; M
</span><a href="#local-6989586621679139777"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="annot"><a href="ModelFinder.Examples.Monad.html#monadLaw4"><span class="hs-identifier hs-type">monadLaw4</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span>
</span><span id="line-118"></span><span id="monadLaw4"><span class="annot"><span class="annottext">monadLaw4 :: M -&gt; I -&gt; Prop
</span><a href="ModelFinder.Examples.Monad.html#monadLaw4"><span class="hs-identifier hs-var hs-var">monadLaw4</span></a></span></span><span> </span><span id="local-6989586621679139784"><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139784"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679139785"><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139785"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig M
-&gt; Expr MonadSig (I :-&gt; M) -&gt; Expr MonadSig I -&gt; Expr MonadSig I
</span><a href="ModelFinder.Examples.Monad.html#index1"><span class="hs-identifier hs-var">index1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">M -&gt; Expr MonadSig M
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139784"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr MonadSig M -&gt; Expr MonadSig (I :-&gt; M)
</span><a href="ModelFinder.Examples.Monad.html#constFn"><span class="hs-identifier hs-var">constFn</span></a></span><span> </span><span class="annot"><span class="annottext">Expr MonadSig M
</span><a href="ModelFinder.Examples.Monad.html#unit"><span class="hs-keyword hs-var">unit</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">I -&gt; Expr MonadSig I
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139785"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig I -&gt; I -&gt; Prop
forall x (f :: * -&gt; *). Eq x =&gt; Expr f x -&gt; x -&gt; Property f
</span><a href="ModelFinder.Expr.html#evaluatesTo"><span class="hs-operator hs-var">`evaluatesTo`</span></a></span><span> </span><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139785"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="annot"><a href="ModelFinder.Examples.Monad.html#monadLaw5"><span class="hs-identifier hs-type">monadLaw5</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span>
</span><span id="line-121"></span><span id="monadLaw5"><span class="annot"><span class="annottext">monadLaw5 :: M -&gt; I -&gt; Prop
</span><a href="ModelFinder.Examples.Monad.html#monadLaw5"><span class="hs-identifier hs-var hs-var">monadLaw5</span></a></span></span><span> </span><span id="local-6989586621679139787"><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139787"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679139788"><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139788"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig M
-&gt; Expr MonadSig (I :-&gt; M) -&gt; Expr MonadSig I -&gt; Expr MonadSig I
</span><a href="ModelFinder.Examples.Monad.html#index2"><span class="hs-identifier hs-var">index2</span></a></span><span> </span><span class="annot"><span class="annottext">Expr MonadSig M
</span><a href="ModelFinder.Examples.Monad.html#unit"><span class="hs-keyword hs-var">unit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr MonadSig M -&gt; Expr MonadSig (I :-&gt; M)
</span><a href="ModelFinder.Examples.Monad.html#constFn"><span class="hs-identifier hs-var">constFn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">M -&gt; Expr MonadSig M
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139787"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">I -&gt; Expr MonadSig I
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139788"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig I -&gt; I -&gt; Prop
forall x (f :: * -&gt; *). Eq x =&gt; Expr f x -&gt; x -&gt; Property f
</span><a href="ModelFinder.Expr.html#evaluatesTo"><span class="hs-operator hs-var">`evaluatesTo`</span></a></span><span> </span><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139788"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="annot"><a href="ModelFinder.Examples.Monad.html#monadLaw678"><span class="hs-identifier hs-type">monadLaw678</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span class="hs-special">,</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span id="monadLaw678"><span class="annot"><span class="annottext">monadLaw678 :: M -&gt; (I :-&gt; M) -&gt; ((I, I) :-&gt; M) -&gt; I -&gt; (Prop, Prop, Prop)
</span><a href="ModelFinder.Examples.Monad.html#monadLaw678"><span class="hs-identifier hs-var hs-var">monadLaw678</span></a></span></span><span> </span><span id="local-6989586621679139790"><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139790"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679139791"><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139791"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679139792"><span class="annot"><span class="annottext">(I, I) :-&gt; M
</span><a href="#local-6989586621679139792"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679139793"><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139793"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679139794"><span class="hs-identifier hs-var">law6</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679139795"><span class="hs-identifier hs-var">law7</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679139796"><span class="hs-identifier hs-var">law8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>    </span><span id="local-6989586621679139797"><span class="annot"><span class="annottext">u :: Expr MonadSig (I :-&gt; M)
</span><a href="#local-6989586621679139797"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(I :-&gt; M) -&gt; ((I, I) :-&gt; M) -&gt; Expr MonadSig (I :-&gt; M)
</span><a href="ModelFinder.Examples.Monad.html#mungeInner"><span class="hs-identifier hs-var">mungeInner</span></a></span><span> </span><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139791"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(I, I) :-&gt; M
</span><a href="#local-6989586621679139792"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span id="local-6989586621679139798"><span class="annot"><span class="annottext">w' :: Expr MonadSig (I :-&gt; M)
</span><a href="#local-6989586621679139798"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((I, I) -&gt; M) -&gt; (I :-&gt; (I, I)) -&gt; I :-&gt; M
forall a b. (a -&gt; b) -&gt; (I :-&gt; a) -&gt; I :-&gt; b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(I, I) :-&gt; M
</span><a href="#local-6989586621679139792"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">((I, I) :-&gt; M) -&gt; (I, I) -&gt; M
forall a b. (a :-&gt; b) -&gt; a -&gt; b
</span><a href="ModelFinder.Examples.Monad.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((I :-&gt; (I, I)) -&gt; I :-&gt; M)
-&gt; Expr MonadSig (I :-&gt; (I, I)) -&gt; Expr MonadSig (I :-&gt; M)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">M -&gt; (I :-&gt; M) -&gt; Expr MonadSig (I :-&gt; (I, I))
</span><a href="ModelFinder.Examples.Monad.html#indexBoth"><span class="hs-identifier hs-var">indexBoth</span></a></span><span> </span><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139790"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139791"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span id="local-6989586621679139799"><span class="annot"><span class="annottext">vw :: I -&gt; (M, I :-&gt; M)
</span><a href="#local-6989586621679139799"><span class="hs-identifier hs-var hs-var">vw</span></a></span></span><span> </span><span id="local-6989586621679139800"><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139800"><span class="hs-identifier hs-var">i'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139791"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(I :-&gt; M) -&gt; I -&gt; M
forall a b. (a :-&gt; b) -&gt; a -&gt; b
</span><a href="ModelFinder.Examples.Monad.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139800"><span class="hs-identifier hs-var">i'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(I -&gt; M) -&gt; I :-&gt; M
forall a b. (a -&gt; b) -&gt; a :-&gt; b
</span><a href="ModelFinder.Examples.Monad.html#Fn"><span class="hs-identifier hs-var">Fn</span></a></span><span> </span><span class="annot"><span class="annottext">((I -&gt; M) -&gt; I :-&gt; M) -&gt; (I -&gt; M) -&gt; I :-&gt; M
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679139801"><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139801"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(I, I) :-&gt; M
</span><a href="#local-6989586621679139792"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">((I, I) :-&gt; M) -&gt; (I, I) -&gt; M
forall a b. (a :-&gt; b) -&gt; a -&gt; b
</span><a href="ModelFinder.Examples.Monad.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139800"><span class="hs-identifier hs-var">i'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139801"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span>    </span><span id="local-6989586621679139802"><span class="annot"><span class="annottext">i1 :: Expr MonadSig I
</span><a href="#local-6989586621679139802"><span class="hs-identifier hs-var hs-var">i1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig M
-&gt; Expr MonadSig (I :-&gt; M) -&gt; Expr MonadSig I -&gt; Expr MonadSig I
</span><a href="ModelFinder.Examples.Monad.html#index1"><span class="hs-identifier hs-var">index1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr MonadSig M -&gt; Expr MonadSig (I :-&gt; M) -&gt; Expr MonadSig M
</span><a href="ModelFinder.Examples.Monad.html#munge"><span class="hs-identifier hs-var">munge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">M -&gt; Expr MonadSig M
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139790"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(I :-&gt; M) -&gt; Expr MonadSig (I :-&gt; M)
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139791"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig (I :-&gt; M)
</span><a href="#local-6989586621679139798"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">I -&gt; Expr MonadSig I
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139793"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>    </span><span id="local-6989586621679139803"><span class="annot"><span class="annottext">i2 :: Expr MonadSig I
</span><a href="#local-6989586621679139803"><span class="hs-identifier hs-var hs-var">i2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig M
-&gt; Expr MonadSig (I :-&gt; M) -&gt; Expr MonadSig I -&gt; Expr MonadSig I
</span><a href="ModelFinder.Examples.Monad.html#index2"><span class="hs-identifier hs-var">index2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr MonadSig M -&gt; Expr MonadSig (I :-&gt; M) -&gt; Expr MonadSig M
</span><a href="ModelFinder.Examples.Monad.html#munge"><span class="hs-identifier hs-var">munge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">M -&gt; Expr MonadSig M
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139790"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(I :-&gt; M) -&gt; Expr MonadSig (I :-&gt; M)
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139791"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig (I :-&gt; M)
</span><a href="#local-6989586621679139798"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">I -&gt; Expr MonadSig I
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139793"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>    </span><span>
</span><span id="line-133"></span><span>    </span><span id="local-6989586621679139804"><span class="annot"><span class="annottext">i1' :: Expr MonadSig I
</span><a href="#local-6989586621679139804"><span class="hs-identifier hs-var hs-var">i1'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig M
-&gt; Expr MonadSig (I :-&gt; M) -&gt; Expr MonadSig I -&gt; Expr MonadSig I
</span><a href="ModelFinder.Examples.Monad.html#index1"><span class="hs-identifier hs-var">index1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">M -&gt; Expr MonadSig M
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139790"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig (I :-&gt; M)
</span><a href="#local-6989586621679139797"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">I -&gt; Expr MonadSig I
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139793"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>    </span><span id="local-6989586621679139805"><span class="annot"><span class="annottext">i2' :: Expr MonadSig I
</span><a href="#local-6989586621679139805"><span class="hs-identifier hs-var hs-var">i2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig M
-&gt; Expr MonadSig (I :-&gt; M) -&gt; Expr MonadSig I -&gt; Expr MonadSig I
</span><a href="ModelFinder.Examples.Monad.html#index2"><span class="hs-identifier hs-var">index2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">M -&gt; Expr MonadSig M
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139790"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig (I :-&gt; M)
</span><a href="#local-6989586621679139797"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">I -&gt; Expr MonadSig I
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139793"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>    </span><span>
</span><span id="line-136"></span><span>    </span><span id="local-6989586621679139794"><span class="annot"><span class="annottext">law6 :: Prop
</span><a href="#local-6989586621679139794"><span class="hs-identifier hs-var hs-var">law6</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig M
-&gt; Expr MonadSig (I :-&gt; M) -&gt; Expr MonadSig I -&gt; Expr MonadSig I
</span><a href="ModelFinder.Examples.Monad.html#index1"><span class="hs-identifier hs-var">index1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">M -&gt; Expr MonadSig M
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139790"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(I :-&gt; M) -&gt; Expr MonadSig (I :-&gt; M)
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139791"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig I
</span><a href="#local-6989586621679139802"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr MonadSig I -&gt; Expr MonadSig I -&gt; Prop
forall x (f :: * -&gt; *). Eq x =&gt; Expr f x -&gt; Expr f x -&gt; Property f
</span><a href="ModelFinder.Expr.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">Expr MonadSig I
</span><a href="#local-6989586621679139804"><span class="hs-identifier hs-var">i1'</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span id="local-6989586621679139795"><span class="annot"><span class="annottext">law7 :: Prop
</span><a href="#local-6989586621679139795"><span class="hs-identifier hs-var hs-var">law7</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig M
-&gt; Expr MonadSig (I :-&gt; M) -&gt; Expr MonadSig I -&gt; Expr MonadSig I
</span><a href="ModelFinder.Examples.Monad.html#index2"><span class="hs-identifier hs-var">index2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">M -&gt; Expr MonadSig M
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139790"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(I :-&gt; M) -&gt; Expr MonadSig (I :-&gt; M)
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139791"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig I
</span><a href="#local-6989586621679139802"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr MonadSig I -&gt; Expr MonadSig I -&gt; Prop
forall x (f :: * -&gt; *). Eq x =&gt; Expr f x -&gt; Expr f x -&gt; Property f
</span><a href="ModelFinder.Expr.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">Expr MonadSig (M, I :-&gt; M) -&gt; Expr MonadSig I -&gt; Expr MonadSig I
</span><a href="ModelFinder.Examples.Monad.html#index1%27"><span class="hs-identifier hs-var">index1'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">I -&gt; (M, I :-&gt; M)
</span><a href="#local-6989586621679139799"><span class="hs-identifier hs-var">vw</span></a></span><span> </span><span class="annot"><span class="annottext">(I -&gt; (M, I :-&gt; M))
-&gt; Expr MonadSig I -&gt; Expr MonadSig (M, I :-&gt; M)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr MonadSig I
</span><a href="#local-6989586621679139804"><span class="hs-identifier hs-var">i1'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig I
</span><a href="#local-6989586621679139805"><span class="hs-identifier hs-var">i2'</span></a></span><span>
</span><span id="line-138"></span><span>    </span><span id="local-6989586621679139796"><span class="annot"><span class="annottext">law8 :: Prop
</span><a href="#local-6989586621679139796"><span class="hs-identifier hs-var hs-var">law8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig I
</span><a href="#local-6989586621679139803"><span class="hs-identifier hs-var">i2</span></a></span><span> </span><span class="annot"><span class="annottext">Expr MonadSig I -&gt; Expr MonadSig I -&gt; Prop
forall x (f :: * -&gt; *). Eq x =&gt; Expr f x -&gt; Expr f x -&gt; Property f
</span><a href="ModelFinder.Expr.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">Expr MonadSig (M, I :-&gt; M) -&gt; Expr MonadSig I -&gt; Expr MonadSig I
</span><a href="ModelFinder.Examples.Monad.html#index2%27"><span class="hs-identifier hs-var">index2'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">I -&gt; (M, I :-&gt; M)
</span><a href="#local-6989586621679139799"><span class="hs-identifier hs-var">vw</span></a></span><span> </span><span class="annot"><span class="annottext">(I -&gt; (M, I :-&gt; M))
-&gt; Expr MonadSig I -&gt; Expr MonadSig (M, I :-&gt; M)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr MonadSig I
</span><a href="#local-6989586621679139804"><span class="hs-identifier hs-var">i1'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig I
</span><a href="#local-6989586621679139805"><span class="hs-identifier hs-var">i2'</span></a></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- Aux functions to write laws</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="annot"><a href="ModelFinder.Examples.Monad.html#mungeInner"><span class="hs-identifier hs-type">mungeInner</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span id="mungeInner"><span class="annot"><span class="annottext">mungeInner :: (I :-&gt; M) -&gt; ((I, I) :-&gt; M) -&gt; Expr MonadSig (I :-&gt; M)
</span><a href="ModelFinder.Examples.Monad.html#mungeInner"><span class="hs-identifier hs-var hs-var">mungeInner</span></a></span></span><span> </span><span id="local-6989586621679139808"><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139808"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679139809"><span class="annot"><span class="annottext">(I, I) :-&gt; M
</span><a href="#local-6989586621679139809"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(I -&gt; Expr MonadSig M) -&gt; Expr MonadSig (I :-&gt; M)
forall a. (I -&gt; Expr MonadSig a) -&gt; Expr MonadSig (I :-&gt; a)
</span><a href="ModelFinder.Examples.Monad.html#fn"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">((I -&gt; Expr MonadSig M) -&gt; Expr MonadSig (I :-&gt; M))
-&gt; (I -&gt; Expr MonadSig M) -&gt; Expr MonadSig (I :-&gt; M)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679139810"><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139810"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr MonadSig M -&gt; Expr MonadSig (I :-&gt; M) -&gt; Expr MonadSig M
</span><a href="ModelFinder.Examples.Monad.html#munge"><span class="hs-identifier hs-var">munge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">M -&gt; Expr MonadSig M
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139808"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(I :-&gt; M) -&gt; I -&gt; M
forall a b. (a :-&gt; b) -&gt; a -&gt; b
</span><a href="ModelFinder.Examples.Monad.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139810"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(I :-&gt; M) -&gt; Expr MonadSig (I :-&gt; M)
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">((I :-&gt; M) -&gt; Expr MonadSig (I :-&gt; M))
-&gt; (I :-&gt; M) -&gt; Expr MonadSig (I :-&gt; M)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(I -&gt; M) -&gt; I :-&gt; M
forall a b. (a -&gt; b) -&gt; a :-&gt; b
</span><a href="ModelFinder.Examples.Monad.html#Fn"><span class="hs-identifier hs-var">Fn</span></a></span><span> </span><span class="annot"><span class="annottext">((I -&gt; M) -&gt; I :-&gt; M) -&gt; (I -&gt; M) -&gt; I :-&gt; M
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679139811"><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139811"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(I, I) :-&gt; M
</span><a href="#local-6989586621679139809"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">((I, I) :-&gt; M) -&gt; (I, I) -&gt; M
forall a b. (a :-&gt; b) -&gt; a -&gt; b
</span><a href="ModelFinder.Examples.Monad.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139810"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139811"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="annot"><a href="ModelFinder.Examples.Monad.html#indexBoth"><span class="hs-identifier hs-type">indexBoth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span id="indexBoth"><span class="annot"><span class="annottext">indexBoth :: M -&gt; (I :-&gt; M) -&gt; Expr MonadSig (I :-&gt; (I, I))
</span><a href="ModelFinder.Examples.Monad.html#indexBoth"><span class="hs-identifier hs-var hs-var">indexBoth</span></a></span></span><span> </span><span id="local-6989586621679139812"><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139812"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679139813"><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139813"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(I -&gt; Expr MonadSig (I, I)) -&gt; Expr MonadSig (I :-&gt; (I, I))
forall a. (I -&gt; Expr MonadSig a) -&gt; Expr MonadSig (I :-&gt; a)
</span><a href="ModelFinder.Examples.Monad.html#fn"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">((I -&gt; Expr MonadSig (I, I)) -&gt; Expr MonadSig (I :-&gt; (I, I)))
-&gt; (I -&gt; Expr MonadSig (I, I)) -&gt; Expr MonadSig (I :-&gt; (I, I))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679139814"><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139814"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(I -&gt; I -&gt; (I, I))
-&gt; Expr MonadSig I -&gt; Expr MonadSig I -&gt; Expr MonadSig (I, I)
forall a b c.
(a -&gt; b -&gt; c)
-&gt; Expr MonadSig a -&gt; Expr MonadSig b -&gt; Expr MonadSig c
forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><span class="hs-identifier hs-var">liftA2</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr MonadSig M
-&gt; Expr MonadSig (I :-&gt; M) -&gt; Expr MonadSig I -&gt; Expr MonadSig I
</span><a href="ModelFinder.Examples.Monad.html#index1"><span class="hs-identifier hs-var">index1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">M -&gt; Expr MonadSig M
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139812"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(I :-&gt; M) -&gt; Expr MonadSig (I :-&gt; M)
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139813"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">I -&gt; Expr MonadSig I
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139814"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr MonadSig M
-&gt; Expr MonadSig (I :-&gt; M) -&gt; Expr MonadSig I -&gt; Expr MonadSig I
</span><a href="ModelFinder.Examples.Monad.html#index2"><span class="hs-identifier hs-var">index2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">M -&gt; Expr MonadSig M
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139812"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(I :-&gt; M) -&gt; Expr MonadSig (I :-&gt; M)
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139813"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">I -&gt; Expr MonadSig I
forall a. a -&gt; Expr MonadSig a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139814"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="annot"><a href="ModelFinder.Examples.Monad.html#index1%27"><span class="hs-identifier hs-type">index1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#index2%27"><span class="hs-identifier hs-type">index2'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span>
</span><span id="line-149"></span><span id="index1%27"><span class="annot"><span class="annottext">index1' :: Expr MonadSig (M, I :-&gt; M) -&gt; Expr MonadSig I -&gt; Expr MonadSig I
</span><a href="ModelFinder.Examples.Monad.html#index1%27"><span class="hs-identifier hs-var hs-var">index1'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((M, I :-&gt; M) -&gt; I -&gt; MonadSig I)
-&gt; Expr MonadSig (M, I :-&gt; M) -&gt; Expr MonadSig I -&gt; Expr MonadSig I
forall x1 x2 (f :: * -&gt; *) y.
(x1 -&gt; x2 -&gt; f y) -&gt; Expr f x1 -&gt; Expr f x2 -&gt; Expr f y
</span><a href="ModelFinder.Expr.html#lift2"><span class="hs-identifier hs-var">lift2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679139816"><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139816"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679139817"><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139817"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679139818"><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139818"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">M -&gt; (I :-&gt; M) -&gt; I -&gt; MonadSig I
</span><a href="ModelFinder.Examples.Monad.html#Index1"><span class="hs-identifier hs-var">Index1</span></a></span><span> </span><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139816"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139817"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139818"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span id="index2%27"><span class="annot"><span class="annottext">index2' :: Expr MonadSig (M, I :-&gt; M) -&gt; Expr MonadSig I -&gt; Expr MonadSig I
</span><a href="ModelFinder.Examples.Monad.html#index2%27"><span class="hs-identifier hs-var hs-var">index2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((M, I :-&gt; M) -&gt; I -&gt; MonadSig I)
-&gt; Expr MonadSig (M, I :-&gt; M) -&gt; Expr MonadSig I -&gt; Expr MonadSig I
forall x1 x2 (f :: * -&gt; *) y.
(x1 -&gt; x2 -&gt; f y) -&gt; Expr f x1 -&gt; Expr f x2 -&gt; Expr f y
</span><a href="ModelFinder.Expr.html#lift2"><span class="hs-identifier hs-var">lift2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679139819"><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139819"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679139820"><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139820"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679139821"><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139821"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">M -&gt; (I :-&gt; M) -&gt; I -&gt; MonadSig I
</span><a href="ModelFinder.Examples.Monad.html#Index2"><span class="hs-identifier hs-var">Index2</span></a></span><span> </span><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139819"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139820"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139821"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="annot"><span class="hs-comment">-- * Model definitions</span></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- &gt;&gt;&gt; length $ searchMonad ()</span><span>
</span><span id="line-155"></span><span class="annot"><span class="hs-comment">-- *** Exception: ProgressCancelledException</span></span><span>
</span><span id="line-156"></span><span class="annot"><a href="ModelFinder.Examples.Monad.html#searchMonad"><span class="hs-identifier hs-type">searchMonad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ModelFinder.Solver.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-157"></span><span id="searchMonad"><span class="annot"><span class="annottext">searchMonad :: () -&gt; [Solution MonadSig]
</span><a href="ModelFinder.Examples.Monad.html#searchMonad"><span class="hs-identifier hs-var hs-var">searchMonad</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Model MonadSig]
</span><a href="ModelFinder.Examples.Monad.html#initialMonadModels"><span class="hs-identifier hs-var">initialMonadModels</span></a></span><span> </span><span class="annot"><span class="annottext">[Model MonadSig]
-&gt; (Model MonadSig -&gt; [Solution MonadSig]) -&gt; [Solution MonadSig]
forall a b. [a] -&gt; (a -&gt; [b]) -&gt; [b]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679139823"><span class="annot"><span class="annottext">Model MonadSig
</span><a href="#local-6989586621679139823"><span class="hs-identifier hs-var">model</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Model MonadSig -&gt; Map Int Prop -&gt; [Model MonadSig]
forall (f :: * -&gt; *) k.
(GCompare f, Has Ord f, Ord k) =&gt;
Int -&gt; Model f -&gt; Map k (Property f) -&gt; [Model f]
</span><a href="ModelFinder.Solver.html#solve"><span class="hs-identifier hs-var">solve</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Model MonadSig
</span><a href="#local-6989586621679139823"><span class="hs-identifier hs-var">model</span></a></span><span> </span><span class="annot"><span class="annottext">Map Int Prop
</span><a href="#local-6989586621679139825"><span class="hs-identifier hs-var">equations</span></a></span><span> </span><span class="annot"><span class="annottext">[Model MonadSig]
-&gt; (Model MonadSig -&gt; [Solution MonadSig]) -&gt; [Solution MonadSig]
forall a b. [a] -&gt; (a -&gt; [b]) -&gt; [b]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Model MonadSig -&gt; [Solution MonadSig]
forall (f :: * -&gt; *). Model f -&gt; [Solution f]
</span><a href="ModelFinder.Solver.html#constraintToSolution"><span class="hs-identifier hs-var">constraintToSolution</span></a></span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-159"></span><span>    </span><span id="local-6989586621679139828"><span class="annot"><span class="annottext">ms :: [M]
</span><a href="#local-6989586621679139828"><span class="hs-identifier hs-var hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[M]
forall a. Finitary a =&gt; [a]
</span><span class="hs-identifier hs-var">inhabitants</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-160"></span><span>    </span><span id="local-6989586621679139831"><span class="annot"><span class="annottext">is :: [I]
</span><a href="#local-6989586621679139831"><span class="hs-identifier hs-var hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[I]
forall a. Finitary a =&gt; [a]
</span><span class="hs-identifier hs-var">inhabitants</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-161"></span><span>    </span><span id="local-6989586621679139835"><span class="annot"><span class="annottext">vs :: [I :-&gt; M]
</span><a href="#local-6989586621679139835"><span class="hs-identifier hs-var hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[I :-&gt; M]
forall a b. (Ord a, Finitary a, Finitary b) =&gt; [a :-&gt; b]
</span><a href="ModelFinder.Examples.Monad.html#allFunctions"><span class="hs-identifier hs-var">allFunctions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-162"></span><span>    </span><span id="local-6989586621679139846"><span class="annot"><span class="annottext">ws :: [(I, I) :-&gt; M]
</span><a href="#local-6989586621679139846"><span class="hs-identifier hs-var hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(I, I) :-&gt; M]
forall a b. (Ord a, Finitary a, Finitary b) =&gt; [a :-&gt; b]
</span><a href="ModelFinder.Examples.Monad.html#allFunctions"><span class="hs-identifier hs-var">allFunctions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span class="hs-special">,</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621679139825"><span class="annot"><span class="annottext">equations :: Map Int Prop
</span><a href="#local-6989586621679139825"><span class="hs-identifier hs-var hs-var">equations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Int, Prop)] -&gt; Map Int Prop
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Int, Prop)] -&gt; Map Int Prop) -&gt; [(Int, Prop)] -&gt; Map Int Prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Prop] -&gt; [(Int, Prop)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Prop]] -&gt; [Prop]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Prop]
</span><a href="#local-6989586621679139854"><span class="hs-identifier hs-var">law3eqs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Prop]
</span><a href="#local-6989586621679139855"><span class="hs-identifier hs-var">law678eqs</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621679139854"><span class="annot"><span class="annottext">law3eqs :: [Prop]
</span><a href="#local-6989586621679139854"><span class="hs-identifier hs-var hs-var">law3eqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">M -&gt; (I :-&gt; M) -&gt; ((I, I) :-&gt; M) -&gt; Prop
</span><a href="ModelFinder.Examples.Monad.html#monadLaw3"><span class="hs-identifier hs-var">monadLaw3</span></a></span><span> </span><span class="annot"><span class="annottext">(M -&gt; (I :-&gt; M) -&gt; ((I, I) :-&gt; M) -&gt; Prop)
-&gt; [M] -&gt; [(I :-&gt; M) -&gt; ((I, I) :-&gt; M) -&gt; Prop]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[M]
</span><a href="#local-6989586621679139828"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="annot"><span class="annottext">[(I :-&gt; M) -&gt; ((I, I) :-&gt; M) -&gt; Prop]
-&gt; [I :-&gt; M] -&gt; [((I, I) :-&gt; M) -&gt; Prop]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[I :-&gt; M]
</span><a href="#local-6989586621679139835"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">[((I, I) :-&gt; M) -&gt; Prop] -&gt; [(I, I) :-&gt; M] -&gt; [Prop]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(I, I) :-&gt; M]
</span><a href="#local-6989586621679139846"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span id="local-6989586621679139855"><span class="annot"><span class="annottext">law678eqs :: [Prop]
</span><a href="#local-6989586621679139855"><span class="hs-identifier hs-var hs-var">law678eqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-168"></span><span>      </span><span id="local-6989586621679139865"><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139865"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[M]
</span><a href="#local-6989586621679139828"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-169"></span><span>      </span><span id="local-6989586621679139866"><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139866"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[I :-&gt; M]
</span><a href="#local-6989586621679139835"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-170"></span><span>      </span><span id="local-6989586621679139867"><span class="annot"><span class="annottext">(I, I) :-&gt; M
</span><a href="#local-6989586621679139867"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(I, I) :-&gt; M]
</span><a href="#local-6989586621679139846"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-171"></span><span>      </span><span id="local-6989586621679139868"><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139868"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[I]
</span><a href="#local-6989586621679139831"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-172"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679139869"><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679139869"><span class="hs-identifier hs-var">p6</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679139870"><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679139870"><span class="hs-identifier hs-var">p7</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679139871"><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679139871"><span class="hs-identifier hs-var">p8</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">M -&gt; (I :-&gt; M) -&gt; ((I, I) :-&gt; M) -&gt; I -&gt; (Prop, Prop, Prop)
</span><a href="ModelFinder.Examples.Monad.html#monadLaw678"><span class="hs-identifier hs-var">monadLaw678</span></a></span><span> </span><span class="annot"><span class="annottext">M
</span><a href="#local-6989586621679139865"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">I :-&gt; M
</span><a href="#local-6989586621679139866"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(I, I) :-&gt; M
</span><a href="#local-6989586621679139867"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">I
</span><a href="#local-6989586621679139868"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-173"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679139869"><span class="hs-identifier hs-var">p6</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679139870"><span class="hs-identifier hs-var">p7</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679139871"><span class="hs-identifier hs-var">p8</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | Law1,2,4,5 are &quot;easy&quot; laws, picking one exact value</span><span>
</span><span id="line-176"></span><span class="hs-comment">--   for unknown functions at specific values.</span><span>
</span><span id="line-177"></span><span class="hs-comment">--</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- &gt;&gt;&gt; length initialMonadModels</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- 1</span><span>
</span><span id="line-180"></span><span class="annot"><a href="ModelFinder.Examples.Monad.html#initialMonadModels"><span class="hs-identifier hs-type">initialMonadModels</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ModelFinder.Solver.html#Model"><span class="hs-identifier hs-type">Model</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-181"></span><span id="initialMonadModels"><span class="annot"><span class="annottext">initialMonadModels :: [Model MonadSig]
</span><a href="ModelFinder.Examples.Monad.html#initialMonadModels"><span class="hs-identifier hs-var hs-var">initialMonadModels</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Model MonadSig -&gt; Map Int Prop -&gt; [Model MonadSig]
forall (f :: * -&gt; *) k.
(GCompare f, Has Ord f, Ord k) =&gt;
Int -&gt; Model f -&gt; Map k (Property f) -&gt; [Model f]
</span><a href="ModelFinder.Solver.html#solve"><span class="hs-identifier hs-var">solve</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Model MonadSig
</span><a href="#local-6989586621679139872"><span class="hs-identifier hs-var">initialModel</span></a></span><span> </span><span class="annot"><span class="annottext">Map Int Prop
</span><a href="#local-6989586621679139873"><span class="hs-identifier hs-var">equations</span></a></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621679139875"><span class="annot"><span class="annottext">ms :: [M]
</span><a href="#local-6989586621679139875"><span class="hs-identifier hs-var hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[M]
forall a. Finitary a =&gt; [a]
</span><span class="hs-identifier hs-var">inhabitants</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621679139877"><span class="annot"><span class="annottext">is :: [I]
</span><a href="#local-6989586621679139877"><span class="hs-identifier hs-var hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[I]
forall a. Finitary a =&gt; [a]
</span><span class="hs-identifier hs-var">inhabitants</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span>    </span><span id="local-6989586621679139881"><span class="annot"><span class="annottext">vs :: [I :-&gt; M]
</span><a href="#local-6989586621679139881"><span class="hs-identifier hs-var hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[I :-&gt; M]
forall a b. (Ord a, Finitary a, Finitary b) =&gt; [a :-&gt; b]
</span><a href="ModelFinder.Examples.Monad.html#allFunctions"><span class="hs-identifier hs-var">allFunctions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-186"></span><span>    </span><span>
</span><span id="line-187"></span><span>    </span><span id="local-6989586621679139883"><span class="annot"><span class="annottext">allMs :: Set M
</span><a href="#local-6989586621679139883"><span class="hs-identifier hs-var hs-var">allMs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[M] -&gt; Set M
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">[M]
</span><a href="#local-6989586621679139875"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621679139886"><span class="annot"><span class="annottext">allIs :: Set I
</span><a href="#local-6989586621679139886"><span class="hs-identifier hs-var hs-var">allIs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[I] -&gt; Set I
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">[I]
</span><a href="#local-6989586621679139877"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621679139872"><span class="annot"><span class="annottext">initialModel :: Model MonadSig
</span><a href="#local-6989586621679139872"><span class="hs-identifier hs-var hs-var">initialModel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DMap MonadSig Set -&gt; Model MonadSig
forall (f :: * -&gt; *). DMap f Set -&gt; Model f
</span><a href="ModelFinder.Solver.html#Model"><span class="hs-identifier hs-var">Model</span></a></span><span> </span><span class="annot"><span class="annottext">(DMap MonadSig Set -&gt; Model MonadSig)
-&gt; DMap MonadSig Set -&gt; Model MonadSig
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DSum MonadSig Set] -&gt; DMap MonadSig Set
forall {k1} (k2 :: k1 -&gt; *) (f :: k1 -&gt; *).
GCompare k2 =&gt;
[DSum k2 f] -&gt; DMap k2 f
</span><span class="hs-identifier hs-var">DMap.fromList</span></span><span> </span><span class="annot"><span class="annottext">([DSum MonadSig Set] -&gt; DMap MonadSig Set)
-&gt; [DSum MonadSig Set] -&gt; DMap MonadSig Set
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-191"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">MonadSig M
</span><a href="ModelFinder.Examples.Monad.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span><span> </span><span class="annot"><span class="annottext">MonadSig M -&gt; Set M -&gt; DSum MonadSig Set
forall {k} (tag :: k -&gt; *) (f :: k -&gt; *) (a :: k).
tag a -&gt; f a -&gt; DSum tag f
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="annot"><span class="annottext">M -&gt; Set M
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">M
</span><a href="ModelFinder.Examples.Monad.html#M0"><span class="hs-identifier hs-var">M0</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[DSum MonadSig Set] -&gt; [DSum MonadSig Set] -&gt; [DSum MonadSig Set]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-192"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">MonadSig M
</span><a href="#local-6989586621679139900"><span class="hs-identifier hs-var">mungeSig</span></a></span><span> </span><span class="annot"><span class="annottext">MonadSig M -&gt; Set M -&gt; DSum MonadSig Set
forall {k} (tag :: k -&gt; *) (f :: k -&gt; *) (a :: k).
tag a -&gt; f a -&gt; DSum tag f
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="annot"><span class="annottext">Set M
</span><a href="#local-6989586621679139883"><span class="hs-identifier hs-var">allMs</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679139900"><span class="annot"><span class="annottext">MonadSig M
</span><a href="#local-6989586621679139900"><span class="hs-identifier hs-var">mungeSig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">M -&gt; (I :-&gt; M) -&gt; MonadSig M
</span><a href="ModelFinder.Examples.Monad.html#Munge"><span class="hs-identifier hs-var">Munge</span></a></span><span> </span><span class="annot"><span class="annottext">(M -&gt; (I :-&gt; M) -&gt; MonadSig M) -&gt; [M] -&gt; [(I :-&gt; M) -&gt; MonadSig M]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[M]
</span><a href="#local-6989586621679139875"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="annot"><span class="annottext">[(I :-&gt; M) -&gt; MonadSig M] -&gt; [I :-&gt; M] -&gt; [MonadSig M]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[I :-&gt; M]
</span><a href="#local-6989586621679139881"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[DSum MonadSig Set] -&gt; [DSum MonadSig Set] -&gt; [DSum MonadSig Set]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-193"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">MonadSig I
</span><a href="#local-6989586621679139901"><span class="hs-identifier hs-var">ix1Sig</span></a></span><span> </span><span class="annot"><span class="annottext">MonadSig I -&gt; Set I -&gt; DSum MonadSig Set
forall {k} (tag :: k -&gt; *) (f :: k -&gt; *) (a :: k).
tag a -&gt; f a -&gt; DSum tag f
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="annot"><span class="annottext">Set I
</span><a href="#local-6989586621679139886"><span class="hs-identifier hs-var">allIs</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679139901"><span class="annot"><span class="annottext">MonadSig I
</span><a href="#local-6989586621679139901"><span class="hs-identifier hs-var">ix1Sig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">M -&gt; (I :-&gt; M) -&gt; I -&gt; MonadSig I
</span><a href="ModelFinder.Examples.Monad.html#Index1"><span class="hs-identifier hs-var">Index1</span></a></span><span> </span><span class="annot"><span class="annottext">(M -&gt; (I :-&gt; M) -&gt; I -&gt; MonadSig I)
-&gt; [M] -&gt; [(I :-&gt; M) -&gt; I -&gt; MonadSig I]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[M]
</span><a href="#local-6989586621679139875"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="annot"><span class="annottext">[(I :-&gt; M) -&gt; I -&gt; MonadSig I] -&gt; [I :-&gt; M] -&gt; [I -&gt; MonadSig I]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[I :-&gt; M]
</span><a href="#local-6989586621679139881"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">[I -&gt; MonadSig I] -&gt; [I] -&gt; [MonadSig I]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[I]
</span><a href="#local-6989586621679139877"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[DSum MonadSig Set] -&gt; [DSum MonadSig Set] -&gt; [DSum MonadSig Set]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-194"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">MonadSig I
</span><a href="#local-6989586621679139902"><span class="hs-identifier hs-var">ix2Sig</span></a></span><span> </span><span class="annot"><span class="annottext">MonadSig I -&gt; Set I -&gt; DSum MonadSig Set
forall {k} (tag :: k -&gt; *) (f :: k -&gt; *) (a :: k).
tag a -&gt; f a -&gt; DSum tag f
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="annot"><span class="annottext">Set I
</span><a href="#local-6989586621679139886"><span class="hs-identifier hs-var">allIs</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679139902"><span class="annot"><span class="annottext">MonadSig I
</span><a href="#local-6989586621679139902"><span class="hs-identifier hs-var">ix2Sig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">M -&gt; (I :-&gt; M) -&gt; I -&gt; MonadSig I
</span><a href="ModelFinder.Examples.Monad.html#Index2"><span class="hs-identifier hs-var">Index2</span></a></span><span> </span><span class="annot"><span class="annottext">(M -&gt; (I :-&gt; M) -&gt; I -&gt; MonadSig I)
-&gt; [M] -&gt; [(I :-&gt; M) -&gt; I -&gt; MonadSig I]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[M]
</span><a href="#local-6989586621679139875"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="annot"><span class="annottext">[(I :-&gt; M) -&gt; I -&gt; MonadSig I] -&gt; [I :-&gt; M] -&gt; [I -&gt; MonadSig I]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[I :-&gt; M]
</span><a href="#local-6989586621679139881"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">[I -&gt; MonadSig I] -&gt; [I] -&gt; [MonadSig I]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[I]
</span><a href="#local-6989586621679139877"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span>    </span><span id="local-6989586621679139873"><span class="annot"><span class="annottext">equations :: Map Int Prop
</span><a href="#local-6989586621679139873"><span class="hs-identifier hs-var hs-var">equations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Int, Prop)] -&gt; Map Int Prop
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Int, Prop)] -&gt; Map Int Prop) -&gt; [(Int, Prop)] -&gt; Map Int Prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Prop] -&gt; [(Int, Prop)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Prop]] -&gt; [Prop]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Prop]
</span><a href="#local-6989586621679139906"><span class="hs-identifier hs-var">law1eqs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Prop]
</span><a href="#local-6989586621679139907"><span class="hs-identifier hs-var">law2eqs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Prop]
</span><a href="#local-6989586621679139908"><span class="hs-identifier hs-var">law4eqs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Prop]
</span><a href="#local-6989586621679139909"><span class="hs-identifier hs-var">law5eqs</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span>    </span><span id="local-6989586621679139906"><span class="annot"><span class="annottext">law1eqs :: [Prop]
</span><a href="#local-6989586621679139906"><span class="hs-identifier hs-var hs-var">law1eqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">M -&gt; Prop
</span><a href="ModelFinder.Examples.Monad.html#monadLaw1"><span class="hs-identifier hs-var">monadLaw1</span></a></span><span> </span><span class="annot"><span class="annottext">(M -&gt; Prop) -&gt; [M] -&gt; [Prop]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[M]
</span><a href="#local-6989586621679139875"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span id="local-6989586621679139907"><span class="annot"><span class="annottext">law2eqs :: [Prop]
</span><a href="#local-6989586621679139907"><span class="hs-identifier hs-var hs-var">law2eqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">M -&gt; Prop
</span><a href="ModelFinder.Examples.Monad.html#monadLaw2"><span class="hs-identifier hs-var">monadLaw2</span></a></span><span> </span><span class="annot"><span class="annottext">(M -&gt; Prop) -&gt; [M] -&gt; [Prop]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[M]
</span><a href="#local-6989586621679139875"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span id="local-6989586621679139908"><span class="annot"><span class="annottext">law4eqs :: [Prop]
</span><a href="#local-6989586621679139908"><span class="hs-identifier hs-var hs-var">law4eqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">M -&gt; I -&gt; Prop
</span><a href="ModelFinder.Examples.Monad.html#monadLaw4"><span class="hs-identifier hs-var">monadLaw4</span></a></span><span> </span><span class="annot"><span class="annottext">(M -&gt; I -&gt; Prop) -&gt; [M] -&gt; [I -&gt; Prop]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[M]
</span><a href="#local-6989586621679139875"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="annot"><span class="annottext">[I -&gt; Prop] -&gt; [I] -&gt; [Prop]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[I]
</span><a href="#local-6989586621679139877"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span id="local-6989586621679139909"><span class="annot"><span class="annottext">law5eqs :: [Prop]
</span><a href="#local-6989586621679139909"><span class="hs-identifier hs-var hs-var">law5eqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">M -&gt; I -&gt; Prop
</span><a href="ModelFinder.Examples.Monad.html#monadLaw5"><span class="hs-identifier hs-var">monadLaw5</span></a></span><span> </span><span class="annot"><span class="annottext">(M -&gt; I -&gt; Prop) -&gt; [M] -&gt; [I -&gt; Prop]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[M]
</span><a href="#local-6989586621679139875"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="annot"><span class="annottext">[I -&gt; Prop] -&gt; [I] -&gt; [Prop]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[I]
</span><a href="#local-6989586621679139877"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-comment">-------------------</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- Instances</span><span>
</span><span id="line-205"></span><span class="hs-comment">-------------------</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span id="local-6989586621679139282"><span id="local-6989586621679139917"><span id="local-6989586621679139919"><span id="local-6989586621679139923"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139282"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-208"></span><span id="local-6989586621679139283"><span id="local-6989586621679139926"><span id="local-6989586621679139928"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139283"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-209"></span><span id="local-6989586621679139284"><span id="local-6989586621679139934"><span id="local-6989586621679139936"><span id="local-6989586621679139940"><span id="local-6989586621679139943"><span id="local-6989586621679139946"><span id="local-6989586621679139949"><span id="local-6989586621679139952"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139284"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GShow</span></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679139958"><span class="annot"><span class="annottext">gshowsPrec :: forall x. Int -&gt; MonadSig x -&gt; ShowS
</span><a href="#local-6989586621679139958"><span class="hs-identifier hs-var hs-var hs-var hs-var">gshowsPrec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; MonadSig a -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GEq</span></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-214"></span><span>  </span><span id="local-6989586621679139964"><span class="annot"><span class="annottext">geq :: forall a b. MonadSig a -&gt; MonadSig b -&gt; Maybe (a :~: b)
</span><a href="#local-6989586621679139964"><span class="hs-identifier hs-var hs-var hs-var hs-var">geq</span></a></span></span><span> </span><span class="annot"><span class="annottext">MonadSig a
</span><a href="ModelFinder.Examples.Monad.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span><span> </span><span class="annot"><span class="annottext">MonadSig b
</span><a href="ModelFinder.Examples.Monad.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a :~: b) -&gt; Maybe (a :~: b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a :~: a
a :~: b
forall {k} (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span>
</span><span id="line-215"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">geq</span></span><span> </span><span id="local-6989586621679139969"><span class="annot"><span class="annottext">x :: MonadSig a
</span><a href="#local-6989586621679139969"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Munge"><span class="hs-identifier hs-type">Munge</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span id="local-6989586621679139971"><span class="annot"><span class="annottext">y :: MonadSig b
</span><a href="#local-6989586621679139971"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Munge"><span class="hs-identifier hs-type">Munge</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MonadSig a
</span><a href="#local-6989586621679139969"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">MonadSig a -&gt; MonadSig a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">MonadSig a
MonadSig b
</span><a href="#local-6989586621679139971"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; Maybe (a :~: b) -&gt; Maybe (a :~: b)
forall a b. Maybe a -&gt; Maybe b -&gt; Maybe b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a :~: b) -&gt; Maybe (a :~: b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a :~: a
a :~: b
forall {k} (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span>
</span><span id="line-216"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">geq</span></span><span> </span><span id="local-6989586621679139979"><span class="annot"><span class="annottext">x :: MonadSig a
</span><a href="#local-6989586621679139979"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Index1"><span class="hs-identifier hs-type">Index1</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span id="local-6989586621679139981"><span class="annot"><span class="annottext">y :: MonadSig b
</span><a href="#local-6989586621679139981"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Index1"><span class="hs-identifier hs-type">Index1</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MonadSig a
</span><a href="#local-6989586621679139979"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">MonadSig a -&gt; MonadSig a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">MonadSig a
MonadSig b
</span><a href="#local-6989586621679139981"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; Maybe (a :~: b) -&gt; Maybe (a :~: b)
forall a b. Maybe a -&gt; Maybe b -&gt; Maybe b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a :~: b) -&gt; Maybe (a :~: b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a :~: a
a :~: b
forall {k} (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">geq</span></span><span> </span><span id="local-6989586621679139987"><span class="annot"><span class="annottext">x :: MonadSig a
</span><a href="#local-6989586621679139987"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Index2"><span class="hs-identifier hs-type">Index2</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span id="local-6989586621679139989"><span class="annot"><span class="annottext">y :: MonadSig b
</span><a href="#local-6989586621679139989"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Index2"><span class="hs-identifier hs-type">Index2</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MonadSig a
</span><a href="#local-6989586621679139987"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">MonadSig a -&gt; MonadSig a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">MonadSig a
MonadSig b
</span><a href="#local-6989586621679139989"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; Maybe (a :~: b) -&gt; Maybe (a :~: b)
forall a b. Maybe a -&gt; Maybe b -&gt; Maybe b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a :~: b) -&gt; Maybe (a :~: b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a :~: a
a :~: b
forall {k} (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span>
</span><span id="line-218"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">geq</span></span><span> </span><span class="annot"><span class="annottext">MonadSig a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MonadSig b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (a :~: b)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GCompare</span></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-221"></span><span>  </span><span id="local-6989586621679139999"><span class="annot"><span class="annottext">gcompare :: forall a b. MonadSig a -&gt; MonadSig b -&gt; GOrdering a b
</span><a href="#local-6989586621679139999"><span class="hs-identifier hs-var hs-var hs-var hs-var">gcompare</span></a></span></span><span> </span><span class="annot"><span class="annottext">MonadSig a
</span><a href="ModelFinder.Examples.Monad.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span><span> </span><span class="annot"><span class="annottext">MonadSig b
</span><a href="ModelFinder.Examples.Monad.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GOrdering a a
GOrdering a b
forall {k} (a :: k). GOrdering a a
</span><span class="hs-identifier hs-var">GEQ</span></span><span>
</span><span id="line-222"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">gcompare</span></span><span> </span><span id="local-6989586621679140004"><span class="annot"><span class="annottext">x :: MonadSig a
</span><a href="#local-6989586621679140004"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Munge"><span class="hs-identifier hs-type">Munge</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span id="local-6989586621679140006"><span class="annot"><span class="annottext">y :: MonadSig b
</span><a href="#local-6989586621679140006"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Munge"><span class="hs-identifier hs-type">Munge</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MonadSig a -&gt; MonadSig a -&gt; GOrdering a a
forall (t :: * -&gt; *) a. Ord (t a) =&gt; t a -&gt; t a -&gt; GOrdering a a
</span><a href="ModelFinder.Examples.Monad.html#monocompare"><span class="hs-identifier hs-var">monocompare</span></a></span><span> </span><span class="annot"><span class="annottext">MonadSig a
</span><a href="#local-6989586621679140004"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">MonadSig a
MonadSig b
</span><a href="#local-6989586621679140006"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-223"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">gcompare</span></span><span> </span><span id="local-6989586621679140011"><span class="annot"><span class="annottext">x :: MonadSig a
</span><a href="#local-6989586621679140011"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Index1"><span class="hs-identifier hs-type">Index1</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span id="local-6989586621679140013"><span class="annot"><span class="annottext">y :: MonadSig b
</span><a href="#local-6989586621679140013"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Index1"><span class="hs-identifier hs-type">Index1</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MonadSig a -&gt; MonadSig a -&gt; GOrdering a a
forall (t :: * -&gt; *) a. Ord (t a) =&gt; t a -&gt; t a -&gt; GOrdering a a
</span><a href="ModelFinder.Examples.Monad.html#monocompare"><span class="hs-identifier hs-var">monocompare</span></a></span><span> </span><span class="annot"><span class="annottext">MonadSig a
</span><a href="#local-6989586621679140011"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">MonadSig a
MonadSig b
</span><a href="#local-6989586621679140013"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">gcompare</span></span><span> </span><span id="local-6989586621679140017"><span class="annot"><span class="annottext">x :: MonadSig a
</span><a href="#local-6989586621679140017"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Index2"><span class="hs-identifier hs-type">Index2</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span id="local-6989586621679140019"><span class="annot"><span class="annottext">y :: MonadSig b
</span><a href="#local-6989586621679140019"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Index2"><span class="hs-identifier hs-type">Index2</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MonadSig a -&gt; MonadSig a -&gt; GOrdering a a
forall (t :: * -&gt; *) a. Ord (t a) =&gt; t a -&gt; t a -&gt; GOrdering a a
</span><a href="ModelFinder.Examples.Monad.html#monocompare"><span class="hs-identifier hs-var">monocompare</span></a></span><span> </span><span class="annot"><span class="annottext">MonadSig a
</span><a href="#local-6989586621679140017"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">MonadSig a
MonadSig b
</span><a href="#local-6989586621679140019"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">gcompare</span></span><span> </span><span class="annot"><span class="annottext">MonadSig a
</span><a href="ModelFinder.Examples.Monad.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span><span> </span><span class="annot"><span class="annottext">MonadSig b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GOrdering a b
forall {k} (a :: k) (b :: k). GOrdering a b
</span><span class="hs-identifier hs-var">GLT</span></span><span>
</span><span id="line-227"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">gcompare</span></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Munge"><span class="hs-identifier hs-type">Munge</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Index1"><span class="hs-identifier hs-type">Index1</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GOrdering a b
forall {k} (a :: k) (b :: k). GOrdering a b
</span><span class="hs-identifier hs-var">GLT</span></span><span>
</span><span id="line-228"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">gcompare</span></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Munge"><span class="hs-identifier hs-type">Munge</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Index2"><span class="hs-identifier hs-type">Index2</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GOrdering a b
forall {k} (a :: k) (b :: k). GOrdering a b
</span><span class="hs-identifier hs-var">GLT</span></span><span>
</span><span id="line-229"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">gcompare</span></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Index1"><span class="hs-identifier hs-type">Index1</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Index2"><span class="hs-identifier hs-type">Index2</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GOrdering a b
forall {k} (a :: k) (b :: k). GOrdering a b
</span><span class="hs-identifier hs-var">GLT</span></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">gcompare</span></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Munge"><span class="hs-identifier hs-type">Munge</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">MonadSig b
</span><a href="ModelFinder.Examples.Monad.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GOrdering a b
forall {k} (a :: k) (b :: k). GOrdering a b
</span><span class="hs-identifier hs-var">GGT</span></span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">gcompare</span></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Index1"><span class="hs-identifier hs-type">Index1</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">MonadSig b
</span><a href="ModelFinder.Examples.Monad.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GOrdering a b
forall {k} (a :: k) (b :: k). GOrdering a b
</span><span class="hs-identifier hs-var">GGT</span></span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">gcompare</span></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Index1"><span class="hs-identifier hs-type">Index1</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Munge"><span class="hs-identifier hs-type">Munge</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GOrdering a b
forall {k} (a :: k) (b :: k). GOrdering a b
</span><span class="hs-identifier hs-var">GGT</span></span><span>
</span><span id="line-234"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">gcompare</span></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Index2"><span class="hs-identifier hs-type">Index2</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">MonadSig b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GOrdering a b
forall {k} (a :: k) (b :: k). GOrdering a b
</span><span class="hs-identifier hs-var">GGT</span></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span id="local-6989586621679139313"><span id="local-6989586621679139314"><span class="annot"><a href="ModelFinder.Examples.Monad.html#monocompare"><span class="hs-identifier hs-type">monocompare</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679139313"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139314"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679139313"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139314"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679139313"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139314"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GOrdering</span></span><span> </span><span class="annot"><a href="#local-6989586621679139314"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139314"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-238"></span><span id="monocompare"><span class="annot"><span class="annottext">monocompare :: forall (t :: * -&gt; *) a. Ord (t a) =&gt; t a -&gt; t a -&gt; GOrdering a a
</span><a href="ModelFinder.Examples.Monad.html#monocompare"><span class="hs-identifier hs-var hs-var">monocompare</span></a></span></span><span> </span><span id="local-6989586621679140041"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679140041"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679140042"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679140042"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">t a -&gt; t a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679140041"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679140042"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-239"></span><span>  </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GOrdering a a
forall {k} (a :: k) (b :: k). GOrdering a b
</span><span class="hs-identifier hs-var">GLT</span></span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GOrdering a a
forall {k} (a :: k). GOrdering a a
</span><span class="hs-identifier hs-var">GEQ</span></span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GOrdering a a
forall {k} (a :: k) (b :: k). GOrdering a b
</span><span class="hs-identifier hs-var">GGT</span></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679139176"><span id="local-6989586621679140048"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679139176"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#I"><span class="hs-identifier hs-type">I</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679139176"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#M"><span class="hs-identifier hs-type">M</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Has</span></span><span> </span><span class="annot"><a href="#local-6989586621679139176"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#MonadSig"><span class="hs-identifier hs-type">MonadSig</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-244"></span><span>  </span><span id="local-6989586621679140053"><span class="annot"><span class="annottext">has :: forall a r. MonadSig a -&gt; (c a =&gt; r) -&gt; r
</span><a href="#local-6989586621679140053"><span class="hs-identifier hs-var hs-var hs-var hs-var">has</span></a></span></span><span> </span><span id="local-6989586621679140055"><span class="annot"><span class="annottext">MonadSig a
</span><a href="#local-6989586621679140055"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span id="local-6989586621679140056"><span class="annot"><span class="annottext">c a =&gt; r
</span><a href="#local-6989586621679140056"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MonadSig a
</span><a href="#local-6989586621679140055"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><span class="annottext">MonadSig a
</span><a href="ModelFinder.Examples.Monad.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r
c a =&gt; r
</span><a href="#local-6989586621679140056"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Munge"><span class="hs-identifier hs-type">Munge</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r
c a =&gt; r
</span><a href="#local-6989586621679140056"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-247"></span><span>    </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Index1"><span class="hs-identifier hs-type">Index1</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r
c a =&gt; r
</span><a href="#local-6989586621679140056"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Index2"><span class="hs-identifier hs-type">Index2</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r
c a =&gt; r
</span><a href="#local-6989586621679140056"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-comment">-----------------------</span><span>
</span><span id="line-251"></span><span class="annot"><span class="hs-comment">-- * Utilities</span></span><span>
</span><span id="line-252"></span><span class="hs-comment">-----------------------</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">-- | Function with finite domain can be treated as data</span><span>
</span><span id="line-255"></span><span class="hs-comment">--   (compare two functions, show to text, ...)</span><span>
</span><span id="line-256"></span><span class="hs-keyword">newtype</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679139210"><span class="annot"><a href="#local-6989586621679139210"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="%3A-%3E"><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span></span><span> </span><span id="local-6989586621679139211"><span class="annot"><a href="#local-6989586621679139211"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Fn"><span class="annot"><a href="ModelFinder.Examples.Monad.html#Fn"><span class="hs-identifier hs-var">Fn</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="%24%24"><span class="annot"><span class="annottext">forall a b. (a :-&gt; b) -&gt; a -&gt; b
</span><a href="ModelFinder.Examples.Monad.html#%24%24"><span class="hs-operator hs-var hs-var">($$)</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679139210"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679139211"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679140070"><span id="local-6989586621679140072"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; (a :-&gt; a) -&gt; a :-&gt; b)
-&gt; (forall a b. a -&gt; (a :-&gt; b) -&gt; a :-&gt; a) -&gt; Functor ((:-&gt;) a)
forall a b. a -&gt; (a :-&gt; b) -&gt; a :-&gt; a
forall a b. (a -&gt; b) -&gt; (a :-&gt; a) -&gt; a :-&gt; b
forall a a b. a -&gt; (a :-&gt; b) -&gt; a :-&gt; a
forall a a b. (a -&gt; b) -&gt; (a :-&gt; a) -&gt; a :-&gt; b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a a b. (a -&gt; b) -&gt; (a :-&gt; a) -&gt; a :-&gt; b
fmap :: forall a b. (a -&gt; b) -&gt; (a :-&gt; a) -&gt; a :-&gt; b
$c&lt;$ :: forall a a b. a -&gt; (a :-&gt; b) -&gt; a :-&gt; a
&lt;$ :: forall a b. a -&gt; (a :-&gt; b) -&gt; a :-&gt; a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679139335"><span id="local-6989586621679139336"><span id="local-6989586621679140078"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Finitary</span></span><span> </span><span class="annot"><a href="#local-6989586621679139335"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679139336"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679139335"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139336"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-260"></span><span>  </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span id="local-6989586621679140083"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679140083"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679140084"><span class="annot"><span class="annottext">== :: (a :-&gt; b) -&gt; (a :-&gt; b) -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span id="local-6989586621679140085"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679140085"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679140087"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679140087"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679140083"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679140087"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679140085"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679140087"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
forall a. Finitary a =&gt; [a]
</span><span class="hs-identifier hs-var">inhabitants</span></span><span> </span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679139341"><span id="local-6989586621679139342"><span id="local-6989586621679140095"><span id="local-6989586621679140098"><span id="local-6989586621679140101"><span id="local-6989586621679140104"><span id="local-6989586621679140107"><span id="local-6989586621679140110"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Finitary</span></span><span> </span><span class="annot"><a href="#local-6989586621679139341"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679139342"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679139341"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139342"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-263"></span><span>  </span><span id="local-6989586621679140118"><span class="annot"><span class="annottext">compare :: (a :-&gt; b) -&gt; (a :-&gt; b) -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span id="local-6989586621679140119"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679140119"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span id="local-6989586621679140120"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679140120"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Ordering) -&gt; [a] -&gt; Ordering
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679140122"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679140122"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679140119"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679140122"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679140120"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679140122"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
forall a. Finitary a =&gt; [a]
</span><span class="hs-identifier hs-var">inhabitants</span></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679139348"><span id="local-6989586621679139349"><span id="local-6989586621679140128"><span id="local-6989586621679140131"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Finitary</span></span><span> </span><span class="annot"><a href="#local-6989586621679139348"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679139348"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679139349"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679139348"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139349"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-266"></span><span>  </span><span id="local-6989586621679140138"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; (a :-&gt; b) -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></span></span><span> </span><span id="local-6989586621679140139"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679140139"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679140140"><span class="annot"><span class="annottext">a :-&gt; b
</span><a href="#local-6989586621679140140"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; [(a, b)] -&gt; ShowS) -&gt; String -&gt; Int -&gt; [(a, b)] -&gt; ShowS
forall a. (Int -&gt; a -&gt; ShowS) -&gt; String -&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsUnaryWith</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(a, b)] -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;makeFn&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679140139"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a :-&gt; b) -&gt; [(a, b)]
forall a b. Finitary a =&gt; (a :-&gt; b) -&gt; [(a, b)]
</span><a href="ModelFinder.Examples.Monad.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span> </span><span class="annot"><span class="annottext">a :-&gt; b
</span><a href="#local-6989586621679140140"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679139376"><span id="local-6989586621679140144"><span id="local-6989586621679140151"><span id="local-6989586621679140156"><span id="local-6989586621679140159"><span id="local-6989586621679140162"><span id="local-6989586621679140165"><span id="local-6989586621679140168"><span id="local-6989586621679140171"><span id="local-6989586621679140174"><span id="local-6989586621679140177"><span id="local-6989586621679140180"><span id="local-6989586621679140183"><span id="local-6989586621679140188"><span id="local-6989586621679140193"><span id="local-6989586621679140198"><span id="local-6989586621679140203"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Finitary</span></span><span> </span><span class="annot"><a href="#local-6989586621679139376"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">(:-&gt;)</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139376"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-269"></span><span>  </span><span id="local-6989586621679140212"><span class="annot"><span class="annottext">foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; (a :-&gt; a) -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">foldMap</span></span></span><span> </span><span id="local-6989586621679140213"><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679140213"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span id="local-6989586621679140214"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679140214"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; [a] -&gt; m
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679140213"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; (a -&gt; a) -&gt; a -&gt; m
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679140214"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
forall a. Finitary a =&gt; [a]
</span><span class="hs-identifier hs-var">inhabitants</span></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679139221"><span id="local-6989586621679140222"><span id="local-6989586621679140227"><span id="local-6989586621679140232"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Finitary</span></span><span> </span><span class="annot"><a href="#local-6989586621679139221"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">(:-&gt;)</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139221"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-272"></span><span>  </span><span id="local-6989586621679140249"><span class="annot"><span class="annottext">traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; (a :-&gt; a) -&gt; f (a :-&gt; b)
</span><a href="#local-6989586621679140249"><span class="hs-identifier hs-var hs-var hs-var hs-var">traverse</span></a></span></span><span> </span><span id="local-6989586621679140251"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679140251"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679140252"><span class="annot"><span class="annottext">a :-&gt; a
</span><a href="#local-6989586621679140252"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; a :-&gt; b
forall a b. Finitary a =&gt; [(a, b)] -&gt; a :-&gt; b
</span><a href="ModelFinder.Examples.Monad.html#makeFn"><span class="hs-identifier hs-var">makeFn</span></a></span><span> </span><span class="annot"><span class="annottext">([(a, b)] -&gt; a :-&gt; b) -&gt; f [(a, b)] -&gt; f (a :-&gt; b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">((a, a) -&gt; f (a, b)) -&gt; [(a, a)] -&gt; f [(a, b)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; (a, a) -&gt; f (a, b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; (a, a) -&gt; f (a, b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679140251"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a :-&gt; a) -&gt; [(a, a)]
forall a b. Finitary a =&gt; (a :-&gt; b) -&gt; [(a, b)]
</span><a href="ModelFinder.Examples.Monad.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span> </span><span class="annot"><span class="annottext">a :-&gt; a
</span><a href="#local-6989586621679140252"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="annot"><a href="ModelFinder.Examples.Monad.html#makeFn"><span class="hs-identifier hs-type">makeFn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679139395"><span class="annot"><a href="#local-6989586621679139395"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679139396"><span class="annot"><a href="#local-6989586621679139396"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Finitary</span></span><span> </span><span class="annot"><a href="#local-6989586621679139395"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679139395"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679139396"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679139395"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139396"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-275"></span><span id="makeFn"><span class="annot"><span class="annottext">makeFn :: forall a b. Finitary a =&gt; [(a, b)] -&gt; a :-&gt; b
</span><a href="ModelFinder.Examples.Monad.html#makeFn"><span class="hs-identifier hs-var hs-var">makeFn</span></a></span></span><span> </span><span id="local-6989586621679140278"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679140278"><span class="hs-identifier hs-var">fnData</span></a></span></span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679140279"><span class="hs-identifier hs-var">isTotalMap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; a :-&gt; b
forall a b. (a -&gt; b) -&gt; a :-&gt; b
</span><a href="ModelFinder.Examples.Monad.html#Fn"><span class="hs-identifier hs-var">Fn</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; b) -&gt; a :-&gt; b) -&gt; (a -&gt; b) -&gt; a :-&gt; b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (Finite (Cardinality a)) b
</span><a href="#local-6989586621679140280"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Finite (Cardinality a)) b -&gt; Finite (Cardinality a) -&gt; b
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Finite (Cardinality a) -&gt; b)
-&gt; (a -&gt; Finite (Cardinality a)) -&gt; a -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Finite (Cardinality a)
forall a. Finitary a =&gt; a -&gt; Finite (Cardinality a)
</span><span class="hs-identifier hs-var">toFinite</span></span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; a :-&gt; b
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Not a data of total map&quot;</span></span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-279"></span><span>    </span><span id="local-6989586621679140280"><span class="annot"><span class="annottext">m :: Map (Finite (Cardinality a)) b
</span><a href="#local-6989586621679140280"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Finite (Cardinality a), b)] -&gt; Map (Finite (Cardinality a)) b
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Finite (Cardinality a))
-&gt; (a, b) -&gt; (Finite (Cardinality a), b)
forall a b c. (a -&gt; b) -&gt; (a, c) -&gt; (b, c)
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Finite (Cardinality a)
forall a. Finitary a =&gt; a -&gt; Finite (Cardinality a)
</span><span class="hs-identifier hs-var">toFinite</span></span><span> </span><span class="annot"><span class="annottext">((a, b) -&gt; (Finite (Cardinality a), b))
-&gt; [(a, b)] -&gt; [(Finite (Cardinality a), b)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679140278"><span class="hs-identifier hs-var">fnData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621679140279"><span class="annot"><span class="annottext">isTotalMap :: Bool
</span><a href="#local-6989586621679140279"><span class="hs-identifier hs-var hs-var">isTotalMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (Finite (Cardinality a)) b -&gt; Int
forall k a. Map k a -&gt; Int
</span><span class="hs-identifier hs-var">Map.size</span></span><span> </span><span class="annot"><span class="annottext">Map (Finite (Cardinality a)) b
</span><a href="#local-6989586621679140280"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (n :: Natural) (proxy :: Natural -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Natural
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Cardinality</span></span><span> </span><span class="annot"><a href="#local-6989586621679139395"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Any (Cardinality a)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span id="local-6989586621679139354"><span id="local-6989586621679139355"><span class="annot"><a href="ModelFinder.Examples.Monad.html#graph"><span class="hs-identifier hs-type">graph</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Finitary</span></span><span> </span><span class="annot"><a href="#local-6989586621679139354"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679139354"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139355"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679139354"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679139355"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-283"></span><span id="graph"><span class="annot"><span class="annottext">graph :: forall a b. Finitary a =&gt; (a :-&gt; b) -&gt; [(a, b)]
</span><a href="ModelFinder.Examples.Monad.html#graph"><span class="hs-identifier hs-var hs-var">graph</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Examples.Monad.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span id="local-6989586621679140290"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679140290"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679140291"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679140291"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679140291"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679140290"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679140291"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, b)) -&gt; [a] -&gt; [(a, b)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[a]
forall a. Finitary a =&gt; [a]
</span><span class="hs-identifier hs-var">inhabitants</span></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span id="local-6989586621679139254"><span id="local-6989586621679139255"><span class="annot"><a href="ModelFinder.Examples.Monad.html#allFunctions"><span class="hs-identifier hs-type">allFunctions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679139254"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Finitary</span></span><span> </span><span class="annot"><a href="#local-6989586621679139254"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Finitary</span></span><span> </span><span class="annot"><a href="#local-6989586621679139255"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679139254"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="ModelFinder.Examples.Monad.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139255"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-286"></span><span id="allFunctions"><span class="annot"><span class="annottext">allFunctions :: forall a b. (Ord a, Finitary a, Finitary b) =&gt; [a :-&gt; b]
</span><a href="ModelFinder.Examples.Monad.html#allFunctions"><span class="hs-identifier hs-var hs-var">allFunctions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; a :-&gt; b
forall a b. Finitary a =&gt; [(a, b)] -&gt; a :-&gt; b
</span><a href="ModelFinder.Examples.Monad.html#makeFn"><span class="hs-identifier hs-var">makeFn</span></a></span><span> </span><span class="annot"><span class="annottext">([(a, b)] -&gt; a :-&gt; b) -&gt; [[(a, b)]] -&gt; [a :-&gt; b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; [(a, b)]) -&gt; [a] -&gt; [[(a, b)]]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679140302"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679140302"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679140302"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; (a, b)) -&gt; [b] -&gt; [(a, b)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[b]
forall a. Finitary a =&gt; [a]
</span><span class="hs-identifier hs-var">inhabitants</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
forall a. Finitary a =&gt; [a]
</span><span class="hs-identifier hs-var">inhabitants</span></span><span>
</span><span id="line-287"></span></pre></body></html>