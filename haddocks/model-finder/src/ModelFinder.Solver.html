<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE InstanceSigs #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html"><span class="hs-identifier">ModelFinder.Solver</span></a></span><span class="hs-special">(</span><span>
</span><span id="line-11"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Model finding entry point</span></span><span>
</span><span id="line-12"></span><span>  </span><span class="annot"><a href="ModelFinder.Solver.html#solve"><span class="hs-identifier">solve</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#solveEqs"><span class="hs-identifier">solveEqs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Languages</span></span><span>
</span><span id="line-15"></span><span>  </span><span class="annot"><a href="ModelFinder.Term.html#L"><span class="hs-identifier">L</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Term.html#Term"><span class="hs-identifier">Term</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><a href="ModelFinder.Term.html#con"><span class="hs-identifier">con</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Term.html#fun"><span class="hs-identifier">fun</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Term.html#liftFun"><span class="hs-identifier">liftFun</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>  </span><span class="annot"><a href="ModelFinder.Term.html#Property%27"><span class="hs-identifier">Property'</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Term.html#Property"><span class="hs-identifier">Property</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><a href="ModelFinder.Term.html#runProperty"><span class="hs-identifier">runProperty</span></a></span><span>
</span><span id="line-19"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">on</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Bifunctor</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Alternative</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">guard</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MonadPlus</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isNothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sortOn</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Down</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Const</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Endo</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">StateT</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MonadTrans</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State.Class</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">State</span></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Equality.Graph</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Equality.Analysis.Monadic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">AnalysisM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Equality.Graph.Lens</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Equality.Utils.SizedList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sizeSL</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="ModelFinder.Model.html"><span class="hs-identifier">ModelFinder.Model</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="ModelFinder.Term.html"><span class="hs-identifier">ModelFinder.Term</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="annot"><span class="hs-comment">-- * Analysis data and monadic environment for it</span></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">data</span><span> </span><span id="ModelInfo"><span class="annot"><a href="ModelFinder.Solver.html#ModelInfo"><span class="hs-identifier hs-var">ModelInfo</span></a></span></span><span> </span><span id="local-6989586621679068774"><span class="annot"><a href="#local-6989586621679068774"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679068775"><span class="annot"><a href="#local-6989586621679068775"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ModelInfo"><span class="annot"><a href="ModelFinder.Solver.html#ModelInfo"><span class="hs-identifier hs-var">ModelInfo</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-51"></span><span>    </span><span id="constValue"><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. ModelInfo f a -&gt; Maybe a
</span><a href="ModelFinder.Solver.html#constValue"><span class="hs-identifier hs-var hs-var">constValue</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679068775"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ The class contains (Con a)</span></span><span>
</span><span id="line-53"></span><span>    </span><span id="constFunctions"><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. ModelInfo f a -&gt; Set (f a)
</span><a href="ModelFinder.Solver.html#constFunctions"><span class="hs-identifier hs-var hs-var">constFunctions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679068774"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068775"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-comment">-- ^ The class contains (Fun fx) where each children</span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-comment">--   classes of fx contain constant value a</span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679069262"><span id="local-6989586621679069270"><span id="local-6989586621679069274"><span class="annot"><span class="annottext">Int -&gt; ModelInfo f a -&gt; ShowS
[ModelInfo f a] -&gt; ShowS
ModelInfo f a -&gt; String
(Int -&gt; ModelInfo f a -&gt; ShowS)
-&gt; (ModelInfo f a -&gt; String)
-&gt; ([ModelInfo f a] -&gt; ShowS)
-&gt; Show (ModelInfo f a)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall (f :: * -&gt; *) a.
(Show a, Show (f a)) =&gt;
Int -&gt; ModelInfo f a -&gt; ShowS
forall (f :: * -&gt; *) a.
(Show a, Show (f a)) =&gt;
[ModelInfo f a] -&gt; ShowS
forall (f :: * -&gt; *) a.
(Show a, Show (f a)) =&gt;
ModelInfo f a -&gt; String
$cshowsPrec :: forall (f :: * -&gt; *) a.
(Show a, Show (f a)) =&gt;
Int -&gt; ModelInfo f a -&gt; ShowS
showsPrec :: Int -&gt; ModelInfo f a -&gt; ShowS
$cshow :: forall (f :: * -&gt; *) a.
(Show a, Show (f a)) =&gt;
ModelInfo f a -&gt; String
show :: ModelInfo f a -&gt; String
$cshowList :: forall (f :: * -&gt; *) a.
(Show a, Show (f a)) =&gt;
[ModelInfo f a] -&gt; ShowS
showList :: [ModelInfo f a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | This is a BAD hack! Changes of @constFunctions@</span><span>
</span><span id="line-60"></span><span class="hs-comment">--   do not need to trigger repair of parents.</span><span>
</span><span id="line-61"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679068793"><span id="local-6989586621679068794"><span id="local-6989586621679069281"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679068793"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Solver.html#ModelInfo"><span class="hs-identifier hs-type">ModelInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068794"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068793"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-62"></span><span>  </span><span id="local-6989586621679069287"><span class="annot"><span class="annottext">== :: ModelInfo f a -&gt; ModelInfo f a -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">(==)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Maybe a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; Maybe a -&gt; Bool)
-&gt; (ModelInfo f a -&gt; Maybe a)
-&gt; ModelInfo f a
-&gt; ModelInfo f a
-&gt; Bool
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">ModelInfo f a -&gt; Maybe a
forall (f :: * -&gt; *) a. ModelInfo f a -&gt; Maybe a
</span><a href="ModelFinder.Solver.html#constValue"><span class="hs-identifier hs-var">constValue</span></a></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="annot"><span class="hs-comment">-- | This is a BAD hack! See @Eq@ instance.</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679068802"><span id="local-6989586621679068803"><span id="local-6989586621679069294"><span id="local-6989586621679069298"><span id="local-6989586621679069301"><span id="local-6989586621679069304"><span id="local-6989586621679069307"><span id="local-6989586621679069310"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679068802"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Solver.html#ModelInfo"><span class="hs-identifier hs-type">ModelInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068803"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068802"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-66"></span><span>  </span><span id="local-6989586621679069316"><span class="annot"><span class="annottext">compare :: ModelInfo f a -&gt; ModelInfo f a -&gt; Ordering
</span><a href="#local-6989586621679069316"><span class="hs-identifier hs-var hs-var hs-var">compare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Maybe a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; Maybe a -&gt; Ordering)
-&gt; (ModelInfo f a -&gt; Maybe a)
-&gt; ModelInfo f a
-&gt; ModelInfo f a
-&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">ModelInfo f a -&gt; Maybe a
forall (f :: * -&gt; *) a. ModelInfo f a -&gt; Maybe a
</span><a href="ModelFinder.Solver.html#constValue"><span class="hs-identifier hs-var">constValue</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">data</span><span> </span><span id="SearchState"><span class="annot"><a href="ModelFinder.Solver.html#SearchState"><span class="hs-identifier hs-var">SearchState</span></a></span></span><span> </span><span id="local-6989586621679068805"><span class="annot"><a href="#local-6989586621679068805"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679068806"><span class="annot"><a href="#local-6989586621679068806"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679068807"><span class="annot"><a href="#local-6989586621679068807"><span class="hs-identifier hs-type">model</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SearchState"><span class="annot"><a href="ModelFinder.Solver.html#SearchState"><span class="hs-identifier hs-var">SearchState</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-69"></span><span>    </span><span id="currentModel"><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a model. SearchState f a model -&gt; model
</span><a href="ModelFinder.Solver.html#currentModel"><span class="hs-identifier hs-var hs-var">currentModel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679068807"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>    </span><span id="waitingDefs"><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a model. SearchState f a model -&gt; [(f a, a)]
</span><a href="ModelFinder.Solver.html#waitingDefs"><span class="hs-identifier hs-var hs-var">waitingDefs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679068805"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068806"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679068806"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-keyword">newtype</span><span> </span><span id="SearchM"><span class="annot"><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-var">SearchM</span></a></span></span><span> </span><span id="local-6989586621679068815"><span class="annot"><a href="#local-6989586621679068815"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679068816"><span class="annot"><a href="#local-6989586621679068816"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679068817"><span class="annot"><a href="#local-6989586621679068817"><span class="hs-identifier hs-type">model</span></a></span></span><span> </span><span id="local-6989586621679068818"><span class="annot"><a href="#local-6989586621679068818"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SearchM"><span class="annot"><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-var">SearchM</span></a></span></span><span class="hs-special">{</span><span> </span><span id="unSearchM"><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a model x.
SearchM f a model x -&gt; StateT (SearchState f a model) [] x
</span><a href="ModelFinder.Solver.html#unSearchM"><span class="hs-identifier hs-var hs-var">unSearchM</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Solver.html#SearchState"><span class="hs-identifier hs-type">SearchState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068815"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068816"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068817"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679068818"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679069324"><span id="local-6989586621679069330"><span class="annot"><span class="annottext">(forall a b.
 (a -&gt; b) -&gt; SearchM f a model a -&gt; SearchM f a model b)
-&gt; (forall a b. a -&gt; SearchM f a model b -&gt; SearchM f a model a)
-&gt; Functor (SearchM f a model)
forall a b. a -&gt; SearchM f a model b -&gt; SearchM f a model a
forall a b. (a -&gt; b) -&gt; SearchM f a model a -&gt; SearchM f a model b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
forall (f :: * -&gt; *) a model a b.
a -&gt; SearchM f a model b -&gt; SearchM f a model a
forall (f :: * -&gt; *) a model a b.
(a -&gt; b) -&gt; SearchM f a model a -&gt; SearchM f a model b
$cfmap :: forall (f :: * -&gt; *) a model a b.
(a -&gt; b) -&gt; SearchM f a model a -&gt; SearchM f a model b
fmap :: forall a b. (a -&gt; b) -&gt; SearchM f a model a -&gt; SearchM f a model b
$c&lt;$ :: forall (f :: * -&gt; *) a model a b.
a -&gt; SearchM f a model b -&gt; SearchM f a model a
&lt;$ :: forall a b. a -&gt; SearchM f a model b -&gt; SearchM f a model a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679069341"><span id="local-6989586621679069348"><span id="local-6989586621679069354"><span id="local-6989586621679069360"><span id="local-6989586621679069366"><span class="annot"><span class="annottext">Functor (SearchM f a model)
Functor (SearchM f a model) =&gt;
(forall a. a -&gt; SearchM f a model a)
-&gt; (forall a b.
    SearchM f a model (a -&gt; b)
    -&gt; SearchM f a model a -&gt; SearchM f a model b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c)
    -&gt; SearchM f a model a
    -&gt; SearchM f a model b
    -&gt; SearchM f a model c)
-&gt; (forall a b.
    SearchM f a model a -&gt; SearchM f a model b -&gt; SearchM f a model b)
-&gt; (forall a b.
    SearchM f a model a -&gt; SearchM f a model b -&gt; SearchM f a model a)
-&gt; Applicative (SearchM f a model)
forall a. a -&gt; SearchM f a model a
forall a b.
SearchM f a model a -&gt; SearchM f a model b -&gt; SearchM f a model a
forall a b.
SearchM f a model a -&gt; SearchM f a model b -&gt; SearchM f a model b
forall a b.
SearchM f a model (a -&gt; b)
-&gt; SearchM f a model a -&gt; SearchM f a model b
forall a b c.
(a -&gt; b -&gt; c)
-&gt; SearchM f a model a
-&gt; SearchM f a model b
-&gt; SearchM f a model c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
forall (f :: * -&gt; *) a model. Functor (SearchM f a model)
forall (f :: * -&gt; *) a model a. a -&gt; SearchM f a model a
forall (f :: * -&gt; *) a model a b.
SearchM f a model a -&gt; SearchM f a model b -&gt; SearchM f a model a
forall (f :: * -&gt; *) a model a b.
SearchM f a model a -&gt; SearchM f a model b -&gt; SearchM f a model b
forall (f :: * -&gt; *) a model a b.
SearchM f a model (a -&gt; b)
-&gt; SearchM f a model a -&gt; SearchM f a model b
forall (f :: * -&gt; *) a model a b c.
(a -&gt; b -&gt; c)
-&gt; SearchM f a model a
-&gt; SearchM f a model b
-&gt; SearchM f a model c
$cpure :: forall (f :: * -&gt; *) a model a. a -&gt; SearchM f a model a
pure :: forall a. a -&gt; SearchM f a model a
$c&lt;*&gt; :: forall (f :: * -&gt; *) a model a b.
SearchM f a model (a -&gt; b)
-&gt; SearchM f a model a -&gt; SearchM f a model b
&lt;*&gt; :: forall a b.
SearchM f a model (a -&gt; b)
-&gt; SearchM f a model a -&gt; SearchM f a model b
$cliftA2 :: forall (f :: * -&gt; *) a model a b c.
(a -&gt; b -&gt; c)
-&gt; SearchM f a model a
-&gt; SearchM f a model b
-&gt; SearchM f a model c
liftA2 :: forall a b c.
(a -&gt; b -&gt; c)
-&gt; SearchM f a model a
-&gt; SearchM f a model b
-&gt; SearchM f a model c
$c*&gt; :: forall (f :: * -&gt; *) a model a b.
SearchM f a model a -&gt; SearchM f a model b -&gt; SearchM f a model b
*&gt; :: forall a b.
SearchM f a model a -&gt; SearchM f a model b -&gt; SearchM f a model b
$c&lt;* :: forall (f :: * -&gt; *) a model a b.
SearchM f a model a -&gt; SearchM f a model b -&gt; SearchM f a model a
&lt;* :: forall a b.
SearchM f a model a -&gt; SearchM f a model b -&gt; SearchM f a model a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679069379"><span id="local-6989586621679069385"><span id="local-6989586621679069390"><span class="annot"><span class="annottext">Applicative (SearchM f a model)
Applicative (SearchM f a model) =&gt;
(forall a b.
 SearchM f a model a
 -&gt; (a -&gt; SearchM f a model b) -&gt; SearchM f a model b)
-&gt; (forall a b.
    SearchM f a model a -&gt; SearchM f a model b -&gt; SearchM f a model b)
-&gt; (forall a. a -&gt; SearchM f a model a)
-&gt; Monad (SearchM f a model)
forall a. a -&gt; SearchM f a model a
forall a b.
SearchM f a model a -&gt; SearchM f a model b -&gt; SearchM f a model b
forall a b.
SearchM f a model a
-&gt; (a -&gt; SearchM f a model b) -&gt; SearchM f a model b
forall (m :: * -&gt; *).
Applicative m =&gt;
(forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
forall (f :: * -&gt; *) a model. Applicative (SearchM f a model)
forall (f :: * -&gt; *) a model a. a -&gt; SearchM f a model a
forall (f :: * -&gt; *) a model a b.
SearchM f a model a -&gt; SearchM f a model b -&gt; SearchM f a model b
forall (f :: * -&gt; *) a model a b.
SearchM f a model a
-&gt; (a -&gt; SearchM f a model b) -&gt; SearchM f a model b
$c&gt;&gt;= :: forall (f :: * -&gt; *) a model a b.
SearchM f a model a
-&gt; (a -&gt; SearchM f a model b) -&gt; SearchM f a model b
&gt;&gt;= :: forall a b.
SearchM f a model a
-&gt; (a -&gt; SearchM f a model b) -&gt; SearchM f a model b
$c&gt;&gt; :: forall (f :: * -&gt; *) a model a b.
SearchM f a model a -&gt; SearchM f a model b -&gt; SearchM f a model b
&gt;&gt; :: forall a b.
SearchM f a model a -&gt; SearchM f a model b -&gt; SearchM f a model b
$creturn :: forall (f :: * -&gt; *) a model a. a -&gt; SearchM f a model a
return :: forall a. a -&gt; SearchM f a model a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679069399"><span id="local-6989586621679069406"><span id="local-6989586621679069412"><span id="local-6989586621679069418"><span class="annot"><span class="annottext">Applicative (SearchM f a model)
Applicative (SearchM f a model) =&gt;
(forall a. SearchM f a model a)
-&gt; (forall a.
    SearchM f a model a -&gt; SearchM f a model a -&gt; SearchM f a model a)
-&gt; (forall a. SearchM f a model a -&gt; SearchM f a model [a])
-&gt; (forall a. SearchM f a model a -&gt; SearchM f a model [a])
-&gt; Alternative (SearchM f a model)
forall a. SearchM f a model a
forall a. SearchM f a model a -&gt; SearchM f a model [a]
forall a.
SearchM f a model a -&gt; SearchM f a model a -&gt; SearchM f a model a
forall (f :: * -&gt; *).
Applicative f =&gt;
(forall a. f a)
-&gt; (forall a. f a -&gt; f a -&gt; f a)
-&gt; (forall a. f a -&gt; f [a])
-&gt; (forall a. f a -&gt; f [a])
-&gt; Alternative f
forall (f :: * -&gt; *) a model. Applicative (SearchM f a model)
forall (f :: * -&gt; *) a model a. SearchM f a model a
forall (f :: * -&gt; *) a model a.
SearchM f a model a -&gt; SearchM f a model [a]
forall (f :: * -&gt; *) a model a.
SearchM f a model a -&gt; SearchM f a model a -&gt; SearchM f a model a
$cempty :: forall (f :: * -&gt; *) a model a. SearchM f a model a
empty :: forall a. SearchM f a model a
$c&lt;|&gt; :: forall (f :: * -&gt; *) a model a.
SearchM f a model a -&gt; SearchM f a model a -&gt; SearchM f a model a
&lt;|&gt; :: forall a.
SearchM f a model a -&gt; SearchM f a model a -&gt; SearchM f a model a
$csome :: forall (f :: * -&gt; *) a model a.
SearchM f a model a -&gt; SearchM f a model [a]
some :: forall a. SearchM f a model a -&gt; SearchM f a model [a]
$cmany :: forall (f :: * -&gt; *) a model a.
SearchM f a model a -&gt; SearchM f a model [a]
many :: forall a. SearchM f a model a -&gt; SearchM f a model [a]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Alternative</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679069435"><span id="local-6989586621679069441"><span class="annot"><span class="annottext">Monad (SearchM f a model)
Alternative (SearchM f a model)
(Alternative (SearchM f a model), Monad (SearchM f a model)) =&gt;
(forall a. SearchM f a model a)
-&gt; (forall a.
    SearchM f a model a -&gt; SearchM f a model a -&gt; SearchM f a model a)
-&gt; MonadPlus (SearchM f a model)
forall a. SearchM f a model a
forall a.
SearchM f a model a -&gt; SearchM f a model a -&gt; SearchM f a model a
forall (m :: * -&gt; *).
(Alternative m, Monad m) =&gt;
(forall a. m a) -&gt; (forall a. m a -&gt; m a -&gt; m a) -&gt; MonadPlus m
forall (f :: * -&gt; *) a model. Monad (SearchM f a model)
forall (f :: * -&gt; *) a model. Alternative (SearchM f a model)
forall (f :: * -&gt; *) a model a. SearchM f a model a
forall (f :: * -&gt; *) a model a.
SearchM f a model a -&gt; SearchM f a model a -&gt; SearchM f a model a
$cmzero :: forall (f :: * -&gt; *) a model a. SearchM f a model a
mzero :: forall a. SearchM f a model a
$cmplus :: forall (f :: * -&gt; *) a model a.
SearchM f a model a -&gt; SearchM f a model a -&gt; SearchM f a model a
mplus :: forall a.
SearchM f a model a -&gt; SearchM f a model a -&gt; SearchM f a model a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadPlus</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span id="local-6989586621679068924"><span id="local-6989586621679068925"><span id="local-6989586621679068926"><span id="local-6989586621679068927"><span class="annot"><a href="ModelFinder.Solver.html#runSearchM"><span class="hs-identifier hs-type">runSearchM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679068924"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-type">SearchM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068925"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068926"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068924"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068927"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679068927"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679068924"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-77"></span><span id="runSearchM"><span class="annot"><span class="annottext">runSearchM :: forall model (f :: * -&gt; *) a x.
model -&gt; SearchM f a model x -&gt; [(x, model)]
</span><a href="ModelFinder.Solver.html#runSearchM"><span class="hs-identifier hs-var hs-var">runSearchM</span></a></span></span><span> </span><span id="local-6989586621679069453"><span class="annot"><span class="annottext">model
</span><a href="#local-6989586621679069453"><span class="hs-identifier hs-var">m0</span></a></span></span><span> </span><span id="local-6989586621679069454"><span class="annot"><span class="annottext">SearchM f a model x
</span><a href="#local-6989586621679069454"><span class="hs-identifier hs-var">mx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SearchState f a model -&gt; model)
-&gt; (x, SearchState f a model) -&gt; (x, model)
forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">SearchState f a model -&gt; model
forall (f :: * -&gt; *) a model. SearchState f a model -&gt; model
</span><a href="ModelFinder.Solver.html#currentModel"><span class="hs-identifier hs-var">currentModel</span></a></span><span> </span><span class="annot"><span class="annottext">((x, SearchState f a model) -&gt; (x, model))
-&gt; [(x, SearchState f a model)] -&gt; [(x, model)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateT (SearchState f a model) [] x
-&gt; SearchState f a model -&gt; [(x, SearchState f a model)]
forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><span class="hs-identifier hs-var">runStateT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SearchM f a model x -&gt; StateT (SearchState f a model) [] x
forall (f :: * -&gt; *) a model x.
SearchM f a model x -&gt; StateT (SearchState f a model) [] x
</span><a href="ModelFinder.Solver.html#unSearchM"><span class="hs-identifier hs-var">unSearchM</span></a></span><span> </span><span class="annot"><span class="annottext">SearchM f a model x
</span><a href="#local-6989586621679069454"><span class="hs-identifier hs-var">mx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">model -&gt; [(f a, a)] -&gt; SearchState f a model
forall (f :: * -&gt; *) a model.
model -&gt; [(f a, a)] -&gt; SearchState f a model
</span><a href="ModelFinder.Solver.html#SearchState"><span class="hs-identifier hs-var">SearchState</span></a></span><span> </span><span class="annot"><span class="annottext">model
</span><a href="#local-6989586621679069453"><span class="hs-identifier hs-var">m0</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span id="local-6989586621679068943"><span id="local-6989586621679068944"><span id="local-6989586621679068945"><span class="annot"><a href="ModelFinder.Solver.html#choose"><span class="hs-identifier hs-type">choose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679068943"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-type">SearchM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068944"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068943"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068945"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068943"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-80"></span><span id="choose"><span class="annot"><span class="annottext">choose :: forall a (f :: * -&gt; *) model. [a] -&gt; SearchM f a model a
</span><a href="ModelFinder.Solver.html#choose"><span class="hs-identifier hs-var hs-var">choose</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT (SearchState f a model) [] a -&gt; SearchM f a model a
forall (f :: * -&gt; *) a model x.
StateT (SearchState f a model) [] x -&gt; SearchM f a model x
</span><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-var">SearchM</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT (SearchState f a model) [] a -&gt; SearchM f a model a)
-&gt; ([a] -&gt; StateT (SearchState f a model) [] a)
-&gt; [a]
-&gt; SearchM f a model a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; StateT (SearchState f a model) [] a
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; StateT (SearchState f a model) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span id="local-6989586621679068957"><span id="local-6989586621679068958"><span id="local-6989586621679068959"><span id="local-6989586621679068960"><span class="annot"><a href="ModelFinder.Solver.html#maybeToSearch"><span class="hs-identifier hs-type">maybeToSearch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679068957"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-type">SearchM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068958"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068959"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068960"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068957"><span class="hs-identifier hs-type">x</span></a></span></span></span></span></span><span>
</span><span id="line-83"></span><span id="maybeToSearch"><span class="annot"><span class="annottext">maybeToSearch :: forall x (f :: * -&gt; *) a model. Maybe x -&gt; SearchM f a model x
</span><a href="ModelFinder.Solver.html#maybeToSearch"><span class="hs-identifier hs-var hs-var">maybeToSearch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SearchM f a model x
-&gt; (x -&gt; SearchM f a model x) -&gt; Maybe x -&gt; SearchM f a model x
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">SearchM f a model x
forall a. SearchM f a model a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span> </span><span class="annot"><span class="annottext">x -&gt; SearchM f a model x
forall a. a -&gt; SearchM f a model a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span id="local-6989586621679068967"><span id="local-6989586621679068968"><span id="local-6989586621679068969"><span class="annot"><a href="ModelFinder.Solver.html#enterDefsM"><span class="hs-identifier hs-type">enterDefsM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Model.html#Model"><span class="hs-identifier hs-type">Model</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679068967"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068968"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679068968"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068969"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679068967"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068968"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679068968"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-type">SearchM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068967"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068968"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068969"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-86"></span><span id="enterDefsM"><span class="annot"><span class="annottext">enterDefsM :: forall (f :: * -&gt; *) a model.
Model (f a) a model =&gt;
[f a] -&gt; a -&gt; SearchM f a model ()
</span><a href="ModelFinder.Solver.html#enterDefsM"><span class="hs-identifier hs-var hs-var">enterDefsM</span></a></span></span><span> </span><span id="local-6989586621679069474"><span class="annot"><span class="annottext">[f a]
</span><a href="#local-6989586621679069474"><span class="hs-identifier hs-var">fas</span></a></span></span><span> </span><span id="local-6989586621679069475"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069475"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-87"></span><span>  </span><span id="local-6989586621679069476"><span class="annot"><a href="#local-6989586621679069476"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SearchM f a model model
forall (f :: * -&gt; *) a model. SearchM f a model model
</span><a href="ModelFinder.Solver.html#getsModel"><span class="hs-identifier hs-var">getsModel</span></a></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679069478"><span class="annot"><a href="#local-6989586621679069478"><span class="hs-identifier hs-var">m'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679069479"><span class="annot"><a href="#local-6989586621679069479"><span class="hs-identifier hs-var">newDefs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#maybeToSearch"><span class="hs-identifier hs-type">maybeToSearch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="ModelFinder.Model.html#enterDef"><span class="hs-identifier hs-type">enterDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069474"><span class="hs-identifier hs-type">fas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069475"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069476"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-89"></span><span>  </span><span class="annot"><a href="ModelFinder.Solver.html#putModel"><span class="hs-identifier hs-type">putModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069478"><span class="hs-identifier hs-type">m'</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="annot"><a href="ModelFinder.Solver.html#pushWaitingDefs"><span class="hs-identifier hs-type">pushWaitingDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069479"><span class="hs-identifier hs-type">newDefs</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span id="local-6989586621679068990"><span id="local-6989586621679068991"><span id="local-6989586621679068992"><span class="annot"><a href="ModelFinder.Solver.html#enterEqsM"><span class="hs-identifier hs-type">enterEqsM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Model.html#Model"><span class="hs-identifier hs-type">Model</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679068990"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068991"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679068991"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068992"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679068990"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068991"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-type">SearchM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068990"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068991"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068992"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-93"></span><span id="enterEqsM"><span class="annot"><span class="annottext">enterEqsM :: forall (f :: * -&gt; *) a model.
Model (f a) a model =&gt;
[f a] -&gt; SearchM f a model ()
</span><a href="ModelFinder.Solver.html#enterEqsM"><span class="hs-identifier hs-var hs-var">enterEqsM</span></a></span></span><span> </span><span id="local-6989586621679069489"><span class="annot"><span class="annottext">[f a]
</span><a href="#local-6989586621679069489"><span class="hs-identifier hs-var">fas</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-94"></span><span>  </span><span id="local-6989586621679069490"><span class="annot"><a href="#local-6989586621679069490"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SearchM f a model model
forall (f :: * -&gt; *) a model. SearchM f a model model
</span><a href="ModelFinder.Solver.html#getsModel"><span class="hs-identifier hs-var">getsModel</span></a></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679069491"><span class="annot"><a href="#local-6989586621679069491"><span class="hs-identifier hs-var">m'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679069492"><span class="annot"><a href="#local-6989586621679069492"><span class="hs-identifier hs-var">newDefs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#maybeToSearch"><span class="hs-identifier hs-type">maybeToSearch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="ModelFinder.Model.html#enterEqs"><span class="hs-identifier hs-type">enterEqs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069489"><span class="hs-identifier hs-type">fas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069490"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><a href="ModelFinder.Solver.html#putModel"><span class="hs-identifier hs-type">putModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069491"><span class="hs-identifier hs-type">m'</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><a href="ModelFinder.Solver.html#pushWaitingDefs"><span class="hs-identifier hs-type">pushWaitingDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069492"><span class="hs-identifier hs-type">newDefs</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span id="local-6989586621679068974"><span id="local-6989586621679068975"><span id="local-6989586621679068976"><span class="annot"><a href="ModelFinder.Solver.html#getsModel"><span class="hs-identifier hs-type">getsModel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-type">SearchM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068974"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068975"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068976"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068976"><span class="hs-identifier hs-type">model</span></a></span></span></span></span><span>
</span><span id="line-100"></span><span id="getsModel"><span class="annot"><span class="annottext">getsModel :: forall (f :: * -&gt; *) a model. SearchM f a model model
</span><a href="ModelFinder.Solver.html#getsModel"><span class="hs-identifier hs-var hs-var">getsModel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT (SearchState f a model) [] model -&gt; SearchM f a model model
forall (f :: * -&gt; *) a model x.
StateT (SearchState f a model) [] x -&gt; SearchM f a model x
</span><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-var">SearchM</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT (SearchState f a model) [] model
 -&gt; SearchM f a model model)
-&gt; StateT (SearchState f a model) [] model
-&gt; SearchM f a model model
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(SearchState f a model -&gt; model)
-&gt; StateT (SearchState f a model) [] model
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">State.gets</span></span><span> </span><span class="annot"><span class="annottext">SearchState f a model -&gt; model
forall (f :: * -&gt; *) a model. SearchState f a model -&gt; model
</span><a href="ModelFinder.Solver.html#currentModel"><span class="hs-identifier hs-var">currentModel</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span id="local-6989586621679068984"><span id="local-6989586621679068985"><span id="local-6989586621679068986"><span class="annot"><a href="ModelFinder.Solver.html#putModel"><span class="hs-identifier hs-type">putModel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679068984"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-type">SearchM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068985"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068986"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068984"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-103"></span><span id="putModel"><span class="annot"><span class="annottext">putModel :: forall model (f :: * -&gt; *) a. model -&gt; SearchM f a model ()
</span><a href="ModelFinder.Solver.html#putModel"><span class="hs-identifier hs-var hs-var">putModel</span></a></span></span><span> </span><span id="local-6989586621679069500"><span class="annot"><span class="annottext">model
</span><a href="#local-6989586621679069500"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT (SearchState f a model) [] () -&gt; SearchM f a model ()
forall (f :: * -&gt; *) a model x.
StateT (SearchState f a model) [] x -&gt; SearchM f a model x
</span><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-var">SearchM</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT (SearchState f a model) [] () -&gt; SearchM f a model ())
-&gt; StateT (SearchState f a model) [] () -&gt; SearchM f a model ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(SearchState f a model -&gt; SearchState f a model)
-&gt; StateT (SearchState f a model) [] ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="annot"><span class="annottext">((SearchState f a model -&gt; SearchState f a model)
 -&gt; StateT (SearchState f a model) [] ())
-&gt; (SearchState f a model -&gt; SearchState f a model)
-&gt; StateT (SearchState f a model) [] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679069502"><span class="annot"><span class="annottext">SearchState f a model
</span><a href="#local-6989586621679069502"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SearchState f a model
</span><a href="#local-6989586621679069502"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#currentModel"><span class="hs-identifier hs-var">currentModel</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679069500"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span id="local-6989586621679068987"><span id="local-6989586621679068988"><span id="local-6989586621679068989"><span class="annot"><a href="ModelFinder.Solver.html#pushWaitingDefs"><span class="hs-identifier hs-type">pushWaitingDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679068987"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068988"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679068988"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-type">SearchM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068987"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068988"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068989"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-106"></span><span id="pushWaitingDefs"><span class="annot"><span class="annottext">pushWaitingDefs :: forall (f :: * -&gt; *) a model. [(f a, a)] -&gt; SearchM f a model ()
</span><a href="ModelFinder.Solver.html#pushWaitingDefs"><span class="hs-identifier hs-var hs-var">pushWaitingDefs</span></a></span></span><span> </span><span id="local-6989586621679069505"><span class="annot"><span class="annottext">[(f a, a)]
</span><a href="#local-6989586621679069505"><span class="hs-identifier hs-var">newDefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT (SearchState f a model) [] () -&gt; SearchM f a model ()
forall (f :: * -&gt; *) a model x.
StateT (SearchState f a model) [] x -&gt; SearchM f a model x
</span><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-var">SearchM</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT (SearchState f a model) [] () -&gt; SearchM f a model ())
-&gt; StateT (SearchState f a model) [] () -&gt; SearchM f a model ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(SearchState f a model -&gt; SearchState f a model)
-&gt; StateT (SearchState f a model) [] ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="annot"><span class="annottext">((SearchState f a model -&gt; SearchState f a model)
 -&gt; StateT (SearchState f a model) [] ())
-&gt; (SearchState f a model -&gt; SearchState f a model)
-&gt; StateT (SearchState f a model) [] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679069506"><span class="annot"><span class="annottext">SearchState f a model
</span><a href="#local-6989586621679069506"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><span class="annottext">SearchState f a model
</span><a href="#local-6989586621679069506"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#waitingDefs"><span class="hs-identifier hs-var">waitingDefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679069505"><span class="hs-identifier hs-type">newDefs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#waitingDefs"><span class="hs-identifier hs-var">waitingDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069506"><span class="hs-identifier hs-type">ss</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- Gets all waitingDefs and remove them from the state</span><span>
</span><span id="line-110"></span><span id="local-6989586621679069014"><span id="local-6989586621679069015"><span id="local-6989586621679069016"><span class="annot"><a href="ModelFinder.Solver.html#takeAllWaitingDefs"><span class="hs-identifier hs-type">takeAllWaitingDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-type">SearchM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069014"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069015"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069016"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069014"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069015"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679069015"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-111"></span><span id="takeAllWaitingDefs"><span class="annot"><span class="annottext">takeAllWaitingDefs :: forall (f :: * -&gt; *) a model. SearchM f a model [(f a, a)]
</span><a href="ModelFinder.Solver.html#takeAllWaitingDefs"><span class="hs-identifier hs-var hs-var">takeAllWaitingDefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT (SearchState f a model) [] [(f a, a)]
-&gt; SearchM f a model [(f a, a)]
forall (f :: * -&gt; *) a model x.
StateT (SearchState f a model) [] x -&gt; SearchM f a model x
</span><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-var">SearchM</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT (SearchState f a model) [] [(f a, a)]
 -&gt; SearchM f a model [(f a, a)])
-&gt; StateT (SearchState f a model) [] [(f a, a)]
-&gt; SearchM f a model [(f a, a)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(SearchState f a model -&gt; ([(f a, a)], SearchState f a model))
-&gt; StateT (SearchState f a model) [] [(f a, a)]
forall a.
(SearchState f a model -&gt; (a, SearchState f a model))
-&gt; StateT (SearchState f a model) [] a
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; (a, s)) -&gt; m a
</span><span class="hs-identifier hs-var">State.state</span></span><span> </span><span class="annot"><span class="annottext">((SearchState f a model -&gt; ([(f a, a)], SearchState f a model))
 -&gt; StateT (SearchState f a model) [] [(f a, a)])
-&gt; (SearchState f a model -&gt; ([(f a, a)], SearchState f a model))
-&gt; StateT (SearchState f a model) [] [(f a, a)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679069511"><span class="annot"><span class="annottext">SearchState f a model
</span><a href="#local-6989586621679069511"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SearchState f a model -&gt; [(f a, a)]
forall (f :: * -&gt; *) a model. SearchState f a model -&gt; [(f a, a)]
</span><a href="ModelFinder.Solver.html#waitingDefs"><span class="hs-identifier hs-var">waitingDefs</span></a></span><span> </span><span class="annot"><span class="annottext">SearchState f a model
</span><a href="#local-6989586621679069511"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SearchState f a model
</span><a href="#local-6989586621679069511"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#waitingDefs"><span class="hs-identifier hs-var">waitingDefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679069032"><span id="local-6989586621679069033"><span id="local-6989586621679069034"><span id="local-6989586621679069524"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679069032"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069033"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069032"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679069033"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Model.html#Model"><span class="hs-identifier hs-type">Model</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069033"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069032"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679069032"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069034"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AnalysisM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-type">SearchM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069033"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069032"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069034"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Solver.html#ModelInfo"><span class="hs-identifier hs-type">ModelInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069033"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069032"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Term.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069033"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069032"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">makeA</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Term.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069033"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069032"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Solver.html#ModelInfo"><span class="hs-identifier hs-type">ModelInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069033"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069032"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-type">SearchM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069033"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069032"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069034"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Solver.html#ModelInfo"><span class="hs-identifier hs-type">ModelInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069033"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069032"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>  </span><span id="local-6989586621679069534"><span class="annot"><span class="annottext">makeA :: L f a (ModelInfo f a) -&gt; SearchM f a model (ModelInfo f a)
</span><span class="hs-identifier hs-var hs-var hs-var">makeA</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Term.html#Con"><span class="hs-identifier hs-type">Con</span></a></span><span> </span><span id="local-6989586621679069536"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069536"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelInfo f a -&gt; SearchM f a model (ModelInfo f a)
forall a. a -&gt; SearchM f a model a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ModelInfo f a -&gt; SearchM f a model (ModelInfo f a))
-&gt; ModelInfo f a -&gt; SearchM f a model (ModelInfo f a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Set (f a) -&gt; ModelInfo f a
forall (f :: * -&gt; *) a. Maybe a -&gt; Set (f a) -&gt; ModelInfo f a
</span><a href="ModelFinder.Solver.html#ModelInfo"><span class="hs-identifier hs-var">ModelInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069536"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set (f a)
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">makeA</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Term.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679069539"><span class="annot"><span class="annottext">f (ModelInfo f a)
</span><a href="#local-6989586621679069539"><span class="hs-identifier hs-var">fm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelInfo f a -&gt; SearchM f a model (ModelInfo f a)
forall a. a -&gt; SearchM f a model a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ModelInfo f a -&gt; SearchM f a model (ModelInfo f a))
-&gt; ModelInfo f a -&gt; SearchM f a model (ModelInfo f a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Set (f a) -&gt; ModelInfo f a
forall (f :: * -&gt; *) a. Maybe a -&gt; Set (f a) -&gt; ModelInfo f a
</span><a href="ModelFinder.Solver.html#ModelInfo"><span class="hs-identifier hs-var">ModelInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069540"><span class="hs-identifier hs-var">fnSet</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-119"></span><span>      </span><span id="local-6989586621679069540"><span class="annot"><span class="annottext">fnSet :: Set (f a)
</span><a href="#local-6989586621679069540"><span class="hs-identifier hs-var hs-var">fnSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (f a) -&gt; (f a -&gt; Set (f a)) -&gt; Maybe (f a) -&gt; Set (f a)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Set (f a)
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">f a -&gt; Set (f a)
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (f a) -&gt; Set (f a)) -&gt; Maybe (f a) -&gt; Set (f a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ModelInfo f a -&gt; Maybe a) -&gt; f (ModelInfo f a) -&gt; Maybe (f a)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; f a -&gt; f (f b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">ModelInfo f a -&gt; Maybe a
forall (f :: * -&gt; *) a. ModelInfo f a -&gt; Maybe a
</span><a href="ModelFinder.Solver.html#constValue"><span class="hs-identifier hs-var">constValue</span></a></span><span> </span><span class="annot"><span class="annottext">f (ModelInfo f a)
</span><a href="#local-6989586621679069539"><span class="hs-identifier hs-var">fm</span></a></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">joinA</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#ModelInfo"><span class="hs-identifier hs-type">ModelInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069033"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069032"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#ModelInfo"><span class="hs-identifier hs-type">ModelInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069033"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069032"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-type">SearchM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069033"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069032"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069034"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Solver.html#ModelInfo"><span class="hs-identifier hs-type">ModelInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069033"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069032"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>  </span><span id="local-6989586621679069558"><span class="annot"><span class="annottext">joinA :: ModelInfo f a -&gt; ModelInfo f a -&gt; SearchM f a model (ModelInfo f a)
</span><span class="hs-identifier hs-var hs-var hs-var">joinA</span></span></span><span> </span><span id="local-6989586621679069559"><span class="annot"><span class="annottext">ModelInfo f a
</span><a href="#local-6989586621679069559"><span class="hs-identifier hs-var">d1</span></a></span></span><span> </span><span id="local-6989586621679069560"><span class="annot"><span class="annottext">ModelInfo f a
</span><a href="#local-6989586621679069560"><span class="hs-identifier hs-var">d2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679069561"><span class="hs-identifier hs-var">con1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679069562"><span class="hs-identifier hs-var">con2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-124"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679069563"><span class="annot"><span class="annottext">eqn :: [f a]
</span><a href="#local-6989586621679069563"><span class="hs-identifier hs-var hs-var hs-var">eqn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [f a] -&gt; [f a]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set (f a) -&gt; [f a]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069566"><span class="hs-identifier hs-var">fun1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[f a] -&gt; [f a] -&gt; [f a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [f a] -&gt; [f a]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set (f a) -&gt; [f a]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069567"><span class="hs-identifier hs-var">fun2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>      </span><span class="annot"><span class="annottext">[f a] -&gt; SearchM f a model ()
forall (f :: * -&gt; *) a model.
Model (f a) a model =&gt;
[f a] -&gt; SearchM f a model ()
</span><a href="ModelFinder.Solver.html#enterEqsM"><span class="hs-identifier hs-var">enterEqsM</span></a></span><span> </span><span class="annot"><span class="annottext">[f a]
</span><a href="#local-6989586621679069563"><span class="hs-identifier hs-var">eqn</span></a></span><span>
</span><span id="line-126"></span><span>      </span><span class="annot"><span class="annottext">ModelInfo f a -&gt; SearchM f a model (ModelInfo f a)
forall a. a -&gt; SearchM f a model a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ModelInfo f a -&gt; SearchM f a model (ModelInfo f a))
-&gt; ModelInfo f a -&gt; SearchM f a model (ModelInfo f a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Set (f a) -&gt; ModelInfo f a
forall (f :: * -&gt; *) a. Maybe a -&gt; Set (f a) -&gt; ModelInfo f a
</span><a href="ModelFinder.Solver.html#ModelInfo"><span class="hs-identifier hs-var">ModelInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069568"><span class="hs-identifier hs-var">fun'</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679069569"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069569"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-128"></span><span>      </span><span class="annot"><span class="annottext">[f a] -&gt; a -&gt; SearchM f a model ()
forall (f :: * -&gt; *) a model.
Model (f a) a model =&gt;
[f a] -&gt; a -&gt; SearchM f a model ()
</span><a href="ModelFinder.Solver.html#enterDefsM"><span class="hs-identifier hs-var">enterDefsM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set (f a) -&gt; [f a]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069566"><span class="hs-identifier hs-var">fun1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069569"><span class="hs-identifier hs-var">a2</span></a></span><span>
</span><span id="line-129"></span><span>      </span><span class="annot"><span class="annottext">ModelInfo f a -&gt; SearchM f a model (ModelInfo f a)
forall a. a -&gt; SearchM f a model a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ModelInfo f a -&gt; SearchM f a model (ModelInfo f a))
-&gt; ModelInfo f a -&gt; SearchM f a model (ModelInfo f a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Set (f a) -&gt; ModelInfo f a
forall (f :: * -&gt; *) a. Maybe a -&gt; Set (f a) -&gt; ModelInfo f a
</span><a href="ModelFinder.Solver.html#ModelInfo"><span class="hs-identifier hs-var">ModelInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069569"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069568"><span class="hs-identifier hs-var">fun'</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679069570"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069570"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-131"></span><span>      </span><span class="annot"><span class="annottext">[f a] -&gt; a -&gt; SearchM f a model ()
forall (f :: * -&gt; *) a model.
Model (f a) a model =&gt;
[f a] -&gt; a -&gt; SearchM f a model ()
</span><a href="ModelFinder.Solver.html#enterDefsM"><span class="hs-identifier hs-var">enterDefsM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set (f a) -&gt; [f a]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069567"><span class="hs-identifier hs-var">fun2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069570"><span class="hs-identifier hs-var">a1</span></a></span><span>
</span><span id="line-132"></span><span>      </span><span class="annot"><span class="annottext">ModelInfo f a -&gt; SearchM f a model (ModelInfo f a)
forall a. a -&gt; SearchM f a model a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ModelInfo f a -&gt; SearchM f a model (ModelInfo f a))
-&gt; ModelInfo f a -&gt; SearchM f a model (ModelInfo f a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Set (f a) -&gt; ModelInfo f a
forall (f :: * -&gt; *) a. Maybe a -&gt; Set (f a) -&gt; ModelInfo f a
</span><a href="ModelFinder.Solver.html#ModelInfo"><span class="hs-identifier hs-var">ModelInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069570"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069568"><span class="hs-identifier hs-var">fun'</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679069571"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069571"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679069572"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069572"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-134"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; SearchM f a model ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069571"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069572"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>      </span><span class="annot"><span class="annottext">ModelInfo f a -&gt; SearchM f a model (ModelInfo f a)
forall a. a -&gt; SearchM f a model a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ModelInfo f a -&gt; SearchM f a model (ModelInfo f a))
-&gt; ModelInfo f a -&gt; SearchM f a model (ModelInfo f a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Set (f a) -&gt; ModelInfo f a
forall (f :: * -&gt; *) a. Maybe a -&gt; Set (f a) -&gt; ModelInfo f a
</span><a href="ModelFinder.Solver.html#ModelInfo"><span class="hs-identifier hs-var">ModelInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069571"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069568"><span class="hs-identifier hs-var">fun'</span></a></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-137"></span><span>      </span><span class="annot"><a href="ModelFinder.Solver.html#ModelInfo"><span class="hs-identifier hs-type">ModelInfo</span></a></span><span> </span><span id="local-6989586621679069561"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679069561"><span class="hs-identifier hs-var">con1</span></a></span></span><span> </span><span id="local-6989586621679069566"><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069566"><span class="hs-identifier hs-var">fun1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelInfo f a
</span><a href="#local-6989586621679069559"><span class="hs-identifier hs-var">d1</span></a></span><span>
</span><span id="line-138"></span><span>      </span><span class="annot"><a href="ModelFinder.Solver.html#ModelInfo"><span class="hs-identifier hs-type">ModelInfo</span></a></span><span> </span><span id="local-6989586621679069562"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679069562"><span class="hs-identifier hs-var">con2</span></a></span></span><span> </span><span id="local-6989586621679069567"><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069567"><span class="hs-identifier hs-var">fun2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelInfo f a
</span><a href="#local-6989586621679069560"><span class="hs-identifier hs-var">d2</span></a></span><span>
</span><span id="line-139"></span><span>      </span><span id="local-6989586621679069568"><span class="annot"><span class="annottext">fun' :: Set (f a)
</span><a href="#local-6989586621679069568"><span class="hs-identifier hs-var hs-var">fun'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (f a) -&gt; Set (f a) -&gt; Set (f a)
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span> </span><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069566"><span class="hs-identifier hs-var">fun1</span></a></span><span> </span><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069567"><span class="hs-identifier hs-var">fun2</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-comment">{-
  -- | We don't need custom modifyA because of the assumption
  -- 
  -- - equations contain every &quot;constant function call&quot;
  --
  -- and any node eventually became &quot;constant function call&quot; will be
  -- simultaneously merged with a class containing that
  -- constant function call.
  modifyA _ = pure
  -}</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="annot"><span class="hs-comment">-- * Model search algorithm</span></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span id="local-6989586621679069045"><span id="local-6989586621679069046"><span id="local-6989586621679069048"><span class="annot"><a href="ModelFinder.Solver.html#solve"><span class="hs-identifier hs-type">solve</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679069045"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Language</span></span><span> </span><span class="annot"><a href="#local-6989586621679069046"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Model.html#Model"><span class="hs-identifier hs-type">Model</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069046"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069045"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679069045"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069048"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679069045"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ModelFinder.Term.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069046"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069046"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069045"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679069045"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069048"><span class="hs-identifier hs-type">model</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679069048"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-160"></span><span id="solve"><span class="annot"><span class="annottext">solve :: forall a (f :: * -&gt; *) model.
(Ord a, Language f, Model (f a) a model) =&gt;
[a] -&gt; [Property f] -&gt; Map (f a) a -&gt; model -&gt; [model]
</span><a href="ModelFinder.Solver.html#solve"><span class="hs-identifier hs-var hs-var">solve</span></a></span></span><span> </span><span id="local-6989586621679069581"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679069581"><span class="hs-identifier hs-var">univ</span></a></span></span><span> </span><span id="local-6989586621679069582"><span class="annot"><span class="annottext">[Property f]
</span><a href="#local-6989586621679069582"><span class="hs-identifier hs-var">props</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Term f a, Term f a)] -&gt; Map (f a) a -&gt; model -&gt; [model]
forall a (f :: * -&gt; *) model.
(Ord a, Language f, Model (f a) a model) =&gt;
[(Term f a, Term f a)] -&gt; Map (f a) a -&gt; model -&gt; [model]
</span><a href="ModelFinder.Solver.html#solveEqs"><span class="hs-identifier hs-var">solveEqs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Term f a, Term f a)]
</span><a href="#local-6989586621679069583"><span class="hs-identifier hs-var">eqs</span></a></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-162"></span><span>    </span><span id="local-6989586621679069583"><span class="annot"><span class="annottext">eqs :: [(Term f a, Term f a)]
</span><a href="#local-6989586621679069583"><span class="hs-identifier hs-var hs-var">eqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Property f]
</span><a href="#local-6989586621679069582"><span class="hs-identifier hs-var">props</span></a></span><span> </span><span class="annot"><span class="annottext">[Property f]
-&gt; (Property f -&gt; [(Term f a, Term f a)]) -&gt; [(Term f a, Term f a)]
forall a b. [a] -&gt; (a -&gt; [b]) -&gt; [b]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Property f -&gt; [(Term f a, Term f a)]
forall a (f :: * -&gt; *). [a] -&gt; Property f -&gt; [(Term f a, Term f a)]
</span><a href="ModelFinder.Term.html#runProperty"><span class="hs-identifier hs-var">runProperty</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679069581"><span class="hs-identifier hs-var">univ</span></a></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span id="local-6989586621679069055"><span id="local-6989586621679069056"><span id="local-6989586621679069057"><span class="annot"><a href="ModelFinder.Solver.html#solveEqs"><span class="hs-identifier hs-type">solveEqs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679069055"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Language</span></span><span> </span><span class="annot"><a href="#local-6989586621679069056"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Model.html#Model"><span class="hs-identifier hs-type">Model</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069056"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069055"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679069055"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069057"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Term.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069056"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069055"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Term.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069056"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069055"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069056"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069055"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679069055"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069057"><span class="hs-identifier hs-type">model</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679069057"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-169"></span><span id="solveEqs"><span class="annot"><span class="annottext">solveEqs :: forall a (f :: * -&gt; *) model.
(Ord a, Language f, Model (f a) a model) =&gt;
[(Term f a, Term f a)] -&gt; Map (f a) a -&gt; model -&gt; [model]
</span><a href="ModelFinder.Solver.html#solveEqs"><span class="hs-identifier hs-var hs-var">solveEqs</span></a></span></span><span> </span><span id="local-6989586621679069591"><span class="annot"><span class="annottext">[(Term f a, Term f a)]
</span><a href="#local-6989586621679069591"><span class="hs-identifier hs-var">eqs</span></a></span></span><span> </span><span id="local-6989586621679069592"><span class="annot"><span class="annottext">Map (f a) a
</span><a href="#local-6989586621679069592"><span class="hs-identifier hs-var">knownDefs</span></a></span></span><span> </span><span id="local-6989586621679069593"><span class="annot"><span class="annottext">model
</span><a href="#local-6989586621679069593"><span class="hs-identifier hs-var">model0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((), model) -&gt; model
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(((), model) -&gt; model) -&gt; [((), model)] -&gt; [model]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">model -&gt; SearchM f a model () -&gt; [((), model)]
forall model (f :: * -&gt; *) a x.
model -&gt; SearchM f a model x -&gt; [(x, model)]
</span><a href="ModelFinder.Solver.html#runSearchM"><span class="hs-identifier hs-var">runSearchM</span></a></span><span> </span><span class="annot"><span class="annottext">model
</span><a href="#local-6989586621679069593"><span class="hs-identifier hs-var">model0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Term f a, Term f a)] -&gt; Map (f a) a -&gt; SearchM f a model ()
forall a (f :: * -&gt; *) model.
(Ord a, Language f, Model (f a) a model) =&gt;
[(Term f a, Term f a)] -&gt; Map (f a) a -&gt; SearchM f a model ()
</span><a href="ModelFinder.Solver.html#solveBody"><span class="hs-identifier hs-var">solveBody</span></a></span><span> </span><span class="annot"><span class="annottext">[(Term f a, Term f a)]
</span><a href="#local-6989586621679069591"><span class="hs-identifier hs-var">eqs</span></a></span><span> </span><span class="annot"><span class="annottext">Map (f a) a
</span><a href="#local-6989586621679069592"><span class="hs-identifier hs-var">knownDefs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- Shorthand</span><span>
</span><span id="line-172"></span><span class="hs-keyword">type</span><span> </span><span id="EG"><span class="annot"><a href="ModelFinder.Solver.html#EG"><span class="hs-identifier hs-var">EG</span></a></span></span><span> </span><span id="local-6989586621679069596"><span class="annot"><a href="#local-6989586621679069596"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679069597"><span class="annot"><a href="#local-6989586621679069597"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EGraph</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Solver.html#ModelInfo"><span class="hs-identifier hs-type">ModelInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069596"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069597"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Term.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069596"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069597"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="annot"><a href="ModelFinder.Solver.html#solveBody"><span class="hs-identifier hs-type">solveBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679069065"><span class="annot"><a href="#local-6989586621679069065"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679069066"><span class="annot"><a href="#local-6989586621679069066"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679069067"><span class="annot"><a href="#local-6989586621679069067"><span class="hs-identifier hs-type">model</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679069065"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Language</span></span><span> </span><span class="annot"><a href="#local-6989586621679069066"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Model.html#Model"><span class="hs-identifier hs-type">Model</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069066"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069065"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679069065"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069067"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Term.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069066"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069065"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Term.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069066"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069065"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069066"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069065"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679069065"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-type">SearchM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069066"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069065"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069067"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span id="solveBody"><span class="annot"><span class="annottext">solveBody :: forall a (f :: * -&gt; *) model.
(Ord a, Language f, Model (f a) a model) =&gt;
[(Term f a, Term f a)] -&gt; Map (f a) a -&gt; SearchM f a model ()
</span><a href="ModelFinder.Solver.html#solveBody"><span class="hs-identifier hs-var hs-var">solveBody</span></a></span></span><span> </span><span id="local-6989586621679069620"><span class="annot"><span class="annottext">[(Term f a, Term f a)]
</span><a href="#local-6989586621679069620"><span class="hs-identifier hs-var">eqs</span></a></span></span><span> </span><span id="local-6989586621679069621"><span class="annot"><span class="annottext">Map (f a) a
</span><a href="#local-6989586621679069621"><span class="hs-identifier hs-var">knownDefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-179"></span><span>  </span><span id="local-6989586621679069622"><span class="annot"><a href="#local-6989586621679069622"><span class="hs-identifier hs-var">eg1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Term f a, Term f a)] -&gt; Map (f a) a -&gt; SearchM f a model (EG f a)
forall a (f :: * -&gt; *) model.
(Ord a, Language f, Model (f a) a model) =&gt;
[(Term f a, Term f a)] -&gt; Map (f a) a -&gt; SearchM f a model (EG f a)
</span><a href="ModelFinder.Solver.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">[(Term f a, Term f a)]
</span><a href="#local-6989586621679069620"><span class="hs-identifier hs-var">eqs</span></a></span><span> </span><span class="annot"><span class="annottext">Map (f a) a
</span><a href="#local-6989586621679069621"><span class="hs-identifier hs-var">knownDefs</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span class="annot"><a href="#local-6989586621679069624"><span class="hs-identifier hs-type">loop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069622"><span class="hs-identifier hs-type">eg1</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><a href="#local-6989586621679069624"><span class="hs-identifier hs-type">loop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#EG"><span class="hs-identifier hs-type">EG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069066"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069065"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-type">SearchM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069066"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069065"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069067"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621679069624"><span class="annot"><span class="annottext">loop :: EG f a -&gt; SearchM f a model ()
</span><a href="#local-6989586621679069624"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679069625"><span class="annot"><span class="annottext">EG f a
</span><a href="#local-6989586621679069625"><span class="hs-identifier hs-var">eg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">EG f a -&gt; [f a]
forall a (f :: * -&gt; *). (Ord a, Language f) =&gt; EG f a -&gt; [f a]
</span><a href="ModelFinder.Solver.html#whatToGuess"><span class="hs-identifier hs-var">whatToGuess</span></a></span><span> </span><span class="annot"><span class="annottext">EG f a
</span><a href="#local-6989586621679069625"><span class="hs-identifier hs-var">eg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-184"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; SearchM f a model ()
forall a. a -&gt; SearchM f a model a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679069627"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679069627"><span class="hs-identifier hs-var">fa</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[f a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-186"></span><span>        </span><span id="local-6989586621679069628"><span class="annot"><a href="#local-6989586621679069628"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SearchM f a model model
forall (f :: * -&gt; *) a model. SearchM f a model model
</span><a href="ModelFinder.Solver.html#getsModel"><span class="hs-identifier hs-var">getsModel</span></a></span><span>
</span><span id="line-187"></span><span>        </span><span id="local-6989586621679069629"><span class="annot"><a href="#local-6989586621679069629"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#choose"><span class="hs-identifier hs-type">choose</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="ModelFinder.Model.html#guess"><span class="hs-identifier hs-type">guess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069627"><span class="hs-identifier hs-type">fa</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069628"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-188"></span><span>        </span><span id="local-6989586621679069631"><span class="annot"><a href="#local-6989586621679069631"><span class="hs-identifier hs-var">eg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#syncLoop"><span class="hs-identifier hs-type">syncLoop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069625"><span class="hs-identifier hs-type">eg</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ModelFinder.Solver.html#defToEq"><span class="hs-identifier hs-type">defToEq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069627"><span class="hs-identifier hs-type">fa</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679069629"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><a href="#local-6989586621679069624"><span class="hs-identifier hs-type">loop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069631"><span class="hs-identifier hs-type">eg'</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span id="local-6989586621679069073"><span id="local-6989586621679069074"><span id="local-6989586621679069075"><span class="annot"><a href="ModelFinder.Solver.html#initialize"><span class="hs-identifier hs-type">initialize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679069073"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Language</span></span><span> </span><span class="annot"><a href="#local-6989586621679069074"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Model.html#Model"><span class="hs-identifier hs-type">Model</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069074"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069073"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679069073"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069075"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Term.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069074"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069073"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Term.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069074"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069073"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069074"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069073"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679069073"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-type">SearchM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069074"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069073"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069075"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Solver.html#EG"><span class="hs-identifier hs-type">EG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069074"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069073"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-195"></span><span id="initialize"><span class="annot"><span class="annottext">initialize :: forall a (f :: * -&gt; *) model.
(Ord a, Language f, Model (f a) a model) =&gt;
[(Term f a, Term f a)] -&gt; Map (f a) a -&gt; SearchM f a model (EG f a)
</span><a href="ModelFinder.Solver.html#initialize"><span class="hs-identifier hs-var hs-var">initialize</span></a></span></span><span> </span><span id="local-6989586621679069662"><span class="annot"><span class="annottext">[(Term f a, Term f a)]
</span><a href="#local-6989586621679069662"><span class="hs-identifier hs-var">eqs</span></a></span></span><span> </span><span id="local-6989586621679069663"><span class="annot"><span class="annottext">Map (f a) a
</span><a href="#local-6989586621679069663"><span class="hs-identifier hs-var">knownDefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-196"></span><span>  </span><span id="local-6989586621679069664"><span class="annot"><a href="#local-6989586621679069664"><span class="hs-identifier hs-var">model0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SearchM f a model model
forall (f :: * -&gt; *) a model. SearchM f a model model
</span><a href="ModelFinder.Solver.html#getsModel"><span class="hs-identifier hs-var">getsModel</span></a></span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679069665"><span class="annot"><a href="#local-6989586621679069665"><span class="hs-identifier hs-var">newDefs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679069666"><span class="annot"><a href="#local-6989586621679069666"><span class="hs-identifier hs-var">model1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#maybeToSearch"><span class="hs-identifier hs-type">maybeToSearch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#updateModelDefs"><span class="hs-identifier hs-type">updateModelDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069664"><span class="hs-identifier hs-type">model0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069668"><span class="hs-identifier hs-type">knownEntries</span></a></span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><a href="ModelFinder.Solver.html#putModel"><span class="hs-identifier hs-type">putModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069666"><span class="hs-identifier hs-type">model1</span></a></span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679069669"><span class="annot"><a href="#local-6989586621679069669"><span class="hs-identifier hs-var hs-var">defs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (f a) a -&gt; Map (f a) a -&gt; Map (f a) a
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.union</span></span><span> </span><span class="annot"><span class="annottext">Map (f a) a
</span><a href="#local-6989586621679069665"><span class="hs-identifier hs-var">newDefs</span></a></span><span> </span><span class="annot"><span class="annottext">Map (f a) a
</span><a href="#local-6989586621679069663"><span class="hs-identifier hs-var">knownDefs</span></a></span><span>
</span><span id="line-200"></span><span>  </span><span id="local-6989586621679069671"><span class="annot"><a href="#local-6989586621679069671"><span class="hs-identifier hs-var">eg1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#equateDefs"><span class="hs-identifier hs-type">equateDefs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.toList</span></span><span> </span><span class="annot"><a href="#local-6989586621679069669"><span class="hs-identifier hs-type">defs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">emptyEGraph</span></span><span>
</span><span id="line-201"></span><span>  </span><span class="annot"><a href="ModelFinder.Solver.html#syncLoop"><span class="hs-identifier hs-type">syncLoop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069671"><span class="hs-identifier hs-type">eg1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069662"><span class="hs-identifier hs-type">eqs</span></a></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-203"></span><span>    </span><span id="local-6989586621679069675"><span class="annot"><span class="annottext">transposedDefs :: Map a (Set (f a))
</span><a href="#local-6989586621679069675"><span class="hs-identifier hs-var hs-var">transposedDefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (f a) a -&gt; Map a (Set (f a))
forall a b. (Ord a, Ord b) =&gt; Map a b -&gt; Map b (Set a)
</span><a href="ModelFinder.Solver.html#transposeMap"><span class="hs-identifier hs-var">transposeMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map (f a) a
</span><a href="#local-6989586621679069663"><span class="hs-identifier hs-var">knownDefs</span></a></span><span>
</span><span id="line-204"></span><span>    </span><span id="local-6989586621679069668"><span class="annot"><span class="annottext">knownEntries :: [(Set (f a), Maybe a)]
</span><a href="#local-6989586621679069668"><span class="hs-identifier hs-var hs-var">knownEntries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679069677"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069677"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679069678"><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069678"><span class="hs-identifier hs-var">fas</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069678"><span class="hs-identifier hs-var">fas</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069677"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((a, Set (f a)) -&gt; (Set (f a), Maybe a))
-&gt; [(a, Set (f a))] -&gt; [(Set (f a), Maybe a)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Map a (Set (f a)) -&gt; [(a, Set (f a))]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map a (Set (f a))
</span><a href="#local-6989586621679069675"><span class="hs-identifier hs-var">transposedDefs</span></a></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span id="local-6989586621679069091"><span id="local-6989586621679069092"><span id="local-6989586621679069093"><span class="annot"><a href="ModelFinder.Solver.html#updateModelDefs"><span class="hs-identifier hs-type">updateModelDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679069091"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Language</span></span><span> </span><span class="annot"><a href="#local-6989586621679069092"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Model.html#Model"><span class="hs-identifier hs-type">Model</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069092"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069091"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679069091"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069093"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069093"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069092"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069091"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679069091"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069092"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069091"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679069091"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679069093"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-208"></span><span id="updateModelDefs"><span class="annot"><span class="annottext">updateModelDefs :: forall a (f :: * -&gt; *) model.
(Ord a, Language f, Model (f a) a model) =&gt;
model -&gt; [(Set (f a), Maybe a)] -&gt; Maybe (Map (f a) a, model)
</span><a href="ModelFinder.Solver.html#updateModelDefs"><span class="hs-identifier hs-var hs-var">updateModelDefs</span></a></span></span><span> </span><span id="local-6989586621679069696"><span class="annot"><span class="annottext">model
</span><a href="#local-6989586621679069696"><span class="hs-identifier hs-var">m0</span></a></span></span><span> </span><span id="local-6989586621679069697"><span class="annot"><span class="annottext">[(Set (f a), Maybe a)]
</span><a href="#local-6989586621679069697"><span class="hs-identifier hs-var">entries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">model
-&gt; [[(f a, a)]]
-&gt; [(Set (f a), Maybe a)]
-&gt; Maybe (Map (f a) a, model)
</span><a href="#local-6989586621679069698"><span class="hs-identifier hs-var">loopKnown</span></a></span><span> </span><span class="annot"><span class="annottext">model
</span><a href="#local-6989586621679069696"><span class="hs-identifier hs-var">m0</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Set (f a), Maybe a)]
</span><a href="#local-6989586621679069697"><span class="hs-identifier hs-var">entries</span></a></span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-210"></span><span>    </span><span id="local-6989586621679069699"><span class="annot"><span class="annottext">alreadyKnownDefs :: Set (f a)
</span><a href="#local-6989586621679069699"><span class="hs-identifier hs-var hs-var">alreadyKnownDefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Set (f a)] -&gt; Set (f a)
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><span class="hs-identifier hs-var">Set.unions</span></span><span>
</span><span id="line-211"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069701"><span class="hs-identifier hs-var">fas</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679069701"><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069701"><span class="hs-identifier hs-var">fas</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Set (f a), Maybe a)]
</span><a href="#local-6989586621679069697"><span class="hs-identifier hs-var">entries</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-212"></span><span>    </span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621679069698"><span class="annot"><span class="annottext">loopKnown :: model
-&gt; [[(f a, a)]]
-&gt; [(Set (f a), Maybe a)]
-&gt; Maybe (Map (f a) a, model)
</span><a href="#local-6989586621679069698"><span class="hs-identifier hs-var hs-var">loopKnown</span></a></span></span><span> </span><span id="local-6989586621679069702"><span class="annot"><span class="annottext">model
</span><a href="#local-6989586621679069702"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679069703"><span class="annot"><span class="annottext">[[(f a, a)]]
</span><a href="#local-6989586621679069703"><span class="hs-identifier hs-var">next</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">model -&gt; [(f a, a)] -&gt; [(f a, a)] -&gt; Maybe (Map (f a) a, model)
</span><a href="#local-6989586621679069704"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">model
</span><a href="#local-6989586621679069702"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[(f a, a)]] -&gt; [(f a, a)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[(f a, a)]]
</span><a href="#local-6989586621679069703"><span class="hs-identifier hs-var">next</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><a href="#local-6989586621679069698"><span class="hs-identifier hs-var">loopKnown</span></a></span><span> </span><span id="local-6989586621679069706"><span class="annot"><span class="annottext">model
</span><a href="#local-6989586621679069706"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679069707"><span class="annot"><span class="annottext">[[(f a, a)]]
</span><a href="#local-6989586621679069707"><span class="hs-identifier hs-var">next</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679069708"><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069708"><span class="hs-identifier hs-var">fas</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679069709"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679069709"><span class="hs-identifier hs-var">ma</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679069710"><span class="annot"><span class="annottext">[(Set (f a), Maybe a)]
</span><a href="#local-6989586621679069710"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-215"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679069711"><span class="annot"><a href="#local-6989586621679069711"><span class="hs-identifier hs-var">m'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679069712"><span class="annot"><a href="#local-6989586621679069712"><span class="hs-identifier hs-var">newDefs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679069709"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[f a] -&gt; model -&gt; Maybe (model, [(f a, a)])
forall k a model.
Model k a model =&gt;
[k] -&gt; model -&gt; Maybe (model, [(k, a)])
</span><a href="ModelFinder.Model.html#enterEqs"><span class="hs-identifier hs-var">enterEqs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set (f a) -&gt; [f a]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069708"><span class="hs-identifier hs-var">fas</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">model
</span><a href="#local-6989586621679069706"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679069713"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069713"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[f a] -&gt; a -&gt; model -&gt; Maybe (model, [(f a, a)])
forall k a model.
Model k a model =&gt;
[k] -&gt; a -&gt; model -&gt; Maybe (model, [(k, a)])
</span><a href="ModelFinder.Model.html#enterDef"><span class="hs-identifier hs-var">enterDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set (f a) -&gt; [f a]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069708"><span class="hs-identifier hs-var">fas</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069713"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">model
</span><a href="#local-6989586621679069706"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-218"></span><span>      </span><span class="annot"><a href="#local-6989586621679069698"><span class="hs-identifier hs-type">loopKnown</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069711"><span class="hs-identifier hs-type">m'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069712"><span class="hs-identifier hs-type">newDefs</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679069707"><span class="hs-identifier hs-type">next</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679069710"><span class="hs-identifier hs-type">rest</span></a></span><span>
</span><span id="line-219"></span><span>    </span><span>
</span><span id="line-220"></span><span>    </span><span id="local-6989586621679069704"><span class="annot"><span class="annottext">loop :: model -&gt; [(f a, a)] -&gt; [(f a, a)] -&gt; Maybe (Map (f a) a, model)
</span><a href="#local-6989586621679069704"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679069714"><span class="annot"><span class="annottext">model
</span><a href="#local-6989586621679069714"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679069715"><span class="annot"><span class="annottext">[(f a, a)]
</span><a href="#local-6989586621679069715"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Map (f a) a, model) -&gt; Maybe (Map (f a) a, model)
forall a. a -&gt; Maybe a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (f a) a -&gt; Set (f a) -&gt; Map (f a) a
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.withoutKeys</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(f a, a)] -&gt; Map (f a) a
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">[(f a, a)]
</span><a href="#local-6989586621679069715"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069699"><span class="hs-identifier hs-var">alreadyKnownDefs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">model
</span><a href="#local-6989586621679069714"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><a href="#local-6989586621679069704"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span id="local-6989586621679069718"><span class="annot"><span class="annottext">model
</span><a href="#local-6989586621679069718"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679069719"><span class="annot"><span class="annottext">[(f a, a)]
</span><a href="#local-6989586621679069719"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679069720"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679069720"><span class="hs-identifier hs-var">fa</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679069721"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069721"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679069722"><span class="annot"><span class="annottext">[(f a, a)]
</span><a href="#local-6989586621679069722"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-222"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679069723"><span class="annot"><a href="#local-6989586621679069723"><span class="hs-identifier hs-var">m'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679069724"><span class="annot"><a href="#local-6989586621679069724"><span class="hs-identifier hs-var">newDefs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[f a] -&gt; a -&gt; model -&gt; Maybe (model, [(f a, a)])
forall k a model.
Model k a model =&gt;
[k] -&gt; a -&gt; model -&gt; Maybe (model, [(k, a)])
</span><a href="ModelFinder.Model.html#enterDef"><span class="hs-identifier hs-var">enterDef</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679069720"><span class="hs-identifier hs-var">fa</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069721"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">model
</span><a href="#local-6989586621679069718"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-223"></span><span>      </span><span class="annot"><a href="#local-6989586621679069704"><span class="hs-identifier hs-type">loop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069723"><span class="hs-identifier hs-type">m'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069720"><span class="hs-identifier hs-type">fa</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679069721"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679069719"><span class="hs-identifier hs-type">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069724"><span class="hs-identifier hs-type">newDefs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621679069722"><span class="hs-identifier hs-type">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span id="local-6989586621679069078"><span id="local-6989586621679069079"><span id="local-6989586621679069080"><span class="annot"><a href="ModelFinder.Solver.html#syncLoop"><span class="hs-identifier hs-type">syncLoop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679069078"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Language</span></span><span> </span><span class="annot"><a href="#local-6989586621679069079"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Model.html#Model"><span class="hs-identifier hs-type">Model</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069079"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069078"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679069078"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069080"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#EG"><span class="hs-identifier hs-type">EG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069079"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069078"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Term.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069079"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069078"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Term.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069079"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069078"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-type">SearchM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069079"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069078"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069080"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Solver.html#EG"><span class="hs-identifier hs-type">EG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069079"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069078"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-227"></span><span id="syncLoop"><span class="annot"><span class="annottext">syncLoop :: forall a (f :: * -&gt; *) model.
(Ord a, Language f, Model (f a) a model) =&gt;
EG f a -&gt; [(Term f a, Term f a)] -&gt; SearchM f a model (EG f a)
</span><a href="ModelFinder.Solver.html#syncLoop"><span class="hs-identifier hs-var hs-var">syncLoop</span></a></span></span><span> </span><span id="local-6989586621679069760"><span class="annot"><span class="annottext">EG f a
</span><a href="#local-6989586621679069760"><span class="hs-identifier hs-var">eg</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EG f a -&gt; SearchM f a model (EG f a)
forall a. a -&gt; SearchM f a model a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">EG f a
</span><a href="#local-6989586621679069760"><span class="hs-identifier hs-var">eg</span></a></span><span>
</span><span id="line-228"></span><span class="annot"><a href="ModelFinder.Solver.html#syncLoop"><span class="hs-identifier hs-var">syncLoop</span></a></span><span> </span><span id="local-6989586621679069761"><span class="annot"><span class="annottext">EG f a
</span><a href="#local-6989586621679069761"><span class="hs-identifier hs-var">eg</span></a></span></span><span> </span><span id="local-6989586621679069762"><span class="annot"><span class="annottext">[(Term f a, Term f a)]
</span><a href="#local-6989586621679069762"><span class="hs-identifier hs-var">eqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-229"></span><span>  </span><span id="local-6989586621679069763"><span class="annot"><a href="#local-6989586621679069763"><span class="hs-identifier hs-var">eg1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Term f a, Term f a)] -&gt; EG f a -&gt; SearchM f a model (EG f a)
forall a (f :: * -&gt; *) model.
(Ord a, Language f, Model (f a) a model) =&gt;
[(Term f a, Term f a)] -&gt; EG f a -&gt; SearchM f a model (EG f a)
</span><a href="ModelFinder.Solver.html#equateTerms"><span class="hs-identifier hs-var">equateTerms</span></a></span><span> </span><span class="annot"><span class="annottext">[(Term f a, Term f a)]
</span><a href="#local-6989586621679069762"><span class="hs-identifier hs-var">eqs</span></a></span><span> </span><span class="annot"><span class="annottext">EG f a
</span><a href="#local-6989586621679069761"><span class="hs-identifier hs-var">eg</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span id="local-6989586621679069765"><span class="annot"><a href="#local-6989586621679069765"><span class="hs-identifier hs-var">eg2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">rebuildM</span></span><span> </span><span class="annot"><a href="#local-6989586621679069763"><span class="hs-identifier hs-type">eg1</span></a></span><span>
</span><span id="line-231"></span><span>  </span><span id="local-6989586621679069767"><span class="annot"><a href="#local-6989586621679069767"><span class="hs-identifier hs-var">updates</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#takeAllWaitingDefs"><span class="hs-identifier hs-type">takeAllWaitingDefs</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span id="local-6989586621679069768"><span class="annot"><a href="#local-6989586621679069768"><span class="hs-identifier hs-var">updatesMap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#maybeToSearch"><span class="hs-identifier hs-type">maybeToSearch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#mapFromListUnique"><span class="hs-identifier hs-type">mapFromListUnique</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069767"><span class="hs-identifier hs-type">updates</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679069770"><span class="annot"><a href="#local-6989586621679069770"><span class="hs-identifier hs-var hs-var">defs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, Set (f a)) -&gt; (Set (f a), Maybe a))
-&gt; [(a, Set (f a))] -&gt; [(Set (f a), Maybe a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679069771"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069771"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679069772"><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069772"><span class="hs-identifier hs-var">fas</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set (f a)
</span><a href="#local-6989586621679069772"><span class="hs-identifier hs-var">fas</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069771"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(a, Set (f a))] -&gt; [(Set (f a), Maybe a)])
-&gt; [(a, Set (f a))] -&gt; [(Set (f a), Maybe a)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map a (Set (f a)) -&gt; [(a, Set (f a))]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">(Map a (Set (f a)) -&gt; [(a, Set (f a))])
-&gt; Map a (Set (f a)) -&gt; [(a, Set (f a))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map (f a) a -&gt; Map a (Set (f a))
forall a b. (Ord a, Ord b) =&gt; Map a b -&gt; Map b (Set a)
</span><a href="ModelFinder.Solver.html#transposeMap"><span class="hs-identifier hs-var">transposeMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map (f a) a
</span><a href="#local-6989586621679069768"><span class="hs-identifier hs-var">updatesMap</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span id="local-6989586621679069773"><span class="annot"><a href="#local-6989586621679069773"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#getsModel"><span class="hs-identifier hs-type">getsModel</span></a></span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679069774"><span class="annot"><a href="#local-6989586621679069774"><span class="hs-identifier hs-var">newDefs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679069775"><span class="annot"><a href="#local-6989586621679069775"><span class="hs-identifier hs-var">m'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#maybeToSearch"><span class="hs-identifier hs-type">maybeToSearch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#updateModelDefs"><span class="hs-identifier hs-type">updateModelDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069773"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069770"><span class="hs-identifier hs-type">defs</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><a href="ModelFinder.Solver.html#putModel"><span class="hs-identifier hs-type">putModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069775"><span class="hs-identifier hs-type">m'</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span class="annot"><a href="ModelFinder.Solver.html#syncLoop"><span class="hs-identifier hs-type">syncLoop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069765"><span class="hs-identifier hs-type">eg2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Solver.html#defToEq"><span class="hs-identifier hs-type">defToEq</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.toList</span></span><span> </span><span class="annot"><a href="#local-6989586621679069774"><span class="hs-identifier hs-type">newDefs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span id="local-6989586621679069076"><span id="local-6989586621679069077"><span class="annot"><a href="ModelFinder.Solver.html#whatToGuess"><span class="hs-identifier hs-type">whatToGuess</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679069076"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Language</span></span><span> </span><span class="annot"><a href="#local-6989586621679069077"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#EG"><span class="hs-identifier hs-type">EG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069077"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069076"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679069077"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069076"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-240"></span><span id="whatToGuess"><span class="annot"><span class="annottext">whatToGuess :: forall a (f :: * -&gt; *). (Ord a, Language f) =&gt; EG f a -&gt; [f a]
</span><a href="ModelFinder.Solver.html#whatToGuess"><span class="hs-identifier hs-var hs-var">whatToGuess</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(EClass (ModelInfo f a) (L f a) -&gt; [f a])
-&gt; [EClass (ModelInfo f a) (L f a)] -&gt; [f a]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">EClass (ModelInfo f a) (L f a) -&gt; [f a]
forall {f :: * -&gt; *} {a} {l :: * -&gt; *}.
EClass (ModelInfo f a) l -&gt; [f a]
</span><a href="#local-6989586621679069787"><span class="hs-identifier hs-var">getConstFunList</span></a></span><span> </span><span class="annot"><span class="annottext">([EClass (ModelInfo f a) (L f a)] -&gt; [f a])
-&gt; (EG f a -&gt; [EClass (ModelInfo f a) (L f a)]) -&gt; EG f a -&gt; [f a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(EClass (ModelInfo f a) (L f a) -&gt; Down Int)
-&gt; [EClass (ModelInfo f a) (L f a)]
-&gt; [EClass (ModelInfo f a) (L f a)]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortOn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Down Int
forall a. a -&gt; Down a
</span><span class="hs-identifier hs-var">Down</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Down Int)
-&gt; (EClass (ModelInfo f a) (L f a) -&gt; Int)
-&gt; EClass (ModelInfo f a) (L f a)
-&gt; Down Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">EClass (ModelInfo f a) (L f a) -&gt; Int
forall {a} {l :: * -&gt; *}. EClass a l -&gt; Int
</span><a href="#local-6989586621679069789"><span class="hs-identifier hs-var">getParentCount</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([EClass (ModelInfo f a) (L f a)]
 -&gt; [EClass (ModelInfo f a) (L f a)])
-&gt; (EG f a -&gt; [EClass (ModelInfo f a) (L f a)])
-&gt; EG f a
-&gt; [EClass (ModelInfo f a) (L f a)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(EClass (ModelInfo f a) (L f a) -&gt; Bool)
-&gt; [EClass (ModelInfo f a) (L f a)]
-&gt; [EClass (ModelInfo f a) (L f a)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">EClass (ModelInfo f a) (L f a) -&gt; Bool
forall {f :: * -&gt; *} {a} {l :: * -&gt; *}.
EClass (ModelInfo f a) l -&gt; Bool
</span><a href="#local-6989586621679069790"><span class="hs-identifier hs-var">isUnknownValue</span></a></span><span> </span><span class="annot"><span class="annottext">([EClass (ModelInfo f a) (L f a)]
 -&gt; [EClass (ModelInfo f a) (L f a)])
-&gt; (EG f a -&gt; [EClass (ModelInfo f a) (L f a)])
-&gt; EG f a
-&gt; [EClass (ModelInfo f a) (L f a)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  (Const (Endo [EClass (ModelInfo f a) (L f a)]))
  (EG f a)
  (EGraph (ZonkAny 0) (L f a))
  (EClass (ModelInfo f a) (L f a))
  (EClass (ZonkAny 0) (L f a))
-&gt; EG f a -&gt; [EClass (ModelInfo f a) (L f a)]
forall a s t b. LensLike (Const (Endo [a])) s t a b -&gt; s -&gt; [a]
</span><a href="ModelFinder.Solver.html#toListOf"><span class="hs-identifier hs-var">toListOf</span></a></span><span> </span><span class="annot"><span class="annottext">LensLike
  (Const (Endo [EClass (ModelInfo f a) (L f a)]))
  (EG f a)
  (EGraph (ZonkAny 0) (L f a))
  (EClass (ModelInfo f a) (L f a))
  (EClass (ZonkAny 0) (L f a))
forall a (l :: * -&gt; *) b (f :: * -&gt; *).
Applicative f =&gt;
(EClass a l -&gt; f (EClass b l)) -&gt; EGraph a l -&gt; f (EGraph b l)
</span><span class="hs-identifier hs-var">_classes</span></span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-242"></span><span>    </span><span id="local-6989586621679069790"><span class="annot"><span class="annottext">isUnknownValue :: EClass (ModelInfo f a) l -&gt; Bool
</span><a href="#local-6989586621679069790"><span class="hs-identifier hs-var hs-var">isUnknownValue</span></a></span></span><span> </span><span id="local-6989586621679069793"><span class="annot"><span class="annottext">EClass (ModelInfo f a) l
</span><a href="#local-6989586621679069793"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; Bool) -&gt; Maybe a -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelInfo f a -&gt; Maybe a
forall (f :: * -&gt; *) a. ModelInfo f a -&gt; Maybe a
</span><a href="ModelFinder.Solver.html#constValue"><span class="hs-identifier hs-var">constValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EClass (ModelInfo f a) l
</span><a href="#local-6989586621679069793"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="annot"><span class="annottext">EClass (ModelInfo f a) l
-&gt; Lens' (EClass (ModelInfo f a) l) (ModelInfo f a)
-&gt; ModelInfo f a
forall s a. s -&gt; Lens' s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">(ModelInfo f a -&gt; f (ModelInfo f a))
-&gt; EClass (ModelInfo f a) l -&gt; f (EClass (ModelInfo f a) l)
forall domain (l :: * -&gt; *) domain' (f :: * -&gt; *).
Functor f =&gt;
(domain -&gt; f domain') -&gt; EClass domain l -&gt; f (EClass domain' l)
Lens' (EClass (ModelInfo f a) l) (ModelInfo f a)
</span><span class="hs-identifier hs-var">_data</span></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>    </span><span id="local-6989586621679069789"><span class="annot"><span class="annottext">getParentCount :: EClass a l -&gt; Int
</span><a href="#local-6989586621679069789"><span class="hs-identifier hs-var hs-var">getParentCount</span></a></span></span><span> </span><span id="local-6989586621679069798"><span class="annot"><span class="annottext">EClass a l
</span><a href="#local-6989586621679069798"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SList (Int, ENode l) -&gt; Int
forall a. SList a -&gt; Int
</span><span class="hs-identifier hs-var">sizeSL</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EClass a l
</span><a href="#local-6989586621679069798"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="annot"><span class="annottext">EClass a l
-&gt; Lens' (EClass a l) (SList (Int, ENode l))
-&gt; SList (Int, ENode l)
forall s a. s -&gt; Lens' s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">(SList (Int, ENode l) -&gt; f (SList (Int, ENode l)))
-&gt; EClass a l -&gt; f (EClass a l)
forall a (l :: * -&gt; *) (f :: * -&gt; *).
Functor f =&gt;
(SList (Int, ENode l) -&gt; f (SList (Int, ENode l)))
-&gt; EClass a l -&gt; f (EClass a l)
Lens' (EClass a l) (SList (Int, ENode l))
</span><span class="hs-identifier hs-var">_parents</span></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>    </span><span id="local-6989586621679069787"><span class="annot"><span class="annottext">getConstFunList :: EClass (ModelInfo f a) l -&gt; [f a]
</span><a href="#local-6989586621679069787"><span class="hs-identifier hs-var hs-var">getConstFunList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (f a) -&gt; [f a]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">(Set (f a) -&gt; [f a])
-&gt; (EClass (ModelInfo f a) l -&gt; Set (f a))
-&gt; EClass (ModelInfo f a) l
-&gt; [f a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelInfo f a -&gt; Set (f a)
forall (f :: * -&gt; *) a. ModelInfo f a -&gt; Set (f a)
</span><a href="ModelFinder.Solver.html#constFunctions"><span class="hs-identifier hs-var">constFunctions</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelInfo f a -&gt; Set (f a))
-&gt; (EClass (ModelInfo f a) l -&gt; ModelInfo f a)
-&gt; EClass (ModelInfo f a) l
-&gt; Set (f a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Lens' (EClass (ModelInfo f a) l) (ModelInfo f a)
-&gt; EClass (ModelInfo f a) l -&gt; ModelInfo f a
forall s a. Lens' s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">(ModelInfo f a -&gt; f (ModelInfo f a))
-&gt; EClass (ModelInfo f a) l -&gt; f (EClass (ModelInfo f a) l)
forall domain (l :: * -&gt; *) domain' (f :: * -&gt; *).
Functor f =&gt;
(domain -&gt; f domain') -&gt; EClass domain l -&gt; f (EClass domain' l)
Lens' (EClass (ModelInfo f a) l) (ModelInfo f a)
</span><span class="hs-identifier hs-var">_data</span></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span id="local-6989586621679069081"><span id="local-6989586621679069082"><span class="annot"><a href="ModelFinder.Solver.html#defToEq"><span class="hs-identifier hs-type">defToEq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679069081"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069081"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069082"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679069082"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Term.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069081"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069082"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Term.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069081"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069082"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-247"></span><span id="defToEq"><span class="annot"><span class="annottext">defToEq :: forall (f :: * -&gt; *) a.
Functor f =&gt;
(f a, a) -&gt; (Term f a, Term f a)
</span><a href="ModelFinder.Solver.html#defToEq"><span class="hs-identifier hs-var hs-var">defToEq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(f a -&gt; Term f a)
-&gt; (a -&gt; Term f a) -&gt; (f a, a) -&gt; (Term f a, Term f a)
forall a b c d. (a -&gt; b) -&gt; (c -&gt; d) -&gt; (a, c) -&gt; (b, d)
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">f a -&gt; Term f a
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; Term f a
</span><a href="ModelFinder.Term.html#liftFun"><span class="hs-identifier hs-var">liftFun</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Term f a
forall a (f :: * -&gt; *). a -&gt; Term f a
</span><a href="ModelFinder.Term.html#con"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span id="local-6989586621679069096"><span id="local-6989586621679069097"><span id="local-6989586621679069098"><span class="annot"><a href="ModelFinder.Solver.html#equateDefs"><span class="hs-identifier hs-type">equateDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679069096"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Language</span></span><span> </span><span class="annot"><a href="#local-6989586621679069097"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Model.html#Model"><span class="hs-identifier hs-type">Model</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069097"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069096"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679069096"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069098"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069097"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069096"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679069096"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#EG"><span class="hs-identifier hs-type">EG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069097"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069096"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-type">SearchM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069097"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069096"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069098"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Solver.html#EG"><span class="hs-identifier hs-type">EG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069097"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069096"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-251"></span><span id="equateDefs"><span class="annot"><span class="annottext">equateDefs :: forall a (f :: * -&gt; *) model.
(Ord a, Language f, Model (f a) a model) =&gt;
[(f a, a)] -&gt; EG f a -&gt; SearchM f a model (EG f a)
</span><a href="ModelFinder.Solver.html#equateDefs"><span class="hs-identifier hs-var hs-var">equateDefs</span></a></span></span><span> </span><span id="local-6989586621679069819"><span class="annot"><span class="annottext">[(f a, a)]
</span><a href="#local-6989586621679069819"><span class="hs-identifier hs-var">defs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Term f a, Term f a)] -&gt; EG f a -&gt; SearchM f a model (EG f a)
forall a (f :: * -&gt; *) model.
(Ord a, Language f, Model (f a) a model) =&gt;
[(Term f a, Term f a)] -&gt; EG f a -&gt; SearchM f a model (EG f a)
</span><a href="ModelFinder.Solver.html#equateTerms"><span class="hs-identifier hs-var">equateTerms</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(f a, a) -&gt; (Term f a, Term f a)
forall (f :: * -&gt; *) a.
Functor f =&gt;
(f a, a) -&gt; (Term f a, Term f a)
</span><a href="ModelFinder.Solver.html#defToEq"><span class="hs-identifier hs-var">defToEq</span></a></span><span> </span><span class="annot"><span class="annottext">((f a, a) -&gt; (Term f a, Term f a))
-&gt; [(f a, a)] -&gt; [(Term f a, Term f a)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(f a, a)]
</span><a href="#local-6989586621679069819"><span class="hs-identifier hs-var">defs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span id="local-6989586621679069119"><span id="local-6989586621679069120"><span id="local-6989586621679069121"><span class="annot"><a href="ModelFinder.Solver.html#equateTerms"><span class="hs-identifier hs-type">equateTerms</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679069119"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Language</span></span><span> </span><span class="annot"><a href="#local-6989586621679069120"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Model.html#Model"><span class="hs-identifier hs-type">Model</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069120"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069119"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679069119"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069121"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Term.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069120"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069119"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ModelFinder.Term.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069120"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069119"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#EG"><span class="hs-identifier hs-type">EG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069120"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069119"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#SearchM"><span class="hs-identifier hs-type">SearchM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069120"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069119"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069121"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Solver.html#EG"><span class="hs-identifier hs-type">EG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069120"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069119"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-255"></span><span id="equateTerms"><span class="annot"><span class="annottext">equateTerms :: forall a (f :: * -&gt; *) model.
(Ord a, Language f, Model (f a) a model) =&gt;
[(Term f a, Term f a)] -&gt; EG f a -&gt; SearchM f a model (EG f a)
</span><a href="ModelFinder.Solver.html#equateTerms"><span class="hs-identifier hs-var hs-var">equateTerms</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679069841"><span class="annot"><span class="annottext">EG f a
</span><a href="#local-6989586621679069841"><span class="hs-identifier hs-var">eg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EG f a -&gt; SearchM f a model (EG f a)
forall a. a -&gt; SearchM f a model a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">EG f a
</span><a href="#local-6989586621679069841"><span class="hs-identifier hs-var">eg</span></a></span><span>
</span><span id="line-256"></span><span class="annot"><a href="ModelFinder.Solver.html#equateTerms"><span class="hs-identifier hs-var">equateTerms</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679069842"><span class="annot"><span class="annottext">Term f a
</span><a href="#local-6989586621679069842"><span class="hs-identifier hs-var">lhs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679069843"><span class="annot"><span class="annottext">Term f a
</span><a href="#local-6989586621679069843"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679069844"><span class="annot"><span class="annottext">[(Term f a, Term f a)]
</span><a href="#local-6989586621679069844"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679069845"><span class="annot"><span class="annottext">EG f a
</span><a href="#local-6989586621679069845"><span class="hs-identifier hs-var">eg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679069846"><span class="annot"><a href="#local-6989586621679069846"><span class="hs-identifier hs-var">cLHS</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679069847"><span class="annot"><a href="#local-6989586621679069847"><span class="hs-identifier hs-var">eg1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term f a -&gt; EG f a -&gt; SearchM f a model (Int, EG f a)
forall a (l :: * -&gt; *) (m :: * -&gt; *).
(AnalysisM m a l, Language l) =&gt;
Fix l -&gt; EGraph a l -&gt; m (Int, EGraph a l)
</span><span class="hs-identifier hs-var">representM</span></span><span> </span><span class="annot"><span class="annottext">Term f a
</span><a href="#local-6989586621679069842"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">EG f a
</span><a href="#local-6989586621679069845"><span class="hs-identifier hs-var">eg</span></a></span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679069849"><span class="annot"><a href="#local-6989586621679069849"><span class="hs-identifier hs-var">cRHS</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679069850"><span class="annot"><a href="#local-6989586621679069850"><span class="hs-identifier hs-var">eg2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">representM</span></span><span> </span><span class="annot"><a href="#local-6989586621679069843"><span class="hs-identifier hs-type">rhs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069847"><span class="hs-identifier hs-type">eg1</span></a></span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679069851"><span class="annot"><a href="#local-6989586621679069851"><span class="hs-identifier hs-var">eg3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mergeM</span></span><span> </span><span class="annot"><a href="#local-6989586621679069846"><span class="hs-identifier hs-type">cLHS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069849"><span class="hs-identifier hs-type">cRHS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069850"><span class="hs-identifier hs-type">eg2</span></a></span><span>
</span><span id="line-260"></span><span>  </span><span class="annot"><a href="ModelFinder.Solver.html#equateTerms"><span class="hs-identifier hs-type">equateTerms</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069844"><span class="hs-identifier hs-type">rest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069851"><span class="hs-identifier hs-type">eg3</span></a></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-comment">----</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span id="local-6989586621679069103"><span id="local-6989586621679069104"><span class="annot"><a href="ModelFinder.Solver.html#transposeMap"><span class="hs-identifier hs-type">transposeMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679069103"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679069104"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679069103"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069104"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679069104"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679069103"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-265"></span><span id="transposeMap"><span class="annot"><span class="annottext">transposeMap :: forall a b. (Ord a, Ord b) =&gt; Map a b -&gt; Map b (Set a)
</span><a href="ModelFinder.Solver.html#transposeMap"><span class="hs-identifier hs-var hs-var">transposeMap</span></a></span></span><span> </span><span id="local-6989586621679069857"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679069857"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set a -&gt; Set a -&gt; Set a) -&gt; [(b, Set a)] -&gt; Map b (Set a)
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromListWith</span></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069859"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069860"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679069860"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069860"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679069859"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069859"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map a b -&gt; [(a, b)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679069857"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-comment">-- Map.fromList but the values for the repeated keys must be unique</span><span>
</span><span id="line-269"></span><span id="local-6989586621679069125"><span id="local-6989586621679069126"><span class="annot"><a href="ModelFinder.Solver.html#mapFromListUnique"><span class="hs-identifier hs-type">mapFromListUnique</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679069125"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679069126"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069125"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679069126"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679069125"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069126"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-270"></span><span id="mapFromListUnique"><span class="annot"><span class="annottext">mapFromListUnique :: forall k v. (Ord k, Eq v) =&gt; [(k, v)] -&gt; Maybe (Map k v)
</span><a href="ModelFinder.Solver.html#mapFromListUnique"><span class="hs-identifier hs-var hs-var">mapFromListUnique</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Map k v -&gt; (k, v) -&gt; Maybe (Map k v))
-&gt; Map k v -&gt; [(k, v)] -&gt; Maybe (Map k v)
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">F.foldlM</span></span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; (k, v) -&gt; Maybe (Map k v)
forall {k} {a}.
(Ord k, Eq a) =&gt;
Map k a -&gt; (k, a) -&gt; Maybe (Map k a)
</span><a href="#local-6989586621679069868"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-272"></span><span>    </span><span id="local-6989586621679069868"><span class="annot"><span class="annottext">step :: Map k a -&gt; (k, a) -&gt; Maybe (Map k a)
</span><a href="#local-6989586621679069868"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679069878"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679069878"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679069879"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679069879"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679069880"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069880"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; Maybe (Maybe a)) -&gt; k -&gt; Map k a -&gt; Maybe (Map k a)
forall (f :: * -&gt; *) k a.
(Functor f, Ord k) =&gt;
(Maybe a -&gt; f (Maybe a)) -&gt; k -&gt; Map k a -&gt; f (Map k a)
</span><span class="hs-identifier hs-var">Map.alterF</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a -&gt; Maybe (Maybe a)
forall {a}. Eq a =&gt; a -&gt; Maybe a -&gt; Maybe (Maybe a)
</span><a href="#local-6989586621679069882"><span class="hs-identifier hs-var">checkedInsert</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069880"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679069879"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679069878"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-273"></span><span>    </span><span id="local-6989586621679069882"><span class="annot"><span class="annottext">checkedInsert :: a -&gt; Maybe a -&gt; Maybe (Maybe a)
</span><a href="#local-6989586621679069882"><span class="hs-identifier hs-var hs-var">checkedInsert</span></a></span></span><span> </span><span id="local-6989586621679069888"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069888"><span class="hs-identifier hs-var">newV</span></a></span></span><span> </span><span id="local-6989586621679069889"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679069889"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679069889"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-274"></span><span>      </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Maybe (Maybe a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069888"><span class="hs-identifier hs-var">newV</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679069890"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069890"><span class="hs-identifier hs-var">oldV</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679069889"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Maybe () -&gt; Maybe (Maybe a)
forall a b. a -&gt; Maybe b -&gt; Maybe a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069888"><span class="hs-identifier hs-var">newV</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069890"><span class="hs-identifier hs-var">oldV</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="hs-comment">----</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-keyword">type</span><span> </span><span id="LensLike"><span class="annot"><a href="ModelFinder.Solver.html#LensLike"><span class="hs-identifier hs-var">LensLike</span></a></span></span><span> </span><span id="local-6989586621679069891"><span class="annot"><a href="#local-6989586621679069891"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679069892"><span class="annot"><a href="#local-6989586621679069892"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679069893"><span class="annot"><a href="#local-6989586621679069893"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679069894"><span class="annot"><a href="#local-6989586621679069894"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679069895"><span class="annot"><a href="#local-6989586621679069895"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069894"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069891"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069895"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069892"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069891"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069893"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span id="local-6989586621679069222"><span id="local-6989586621679069223"><span id="local-6989586621679069224"><span id="local-6989586621679069225"><span id="local-6989586621679069226"><span class="annot"><a href="ModelFinder.Solver.html#foldMapOf"><span class="hs-identifier hs-type">foldMapOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#LensLike"><span class="hs-identifier hs-type">LensLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="annot"><a href="#local-6989586621679069222"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679069223"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069224"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069225"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069226"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069225"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069222"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069223"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069222"><span class="hs-identifier hs-type">m</span></a></span></span></span></span></span></span><span>
</span><span id="line-282"></span><span id="foldMapOf"><span class="annot"><span class="annottext">foldMapOf :: forall m s t a b. LensLike (Const m) s t a b -&gt; (a -&gt; m) -&gt; s -&gt; m
</span><a href="ModelFinder.Solver.html#foldMapOf"><span class="hs-identifier hs-var hs-var">foldMapOf</span></a></span></span><span> </span><span id="local-6989586621679069897"><span class="annot"><span class="annottext">LensLike (Const m) s t a b
</span><a href="#local-6989586621679069897"><span class="hs-identifier hs-var">trav</span></a></span></span><span> </span><span id="local-6989586621679069898"><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679069898"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Const m t -&gt; m
forall {k} a (b :: k). Const a b -&gt; a
</span><span class="hs-identifier hs-var">getConst</span></span><span> </span><span class="annot"><span class="annottext">(Const m t -&gt; m) -&gt; (s -&gt; Const m t) -&gt; s -&gt; m
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LensLike (Const m) s t a b
</span><a href="#local-6989586621679069897"><span class="hs-identifier hs-var">trav</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m -&gt; Const m b
forall {k} a (b :: k). a -&gt; Const a b
</span><span class="hs-identifier hs-var">Const</span></span><span> </span><span class="annot"><span class="annottext">(m -&gt; Const m b) -&gt; (a -&gt; m) -&gt; a -&gt; Const m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679069898"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span id="local-6989586621679069154"><span id="local-6989586621679069155"><span id="local-6989586621679069156"><span id="local-6989586621679069157"><span class="annot"><a href="ModelFinder.Solver.html#toListOf"><span class="hs-identifier hs-type">toListOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Solver.html#LensLike"><span class="hs-identifier hs-type">LensLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Endo</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679069154"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679069155"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069156"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069154"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069157"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069155"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679069154"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-285"></span><span id="toListOf"><span class="annot"><span class="annottext">toListOf :: forall a s t b. LensLike (Const (Endo [a])) s t a b -&gt; s -&gt; [a]
</span><a href="ModelFinder.Solver.html#toListOf"><span class="hs-identifier hs-var hs-var">toListOf</span></a></span></span><span> </span><span id="local-6989586621679069901"><span class="annot"><span class="annottext">LensLike (Const (Endo [a])) s t a b
</span><a href="#local-6989586621679069901"><span class="hs-identifier hs-var">trav</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo [a] -&gt; [a]
forall {a}. Endo [a] -&gt; [a]
</span><a href="#local-6989586621679069902"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">(Endo [a] -&gt; [a]) -&gt; (s -&gt; Endo [a]) -&gt; s -&gt; [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LensLike (Const (Endo [a])) s t a b
-&gt; (a -&gt; Endo [a]) -&gt; s -&gt; Endo [a]
forall m s t a b. LensLike (Const m) s t a b -&gt; (a -&gt; m) -&gt; s -&gt; m
</span><a href="ModelFinder.Solver.html#foldMapOf"><span class="hs-identifier hs-var">foldMapOf</span></a></span><span> </span><span class="annot"><span class="annottext">LensLike (Const (Endo [a])) s t a b
</span><a href="#local-6989586621679069901"><span class="hs-identifier hs-var">trav</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679069903"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069903"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; Endo [a]
forall a. (a -&gt; a) -&gt; Endo a
</span><span class="hs-identifier hs-var">Endo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069903"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-287"></span><span>    </span><span id="local-6989586621679069902"><span class="annot"><span class="annottext">reify :: Endo [a] -&gt; [a]
</span><a href="#local-6989586621679069902"><span class="hs-identifier hs-var hs-var">reify</span></a></span></span><span> </span><span id="local-6989586621679069905"><span class="annot"><span class="annottext">Endo [a]
</span><a href="#local-6989586621679069905"><span class="hs-identifier hs-var">endo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo [a] -&gt; [a] -&gt; [a]
forall a. Endo a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">appEndo</span></span><span> </span><span class="annot"><span class="annottext">Endo [a]
</span><a href="#local-6989586621679069905"><span class="hs-identifier hs-var">endo</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-288"></span></pre></body></html>