<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveTraversable #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ImportQualifiedPost #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="ApplicativeGen.html"><span class="hs-identifier">ApplicativeGen</span></a></span><span class="hs-special">(</span><span>
</span><span id="line-10"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Dict</span></span><span>
</span><span id="line-11"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeDict"><span class="hs-identifier">ApplicativeDict</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#makeApplicativeDict"><span class="hs-identifier">makeApplicativeDict</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Data</span></span><span>
</span><span id="line-15"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier">ApplicativeData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#genApplicativeData"><span class="hs-identifier">genApplicativeData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#genApplicativeDataFrom"><span class="hs-identifier">genApplicativeDataFrom</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Serialize</span></span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#serializeApplicativeDataList"><span class="hs-identifier">serializeApplicativeDataList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#deserializeApplicativeDataList"><span class="hs-identifier">deserializeApplicativeDataList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Raw</span></span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier">RawApplicativeData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#prettyRawApplicativeData"><span class="hs-identifier">prettyRawApplicativeData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#genRawApplicativeData"><span class="hs-identifier">genRawApplicativeData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#genRawApplicativeDataFrom"><span class="hs-identifier">genRawApplicativeDataFrom</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Applicative laws for Raw</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#prop_LeftUnit"><span class="hs-identifier">prop_LeftUnit</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#prop_RightUnit"><span class="hs-identifier">prop_RightUnit</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#prop_LeftLeft"><span class="hs-identifier">prop_LeftLeft</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#prop_RightRight"><span class="hs-identifier">prop_RightRight</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#prop_LeftRight"><span class="hs-identifier">prop_LeftRight</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Applicative-preserving isomorphisms</span></span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#stabilizingIsomorphisms"><span class="hs-identifier">stabilizingIsomorphisms</span></a></span><span>
</span><span id="line-38"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Array</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Array</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(!)</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Array.Extra.html"><span class="hs-identifier">Data.Array.Extra</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Array</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">for_</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.FunctorShape</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.PTraversable</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.PTraversable.Extra.html"><span class="hs-identifier">Data.PTraversable.Extra</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PTraversable.Extra.html#_indices"><span class="hs-identifier">_indices</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PTraversable.Extra.html#skolem"><span class="hs-identifier">skolem</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Tuple</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">swap</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="MonoidGen.html"><span class="hs-identifier">MonoidGen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonoidGen.html#RawMonoidData"><span class="hs-identifier">RawMonoidData</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonoidGen.html#Signature"><span class="hs-identifier">Signature</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonoidGen.html#genRawMonoidsForApplicative"><span class="hs-identifier">genRawMonoidsForApplicative</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonoidGen.html#makeEnv"><span class="hs-identifier">makeEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonoidGen.html#prettyRawMonoidData"><span class="hs-identifier">prettyRawMonoidData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonoidGen.html#MonoidData"><span class="hs-identifier">MonoidData</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonoidGen.html#stabilizingPermutations"><span class="hs-identifier">stabilizingPermutations</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonoidGen.html#Permutation"><span class="hs-identifier">Permutation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonoidGen.html#encodeRawMonoidData"><span class="hs-identifier">encodeRawMonoidData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonoidGen.html#decodeRawMonoidData"><span class="hs-identifier">decodeRawMonoidData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Equivalence.Monad</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">assert</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Isomorphism.html"><span class="hs-identifier">Isomorphism</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sort</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">ModelFinder.Model</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">ModelFinder.Term</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">ModelFinder.Solver</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="ModelFinder.Model.GuessMaskModel.html"><span class="hs-identifier">ModelFinder.Model.GuessMaskModel</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">guard</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">readMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Finitary.Enum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">enum</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-keyword">data</span><span> </span><span id="ApplicativeDict"><span class="annot"><a href="ApplicativeGen.html#ApplicativeDict"><span class="hs-identifier hs-var">ApplicativeDict</span></a></span></span><span> </span><span id="local-6989586621679201789"><span class="annot"><a href="#local-6989586621679201789"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ApplicativeDict"><span class="annot"><a href="ApplicativeGen.html#ApplicativeDict"><span class="hs-identifier hs-var">ApplicativeDict</span></a></span></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_applicativePure"><span class="annot"><span class="annottext">forall (f :: * -&gt; *). ApplicativeDict f -&gt; forall a. a -&gt; f a
</span><a href="ApplicativeGen.html#_applicativePure"><span class="hs-identifier hs-var hs-var">_applicativePure</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679201791"><span class="annot"><a href="#local-6989586621679201791"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679201791"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679201789"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679201791"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>    </span><span id="_applicativeLiftA2"><span class="annot"><span class="annottext">forall (f :: * -&gt; *).
ApplicativeDict f
-&gt; forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><a href="ApplicativeGen.html#_applicativeLiftA2"><span class="hs-identifier hs-var hs-var">_applicativeLiftA2</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679201794"><span class="annot"><a href="#local-6989586621679201794"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679201795"><span class="annot"><a href="#local-6989586621679201795"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679201796"><span class="annot"><a href="#local-6989586621679201796"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679201794"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679201795"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679201796"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679201789"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679201794"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679201789"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679201795"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679201789"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679201796"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="annot"><a href="ApplicativeGen.html#makeApplicativeDict"><span class="hs-identifier hs-type">makeApplicativeDict</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679201801"><span class="annot"><a href="#local-6989586621679201801"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679201801"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-type">ApplicativeData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679201801"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeDict"><span class="hs-identifier hs-type">ApplicativeDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679201801"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-70"></span><span id="makeApplicativeDict"><span class="annot"><span class="annottext">makeApplicativeDict :: forall (f :: * -&gt; *).
PTraversable f =&gt;
ApplicativeData f -&gt; ApplicativeDict f
</span><a href="ApplicativeGen.html#makeApplicativeDict"><span class="hs-identifier hs-var hs-var">makeApplicativeDict</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-type">ApplicativeData</span></a></span><span> </span><span id="local-6989586621679202231"><span class="annot"><span class="annottext">Vector (Shape f)
</span><a href="#local-6989586621679202231"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span id="local-6989586621679202232"><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202232"><span class="hs-identifier hs-var">raw</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-71"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeDict"><span class="hs-identifier hs-type">ApplicativeDict</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">_applicativePure :: forall a. a -&gt; f a
</span><a href="ApplicativeGen.html#_applicativePure"><span class="hs-identifier hs-var">_applicativePure</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; f a
forall a. a -&gt; f a
</span><a href="#local-6989586621679202233"><span class="hs-identifier hs-var">pure'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_applicativeLiftA2 :: forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><a href="ApplicativeGen.html#_applicativeLiftA2"><span class="hs-identifier hs-var">_applicativeLiftA2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><a href="#local-6989586621679202234"><span class="hs-identifier hs-var">liftA2'</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-73"></span><span>    </span><span id="local-6989586621679202235"><span class="annot"><span class="annottext">e :: Int
</span><a href="#local-6989586621679202235"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Int
</span><a href="MonoidGen.html#_unitElem"><span class="hs-identifier hs-var">_unitElem</span></a></span><span> </span><span class="annot"><span class="annottext">(RawMonoidData -&gt; Int) -&gt; RawMonoidData -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; RawMonoidData
</span><a href="ApplicativeGen.html#_baseMonoid"><span class="hs-identifier hs-var">_baseMonoid</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202232"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span id="local-6989586621679202238"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202238"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#monoidOp"><span class="hs-identifier hs-var">monoidOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202232"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span id="local-6989586621679202240"><span class="annot"><span class="annottext">leftFactor :: Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202240"><span class="hs-identifier hs-var hs-var">leftFactor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#leftFactorOp"><span class="hs-identifier hs-var">leftFactorOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202232"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span id="local-6989586621679202242"><span class="annot"><span class="annottext">rightFactor :: Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202242"><span class="hs-identifier hs-var hs-var">rightFactor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#rightFactorOp"><span class="hs-identifier hs-var">rightFactorOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202232"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span>    </span><span id="local-6989586621679202253"><span class="annot"><span class="annottext">reverseTable :: Map (Shape f) Int
</span><a href="#local-6989586621679202253"><span class="hs-identifier hs-var hs-var">reverseTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Shape f, Int)] -&gt; Map (Shape f) Int
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Shape f) -&gt; (Shape f, Int)
forall a b. (a, b) -&gt; (b, a)
</span><span class="hs-identifier hs-var">swap</span></span><span> </span><span class="annot"><span class="annottext">((Int, Shape f) -&gt; (Shape f, Int))
-&gt; [(Int, Shape f)] -&gt; [(Shape f, Int)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector (Int, Shape f) -&gt; [(Int, Shape f)]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (Shape f) -&gt; Vector (Int, Shape f)
forall a. Vector a -&gt; Vector (Int, a)
</span><span class="hs-identifier hs-var">V.indexed</span></span><span> </span><span class="annot"><span class="annottext">Vector (Shape f)
</span><a href="#local-6989586621679202231"><span class="hs-identifier hs-var">table</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><a href="#local-6989586621679202233"><span class="hs-identifier hs-type">pure'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679202258"><span class="annot"><a href="#local-6989586621679202258"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679202258"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679201801"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202258"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span id="local-6989586621679202233"><span class="annot"><span class="annottext">pure' :: forall a. a -&gt; f a
</span><a href="#local-6989586621679202233"><span class="hs-identifier hs-var hs-var">pure'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Vector (Shape f)
</span><a href="#local-6989586621679202231"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Shape f) -&gt; Int -&gt; Shape f
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202235"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-81"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span id="local-6989586621679202262"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679202262"><span class="hs-identifier hs-var">u1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; f a -&gt; f a
forall a b. a -&gt; f b -&gt; f a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679202262"><span class="hs-identifier hs-var">u1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><a href="#local-6989586621679202234"><span class="hs-identifier hs-type">liftA2'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679202264"><span class="annot"><a href="#local-6989586621679202264"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679202265"><span class="annot"><a href="#local-6989586621679202265"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679202266"><span class="annot"><a href="#local-6989586621679202266"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679202264"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679202265"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679202266"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679201801"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202264"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679201801"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202265"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679201801"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202266"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span id="local-6989586621679202234"><span class="annot"><span class="annottext">liftA2' :: forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><a href="#local-6989586621679202234"><span class="hs-identifier hs-var hs-var">liftA2'</span></a></span></span><span> </span><span id="local-6989586621679202267"><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679202267"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679202268"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679202268"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679202269"><span class="annot"><span class="annottext">f b
</span><a href="#local-6989586621679202269"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f c
</span><a href="#local-6989586621679202270"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-85"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-86"></span><span>        </span><span id="local-6989586621679202272"><span class="annot"><span class="annottext">as :: [a]
</span><a href="#local-6989586621679202272"><span class="hs-keyword hs-var hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f a -&gt; [a]
forall a. f a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679202268"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-87"></span><span>        </span><span id="local-6989586621679202274"><span class="annot"><span class="annottext">bs :: [b]
</span><a href="#local-6989586621679202274"><span class="hs-identifier hs-var hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f b -&gt; [b]
forall a. f a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">f b
</span><a href="#local-6989586621679202269"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-88"></span><span>        </span><span id="local-6989586621679202280"><span class="annot"><span class="annottext">mx :: Int
</span><a href="#local-6989586621679202280"><span class="hs-identifier hs-var hs-var">mx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) Int
</span><a href="#local-6989586621679202253"><span class="hs-identifier hs-var">reverseTable</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Shape f) Int -&gt; Shape f -&gt; Int
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span> </span><span class="annot"><span class="annottext">f a -&gt; Shape f
forall (f :: * -&gt; *) a. f a -&gt; Shape f
</span><span class="hs-identifier hs-var">Shape</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679202268"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-89"></span><span>        </span><span id="local-6989586621679202287"><span class="annot"><span class="annottext">my :: Int
</span><a href="#local-6989586621679202287"><span class="hs-identifier hs-var hs-var">my</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Shape f) Int
</span><a href="#local-6989586621679202253"><span class="hs-identifier hs-var">reverseTable</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Shape f) Int -&gt; Shape f -&gt; Int
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span> </span><span class="annot"><span class="annottext">f b -&gt; Shape f
forall (f :: * -&gt; *) a. f a -&gt; Shape f
</span><span class="hs-identifier hs-var">Shape</span></span><span> </span><span class="annot"><span class="annottext">f b
</span><a href="#local-6989586621679202269"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-90"></span><span>        </span><span id="local-6989586621679202288"><span class="annot"><span class="annottext">mz :: Int
</span><a href="#local-6989586621679202288"><span class="hs-identifier hs-var hs-var">mz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202238"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202280"><span class="hs-identifier hs-var">mx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202287"><span class="hs-identifier hs-var">my</span></a></span><span>
</span><span id="line-91"></span><span>        </span><span id="local-6989586621679202289"><span class="annot"><span class="annottext">zi :: f Int
</span><a href="#local-6989586621679202289"><span class="hs-identifier hs-var hs-var">zi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Vector (Shape f)
</span><a href="#local-6989586621679202231"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Shape f) -&gt; Int -&gt; Shape f
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202288"><span class="hs-identifier hs-var">mz</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-92"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span id="local-6989586621679202293"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679202293"><span class="hs-identifier hs-var">z1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f a -&gt; f Int
forall (t :: * -&gt; *) a. Traversable t =&gt; t a -&gt; t Int
</span><a href="Data.PTraversable.Extra.html#_indices"><span class="hs-identifier hs-var">_indices</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679202293"><span class="hs-identifier hs-var">z1</span></a></span><span>
</span><span id="line-93"></span><span>        </span><span id="local-6989586621679202298"><span class="annot"><span class="annottext">cs :: Int -&gt; c
</span><a href="#local-6989586621679202298"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621679202299"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202299"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-94"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679202300"><span class="annot"><span class="annottext">j :: Int
</span><a href="#local-6989586621679202300"><span class="hs-identifier hs-var hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202240"><span class="hs-identifier hs-var">leftFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202280"><span class="hs-identifier hs-var">mx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202287"><span class="hs-identifier hs-var">my</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202299"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-95"></span><span>              </span><span id="local-6989586621679202301"><span class="annot"><span class="annottext">k :: Int
</span><a href="#local-6989586621679202301"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202242"><span class="hs-identifier hs-var">rightFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202280"><span class="hs-identifier hs-var">mx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202287"><span class="hs-identifier hs-var">my</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202299"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-96"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679202267"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679202272"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int -&gt; a
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202300"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679202274"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; Int -&gt; b
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202301"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>        </span><span id="local-6989586621679202270"><span class="annot"><span class="annottext">z :: f c
</span><a href="#local-6989586621679202270"><span class="hs-identifier hs-var hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; c
</span><a href="#local-6989586621679202298"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; c) -&gt; f Int -&gt; f c
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679202289"><span class="hs-identifier hs-var">zi</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-keyword">data</span><span> </span><span id="ApplicativeData"><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-var">ApplicativeData</span></a></span></span><span> </span><span id="local-6989586621679201856"><span class="annot"><a href="#local-6989586621679201856"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ApplicativeData"><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-var">ApplicativeData</span></a></span></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_applicativeShapeTable"><span class="annot"><span class="annottext">forall (f :: * -&gt; *). ApplicativeData f -&gt; Vector (Shape f)
</span><a href="ApplicativeGen.html#_applicativeShapeTable"><span class="hs-identifier hs-var hs-var">_applicativeShapeTable</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span class="annot"><a href="#local-6989586621679201856"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>    </span><span id="_rawApplicative"><span class="annot"><span class="annottext">forall (f :: * -&gt; *). ApplicativeData f -&gt; RawApplicativeData
</span><a href="ApplicativeGen.html#_rawApplicative"><span class="hs-identifier hs-var hs-var">_rawApplicative</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span id="local-6989586621679201864"><span id="local-6989586621679202308"><span id="local-6989586621679202315"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679201864"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ignored</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-type">ApplicativeData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679201864"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-105"></span><span id="local-6989586621679201867"><span id="local-6989586621679202325"><span id="local-6989586621679202331"><span id="local-6989586621679202336"><span id="local-6989586621679202340"><span id="local-6989586621679202343"><span id="local-6989586621679202346"><span id="local-6989586621679202349"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679201867"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ignored</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-type">ApplicativeData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679201867"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span id="local-6989586621679201868"><span class="annot"><a href="ApplicativeGen.html#genApplicativeData"><span class="hs-identifier hs-type">genApplicativeData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679201868"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-type">ApplicativeData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679201868"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-108"></span><span id="genApplicativeData"><span class="annot"><span class="annottext">genApplicativeData :: forall (f :: * -&gt; *). PTraversable f =&gt; [ApplicativeData f]
</span><a href="ApplicativeGen.html#genApplicativeData"><span class="hs-identifier hs-var hs-var">genApplicativeData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Shape f) -&gt; RawApplicativeData -&gt; ApplicativeData f
forall (f :: * -&gt; *).
Vector (Shape f) -&gt; RawApplicativeData -&gt; ApplicativeData f
</span><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-var">ApplicativeData</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Shape f)
</span><a href="#local-6989586621679202366"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">(RawApplicativeData -&gt; ApplicativeData f)
-&gt; [RawApplicativeData] -&gt; [ApplicativeData f]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; [RawApplicativeData]
</span><a href="ApplicativeGen.html#genRawApplicativeData"><span class="hs-identifier hs-var">genRawApplicativeData</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202367"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679202366"><span class="annot"><span class="annottext">Vector (Shape f)
</span><a href="#local-6989586621679202366"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679202367"><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202367"><span class="hs-identifier hs-var">sig</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Shape f -&gt; Int) -&gt; (Vector (Shape f), Vector Int)
forall a. Enum a =&gt; (a -&gt; Int) -&gt; (Vector a, Vector Int)
</span><a href="MonoidGen.html#makeEnv"><span class="hs-identifier hs-var">makeEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Shape f -&gt; Int
forall (f :: * -&gt; *). Foldable f =&gt; Shape f -&gt; Int
</span><span class="hs-identifier hs-var">lengthShape</span></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span id="local-6989586621679201874"><span class="annot"><a href="ApplicativeGen.html#genApplicativeDataFrom"><span class="hs-identifier hs-type">genApplicativeDataFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679201874"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MonoidGen.html#MonoidData"><span class="hs-identifier hs-type">MonoidData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span class="annot"><a href="#local-6989586621679201874"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-type">ApplicativeData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679201874"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-113"></span><span id="genApplicativeDataFrom"><span class="annot"><span class="annottext">genApplicativeDataFrom :: forall (f :: * -&gt; *).
Foldable f =&gt;
MonoidData (Shape f) -&gt; [ApplicativeData f]
</span><a href="ApplicativeGen.html#genApplicativeDataFrom"><span class="hs-identifier hs-var hs-var">genApplicativeDataFrom</span></a></span></span><span> </span><span id="local-6989586621679202382"><span class="annot"><span class="annottext">MonoidData (Shape f)
</span><a href="#local-6989586621679202382"><span class="hs-identifier hs-var">monData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Shape f) -&gt; RawApplicativeData -&gt; ApplicativeData f
forall (f :: * -&gt; *).
Vector (Shape f) -&gt; RawApplicativeData -&gt; ApplicativeData f
</span><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-var">ApplicativeData</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Shape f)
</span><a href="#local-6989586621679202383"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">(RawApplicativeData -&gt; ApplicativeData f)
-&gt; [RawApplicativeData] -&gt; [ApplicativeData f]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; RawMonoidData -&gt; [RawApplicativeData]
</span><a href="ApplicativeGen.html#genRawApplicativeDataFrom"><span class="hs-identifier hs-var">genRawApplicativeDataFrom</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202384"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679202385"><span class="hs-identifier hs-var">mon</span></a></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-115"></span><span>    </span><span id="local-6989586621679202383"><span class="annot"><span class="annottext">env :: Vector (Shape f)
</span><a href="#local-6989586621679202383"><span class="hs-identifier hs-var hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MonoidData (Shape f) -&gt; Vector (Shape f)
forall a. MonoidData a -&gt; Vector a
</span><a href="MonoidGen.html#_elemTable"><span class="hs-identifier hs-var">_elemTable</span></a></span><span> </span><span class="annot"><span class="annottext">MonoidData (Shape f)
</span><a href="#local-6989586621679202382"><span class="hs-identifier hs-var">monData</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span id="local-6989586621679202384"><span class="annot"><span class="annottext">sig :: Vector Int
</span><a href="#local-6989586621679202384"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Shape f -&gt; Int
forall (f :: * -&gt; *). Foldable f =&gt; Shape f -&gt; Int
</span><span class="hs-identifier hs-var">lengthShape</span></span><span> </span><span class="annot"><span class="annottext">(Shape f -&gt; Int) -&gt; Vector (Shape f) -&gt; Vector Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector (Shape f)
</span><a href="#local-6989586621679202383"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span id="local-6989586621679202385"><span class="annot"><span class="annottext">mon :: RawMonoidData
</span><a href="#local-6989586621679202385"><span class="hs-identifier hs-var hs-var">mon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MonoidData (Shape f) -&gt; RawMonoidData
forall a. MonoidData a -&gt; RawMonoidData
</span><a href="MonoidGen.html#_rawMonoidData"><span class="hs-identifier hs-var">_rawMonoidData</span></a></span><span> </span><span class="annot"><span class="annottext">MonoidData (Shape f)
</span><a href="#local-6989586621679202382"><span class="hs-identifier hs-var">monData</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="annot"><span class="hs-comment">-- ** Serialize/deserialize</span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="annot"><a href="ApplicativeGen.html#signatureOf"><span class="hs-identifier hs-type">signatureOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679201879"><span class="annot"><a href="#local-6989586621679201879"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679201880"><span class="annot"><a href="#local-6989586621679201880"><span class="hs-identifier hs-type">proxy</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679201879"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679201880"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679201879"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-122"></span><span id="signatureOf"><span class="annot"><span class="annottext">signatureOf :: forall (f :: * -&gt; *) (proxy :: (* -&gt; *) -&gt; *).
PTraversable f =&gt;
proxy f -&gt; [Int]
</span><a href="ApplicativeGen.html#signatureOf"><span class="hs-identifier hs-var hs-var">signatureOf</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Shape f -&gt; Int
forall (f :: * -&gt; *). Foldable f =&gt; Shape f -&gt; Int
</span><span class="hs-identifier hs-var">lengthShape</span></span><span> </span><span class="annot"><span class="annottext">(Shape f -&gt; Int) -&gt; [Shape f] -&gt; [Int]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Shape f]
forall x (f :: * -&gt; *). (Enum x, Alternative f) =&gt; f x
</span><span class="hs-identifier hs-var">enum</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span class="annot"><a href="#local-6989586621679201879"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="annot"><a href="ApplicativeGen.html#serializeApplicativeDataList"><span class="hs-identifier hs-type">serializeApplicativeDataList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679201886"><span class="annot"><a href="#local-6989586621679201886"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679201886"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-type">ApplicativeData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679201886"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-125"></span><span id="serializeApplicativeDataList"><span class="annot"><span class="annottext">serializeApplicativeDataList :: forall (f :: * -&gt; *).
PTraversable f =&gt;
[ApplicativeData f] -&gt; [String]
</span><a href="ApplicativeGen.html#serializeApplicativeDataList"><span class="hs-identifier hs-var hs-var">serializeApplicativeDataList</span></a></span></span><span> </span><span id="local-6989586621679202413"><span class="annot"><span class="annottext">[ApplicativeData f]
</span><a href="#local-6989586621679202413"><span class="hs-identifier hs-var">apData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><span class="annottext">[Int] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) (proxy :: (* -&gt; *) -&gt; *).
PTraversable f =&gt;
proxy f -&gt; [Int]
</span><a href="ApplicativeGen.html#signatureOf"><span class="hs-identifier hs-var">signatureOf</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679201886"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy f
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(ApplicativeData f -&gt; String) -&gt; [ApplicativeData f] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApplicativeCode -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(ApplicativeCode -&gt; String)
-&gt; (ApplicativeData f -&gt; ApplicativeCode)
-&gt; ApplicativeData f
-&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ApplicativeData f -&gt; ApplicativeCode
forall (f :: * -&gt; *). ApplicativeData f -&gt; ApplicativeCode
</span><a href="ApplicativeGen.html#encodeApplicativeData"><span class="hs-identifier hs-var">encodeApplicativeData</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ApplicativeData f] -&gt; [ApplicativeData f]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="annot"><span class="annottext">[ApplicativeData f]
</span><a href="#local-6989586621679202413"><span class="hs-identifier hs-var">apData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="annot"><a href="ApplicativeGen.html#deserializeApplicativeDataList"><span class="hs-identifier hs-type">deserializeApplicativeDataList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679201906"><span class="annot"><a href="#local-6989586621679201906"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679201906"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-type">ApplicativeData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679201906"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-129"></span><span id="deserializeApplicativeDataList"><span class="annot"><span class="annottext">deserializeApplicativeDataList :: forall (f :: * -&gt; *).
PTraversable f =&gt;
[String] -&gt; Either String [ApplicativeData f]
</span><a href="ApplicativeGen.html#deserializeApplicativeDataList"><span class="hs-identifier hs-var hs-var">deserializeApplicativeDataList</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String [ApplicativeData f]
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;No signature&quot;</span></span><span>
</span><span id="line-130"></span><span class="annot"><a href="ApplicativeGen.html#deserializeApplicativeDataList"><span class="hs-identifier hs-var">deserializeApplicativeDataList</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679202444"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679202444"><span class="hs-identifier hs-var">sigStr</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679202445"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679202445"><span class="hs-identifier hs-var">records</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Either String ()
</span><a href="#local-6989586621679202446"><span class="hs-identifier hs-var">readSig</span></a></span><span>
</span><span id="line-132"></span><span>     </span><span class="annot"><span class="annottext">((Int, String) -&gt; Either String (ApplicativeData f))
-&gt; [(Int, String)] -&gt; Either String [ApplicativeData f]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">(Int, String) -&gt; Either String (ApplicativeData f)
</span><a href="#local-6989586621679202448"><span class="hs-identifier hs-var">parseMonadData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; [String] -&gt; [(Int, String)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679202445"><span class="hs-identifier hs-var">records</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-134"></span><span>    </span><span class="annot"><a href="#local-6989586621679202446"><span class="hs-identifier hs-type">readSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621679202446"><span class="annot"><span class="annottext">readSig :: Either String ()
</span><a href="#local-6989586621679202446"><span class="hs-identifier hs-var hs-var">readSig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe [Int]
forall a. Read a =&gt; String -&gt; Maybe a
</span><span class="hs-identifier hs-var">readMaybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679202444"><span class="hs-identifier hs-var">sigStr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-136"></span><span>      </span><span class="annot"><span class="annottext">Maybe [Int]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String ()
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;parse error at signature&quot;</span></span><span>
</span><span id="line-137"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679202449"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679202449"><span class="hs-identifier hs-var">sig</span></a></span></span><span>
</span><span id="line-138"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679202449"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Int] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679202450"><span class="hs-identifier hs-var">expectedSig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Either String ()
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String ()
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;signature mismatch&quot;</span></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><a href="#local-6989586621679202450"><span class="hs-identifier hs-type">expectedSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-142"></span><span>    </span><span id="local-6989586621679202450"><span class="annot"><span class="annottext">expectedSig :: [Int]
</span><a href="#local-6989586621679202450"><span class="hs-identifier hs-var hs-var">expectedSig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy f -&gt; [Int]
forall (f :: * -&gt; *) (proxy :: (* -&gt; *) -&gt; *).
PTraversable f =&gt;
proxy f -&gt; [Int]
</span><a href="ApplicativeGen.html#signatureOf"><span class="hs-identifier hs-var">signatureOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy f
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679201906"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><a href="#local-6989586621679202448"><span class="hs-identifier hs-type">parseMonadData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-type">ApplicativeData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679201906"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>    </span><span id="local-6989586621679202448"><span class="annot"><span class="annottext">parseMonadData :: (Int, String) -&gt; Either String (ApplicativeData f)
</span><a href="#local-6989586621679202448"><span class="hs-identifier hs-var hs-var">parseMonadData</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679202451"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202451"><span class="hs-identifier hs-var">lineNo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679202452"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679202452"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe ApplicativeCode
forall a. Read a =&gt; String -&gt; Maybe a
</span><span class="hs-identifier hs-var">readMaybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679202452"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-146"></span><span>      </span><span class="annot"><span class="annottext">Maybe ApplicativeCode
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (ApplicativeData f)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String (ApplicativeData f))
-&gt; String -&gt; Either String (ApplicativeData f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;parse error at line &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202451"><span class="hs-identifier hs-var">lineNo</span></a></span><span>
</span><span id="line-147"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679202453"><span class="annot"><span class="annottext">ApplicativeCode
</span><a href="#local-6989586621679202453"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ApplicativeCode -&gt; Maybe (ApplicativeData f)
forall (f :: * -&gt; *).
PTraversable f =&gt;
ApplicativeCode -&gt; Maybe (ApplicativeData f)
</span><a href="ApplicativeGen.html#decodeApplicativeData"><span class="hs-identifier hs-var">decodeApplicativeData</span></a></span><span> </span><span class="annot"><span class="annottext">ApplicativeCode
</span><a href="#local-6989586621679202453"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-148"></span><span>        </span><span class="annot"><span class="annottext">Maybe (ApplicativeData f)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (ApplicativeData f)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String (ApplicativeData f))
-&gt; String -&gt; Either String (ApplicativeData f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;non well-formed ApplicativeData at line &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202451"><span class="hs-identifier hs-var">lineNo</span></a></span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679202455"><span class="annot"><span class="annottext">ApplicativeData f
</span><a href="#local-6989586621679202455"><span class="hs-identifier hs-var">md</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ApplicativeData f -&gt; Either String (ApplicativeData f)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">ApplicativeData f
</span><a href="#local-6989586621679202455"><span class="hs-identifier hs-var">md</span></a></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-keyword">type</span><span> </span><span id="ApplicativeCode"><span class="annot"><a href="ApplicativeGen.html#ApplicativeCode"><span class="hs-identifier hs-var">ApplicativeCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span id="local-6989586621679201904"><span class="annot"><a href="ApplicativeGen.html#encodeApplicativeData"><span class="hs-identifier hs-type">encodeApplicativeData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-type">ApplicativeData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679201904"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeCode"><span class="hs-identifier hs-type">ApplicativeCode</span></a></span></span><span>
</span><span id="line-154"></span><span id="encodeApplicativeData"><span class="annot"><span class="annottext">encodeApplicativeData :: forall (f :: * -&gt; *). ApplicativeData f -&gt; ApplicativeCode
</span><a href="ApplicativeGen.html#encodeApplicativeData"><span class="hs-identifier hs-var hs-var">encodeApplicativeData</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-type">ApplicativeData</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Shape f)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679202456"><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202456"><span class="hs-identifier hs-var">raw</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202457"><span class="hs-identifier hs-var">unitElem</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679202458"><span class="hs-identifier hs-var">multTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[Int]]
</span><a href="#local-6989586621679202459"><span class="hs-identifier hs-var">leftFactor</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[Int]]
</span><a href="#local-6989586621679202460"><span class="hs-identifier hs-var">rightFactor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679202457"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202457"><span class="hs-identifier hs-var">unitElem</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679202458"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679202458"><span class="hs-identifier hs-var">multTable</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; (Int, [Int])
</span><a href="MonoidGen.html#encodeRawMonoidData"><span class="hs-identifier hs-var">encodeRawMonoidData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RawApplicativeData -&gt; RawMonoidData
</span><a href="ApplicativeGen.html#_baseMonoid"><span class="hs-identifier hs-var">_baseMonoid</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202456"><span class="hs-identifier hs-var">raw</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>    </span><span id="local-6989586621679202459"><span class="annot"><span class="annottext">leftFactor :: [[Int]]
</span><a href="#local-6989586621679202459"><span class="hs-identifier hs-var hs-var">leftFactor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; [Int]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector Int -&gt; [Int]) -&gt; [Vector Int] -&gt; [[Int]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FactorTable -&gt; [Vector Int]
forall i e. Array i e -&gt; [e]
</span><span class="hs-identifier hs-var">Array.elems</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RawApplicativeData -&gt; FactorTable
</span><a href="ApplicativeGen.html#_leftFactorTable"><span class="hs-identifier hs-var">_leftFactorTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202456"><span class="hs-identifier hs-var">raw</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>    </span><span id="local-6989586621679202460"><span class="annot"><span class="annottext">rightFactor :: [[Int]]
</span><a href="#local-6989586621679202460"><span class="hs-identifier hs-var hs-var">rightFactor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; [Int]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector Int -&gt; [Int]) -&gt; [Vector Int] -&gt; [[Int]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FactorTable -&gt; [Vector Int]
forall i e. Array i e -&gt; [e]
</span><span class="hs-identifier hs-var">Array.elems</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RawApplicativeData -&gt; FactorTable
</span><a href="ApplicativeGen.html#_rightFactorTable"><span class="hs-identifier hs-var">_rightFactorTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202456"><span class="hs-identifier hs-var">raw</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="annot"><a href="ApplicativeGen.html#decodeApplicativeData"><span class="hs-identifier hs-type">decodeApplicativeData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679201927"><span class="annot"><a href="#local-6989586621679201927"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679201927"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeCode"><span class="hs-identifier hs-type">ApplicativeCode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-type">ApplicativeData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679201927"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span id="decodeApplicativeData"><span class="annot"><span class="annottext">decodeApplicativeData :: forall (f :: * -&gt; *).
PTraversable f =&gt;
ApplicativeCode -&gt; Maybe (ApplicativeData f)
</span><a href="ApplicativeGen.html#decodeApplicativeData"><span class="hs-identifier hs-var hs-var">decodeApplicativeData</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679202502"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202502"><span class="hs-identifier hs-var">unitElem</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679202503"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679202503"><span class="hs-identifier hs-var">multTable</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679202504"><span class="annot"><span class="annottext">[[Int]]
</span><a href="#local-6989586621679202504"><span class="hs-identifier hs-var">leftFactor</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679202505"><span class="annot"><span class="annottext">[[Int]]
</span><a href="#local-6989586621679202505"><span class="hs-identifier hs-var">rightFactor</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-162"></span><span>  </span><span id="local-6989586621679202506"><span class="annot"><a href="#local-6989586621679202506"><span class="hs-identifier hs-var">rawMonoid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int, [Int]) -&gt; Maybe RawMonoidData
</span><a href="MonoidGen.html#decodeRawMonoidData"><span class="hs-identifier hs-var">decodeRawMonoidData</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202507"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202502"><span class="hs-identifier hs-var">unitElem</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679202503"><span class="hs-identifier hs-var">multTable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679202511"><span class="annot"><a href="#local-6989586621679202511"><span class="hs-identifier hs-var hs-var">factorLens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) Int -&gt; [((Int, Int), Int)]
forall i e. Ix i =&gt; Array i e -&gt; [(i, e)]
</span><span class="hs-identifier hs-var">Array.assocs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RawMonoidData -&gt; Array (Int, Int) Int
</span><a href="#local-6989586621679202513"><span class="hs-identifier hs-var">factorLenTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679202506"><span class="hs-identifier hs-var">rawMonoid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="annot"><a href="#local-6989586621679202514"><span class="hs-identifier hs-type">validLength</span></a></span><span>
</span><span id="line-165"></span><span>  </span><span id="local-6989586621679202515"><span class="annot"><a href="#local-6989586621679202515"><span class="hs-identifier hs-var">leftFactor'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Array.listArray</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679202507"><span class="hs-identifier hs-type">n</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679202507"><span class="hs-identifier hs-type">n</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">sequenceA</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">zipWith</span></span><span> </span><span class="annot"><a href="#local-6989586621679202519"><span class="hs-identifier hs-type">makeLeftFactor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202511"><span class="hs-identifier hs-type">factorLens</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202504"><span class="hs-identifier hs-type">leftFactor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>  </span><span id="local-6989586621679202520"><span class="annot"><a href="#local-6989586621679202520"><span class="hs-identifier hs-var">rightFactor'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Array.listArray</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679202507"><span class="hs-identifier hs-type">n</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679202507"><span class="hs-identifier hs-type">n</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">sequenceA</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">zipWith</span></span><span> </span><span class="annot"><a href="#local-6989586621679202521"><span class="hs-identifier hs-type">makeRightFactor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202511"><span class="hs-identifier hs-type">factorLens</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202505"><span class="hs-identifier hs-type">rightFactor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679202522"><span class="annot"><a href="#local-6989586621679202522"><span class="hs-identifier hs-var hs-var">rawApplicative</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><span class="annottext">_signature :: Vector Int
</span><a href="ApplicativeGen.html#_signature"><span class="hs-identifier hs-var">_signature</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202525"><span class="hs-identifier hs-var">sig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-171"></span><span>        </span><span class="annot"><span class="annottext">_baseMonoid :: RawMonoidData
</span><a href="ApplicativeGen.html#_baseMonoid"><span class="hs-identifier hs-var">_baseMonoid</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679202506"><span class="hs-identifier hs-var">rawMonoid</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="annottext">_leftFactorTable :: FactorTable
</span><a href="ApplicativeGen.html#_leftFactorTable"><span class="hs-identifier hs-var">_leftFactorTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679202515"><span class="hs-identifier hs-var">leftFactor'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><span class="annottext">_rightFactorTable :: FactorTable
</span><a href="ApplicativeGen.html#_rightFactorTable"><span class="hs-identifier hs-var">_rightFactorTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679202520"><span class="hs-identifier hs-var">rightFactor'</span></a></span><span>
</span><span id="line-174"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-175"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeData"><span class="hs-identifier hs-type">ApplicativeData</span></a></span><span class="hs-special">{</span><span>
</span><span id="line-176"></span><span>      </span><span class="annot"><a href="ApplicativeGen.html#_applicativeShapeTable"><span class="hs-identifier hs-var">_applicativeShapeTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679202526"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-177"></span><span>      </span><span class="annot"><a href="ApplicativeGen.html#_rawApplicative"><span class="hs-identifier hs-var">_rawApplicative</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679202522"><span class="hs-identifier hs-type">rawApplicative</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679202526"><span class="annot"><span class="annottext">Vector (Shape f)
</span><a href="#local-6989586621679202526"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679202525"><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202525"><span class="hs-identifier hs-var">sig</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Shape f -&gt; Int) -&gt; (Vector (Shape f), Vector Int)
forall a. Enum a =&gt; (a -&gt; Int) -&gt; (Vector a, Vector Int)
</span><a href="MonoidGen.html#makeEnv"><span class="hs-identifier hs-var">makeEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Shape f -&gt; Int
forall (f :: * -&gt; *). Foldable f =&gt; Shape f -&gt; Int
</span><span class="hs-identifier hs-var">lengthShape</span></span><span>
</span><span id="line-181"></span><span>    </span><span id="local-6989586621679202507"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679202507"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int
forall a. Vector a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202525"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621679202546"><span class="annot"><span class="annottext">tableRange :: ((Int, Int), (Int, Int))
</span><a href="#local-6989586621679202546"><span class="hs-identifier hs-var hs-var">tableRange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202507"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202507"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621679202513"><span class="annot"><span class="annottext">factorLenTable :: RawMonoidData -&gt; Array (Int, Int) Int
</span><a href="#local-6989586621679202513"><span class="hs-identifier hs-var hs-var">factorLenTable</span></a></span></span><span> </span><span id="local-6989586621679202551"><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679202551"><span class="hs-identifier hs-var">rawMonoid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Int), (Int, Int))
-&gt; ((Int, Int) -&gt; Int) -&gt; Array (Int, Int) Int
forall i a. Ix i =&gt; (i, i) -&gt; (i -&gt; a) -&gt; Array i a
</span><a href="Data.Array.Extra.html#genArray"><span class="hs-identifier hs-var">Array.genArray</span></a></span><span> </span><span class="annot"><span class="annottext">((Int, Int), (Int, Int))
</span><a href="#local-6989586621679202546"><span class="hs-identifier hs-var">tableRange</span></a></span><span> </span><span class="annot"><span class="annottext">(((Int, Int) -&gt; Int) -&gt; Array (Int, Int) Int)
-&gt; ((Int, Int) -&gt; Int) -&gt; Array (Int, Int) Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-185"></span><span>      </span><span class="hs-glyph">\</span><span id="local-6989586621679202553"><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679202553"><span class="hs-identifier hs-var">ij</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202525"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RawMonoidData -&gt; Array (Int, Int) Int
</span><a href="MonoidGen.html#_multTable"><span class="hs-identifier hs-var">_multTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679202551"><span class="hs-identifier hs-var">rawMonoid</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) Int -&gt; (Int, Int) -&gt; Int
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">Array.!</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679202553"><span class="hs-identifier hs-var">ij</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>    </span><span>
</span><span id="line-187"></span><span>    </span><span id="local-6989586621679202519"><span class="annot"><span class="annottext">makeLeftFactor :: ((Int, b), Int) -&gt; [Int] -&gt; Maybe (Vector Int)
</span><a href="#local-6989586621679202519"><span class="hs-identifier hs-var hs-var">makeLeftFactor</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679202555"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202555"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679202556"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202556"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679202557"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679202557"><span class="hs-identifier hs-var">ks</span></a></span></span><span>
</span><span id="line-188"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679202558"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Maybe (Vector Int)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; Vector Int
forall a. Int -&gt; [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromListN</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202556"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679202557"><span class="hs-identifier hs-var">ks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Vector Int)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-190"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-191"></span><span>        </span><span id="local-6989586621679202560"><span class="annot"><span class="annottext">targetLen :: Int
</span><a href="#local-6989586621679202560"><span class="hs-identifier hs-var hs-var">targetLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202525"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202555"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-192"></span><span>        </span><span id="local-6989586621679202564"><span class="annot"><span class="annottext">checkRange :: Int -&gt; Bool
</span><a href="#local-6989586621679202564"><span class="hs-identifier hs-var hs-var">checkRange</span></a></span></span><span> </span><span id="local-6989586621679202565"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202565"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202565"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202565"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202560"><span class="hs-identifier hs-var">targetLen</span></a></span><span>
</span><span id="line-193"></span><span>        </span><span id="local-6989586621679202558"><span class="annot"><span class="annottext">valid :: Bool
</span><a href="#local-6989586621679202558"><span class="hs-identifier hs-var hs-var">valid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679202557"><span class="hs-identifier hs-var">ks</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202556"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; [Int] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="#local-6989586621679202564"><span class="hs-identifier hs-var">checkRange</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679202557"><span class="hs-identifier hs-var">ks</span></a></span><span>
</span><span id="line-194"></span><span>    </span><span id="local-6989586621679202521"><span class="annot"><span class="annottext">makeRightFactor :: ((a, Int), Int) -&gt; [Int] -&gt; Maybe (Vector Int)
</span><a href="#local-6989586621679202521"><span class="hs-identifier hs-var hs-var">makeRightFactor</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679202571"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202571"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679202572"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202572"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679202573"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679202573"><span class="hs-identifier hs-var">ks</span></a></span></span><span>
</span><span id="line-195"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679202574"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Maybe (Vector Int)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; Vector Int
forall a. Int -&gt; [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromListN</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202572"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679202573"><span class="hs-identifier hs-var">ks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Vector Int)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-197"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-198"></span><span>        </span><span id="local-6989586621679202575"><span class="annot"><span class="annottext">targetLen :: Int
</span><a href="#local-6989586621679202575"><span class="hs-identifier hs-var hs-var">targetLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202525"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202571"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-199"></span><span>        </span><span id="local-6989586621679202579"><span class="annot"><span class="annottext">checkRange :: Int -&gt; Bool
</span><a href="#local-6989586621679202579"><span class="hs-identifier hs-var hs-var">checkRange</span></a></span></span><span> </span><span id="local-6989586621679202580"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202580"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202580"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202580"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202575"><span class="hs-identifier hs-var">targetLen</span></a></span><span>
</span><span id="line-200"></span><span>        </span><span id="local-6989586621679202574"><span class="annot"><span class="annottext">valid :: Bool
</span><a href="#local-6989586621679202574"><span class="hs-identifier hs-var hs-var">valid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679202573"><span class="hs-identifier hs-var">ks</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202572"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; [Int] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="#local-6989586621679202579"><span class="hs-identifier hs-var">checkRange</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679202573"><span class="hs-identifier hs-var">ks</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span>
</span><span id="line-202"></span><span>    </span><span id="local-6989586621679202514"><span class="annot"><span class="annottext">validLength :: Bool
</span><a href="#local-6989586621679202514"><span class="hs-identifier hs-var hs-var">validLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-203"></span><span>      </span><span class="annot"><span class="annottext">[[Int]] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[[Int]]
</span><a href="#local-6989586621679202504"><span class="hs-identifier hs-var">leftFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202507"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202507"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-204"></span><span>      </span><span class="annot"><span class="annottext">[[Int]] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[[Int]]
</span><a href="#local-6989586621679202505"><span class="hs-identifier hs-var">rightFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202507"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202507"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="annot"><span class="hs-comment">-- * Raw applicatives</span></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-keyword">data</span><span> </span><span id="RawApplicativeData"><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-var">RawApplicativeData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RawApplicativeData"><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-var">RawApplicativeData</span></a></span></span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_signature"><span class="annot"><span class="annottext">RawApplicativeData -&gt; Vector Int
</span><a href="ApplicativeGen.html#_signature"><span class="hs-identifier hs-var hs-var">_signature</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-210"></span><span>    </span><span id="_baseMonoid"><span class="annot"><span class="annottext">RawApplicativeData -&gt; RawMonoidData
</span><a href="ApplicativeGen.html#_baseMonoid"><span class="hs-identifier hs-var hs-var">_baseMonoid</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonoidGen.html#RawMonoidData"><span class="hs-identifier hs-type">RawMonoidData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-211"></span><span>    </span><span id="_leftFactorTable"><span class="annot"><span class="annottext">RawApplicativeData -&gt; FactorTable
</span><a href="ApplicativeGen.html#_leftFactorTable"><span class="hs-identifier hs-var hs-var">_leftFactorTable</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-212"></span><span>    </span><span id="_rightFactorTable"><span class="annot"><span class="annottext">RawApplicativeData -&gt; FactorTable
</span><a href="ApplicativeGen.html#_rightFactorTable"><span class="hs-identifier hs-var hs-var">_rightFactorTable</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679202592"><span id="local-6989586621679202602"><span class="annot"><span class="annottext">RawApplicativeData -&gt; RawApplicativeData -&gt; Bool
(RawApplicativeData -&gt; RawApplicativeData -&gt; Bool)
-&gt; (RawApplicativeData -&gt; RawApplicativeData -&gt; Bool)
-&gt; Eq RawApplicativeData
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: RawApplicativeData -&gt; RawApplicativeData -&gt; Bool
== :: RawApplicativeData -&gt; RawApplicativeData -&gt; Bool
$c/= :: RawApplicativeData -&gt; RawApplicativeData -&gt; Bool
/= :: RawApplicativeData -&gt; RawApplicativeData -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679202607"><span id="local-6989586621679202615"><span id="local-6989586621679202622"><span id="local-6989586621679202625"><span id="local-6989586621679202628"><span id="local-6989586621679202631"><span id="local-6989586621679202634"><span class="annot"><span class="annottext">Eq RawApplicativeData
Eq RawApplicativeData =&gt;
(RawApplicativeData -&gt; RawApplicativeData -&gt; Ordering)
-&gt; (RawApplicativeData -&gt; RawApplicativeData -&gt; Bool)
-&gt; (RawApplicativeData -&gt; RawApplicativeData -&gt; Bool)
-&gt; (RawApplicativeData -&gt; RawApplicativeData -&gt; Bool)
-&gt; (RawApplicativeData -&gt; RawApplicativeData -&gt; Bool)
-&gt; (RawApplicativeData -&gt; RawApplicativeData -&gt; RawApplicativeData)
-&gt; (RawApplicativeData -&gt; RawApplicativeData -&gt; RawApplicativeData)
-&gt; Ord RawApplicativeData
RawApplicativeData -&gt; RawApplicativeData -&gt; Bool
RawApplicativeData -&gt; RawApplicativeData -&gt; Ordering
RawApplicativeData -&gt; RawApplicativeData -&gt; RawApplicativeData
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: RawApplicativeData -&gt; RawApplicativeData -&gt; Ordering
compare :: RawApplicativeData -&gt; RawApplicativeData -&gt; Ordering
$c&lt; :: RawApplicativeData -&gt; RawApplicativeData -&gt; Bool
&lt; :: RawApplicativeData -&gt; RawApplicativeData -&gt; Bool
$c&lt;= :: RawApplicativeData -&gt; RawApplicativeData -&gt; Bool
&lt;= :: RawApplicativeData -&gt; RawApplicativeData -&gt; Bool
$c&gt; :: RawApplicativeData -&gt; RawApplicativeData -&gt; Bool
&gt; :: RawApplicativeData -&gt; RawApplicativeData -&gt; Bool
$c&gt;= :: RawApplicativeData -&gt; RawApplicativeData -&gt; Bool
&gt;= :: RawApplicativeData -&gt; RawApplicativeData -&gt; Bool
$cmax :: RawApplicativeData -&gt; RawApplicativeData -&gt; RawApplicativeData
max :: RawApplicativeData -&gt; RawApplicativeData -&gt; RawApplicativeData
$cmin :: RawApplicativeData -&gt; RawApplicativeData -&gt; RawApplicativeData
min :: RawApplicativeData -&gt; RawApplicativeData -&gt; RawApplicativeData
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679202637"><span id="local-6989586621679202648"><span id="local-6989586621679202652"><span class="annot"><span class="annottext">Int -&gt; RawApplicativeData -&gt; String -&gt; String
[RawApplicativeData] -&gt; String -&gt; String
RawApplicativeData -&gt; String
(Int -&gt; RawApplicativeData -&gt; String -&gt; String)
-&gt; (RawApplicativeData -&gt; String)
-&gt; ([RawApplicativeData] -&gt; String -&gt; String)
-&gt; Show RawApplicativeData
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
$cshowsPrec :: Int -&gt; RawApplicativeData -&gt; String -&gt; String
showsPrec :: Int -&gt; RawApplicativeData -&gt; String -&gt; String
$cshow :: RawApplicativeData -&gt; String
show :: RawApplicativeData -&gt; String
$cshowList :: [RawApplicativeData] -&gt; String -&gt; String
showList :: [RawApplicativeData] -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-keyword">type</span><span> </span><span id="FactorTable"><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-var">FactorTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="annot"><a href="ApplicativeGen.html#prettyRawApplicativeData"><span class="hs-identifier hs-type">prettyRawApplicativeData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-219"></span><span id="prettyRawApplicativeData"><span class="annot"><span class="annottext">prettyRawApplicativeData :: String -&gt; RawApplicativeData -&gt; [String]
</span><a href="ApplicativeGen.html#prettyRawApplicativeData"><span class="hs-identifier hs-var hs-var">prettyRawApplicativeData</span></a></span></span><span> </span><span id="local-6989586621679202657"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679202657"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679202658"><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202658"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679202657"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = RawApplicative{&quot;</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-221"></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; [String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679202659"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Signature: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Vector Int
</span><a href="ApplicativeGen.html#_signature"><span class="hs-identifier hs-var">_signature</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202658"><span class="hs-identifier hs-var">raw</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; RawMonoidData -&gt; [String]
</span><a href="MonoidGen.html#prettyRawMonoidData"><span class="hs-identifier hs-var">prettyRawMonoidData</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;base&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RawApplicativeData -&gt; RawMonoidData
</span><a href="ApplicativeGen.html#_baseMonoid"><span class="hs-identifier hs-var">_baseMonoid</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202658"><span class="hs-identifier hs-var">raw</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LeftFactor:&quot;</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; [String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679202659"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FactorTable -&gt; [String]
forall i j a.
(Ix i, Ix j, Show i, Show j, Show a) =&gt;
Array (i, j) a -&gt; [String]
</span><a href="Data.Array.Extra.html#prettyArray"><span class="hs-identifier hs-var">Array.prettyArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RawApplicativeData -&gt; FactorTable
</span><a href="ApplicativeGen.html#_leftFactorTable"><span class="hs-identifier hs-var">_leftFactorTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202658"><span class="hs-identifier hs-var">raw</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RightFactor:&quot;</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; [String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679202659"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FactorTable -&gt; [String]
forall i j a.
(Ix i, Ix j, Show i, Show j, Show a) =&gt;
Array (i, j) a -&gt; [String]
</span><a href="Data.Array.Extra.html#prettyArray"><span class="hs-identifier hs-var">Array.prettyArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RawApplicativeData -&gt; FactorTable
</span><a href="ApplicativeGen.html#_rightFactorTable"><span class="hs-identifier hs-var">_rightFactorTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202658"><span class="hs-identifier hs-var">raw</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-231"></span><span>    </span><span id="local-6989586621679202659"><span class="annot"><span class="annottext">indent :: String -&gt; String
</span><a href="#local-6989586621679202659"><span class="hs-identifier hs-var hs-var">indent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="annot"><a href="ApplicativeGen.html#monoidOp"><span class="hs-identifier hs-type">monoidOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-234"></span><span id="monoidOp"><span class="annot"><span class="annottext">monoidOp :: RawApplicativeData -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#monoidOp"><span class="hs-identifier hs-var hs-var">monoidOp</span></a></span></span><span> </span><span id="local-6989586621679202661"><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202661"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202662"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-236"></span><span>    </span><span id="local-6989586621679202663"><span class="annot"><span class="annottext">table :: Array (Int, Int) Int
</span><a href="#local-6989586621679202663"><span class="hs-identifier hs-var hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Array (Int, Int) Int
</span><a href="MonoidGen.html#_multTable"><span class="hs-identifier hs-var">_multTable</span></a></span><span> </span><span class="annot"><span class="annottext">(RawMonoidData -&gt; Array (Int, Int) Int)
-&gt; (RawApplicativeData -&gt; RawMonoidData)
-&gt; RawApplicativeData
-&gt; Array (Int, Int) Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; RawMonoidData
</span><a href="ApplicativeGen.html#_baseMonoid"><span class="hs-identifier hs-var">_baseMonoid</span></a></span><span> </span><span class="annot"><span class="annottext">(RawApplicativeData -&gt; Array (Int, Int) Int)
-&gt; RawApplicativeData -&gt; Array (Int, Int) Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202661"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-237"></span><span>    </span><span id="local-6989586621679202662"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202662"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679202667"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202667"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679202668"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202668"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) Int
</span><a href="#local-6989586621679202663"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) Int -&gt; (Int, Int) -&gt; Int
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202667"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202668"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="annot"><a href="ApplicativeGen.html#leftFactorOp"><span class="hs-identifier hs-type">leftFactorOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-240"></span><span id="leftFactorOp"><span class="annot"><span class="annottext">leftFactorOp :: RawApplicativeData -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#leftFactorOp"><span class="hs-identifier hs-var hs-var">leftFactorOp</span></a></span></span><span> </span><span id="local-6989586621679202669"><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202669"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202670"><span class="hs-identifier hs-var">leftFactor</span></a></span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-242"></span><span>    </span><span id="local-6989586621679202671"><span class="annot"><span class="annottext">table :: FactorTable
</span><a href="#local-6989586621679202671"><span class="hs-identifier hs-var hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; FactorTable
</span><a href="ApplicativeGen.html#_leftFactorTable"><span class="hs-identifier hs-var">_leftFactorTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202669"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span id="local-6989586621679202670"><span class="annot"><span class="annottext">leftFactor :: Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202670"><span class="hs-identifier hs-var hs-var">leftFactor</span></a></span></span><span> </span><span id="local-6989586621679202675"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202675"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679202676"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202676"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679202677"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202677"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679202671"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">FactorTable -&gt; (Int, Int) -&gt; Vector Int
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202675"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202676"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202677"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="annot"><a href="ApplicativeGen.html#rightFactorOp"><span class="hs-identifier hs-type">rightFactorOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-246"></span><span id="rightFactorOp"><span class="annot"><span class="annottext">rightFactorOp :: RawApplicativeData -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#rightFactorOp"><span class="hs-identifier hs-var hs-var">rightFactorOp</span></a></span></span><span> </span><span id="local-6989586621679202678"><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202678"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202679"><span class="hs-identifier hs-var">rightFactor</span></a></span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-248"></span><span>    </span><span id="local-6989586621679202680"><span class="annot"><span class="annottext">table :: FactorTable
</span><a href="#local-6989586621679202680"><span class="hs-identifier hs-var hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; FactorTable
</span><a href="ApplicativeGen.html#_rightFactorTable"><span class="hs-identifier hs-var">_rightFactorTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202678"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-249"></span><span>    </span><span id="local-6989586621679202679"><span class="annot"><span class="annottext">rightFactor :: Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202679"><span class="hs-identifier hs-var hs-var">rightFactor</span></a></span></span><span> </span><span id="local-6989586621679202684"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202684"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679202685"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202685"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679202686"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202686"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679202680"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">FactorTable -&gt; (Int, Int) -&gt; Vector Int
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202684"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202685"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202686"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="annot"><a href="ApplicativeGen.html#prop_LeftUnit"><span class="hs-identifier hs-type">prop_LeftUnit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-252"></span><span id="prop_LeftUnit"><span class="annot"><span class="annottext">prop_LeftUnit :: RawApplicativeData -&gt; Bool
</span><a href="ApplicativeGen.html#prop_LeftUnit"><span class="hs-identifier hs-var hs-var">prop_LeftUnit</span></a></span></span><span> </span><span id="local-6989586621679202687"><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202687"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679202689"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-254"></span><span>    </span><span id="local-6989586621679202690"><span class="annot"><span class="annottext">sig :: Vector Int
</span><a href="#local-6989586621679202690"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Vector Int
</span><a href="ApplicativeGen.html#_signature"><span class="hs-identifier hs-var">_signature</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202687"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-255"></span><span>    </span><span id="local-6989586621679202691"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679202691"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202690"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-256"></span><span>    </span><span id="local-6989586621679202693"><span class="annot"><span class="annottext">e :: Int
</span><a href="#local-6989586621679202693"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Int
</span><a href="MonoidGen.html#_unitElem"><span class="hs-identifier hs-var">_unitElem</span></a></span><span> </span><span class="annot"><span class="annottext">(RawMonoidData -&gt; Int)
-&gt; (RawApplicativeData -&gt; RawMonoidData)
-&gt; RawApplicativeData
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; RawMonoidData
</span><a href="ApplicativeGen.html#_baseMonoid"><span class="hs-identifier hs-var">_baseMonoid</span></a></span><span> </span><span class="annot"><span class="annottext">(RawApplicativeData -&gt; Int) -&gt; RawApplicativeData -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202687"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-257"></span><span>    </span><span id="local-6989586621679202694"><span class="annot"><span class="annottext">leftFactor :: Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202694"><span class="hs-identifier hs-var hs-var">leftFactor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#leftFactorOp"><span class="hs-identifier hs-var">leftFactorOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202687"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-258"></span><span>    </span><span id="local-6989586621679202689"><span class="annot"><span class="annottext">result :: [Bool]
</span><a href="#local-6989586621679202689"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-259"></span><span>      </span><span id="local-6989586621679202707"><span class="annot"><a href="#local-6989586621679202707"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202691"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-260"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679202708"><span class="annot"><a href="#local-6989586621679202708"><span class="hs-identifier hs-var hs-var">numX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202690"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202707"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-261"></span><span>      </span><span id="local-6989586621679202709"><span class="annot"><a href="#local-6989586621679202709"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><a href="#local-6989586621679202708"><span class="hs-identifier hs-type">numX</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-262"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679202694"><span class="hs-identifier hs-type">leftFactor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202707"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202693"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202709"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621679202709"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="annot"><a href="ApplicativeGen.html#prop_RightUnit"><span class="hs-identifier hs-type">prop_RightUnit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-265"></span><span id="prop_RightUnit"><span class="annot"><span class="annottext">prop_RightUnit :: RawApplicativeData -&gt; Bool
</span><a href="ApplicativeGen.html#prop_RightUnit"><span class="hs-identifier hs-var hs-var">prop_RightUnit</span></a></span></span><span> </span><span id="local-6989586621679202710"><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202710"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679202711"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-267"></span><span>    </span><span id="local-6989586621679202712"><span class="annot"><span class="annottext">sig :: Vector Int
</span><a href="#local-6989586621679202712"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Vector Int
</span><a href="ApplicativeGen.html#_signature"><span class="hs-identifier hs-var">_signature</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202710"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621679202713"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679202713"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202712"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621679202714"><span class="annot"><span class="annottext">e :: Int
</span><a href="#local-6989586621679202714"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Int
</span><a href="MonoidGen.html#_unitElem"><span class="hs-identifier hs-var">_unitElem</span></a></span><span> </span><span class="annot"><span class="annottext">(RawMonoidData -&gt; Int)
-&gt; (RawApplicativeData -&gt; RawMonoidData)
-&gt; RawApplicativeData
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; RawMonoidData
</span><a href="ApplicativeGen.html#_baseMonoid"><span class="hs-identifier hs-var">_baseMonoid</span></a></span><span> </span><span class="annot"><span class="annottext">(RawApplicativeData -&gt; Int) -&gt; RawApplicativeData -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202710"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-270"></span><span>    </span><span id="local-6989586621679202715"><span class="annot"><span class="annottext">rightFactor :: Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202715"><span class="hs-identifier hs-var hs-var">rightFactor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#rightFactorOp"><span class="hs-identifier hs-var">rightFactorOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202710"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-271"></span><span>    </span><span id="local-6989586621679202711"><span class="annot"><span class="annottext">result :: [Bool]
</span><a href="#local-6989586621679202711"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-272"></span><span>      </span><span id="local-6989586621679202728"><span class="annot"><a href="#local-6989586621679202728"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202713"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-273"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679202729"><span class="annot"><a href="#local-6989586621679202729"><span class="hs-identifier hs-var hs-var">numX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202712"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202728"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-274"></span><span>      </span><span id="local-6989586621679202730"><span class="annot"><a href="#local-6989586621679202730"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><a href="#local-6989586621679202729"><span class="hs-identifier hs-type">numX</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-275"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679202715"><span class="hs-identifier hs-type">rightFactor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202714"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202728"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202730"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621679202730"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="annot"><a href="ApplicativeGen.html#prop_LeftLeft"><span class="hs-identifier hs-type">prop_LeftLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-278"></span><span id="prop_LeftLeft"><span class="annot"><span class="annottext">prop_LeftLeft :: RawApplicativeData -&gt; Bool
</span><a href="ApplicativeGen.html#prop_LeftLeft"><span class="hs-identifier hs-var hs-var">prop_LeftLeft</span></a></span></span><span> </span><span id="local-6989586621679202731"><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202731"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679202732"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621679202733"><span class="annot"><span class="annottext">sig :: Vector Int
</span><a href="#local-6989586621679202733"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Vector Int
</span><a href="ApplicativeGen.html#_signature"><span class="hs-identifier hs-var">_signature</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202731"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-281"></span><span>    </span><span id="local-6989586621679202734"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679202734"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202733"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-282"></span><span>    </span><span id="local-6989586621679202735"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202735"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#monoidOp"><span class="hs-identifier hs-var">monoidOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202731"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-283"></span><span>    </span><span id="local-6989586621679202736"><span class="annot"><span class="annottext">leftFactor :: Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202736"><span class="hs-identifier hs-var hs-var">leftFactor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#leftFactorOp"><span class="hs-identifier hs-var">leftFactorOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202731"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-284"></span><span>    </span><span id="local-6989586621679202732"><span class="annot"><span class="annottext">result :: [Bool]
</span><a href="#local-6989586621679202732"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-285"></span><span>      </span><span id="local-6989586621679202759"><span class="annot"><a href="#local-6989586621679202759"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202734"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-286"></span><span>      </span><span id="local-6989586621679202760"><span class="annot"><a href="#local-6989586621679202760"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><a href="#local-6989586621679202734"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-287"></span><span>      </span><span id="local-6989586621679202761"><span class="annot"><a href="#local-6989586621679202761"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><a href="#local-6989586621679202734"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-288"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679202762"><span class="annot"><a href="#local-6989586621679202762"><span class="hs-identifier hs-var hs-var">ij</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202735"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202759"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202760"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-289"></span><span>          </span><span id="local-6989586621679202763"><span class="annot"><a href="#local-6989586621679202763"><span class="hs-identifier hs-var hs-var">jk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202735"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202760"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202761"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-290"></span><span>          </span><span id="local-6989586621679202764"><span class="annot"><a href="#local-6989586621679202764"><span class="hs-identifier hs-var hs-var">numX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202733"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202735"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202762"><span class="hs-identifier hs-var">ij</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202761"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-291"></span><span>      </span><span id="local-6989586621679202765"><span class="annot"><a href="#local-6989586621679202765"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><a href="#local-6989586621679202764"><span class="hs-identifier hs-type">numX</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-292"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679202736"><span class="hs-identifier hs-type">leftFactor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202759"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202760"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679202736"><span class="hs-identifier hs-type">leftFactor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202762"><span class="hs-identifier hs-type">ij</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202761"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202765"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621679202736"><span class="hs-identifier hs-type">leftFactor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202759"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202763"><span class="hs-identifier hs-type">jk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202765"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="annot"><a href="ApplicativeGen.html#prop_RightRight"><span class="hs-identifier hs-type">prop_RightRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-295"></span><span id="prop_RightRight"><span class="annot"><span class="annottext">prop_RightRight :: RawApplicativeData -&gt; Bool
</span><a href="ApplicativeGen.html#prop_RightRight"><span class="hs-identifier hs-var hs-var">prop_RightRight</span></a></span></span><span> </span><span id="local-6989586621679202766"><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202766"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679202767"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-297"></span><span>    </span><span id="local-6989586621679202768"><span class="annot"><span class="annottext">sig :: Vector Int
</span><a href="#local-6989586621679202768"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Vector Int
</span><a href="ApplicativeGen.html#_signature"><span class="hs-identifier hs-var">_signature</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202766"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-298"></span><span>    </span><span id="local-6989586621679202769"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679202769"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202768"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-299"></span><span>    </span><span id="local-6989586621679202770"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202770"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#monoidOp"><span class="hs-identifier hs-var">monoidOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202766"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-300"></span><span>    </span><span id="local-6989586621679202771"><span class="annot"><span class="annottext">rightFactor :: Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202771"><span class="hs-identifier hs-var hs-var">rightFactor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#rightFactorOp"><span class="hs-identifier hs-var">rightFactorOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202766"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span id="local-6989586621679202767"><span class="annot"><span class="annottext">result :: [Bool]
</span><a href="#local-6989586621679202767"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-302"></span><span>      </span><span id="local-6989586621679202794"><span class="annot"><a href="#local-6989586621679202794"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202769"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-303"></span><span>      </span><span id="local-6989586621679202795"><span class="annot"><a href="#local-6989586621679202795"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><a href="#local-6989586621679202769"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-304"></span><span>      </span><span id="local-6989586621679202796"><span class="annot"><a href="#local-6989586621679202796"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><a href="#local-6989586621679202769"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-305"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679202797"><span class="annot"><a href="#local-6989586621679202797"><span class="hs-identifier hs-var hs-var">ij</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202770"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202794"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202795"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-306"></span><span>          </span><span id="local-6989586621679202798"><span class="annot"><a href="#local-6989586621679202798"><span class="hs-identifier hs-var hs-var">jk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202770"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202795"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202796"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-307"></span><span>          </span><span id="local-6989586621679202799"><span class="annot"><a href="#local-6989586621679202799"><span class="hs-identifier hs-var hs-var">numX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202768"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202770"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202797"><span class="hs-identifier hs-var">ij</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202796"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-308"></span><span>      </span><span id="local-6989586621679202800"><span class="annot"><a href="#local-6989586621679202800"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><a href="#local-6989586621679202799"><span class="hs-identifier hs-type">numX</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-309"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679202771"><span class="hs-identifier hs-type">rightFactor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202795"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202796"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679202771"><span class="hs-identifier hs-type">rightFactor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202794"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202798"><span class="hs-identifier hs-type">jk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202800"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621679202771"><span class="hs-identifier hs-type">rightFactor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202797"><span class="hs-identifier hs-type">ij</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202796"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202800"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="annot"><a href="ApplicativeGen.html#prop_LeftRight"><span class="hs-identifier hs-type">prop_LeftRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-312"></span><span id="prop_LeftRight"><span class="annot"><span class="annottext">prop_LeftRight :: RawApplicativeData -&gt; Bool
</span><a href="ApplicativeGen.html#prop_LeftRight"><span class="hs-identifier hs-var hs-var">prop_LeftRight</span></a></span></span><span> </span><span id="local-6989586621679202801"><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202801"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679202802"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-314"></span><span>    </span><span id="local-6989586621679202803"><span class="annot"><span class="annottext">sig :: Vector Int
</span><a href="#local-6989586621679202803"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Vector Int
</span><a href="ApplicativeGen.html#_signature"><span class="hs-identifier hs-var">_signature</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202801"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-315"></span><span>    </span><span id="local-6989586621679202804"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679202804"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202803"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-316"></span><span>    </span><span id="local-6989586621679202805"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202805"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#monoidOp"><span class="hs-identifier hs-var">monoidOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202801"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-317"></span><span>    </span><span id="local-6989586621679202806"><span class="annot"><span class="annottext">leftFactor :: Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202806"><span class="hs-identifier hs-var hs-var">leftFactor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#leftFactorOp"><span class="hs-identifier hs-var">leftFactorOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202801"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-318"></span><span>    </span><span id="local-6989586621679202807"><span class="annot"><span class="annottext">rightFactor :: Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202807"><span class="hs-identifier hs-var hs-var">rightFactor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="ApplicativeGen.html#rightFactorOp"><span class="hs-identifier hs-var">rightFactorOp</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202801"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-319"></span><span>    </span><span id="local-6989586621679202802"><span class="annot"><span class="annottext">result :: [Bool]
</span><a href="#local-6989586621679202802"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-320"></span><span>      </span><span id="local-6989586621679202830"><span class="annot"><a href="#local-6989586621679202830"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202804"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-321"></span><span>      </span><span id="local-6989586621679202831"><span class="annot"><a href="#local-6989586621679202831"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><a href="#local-6989586621679202804"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-322"></span><span>      </span><span id="local-6989586621679202832"><span class="annot"><a href="#local-6989586621679202832"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><a href="#local-6989586621679202804"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-323"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679202833"><span class="annot"><a href="#local-6989586621679202833"><span class="hs-identifier hs-var hs-var">ij</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202805"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202830"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202831"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-324"></span><span>          </span><span id="local-6989586621679202834"><span class="annot"><a href="#local-6989586621679202834"><span class="hs-identifier hs-var hs-var">jk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202805"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202831"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202832"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-325"></span><span>          </span><span id="local-6989586621679202835"><span class="annot"><a href="#local-6989586621679202835"><span class="hs-identifier hs-var hs-var">numX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202803"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679202805"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202833"><span class="hs-identifier hs-var">ij</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202832"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-326"></span><span>      </span><span id="local-6989586621679202836"><span class="annot"><a href="#local-6989586621679202836"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><a href="#local-6989586621679202835"><span class="hs-identifier hs-type">numX</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-327"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679202807"><span class="hs-identifier hs-type">rightFactor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202830"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202831"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679202806"><span class="hs-identifier hs-type">leftFactor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202833"><span class="hs-identifier hs-type">ij</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202832"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202836"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621679202806"><span class="hs-identifier hs-type">leftFactor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202831"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202832"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679202807"><span class="hs-identifier hs-type">rightFactor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202830"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202834"><span class="hs-identifier hs-type">jk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202836"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="annot"><a href="ApplicativeGen.html#genRawApplicativeData"><span class="hs-identifier hs-type">genRawApplicativeData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonoidGen.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-330"></span><span id="genRawApplicativeData"><span class="annot"><span class="annottext">genRawApplicativeData :: Vector Int -&gt; [RawApplicativeData]
</span><a href="ApplicativeGen.html#genRawApplicativeData"><span class="hs-identifier hs-var hs-var">genRawApplicativeData</span></a></span></span><span> </span><span id="local-6989586621679202837"><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202837"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-331"></span><span>  </span><span id="local-6989586621679202838"><span class="annot"><a href="#local-6989586621679202838"><span class="hs-identifier hs-var">mon</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; [RawMonoidData]
</span><a href="MonoidGen.html#genRawMonoidsForApplicative"><span class="hs-identifier hs-var">genRawMonoidsForApplicative</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202837"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-332"></span><span>  </span><span class="annot"><a href="ApplicativeGen.html#genRawApplicativeDataFrom"><span class="hs-identifier hs-type">genRawApplicativeDataFrom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202837"><span class="hs-identifier hs-type">sig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202838"><span class="hs-identifier hs-type">mon</span></a></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="annot"><a href="ApplicativeGen.html#genRawApplicativeDataFrom"><span class="hs-identifier hs-type">genRawApplicativeDataFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonoidGen.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonoidGen.html#RawMonoidData"><span class="hs-identifier hs-type">RawMonoidData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-335"></span><span id="genRawApplicativeDataFrom"><span class="annot"><span class="annottext">genRawApplicativeDataFrom :: Vector Int -&gt; RawMonoidData -&gt; [RawApplicativeData]
</span><a href="ApplicativeGen.html#genRawApplicativeDataFrom"><span class="hs-identifier hs-var hs-var">genRawApplicativeDataFrom</span></a></span></span><span> </span><span id="local-6989586621679202839"><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202839"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span id="local-6989586621679202840"><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679202840"><span class="hs-identifier hs-var">mon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-336"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679202842"><span class="annot"><span class="annottext">tables :: [(FactorTable, FactorTable)]
</span><a href="#local-6989586621679202842"><span class="hs-identifier hs-var hs-var hs-var">tables</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
-&gt; RawMonoidData -&gt; DefTable Fn Int -&gt; (FactorTable, FactorTable)
</span><a href="ApplicativeGen.html#completeTable"><span class="hs-identifier hs-var">completeTable</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202839"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679202840"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">(DefTable Fn Int -&gt; (FactorTable, FactorTable))
-&gt; [DefTable Fn Int] -&gt; [(FactorTable, FactorTable)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; RawMonoidData -&gt; [DefTable Fn Int]
</span><a href="ApplicativeGen.html#gen"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202839"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679202840"><span class="hs-identifier hs-var">mon</span></a></span><span>
</span><span id="line-337"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679202845"><span class="annot"><a href="#local-6989586621679202845"><span class="hs-identifier hs-var">leftFactorTable</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679202846"><span class="annot"><a href="#local-6989586621679202846"><span class="hs-identifier hs-var">rightFactorTable</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Vector Int
-&gt; RawMonoidData
-&gt; [(FactorTable, FactorTable)]
-&gt; [(FactorTable, FactorTable)]
</span><a href="ApplicativeGen.html#upToIso"><span class="hs-identifier hs-var">upToIso</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202839"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679202840"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">[(FactorTable, FactorTable)]
</span><a href="#local-6989586621679202842"><span class="hs-identifier hs-var">tables</span></a></span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679202848"><span class="annot"><a href="#local-6989586621679202848"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-339"></span><span>        </span><span class="annot"><a href="ApplicativeGen.html#RawApplicativeData"><span class="hs-identifier hs-type">RawApplicativeData</span></a></span><span>
</span><span id="line-340"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_signature :: Vector Int
</span><a href="ApplicativeGen.html#_signature"><span class="hs-identifier hs-var">_signature</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679202839"><span class="hs-identifier hs-var">sig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-341"></span><span>            </span><span class="annot"><span class="annottext">_baseMonoid :: RawMonoidData
</span><a href="ApplicativeGen.html#_baseMonoid"><span class="hs-identifier hs-var">_baseMonoid</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679202840"><span class="hs-identifier hs-var">mon</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-342"></span><span>            </span><span class="annot"><span class="annottext">_leftFactorTable :: FactorTable
</span><a href="ApplicativeGen.html#_leftFactorTable"><span class="hs-identifier hs-var">_leftFactorTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679202845"><span class="hs-identifier hs-var">leftFactorTable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-343"></span><span>            </span><span class="annot"><span class="annottext">_rightFactorTable :: FactorTable
</span><a href="ApplicativeGen.html#_rightFactorTable"><span class="hs-identifier hs-var">_rightFactorTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679202846"><span class="hs-identifier hs-var">rightFactorTable</span></a></span><span>
</span><span id="line-344"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-345"></span><span>  </span><span class="hs-comment">-- sanity check</span><span>
</span><span id="line-346"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679202849"><span class="annot"><a href="#local-6989586621679202849"><span class="hs-identifier hs-var hs-var">checkAll</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Bool
</span><a href="ApplicativeGen.html#prop_LeftUnit"><span class="hs-identifier hs-var">prop_LeftUnit</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202848"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Bool
</span><a href="ApplicativeGen.html#prop_RightUnit"><span class="hs-identifier hs-var">prop_RightUnit</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202848"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-347"></span><span>        </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Bool
</span><a href="ApplicativeGen.html#prop_LeftLeft"><span class="hs-identifier hs-var">prop_LeftLeft</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202848"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Bool
</span><a href="ApplicativeGen.html#prop_LeftRight"><span class="hs-identifier hs-var">prop_LeftRight</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202848"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData -&gt; Bool
</span><a href="ApplicativeGen.html#prop_RightRight"><span class="hs-identifier hs-var">prop_RightRight</span></a></span><span> </span><span class="annot"><span class="annottext">RawApplicativeData
</span><a href="#local-6989586621679202848"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-348"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">assert</span></span><span> </span><span class="annot"><a href="#local-6989586621679202849"><span class="hs-identifier hs-type">checkAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621679202848"><span class="hs-identifier hs-type">result</span></a></span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="hs-keyword">data</span><span> </span><span id="Fn"><span class="annot"><a href="ApplicativeGen.html#Fn"><span class="hs-identifier hs-var">Fn</span></a></span></span><span> </span><span id="local-6989586621679202009"><span class="annot"><a href="#local-6989586621679202009"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LeftFactor"><span class="annot"><a href="ApplicativeGen.html#LeftFactor"><span class="hs-identifier hs-var">LeftFactor</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="#local-6989586621679202009"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="RightFactor"><span class="annot"><a href="ApplicativeGen.html#RightFactor"><span class="hs-identifier hs-var">RightFactor</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="#local-6989586621679202009"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-352"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679202854"><span id="local-6989586621679202864"><span id="local-6989586621679202868"><span class="annot"><span class="annottext">Int -&gt; Fn a -&gt; String -&gt; String
[Fn a] -&gt; String -&gt; String
Fn a -&gt; String
(Int -&gt; Fn a -&gt; String -&gt; String)
-&gt; (Fn a -&gt; String) -&gt; ([Fn a] -&gt; String -&gt; String) -&gt; Show (Fn a)
forall a. Show a =&gt; Int -&gt; Fn a -&gt; String -&gt; String
forall a. Show a =&gt; [Fn a] -&gt; String -&gt; String
forall a. Show a =&gt; Fn a -&gt; String
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Fn a -&gt; String -&gt; String
showsPrec :: Int -&gt; Fn a -&gt; String -&gt; String
$cshow :: forall a. Show a =&gt; Fn a -&gt; String
show :: Fn a -&gt; String
$cshowList :: forall a. Show a =&gt; [Fn a] -&gt; String -&gt; String
showList :: [Fn a] -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679202872"><span id="local-6989586621679202883"><span class="annot"><span class="annottext">Fn a -&gt; Fn a -&gt; Bool
(Fn a -&gt; Fn a -&gt; Bool) -&gt; (Fn a -&gt; Fn a -&gt; Bool) -&gt; Eq (Fn a)
forall a. Eq a =&gt; Fn a -&gt; Fn a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall a. Eq a =&gt; Fn a -&gt; Fn a -&gt; Bool
== :: Fn a -&gt; Fn a -&gt; Bool
$c/= :: forall a. Eq a =&gt; Fn a -&gt; Fn a -&gt; Bool
/= :: Fn a -&gt; Fn a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679202891"><span id="local-6989586621679202899"><span id="local-6989586621679202907"><span id="local-6989586621679202910"><span id="local-6989586621679202913"><span id="local-6989586621679202916"><span id="local-6989586621679202919"><span class="annot"><span class="annottext">Eq (Fn a)
Eq (Fn a) =&gt;
(Fn a -&gt; Fn a -&gt; Ordering)
-&gt; (Fn a -&gt; Fn a -&gt; Bool)
-&gt; (Fn a -&gt; Fn a -&gt; Bool)
-&gt; (Fn a -&gt; Fn a -&gt; Bool)
-&gt; (Fn a -&gt; Fn a -&gt; Bool)
-&gt; (Fn a -&gt; Fn a -&gt; Fn a)
-&gt; (Fn a -&gt; Fn a -&gt; Fn a)
-&gt; Ord (Fn a)
Fn a -&gt; Fn a -&gt; Bool
Fn a -&gt; Fn a -&gt; Ordering
Fn a -&gt; Fn a -&gt; Fn a
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall a. Ord a =&gt; Eq (Fn a)
forall a. Ord a =&gt; Fn a -&gt; Fn a -&gt; Bool
forall a. Ord a =&gt; Fn a -&gt; Fn a -&gt; Ordering
forall a. Ord a =&gt; Fn a -&gt; Fn a -&gt; Fn a
$ccompare :: forall a. Ord a =&gt; Fn a -&gt; Fn a -&gt; Ordering
compare :: Fn a -&gt; Fn a -&gt; Ordering
$c&lt; :: forall a. Ord a =&gt; Fn a -&gt; Fn a -&gt; Bool
&lt; :: Fn a -&gt; Fn a -&gt; Bool
$c&lt;= :: forall a. Ord a =&gt; Fn a -&gt; Fn a -&gt; Bool
&lt;= :: Fn a -&gt; Fn a -&gt; Bool
$c&gt; :: forall a. Ord a =&gt; Fn a -&gt; Fn a -&gt; Bool
&gt; :: Fn a -&gt; Fn a -&gt; Bool
$c&gt;= :: forall a. Ord a =&gt; Fn a -&gt; Fn a -&gt; Bool
&gt;= :: Fn a -&gt; Fn a -&gt; Bool
$cmax :: forall a. Ord a =&gt; Fn a -&gt; Fn a -&gt; Fn a
max :: Fn a -&gt; Fn a -&gt; Fn a
$cmin :: forall a. Ord a =&gt; Fn a -&gt; Fn a -&gt; Fn a
min :: Fn a -&gt; Fn a -&gt; Fn a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679202922"><span id="local-6989586621679202924"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; Fn a -&gt; Fn b)
-&gt; (forall a b. a -&gt; Fn b -&gt; Fn a) -&gt; Functor Fn
forall a b. a -&gt; Fn b -&gt; Fn a
forall a b. (a -&gt; b) -&gt; Fn a -&gt; Fn b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; Fn a -&gt; Fn b
fmap :: forall a b. (a -&gt; b) -&gt; Fn a -&gt; Fn b
$c&lt;$ :: forall a b. a -&gt; Fn b -&gt; Fn a
&lt;$ :: forall a b. a -&gt; Fn b -&gt; Fn a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679202928"><span id="local-6989586621679202934"><span id="local-6989586621679202937"><span id="local-6989586621679202942"><span id="local-6989586621679202944"><span id="local-6989586621679202947"><span id="local-6989586621679202950"><span id="local-6989586621679202953"><span id="local-6989586621679202956"><span id="local-6989586621679202959"><span id="local-6989586621679202962"><span id="local-6989586621679202964"><span id="local-6989586621679202967"><span id="local-6989586621679202972"><span id="local-6989586621679202977"><span id="local-6989586621679202982"><span id="local-6989586621679202987"><span class="annot"><span class="annottext">(forall m. Monoid m =&gt; Fn m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Fn a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Fn a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Fn a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Fn a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Fn a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Fn a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; Fn a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; Fn a -&gt; a)
-&gt; (forall a. Fn a -&gt; [a])
-&gt; (forall a. Fn a -&gt; Bool)
-&gt; (forall a. Fn a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; Fn a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; Fn a -&gt; a)
-&gt; (forall a. Ord a =&gt; Fn a -&gt; a)
-&gt; (forall a. Num a =&gt; Fn a -&gt; a)
-&gt; (forall a. Num a =&gt; Fn a -&gt; a)
-&gt; Foldable Fn
forall a. Eq a =&gt; a -&gt; Fn a -&gt; Bool
forall a. Num a =&gt; Fn a -&gt; a
forall a. Ord a =&gt; Fn a -&gt; a
forall m. Monoid m =&gt; Fn m -&gt; m
forall a. Fn a -&gt; Bool
forall a. Fn a -&gt; Int
forall a. Fn a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; Fn a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Fn a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Fn a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Fn a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
$cfold :: forall m. Monoid m =&gt; Fn m -&gt; m
fold :: forall m. Monoid m =&gt; Fn m -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Fn a -&gt; m
foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Fn a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Fn a -&gt; m
foldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Fn a -&gt; m
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Fn a -&gt; b
foldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Fn a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Fn a -&gt; b
foldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Fn a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Fn a -&gt; b
foldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Fn a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Fn a -&gt; b
foldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Fn a -&gt; b
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; Fn a -&gt; a
foldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; Fn a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; Fn a -&gt; a
foldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; Fn a -&gt; a
$ctoList :: forall a. Fn a -&gt; [a]
toList :: forall a. Fn a -&gt; [a]
$cnull :: forall a. Fn a -&gt; Bool
null :: forall a. Fn a -&gt; Bool
$clength :: forall a. Fn a -&gt; Int
length :: forall a. Fn a -&gt; Int
$celem :: forall a. Eq a =&gt; a -&gt; Fn a -&gt; Bool
elem :: forall a. Eq a =&gt; a -&gt; Fn a -&gt; Bool
$cmaximum :: forall a. Ord a =&gt; Fn a -&gt; a
maximum :: forall a. Ord a =&gt; Fn a -&gt; a
$cminimum :: forall a. Ord a =&gt; Fn a -&gt; a
minimum :: forall a. Ord a =&gt; Fn a -&gt; a
$csum :: forall a. Num a =&gt; Fn a -&gt; a
sum :: forall a. Num a =&gt; Fn a -&gt; a
$cproduct :: forall a. Num a =&gt; Fn a -&gt; a
product :: forall a. Num a =&gt; Fn a -&gt; a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679203000"><span id="local-6989586621679203006"><span id="local-6989586621679203011"><span id="local-6989586621679203016"><span class="annot"><span class="annottext">Functor Fn
Foldable Fn
(Functor Fn, Foldable Fn) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; Fn a -&gt; f (Fn b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; Fn (f a) -&gt; f (Fn a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; Fn a -&gt; m (Fn b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; Fn (m a) -&gt; m (Fn a))
-&gt; Traversable Fn
forall (t :: * -&gt; *).
(Functor t, Foldable t) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a. Monad m =&gt; Fn (m a) -&gt; m (Fn a)
forall (f :: * -&gt; *) a. Applicative f =&gt; Fn (f a) -&gt; f (Fn a)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; Fn a -&gt; m (Fn b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Fn a -&gt; f (Fn b)
$ctraverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Fn a -&gt; f (Fn b)
traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Fn a -&gt; f (Fn b)
$csequenceA :: forall (f :: * -&gt; *) a. Applicative f =&gt; Fn (f a) -&gt; f (Fn a)
sequenceA :: forall (f :: * -&gt; *) a. Applicative f =&gt; Fn (f a) -&gt; f (Fn a)
$cmapM :: forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; Fn a -&gt; m (Fn b)
mapM :: forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; Fn a -&gt; m (Fn b)
$csequence :: forall (m :: * -&gt; *) a. Monad m =&gt; Fn (m a) -&gt; m (Fn a)
sequence :: forall (m :: * -&gt; *) a. Monad m =&gt; Fn (m a) -&gt; m (Fn a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span class="hs-keyword">type</span><span> </span><span id="E"><span class="annot"><a href="ApplicativeGen.html#E"><span class="hs-identifier hs-var">E</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="ApplicativeGen.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-355"></span><span class="hs-keyword">type</span><span> </span><span id="Defn"><span class="annot"><a href="ApplicativeGen.html#Defn"><span class="hs-identifier hs-var">Defn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span class="hs-keyword">type</span><span> </span><span id="Eqn"><span class="annot"><a href="ApplicativeGen.html#Eqn"><span class="hs-identifier hs-var">Eqn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#E"><span class="hs-identifier hs-type">E</span></a></span><span class="hs-special">,</span><span class="annot"><a href="ApplicativeGen.html#E"><span class="hs-identifier hs-type">E</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="hs-keyword">type</span><span> </span><span id="DefTable"><span class="annot"><a href="ApplicativeGen.html#DefTable"><span class="hs-identifier hs-var">DefTable</span></a></span></span><span> </span><span id="local-6989586621679203023"><span class="annot"><a href="#local-6989586621679203023"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679203024"><span class="annot"><a href="#local-6989586621679203024"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679203023"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203024"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679203024"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span id="local-6989586621679202004"><span class="annot"><a href="ApplicativeGen.html#leftE"><span class="hs-identifier hs-type">leftE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#rightE"><span class="hs-identifier hs-type">rightE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="ApplicativeGen.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202004"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="ApplicativeGen.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202004"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-361"></span><span id="leftE"><span class="annot"><span class="annottext">leftE :: forall a. Int -&gt; Int -&gt; Term Fn a -&gt; Term Fn a
</span><a href="ApplicativeGen.html#leftE"><span class="hs-identifier hs-var hs-var">leftE</span></a></span></span><span> </span><span id="local-6989586621679203027"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203027"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679203028"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203028"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679203029"><span class="annot"><span class="annottext">Term Fn a
</span><a href="#local-6989586621679203029"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fn (Term Fn a) -&gt; Term Fn a
forall (f :: * -&gt; *) a. f (Term f a) -&gt; Term f a
</span><span class="hs-identifier hs-var">fun</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Term Fn a -&gt; Fn (Term Fn a)
forall a. Int -&gt; Int -&gt; a -&gt; Fn a
</span><a href="ApplicativeGen.html#LeftFactor"><span class="hs-identifier hs-var">LeftFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203027"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203028"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Term Fn a
</span><a href="#local-6989586621679203029"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span id="rightE"><span class="annot"><span class="annottext">rightE :: forall a. Int -&gt; Int -&gt; Term Fn a -&gt; Term Fn a
</span><a href="ApplicativeGen.html#rightE"><span class="hs-identifier hs-var hs-var">rightE</span></a></span></span><span> </span><span id="local-6989586621679203031"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203031"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679203032"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203032"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679203033"><span class="annot"><span class="annottext">Term Fn a
</span><a href="#local-6989586621679203033"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fn (Term Fn a) -&gt; Term Fn a
forall (f :: * -&gt; *) a. f (Term f a) -&gt; Term f a
</span><span class="hs-identifier hs-var">fun</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Term Fn a -&gt; Fn (Term Fn a)
forall a. Int -&gt; Int -&gt; a -&gt; Fn a
</span><a href="ApplicativeGen.html#RightFactor"><span class="hs-identifier hs-var">RightFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203031"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203032"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Term Fn a
</span><a href="#local-6989586621679203033"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="annot"><a href="ApplicativeGen.html#makeEqUnitL"><span class="hs-identifier hs-type">makeEqUnitL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#makeEqUnitR"><span class="hs-identifier hs-type">makeEqUnitR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonoidGen.html#RawMonoidData"><span class="hs-identifier hs-type">RawMonoidData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#Defn"><span class="hs-identifier hs-type">Defn</span></a></span><span>
</span><span id="line-365"></span><span id="makeEqUnitL"><span class="annot"><span class="annottext">makeEqUnitL :: RawMonoidData -&gt; Int -&gt; Int -&gt; Defn
</span><a href="ApplicativeGen.html#makeEqUnitL"><span class="hs-identifier hs-var hs-var">makeEqUnitL</span></a></span></span><span> </span><span id="local-6989586621679203036"><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679203036"><span class="hs-identifier hs-var">mon</span></a></span></span><span> </span><span id="local-6989586621679203037"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203037"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679203038"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203038"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Fn Int
forall a. Int -&gt; Int -&gt; a -&gt; Fn a
</span><a href="ApplicativeGen.html#LeftFactor"><span class="hs-identifier hs-var">LeftFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203037"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203039"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203038"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203038"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-367"></span><span>    </span><span id="local-6989586621679203039"><span class="annot"><span class="annottext">e :: Int
</span><a href="#local-6989586621679203039"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Int
</span><a href="MonoidGen.html#_unitElem"><span class="hs-identifier hs-var">_unitElem</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679203036"><span class="hs-identifier hs-var">mon</span></a></span><span>
</span><span id="line-368"></span><span id="makeEqUnitR"><span class="annot"><span class="annottext">makeEqUnitR :: RawMonoidData -&gt; Int -&gt; Int -&gt; Defn
</span><a href="ApplicativeGen.html#makeEqUnitR"><span class="hs-identifier hs-var hs-var">makeEqUnitR</span></a></span></span><span> </span><span id="local-6989586621679203040"><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679203040"><span class="hs-identifier hs-var">mon</span></a></span></span><span> </span><span id="local-6989586621679203041"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203041"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679203042"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203042"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Fn Int
forall a. Int -&gt; Int -&gt; a -&gt; Fn a
</span><a href="ApplicativeGen.html#RightFactor"><span class="hs-identifier hs-var">RightFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203043"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203041"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203042"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203042"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-370"></span><span>    </span><span id="local-6989586621679203043"><span class="annot"><span class="annottext">e :: Int
</span><a href="#local-6989586621679203043"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Int
</span><a href="MonoidGen.html#_unitElem"><span class="hs-identifier hs-var">_unitElem</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679203040"><span class="hs-identifier hs-var">mon</span></a></span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span class="annot"><a href="ApplicativeGen.html#makeEqAssocLL"><span class="hs-identifier hs-type">makeEqAssocLL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#makeEqAssocLR"><span class="hs-identifier hs-type">makeEqAssocLR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#makeEqAssocRR"><span class="hs-identifier hs-type">makeEqAssocRR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonoidGen.html#RawMonoidData"><span class="hs-identifier hs-type">RawMonoidData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#Eqn"><span class="hs-identifier hs-type">Eqn</span></a></span><span>
</span><span id="line-373"></span><span id="makeEqAssocLL"><span class="annot"><span class="annottext">makeEqAssocLL :: RawMonoidData -&gt; (Int, Int, Int) -&gt; Int -&gt; Eqn
</span><a href="ApplicativeGen.html#makeEqAssocLL"><span class="hs-identifier hs-var hs-var">makeEqAssocLL</span></a></span></span><span> </span><span id="local-6989586621679203047"><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679203047"><span class="hs-identifier hs-var">mon</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679203048"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203048"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679203049"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203049"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679203050"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203050"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679203051"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203051"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Term Fn Int -&gt; Term Fn Int
forall a. Int -&gt; Int -&gt; Term Fn a -&gt; Term Fn a
</span><a href="ApplicativeGen.html#leftE"><span class="hs-identifier hs-var">leftE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203048"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203052"><span class="hs-identifier hs-var">jk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Term Fn Int
forall a (f :: * -&gt; *). a -&gt; Term f a
</span><span class="hs-identifier hs-var">con</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203051"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Term Fn Int -&gt; Term Fn Int
forall a. Int -&gt; Int -&gt; Term Fn a -&gt; Term Fn a
</span><a href="ApplicativeGen.html#leftE"><span class="hs-identifier hs-var">leftE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203048"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203049"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Term Fn Int -&gt; Term Fn Int
forall a. Int -&gt; Int -&gt; Term Fn a -&gt; Term Fn a
</span><a href="ApplicativeGen.html#leftE"><span class="hs-identifier hs-var">leftE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203054"><span class="hs-identifier hs-var">ij</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203050"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Term Fn Int
forall a (f :: * -&gt; *). a -&gt; Term f a
</span><span class="hs-identifier hs-var">con</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203051"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-376"></span><span>    </span><span id="local-6989586621679203054"><span class="annot"><span class="annottext">ij :: Int
</span><a href="#local-6989586621679203054"><span class="hs-identifier hs-var hs-var">ij</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679203055"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203048"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203049"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-377"></span><span>    </span><span id="local-6989586621679203052"><span class="annot"><span class="annottext">jk :: Int
</span><a href="#local-6989586621679203052"><span class="hs-identifier hs-var hs-var">jk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679203055"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203049"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203050"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-378"></span><span>    </span><span id="local-6989586621679203055"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679203055"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679203059"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203059"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679203060"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203060"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Array (Int, Int) Int
</span><a href="MonoidGen.html#_multTable"><span class="hs-identifier hs-var">_multTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679203047"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) Int -&gt; (Int, Int) -&gt; Int
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203059"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203060"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span id="makeEqAssocRR"><span class="annot"><span class="annottext">makeEqAssocRR :: RawMonoidData -&gt; (Int, Int, Int) -&gt; Int -&gt; Eqn
</span><a href="ApplicativeGen.html#makeEqAssocRR"><span class="hs-identifier hs-var hs-var">makeEqAssocRR</span></a></span></span><span> </span><span id="local-6989586621679203061"><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679203061"><span class="hs-identifier hs-var">mon</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679203062"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203062"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679203063"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203063"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679203064"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203064"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679203065"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203065"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-380"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Term Fn Int -&gt; Term Fn Int
forall a. Int -&gt; Int -&gt; Term Fn a -&gt; Term Fn a
</span><a href="ApplicativeGen.html#rightE"><span class="hs-identifier hs-var">rightE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203066"><span class="hs-identifier hs-var">ij</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203064"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Term Fn Int
forall a (f :: * -&gt; *). a -&gt; Term f a
</span><span class="hs-identifier hs-var">con</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203065"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Term Fn Int -&gt; Term Fn Int
forall a. Int -&gt; Int -&gt; Term Fn a -&gt; Term Fn a
</span><a href="ApplicativeGen.html#rightE"><span class="hs-identifier hs-var">rightE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203063"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203064"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Term Fn Int -&gt; Term Fn Int
forall a. Int -&gt; Int -&gt; Term Fn a -&gt; Term Fn a
</span><a href="ApplicativeGen.html#rightE"><span class="hs-identifier hs-var">rightE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203062"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203067"><span class="hs-identifier hs-var">jk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Term Fn Int
forall a (f :: * -&gt; *). a -&gt; Term f a
</span><span class="hs-identifier hs-var">con</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203065"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-382"></span><span>    </span><span id="local-6989586621679203066"><span class="annot"><span class="annottext">ij :: Int
</span><a href="#local-6989586621679203066"><span class="hs-identifier hs-var hs-var">ij</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679203068"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203062"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203063"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-383"></span><span>    </span><span id="local-6989586621679203067"><span class="annot"><span class="annottext">jk :: Int
</span><a href="#local-6989586621679203067"><span class="hs-identifier hs-var hs-var">jk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679203068"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203063"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203064"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-384"></span><span>    </span><span id="local-6989586621679203068"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679203068"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679203072"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203072"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679203073"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203073"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Array (Int, Int) Int
</span><a href="MonoidGen.html#_multTable"><span class="hs-identifier hs-var">_multTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679203061"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) Int -&gt; (Int, Int) -&gt; Int
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203072"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203073"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span id="makeEqAssocLR"><span class="annot"><span class="annottext">makeEqAssocLR :: RawMonoidData -&gt; (Int, Int, Int) -&gt; Int -&gt; Eqn
</span><a href="ApplicativeGen.html#makeEqAssocLR"><span class="hs-identifier hs-var hs-var">makeEqAssocLR</span></a></span></span><span> </span><span id="local-6989586621679203074"><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679203074"><span class="hs-identifier hs-var">mon</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679203075"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203075"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679203076"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203076"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679203077"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203077"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679203078"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203078"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-386"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Term Fn Int -&gt; Term Fn Int
forall a. Int -&gt; Int -&gt; Term Fn a -&gt; Term Fn a
</span><a href="ApplicativeGen.html#leftE"><span class="hs-identifier hs-var">leftE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203076"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203077"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Term Fn Int -&gt; Term Fn Int
forall a. Int -&gt; Int -&gt; Term Fn a -&gt; Term Fn a
</span><a href="ApplicativeGen.html#rightE"><span class="hs-identifier hs-var">rightE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203075"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203079"><span class="hs-identifier hs-var">jk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Term Fn Int
forall a (f :: * -&gt; *). a -&gt; Term f a
</span><span class="hs-identifier hs-var">con</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203078"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-387"></span><span>   </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Term Fn Int -&gt; Term Fn Int
forall a. Int -&gt; Int -&gt; Term Fn a -&gt; Term Fn a
</span><a href="ApplicativeGen.html#rightE"><span class="hs-identifier hs-var">rightE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203075"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203076"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Term Fn Int -&gt; Term Fn Int
forall a. Int -&gt; Int -&gt; Term Fn a -&gt; Term Fn a
</span><a href="ApplicativeGen.html#leftE"><span class="hs-identifier hs-var">leftE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203080"><span class="hs-identifier hs-var">ij</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203077"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Term Fn Int
forall a (f :: * -&gt; *). a -&gt; Term f a
</span><span class="hs-identifier hs-var">con</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203078"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-389"></span><span>    </span><span id="local-6989586621679203084"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679203084"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679203085"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203085"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679203086"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203086"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Array (Int, Int) Int
</span><a href="MonoidGen.html#_multTable"><span class="hs-identifier hs-var">_multTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679203074"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) Int -&gt; (Int, Int) -&gt; Int
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203085"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203086"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>    </span><span id="local-6989586621679203080"><span class="annot"><span class="annottext">ij :: Int
</span><a href="#local-6989586621679203080"><span class="hs-identifier hs-var hs-var">ij</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679203084"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203075"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203076"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-391"></span><span>    </span><span id="local-6989586621679203079"><span class="annot"><span class="annottext">jk :: Int
</span><a href="#local-6989586621679203079"><span class="hs-identifier hs-var hs-var">jk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679203084"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203076"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203077"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="hs-keyword">type</span><span> </span><span id="ModelImpl"><span class="annot"><a href="ApplicativeGen.html#ModelImpl"><span class="hs-identifier hs-var">ModelImpl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="ModelFinder.Model.GuessMaskModel.html#GuessMaskModel"><span class="hs-identifier hs-type">GuessMaskModel</span></a></span><span> </span><span class="annot"><a href="ApplicativeGen.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SimpleModel</span></span><span> </span><span class="annot"><a href="ApplicativeGen.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="annot"><a href="ApplicativeGen.html#genDefTables"><span class="hs-identifier hs-type">genDefTables</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#ModelImpl"><span class="hs-identifier hs-type">ModelImpl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApplicativeGen.html#Eqn"><span class="hs-identifier hs-type">Eqn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApplicativeGen.html#Defn"><span class="hs-identifier hs-type">Defn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApplicativeGen.html#DefTable"><span class="hs-identifier hs-type">DefTable</span></a></span><span> </span><span class="annot"><a href="ApplicativeGen.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-396"></span><span id="genDefTables"><span class="annot"><span class="annottext">genDefTables :: ModelImpl -&gt; [Eqn] -&gt; [Defn] -&gt; [DefTable Fn Int]
</span><a href="ApplicativeGen.html#genDefTables"><span class="hs-identifier hs-var hs-var">genDefTables</span></a></span></span><span> </span><span id="local-6989586621679203088"><span class="annot"><span class="annottext">ModelImpl
</span><a href="#local-6989586621679203088"><span class="hs-identifier hs-var">pmodel</span></a></span></span><span> </span><span id="local-6989586621679203089"><span class="annot"><span class="annottext">[Eqn]
</span><a href="#local-6989586621679203089"><span class="hs-identifier hs-var">props</span></a></span></span><span> </span><span id="local-6989586621679203090"><span class="annot"><span class="annottext">[Defn]
</span><a href="#local-6989586621679203090"><span class="hs-identifier hs-var">defs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelImpl -&gt; DefTable Fn Int
</span><a href="ApplicativeGen.html#modelToDefTable"><span class="hs-identifier hs-var">modelToDefTable</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelImpl -&gt; DefTable Fn Int) -&gt; [ModelImpl] -&gt; [DefTable Fn Int]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Eqn] -&gt; DefTable Fn Int -&gt; ModelImpl -&gt; [ModelImpl]
forall a (f :: * -&gt; *) model.
(Ord a, Language f, Model f a model) =&gt;
[(Term f a, Term f a)] -&gt; Map (f a) a -&gt; model -&gt; [model]
</span><span class="hs-identifier hs-var">solveEqs</span></span><span> </span><span class="annot"><span class="annottext">[Eqn]
</span><a href="#local-6989586621679203089"><span class="hs-identifier hs-var">props</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Defn] -&gt; DefTable Fn Int
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">[Defn]
</span><a href="#local-6989586621679203090"><span class="hs-identifier hs-var">defs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ModelImpl
</span><a href="#local-6989586621679203088"><span class="hs-identifier hs-var">pmodel</span></a></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="annot"><a href="ApplicativeGen.html#modelToDefTable"><span class="hs-identifier hs-type">modelToDefTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApplicativeGen.html#ModelImpl"><span class="hs-identifier hs-type">ModelImpl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#DefTable"><span class="hs-identifier hs-type">DefTable</span></a></span><span> </span><span class="annot"><a href="ApplicativeGen.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-399"></span><span id="modelToDefTable"><span class="annot"><span class="annottext">modelToDefTable :: ModelImpl -&gt; DefTable Fn Int
</span><a href="ApplicativeGen.html#modelToDefTable"><span class="hs-identifier hs-var hs-var">modelToDefTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SimpleModel Fn Int -&gt; DefTable Fn Int
forall (f :: * -&gt; *) a. SimpleModel f a -&gt; Map (f a) a
</span><span class="hs-identifier hs-var">simpleGuesses</span></span><span> </span><span class="annot"><span class="annottext">(SimpleModel Fn Int -&gt; DefTable Fn Int)
-&gt; (ModelImpl -&gt; SimpleModel Fn Int)
-&gt; ModelImpl
-&gt; DefTable Fn Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelImpl -&gt; SimpleModel Fn Int
forall (f :: * -&gt; *) a model. GuessMaskModel f a model -&gt; model
</span><a href="ModelFinder.Model.GuessMaskModel.html#rawModel"><span class="hs-identifier hs-var">rawModel</span></a></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="annot"><a href="ApplicativeGen.html#makeModel"><span class="hs-identifier hs-type">makeModel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonoidGen.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonoidGen.html#RawMonoidData"><span class="hs-identifier hs-type">RawMonoidData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#ModelImpl"><span class="hs-identifier hs-type">ModelImpl</span></a></span><span>
</span><span id="line-402"></span><span id="makeModel"><span class="annot"><span class="annottext">makeModel :: Vector Int -&gt; RawMonoidData -&gt; ModelImpl
</span><a href="ApplicativeGen.html#makeModel"><span class="hs-identifier hs-var hs-var">makeModel</span></a></span></span><span> </span><span id="local-6989586621679203096"><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679203096"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Fn Int -&gt; Int -&gt; Bool) -&gt; SimpleModel Fn Int -&gt; ModelImpl
forall (f :: * -&gt; *) a model.
(f a -&gt; a -&gt; Bool) -&gt; model -&gt; GuessMaskModel f a model
</span><a href="ModelFinder.Model.GuessMaskModel.html#GuessMaskModel"><span class="hs-identifier hs-var">GuessMaskModel</span></a></span><span> </span><span class="annot"><span class="annottext">Fn Int -&gt; Int -&gt; Bool
forall {a}. Fn a -&gt; Int -&gt; Bool
</span><a href="#local-6989586621679203098"><span class="hs-identifier hs-var">guessFilter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; SimpleModel Fn Int
forall a (f :: * -&gt; *). [a] -&gt; SimpleModel f a
</span><span class="hs-identifier hs-var">newSimpleModel</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679203100"><span class="hs-identifier hs-var">univ</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-404"></span><span>    </span><span id="local-6989586621679203104"><span class="annot"><span class="annottext">maxNumX :: Int
</span><a href="#local-6989586621679203104"><span class="hs-identifier hs-var hs-var">maxNumX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall a. Ord a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; [Int]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679203096"><span class="hs-identifier hs-var">sig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>    </span><span id="local-6989586621679203100"><span class="annot"><span class="annottext">univ :: [Int]
</span><a href="#local-6989586621679203100"><span class="hs-identifier hs-var hs-var">univ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203104"><span class="hs-identifier hs-var">maxNumX</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span>    </span><span id="local-6989586621679203098"><span class="annot"><span class="annottext">guessFilter :: Fn a -&gt; Int -&gt; Bool
</span><a href="#local-6989586621679203098"><span class="hs-identifier hs-var hs-var">guessFilter</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#LeftFactor"><span class="hs-identifier hs-type">LeftFactor</span></a></span><span> </span><span id="local-6989586621679203112"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203112"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679203113"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203113"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203113"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679203096"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203112"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-408"></span><span>    </span><span class="annot"><a href="#local-6989586621679203098"><span class="hs-identifier hs-var">guessFilter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#RightFactor"><span class="hs-identifier hs-type">RightFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679203114"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203114"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679203115"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203115"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203115"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679203096"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203114"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span class="annot"><a href="ApplicativeGen.html#gen"><span class="hs-identifier hs-type">gen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonoidGen.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonoidGen.html#RawMonoidData"><span class="hs-identifier hs-type">RawMonoidData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApplicativeGen.html#DefTable"><span class="hs-identifier hs-type">DefTable</span></a></span><span> </span><span class="annot"><a href="ApplicativeGen.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-411"></span><span id="gen"><span class="annot"><span class="annottext">gen :: Vector Int -&gt; RawMonoidData -&gt; [DefTable Fn Int]
</span><a href="ApplicativeGen.html#gen"><span class="hs-identifier hs-var hs-var">gen</span></a></span></span><span> </span><span id="local-6989586621679203116"><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679203116"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span id="local-6989586621679203117"><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679203117"><span class="hs-identifier hs-var">mon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelImpl -&gt; [Eqn] -&gt; [Defn] -&gt; [DefTable Fn Int]
</span><a href="ApplicativeGen.html#genDefTables"><span class="hs-identifier hs-var">genDefTables</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Int -&gt; RawMonoidData -&gt; ModelImpl
</span><a href="ApplicativeGen.html#makeModel"><span class="hs-identifier hs-var">makeModel</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679203116"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679203117"><span class="hs-identifier hs-var">mon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Eqn]
</span><a href="#local-6989586621679203118"><span class="hs-identifier hs-var">assocEquations</span></a></span><span> </span><span class="annot"><span class="annottext">[Defn]
</span><a href="#local-6989586621679203119"><span class="hs-identifier hs-var">unitEquations</span></a></span><span>
</span><span id="line-412"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-413"></span><span>    </span><span id="local-6989586621679203120"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679203120"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Int
</span><a href="MonoidGen.html#_monoidSize"><span class="hs-identifier hs-var">_monoidSize</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679203117"><span class="hs-identifier hs-var">mon</span></a></span><span>
</span><span id="line-414"></span><span>    </span><span id="local-6989586621679203125"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679203125"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679203126"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203126"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679203127"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203127"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Array (Int, Int) Int
</span><a href="MonoidGen.html#_multTable"><span class="hs-identifier hs-var">_multTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679203117"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) Int -&gt; (Int, Int) -&gt; Int
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203126"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203127"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span>    </span><span id="local-6989586621679203119"><span class="annot"><span class="annottext">unitEquations :: [Defn]
</span><a href="#local-6989586621679203119"><span class="hs-identifier hs-var hs-var">unitEquations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-417"></span><span>      </span><span id="local-6989586621679203138"><span class="annot"><a href="#local-6989586621679203138"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203120"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-418"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679203139"><span class="annot"><a href="#local-6989586621679203139"><span class="hs-identifier hs-var hs-var">numX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679203116"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203138"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-419"></span><span>      </span><span id="local-6989586621679203140"><span class="annot"><a href="#local-6989586621679203140"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><a href="#local-6989586621679203139"><span class="hs-identifier hs-type">numX</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-420"></span><span>      </span><span class="hs-special">[</span><span class="annot"><a href="ApplicativeGen.html#makeEqUnitL"><span class="hs-identifier hs-type">makeEqUnitL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203117"><span class="hs-identifier hs-type">mon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203138"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203140"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#makeEqUnitR"><span class="hs-identifier hs-type">makeEqUnitR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203117"><span class="hs-identifier hs-type">mon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203138"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203140"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-421"></span><span>    </span><span id="local-6989586621679203118"><span class="annot"><span class="annottext">assocEquations :: [Eqn]
</span><a href="#local-6989586621679203118"><span class="hs-identifier hs-var hs-var">assocEquations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-422"></span><span>      </span><span id="local-6989586621679203161"><span class="annot"><a href="#local-6989586621679203161"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203120"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-423"></span><span>      </span><span id="local-6989586621679203162"><span class="annot"><a href="#local-6989586621679203162"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><a href="#local-6989586621679203120"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-424"></span><span>      </span><span id="local-6989586621679203163"><span class="annot"><a href="#local-6989586621679203163"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><a href="#local-6989586621679203120"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-425"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679203164"><span class="annot"><a href="#local-6989586621679203164"><span class="hs-identifier hs-var hs-var">ijk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679203125"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203161"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679203125"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203162"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203163"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>          </span><span id="local-6989586621679203165"><span class="annot"><a href="#local-6989586621679203165"><span class="hs-identifier hs-var hs-var">numX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679203116"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203164"><span class="hs-identifier hs-var">ijk</span></a></span><span>
</span><span id="line-427"></span><span>      </span><span id="local-6989586621679203166"><span class="annot"><a href="#local-6989586621679203166"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><a href="#local-6989586621679203165"><span class="hs-identifier hs-type">numX</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-428"></span><span>      </span><span class="hs-special">[</span><span class="annot"><a href="ApplicativeGen.html#makeEqAssocLL"><span class="hs-identifier hs-type">makeEqAssocLL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203117"><span class="hs-identifier hs-type">mon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679203161"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679203162"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679203163"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679203166"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#makeEqAssocRR"><span class="hs-identifier hs-type">makeEqAssocRR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203117"><span class="hs-identifier hs-type">mon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679203161"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679203162"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679203163"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679203166"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#makeEqAssocLR"><span class="hs-identifier hs-type">makeEqAssocLR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203117"><span class="hs-identifier hs-type">mon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679203161"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679203162"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679203163"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679203166"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span class="annot"><a href="ApplicativeGen.html#completeTable"><span class="hs-identifier hs-type">completeTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonoidGen.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonoidGen.html#RawMonoidData"><span class="hs-identifier hs-type">RawMonoidData</span></a></span><span>
</span><span id="line-431"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#DefTable"><span class="hs-identifier hs-type">DefTable</span></a></span><span> </span><span class="annot"><a href="ApplicativeGen.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-432"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span id="completeTable"><span class="annot"><span class="annottext">completeTable :: Vector Int
-&gt; RawMonoidData -&gt; DefTable Fn Int -&gt; (FactorTable, FactorTable)
</span><a href="ApplicativeGen.html#completeTable"><span class="hs-identifier hs-var hs-var">completeTable</span></a></span></span><span> </span><span id="local-6989586621679203167"><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679203167"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span id="local-6989586621679203168"><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679203168"><span class="hs-identifier hs-var">mon</span></a></span></span><span> </span><span id="local-6989586621679203169"><span class="annot"><span class="annottext">DefTable Fn Int
</span><a href="#local-6989586621679203169"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FactorTable -&gt; FactorTable -&gt; (FactorTable, FactorTable))
-&gt; Maybe FactorTable
-&gt; Maybe (FactorTable -&gt; (FactorTable, FactorTable))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe FactorTable
</span><a href="#local-6989586621679203170"><span class="hs-identifier hs-var">leftTable</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (FactorTable -&gt; (FactorTable, FactorTable))
-&gt; Maybe FactorTable -&gt; Maybe (FactorTable, FactorTable)
forall a b. Maybe (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe FactorTable
</span><a href="#local-6989586621679203171"><span class="hs-identifier hs-var">rightTable</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-434"></span><span>    </span><span class="annot"><span class="annottext">Maybe (FactorTable, FactorTable)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (FactorTable, FactorTable)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;incomplete table?&quot;</span></span><span>
</span><span id="line-435"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679203173"><span class="annot"><span class="annottext">(FactorTable, FactorTable)
</span><a href="#local-6989586621679203173"><span class="hs-identifier hs-var">tabs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(FactorTable, FactorTable)
</span><a href="#local-6989586621679203173"><span class="hs-identifier hs-var">tabs</span></a></span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-437"></span><span>    </span><span id="local-6989586621679203174"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679203174"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Int
</span><a href="MonoidGen.html#_monoidSize"><span class="hs-identifier hs-var">_monoidSize</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679203168"><span class="hs-identifier hs-var">mon</span></a></span><span>
</span><span id="line-438"></span><span>    </span><span id="local-6989586621679203178"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679203178"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679203179"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203179"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679203180"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203180"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Array (Int, Int) Int
</span><a href="MonoidGen.html#_multTable"><span class="hs-identifier hs-var">_multTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679203168"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) Int -&gt; (Int, Int) -&gt; Int
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203179"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203180"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>    </span><span id="local-6989586621679203187"><span class="annot"><span class="annottext">arrayRange :: ((Int, Int), (Int, Int))
</span><a href="#local-6989586621679203187"><span class="hs-identifier hs-var hs-var">arrayRange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203174"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203174"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span>    </span><span id="local-6989586621679203170"><span class="annot"><span class="annottext">leftTable :: Maybe FactorTable
</span><a href="#local-6989586621679203170"><span class="hs-identifier hs-var hs-var">leftTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Int), (Int, Int))
-&gt; ((Int, Int) -&gt; Maybe (Vector Int)) -&gt; Maybe FactorTable
forall i (f :: * -&gt; *) a.
(Ix i, Monad f) =&gt;
(i, i) -&gt; (i -&gt; f a) -&gt; f (Array i a)
</span><a href="Data.Array.Extra.html#genArrayM"><span class="hs-identifier hs-var">Array.genArrayM</span></a></span><span> </span><span class="annot"><span class="annottext">((Int, Int), (Int, Int))
</span><a href="#local-6989586621679203187"><span class="hs-identifier hs-var">arrayRange</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679203196"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203196"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679203197"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203197"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; Maybe Int) -&gt; Maybe (Vector Int)
forall (m :: * -&gt; *) a.
Monad m =&gt;
Int -&gt; (Int -&gt; m a) -&gt; m (Vector a)
</span><span class="hs-identifier hs-var">V.generateM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679203167"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679203178"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203196"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203197"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679203199"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203199"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Fn Int -&gt; DefTable Fn Int -&gt; Maybe Int
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Fn Int
forall a. Int -&gt; Int -&gt; a -&gt; Fn a
</span><a href="ApplicativeGen.html#LeftFactor"><span class="hs-identifier hs-var">LeftFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203196"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203197"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203199"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DefTable Fn Int
</span><a href="#local-6989586621679203169"><span class="hs-identifier hs-var">table</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>    </span><span id="local-6989586621679203171"><span class="annot"><span class="annottext">rightTable :: Maybe FactorTable
</span><a href="#local-6989586621679203171"><span class="hs-identifier hs-var hs-var">rightTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Int), (Int, Int))
-&gt; ((Int, Int) -&gt; Maybe (Vector Int)) -&gt; Maybe FactorTable
forall i (f :: * -&gt; *) a.
(Ix i, Monad f) =&gt;
(i, i) -&gt; (i -&gt; f a) -&gt; f (Array i a)
</span><a href="Data.Array.Extra.html#genArrayM"><span class="hs-identifier hs-var">Array.genArrayM</span></a></span><span> </span><span class="annot"><span class="annottext">((Int, Int), (Int, Int))
</span><a href="#local-6989586621679203187"><span class="hs-identifier hs-var">arrayRange</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679203208"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203208"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679203209"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203209"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; Maybe Int) -&gt; Maybe (Vector Int)
forall (m :: * -&gt; *) a.
Monad m =&gt;
Int -&gt; (Int -&gt; m a) -&gt; m (Vector a)
</span><span class="hs-identifier hs-var">V.generateM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679203167"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679203178"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203208"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203209"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679203210"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203210"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Fn Int -&gt; DefTable Fn Int -&gt; Maybe Int
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Fn Int
forall a. Int -&gt; Int -&gt; a -&gt; Fn a
</span><a href="ApplicativeGen.html#RightFactor"><span class="hs-identifier hs-var">RightFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203208"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203209"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203210"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DefTable Fn Int
</span><a href="#local-6989586621679203169"><span class="hs-identifier hs-var">table</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span class="annot"><a href="ApplicativeGen.html#upToIso"><span class="hs-identifier hs-type">upToIso</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonoidGen.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonoidGen.html#RawMonoidData"><span class="hs-identifier hs-type">RawMonoidData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-446"></span><span id="upToIso"><span class="annot"><span class="annottext">upToIso :: Vector Int
-&gt; RawMonoidData
-&gt; [(FactorTable, FactorTable)]
-&gt; [(FactorTable, FactorTable)]
</span><a href="ApplicativeGen.html#upToIso"><span class="hs-identifier hs-var hs-var">upToIso</span></a></span></span><span> </span><span id="local-6989586621679203211"><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679203211"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span id="local-6989586621679203212"><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679203212"><span class="hs-identifier hs-var">mon</span></a></span></span><span> </span><span id="local-6989586621679203213"><span class="annot"><span class="annottext">[(FactorTable, FactorTable)]
</span><a href="#local-6989586621679203213"><span class="hs-identifier hs-var">tabs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((FactorTable, FactorTable) -&gt; (FactorTable, FactorTable))
-&gt; ((FactorTable, FactorTable)
    -&gt; (FactorTable, FactorTable) -&gt; (FactorTable, FactorTable))
-&gt; (forall s.
    EquivM
      s
      (FactorTable, FactorTable)
      (FactorTable, FactorTable)
      [(FactorTable, FactorTable)])
-&gt; [(FactorTable, FactorTable)]
forall v c a.
(v -&gt; c) -&gt; (c -&gt; c -&gt; c) -&gt; (forall s. EquivM s c v a) -&gt; a
</span><span class="hs-identifier hs-var">runEquivM</span></span><span> </span><span class="annot"><span class="annottext">(FactorTable, FactorTable) -&gt; (FactorTable, FactorTable)
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(FactorTable, FactorTable)
-&gt; (FactorTable, FactorTable) -&gt; (FactorTable, FactorTable)
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">((forall s.
  EquivM
    s
    (FactorTable, FactorTable)
    (FactorTable, FactorTable)
    [(FactorTable, FactorTable)])
 -&gt; [(FactorTable, FactorTable)])
-&gt; (forall s.
    EquivM
      s
      (FactorTable, FactorTable)
      (FactorTable, FactorTable)
      [(FactorTable, FactorTable)])
-&gt; [(FactorTable, FactorTable)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-447"></span><span>  </span><span class="annot"><span class="annottext">[(FactorTable, FactorTable)]
-&gt; ((FactorTable, FactorTable)
    -&gt; EquivT
         s
         (FactorTable, FactorTable)
         (FactorTable, FactorTable)
         Identity
         ())
-&gt; EquivT
     s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="annot"><span class="annottext">[(FactorTable, FactorTable)]
</span><a href="#local-6989586621679203213"><span class="hs-identifier hs-var">tabs</span></a></span><span> </span><span class="annot"><span class="annottext">(((FactorTable, FactorTable)
  -&gt; EquivT
       s
       (FactorTable, FactorTable)
       (FactorTable, FactorTable)
       Identity
       ())
 -&gt; EquivT
      s
      (FactorTable, FactorTable)
      (FactorTable, FactorTable)
      Identity
      ())
-&gt; ((FactorTable, FactorTable)
    -&gt; EquivT
         s
         (FactorTable, FactorTable)
         (FactorTable, FactorTable)
         Identity
         ())
-&gt; EquivT
     s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679203250"><span class="annot"><span class="annottext">(FactorTable, FactorTable)
</span><a href="#local-6989586621679203250"><span class="hs-identifier hs-var">mm</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-448"></span><span>    </span><span class="annot"><span class="annottext">(FactorTable, FactorTable)
-&gt; (FactorTable, FactorTable)
-&gt; EquivT
     s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity ()
forall c v d (m :: * -&gt; *). MonadEquiv c v d m =&gt; v -&gt; v -&gt; m ()
</span><span class="hs-identifier hs-var">equate</span></span><span> </span><span class="annot"><span class="annottext">(FactorTable, FactorTable)
</span><a href="#local-6989586621679203250"><span class="hs-identifier hs-var">mm</span></a></span><span> </span><span class="annot"><span class="annottext">(FactorTable, FactorTable)
</span><a href="#local-6989586621679203250"><span class="hs-identifier hs-var">mm</span></a></span><span>
</span><span id="line-449"></span><span>  </span><span class="annot"><span class="annottext">[(FactorTable, FactorTable)]
-&gt; ((FactorTable, FactorTable)
    -&gt; EquivT
         s
         (FactorTable, FactorTable)
         (FactorTable, FactorTable)
         Identity
         ())
-&gt; EquivT
     s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="annot"><span class="annottext">[(FactorTable, FactorTable)]
</span><a href="#local-6989586621679203213"><span class="hs-identifier hs-var">tabs</span></a></span><span> </span><span class="annot"><span class="annottext">(((FactorTable, FactorTable)
  -&gt; EquivT
       s
       (FactorTable, FactorTable)
       (FactorTable, FactorTable)
       Identity
       ())
 -&gt; EquivT
      s
      (FactorTable, FactorTable)
      (FactorTable, FactorTable)
      Identity
      ())
-&gt; ((FactorTable, FactorTable)
    -&gt; EquivT
         s
         (FactorTable, FactorTable)
         (FactorTable, FactorTable)
         Identity
         ())
-&gt; EquivT
     s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679203252"><span class="annot"><span class="annottext">(FactorTable, FactorTable)
</span><a href="#local-6989586621679203252"><span class="hs-identifier hs-var">mm</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-450"></span><span>    </span><span class="annot"><span class="annottext">[[Permutation]]
-&gt; ([Permutation]
    -&gt; EquivT
         s
         (FactorTable, FactorTable)
         (FactorTable, FactorTable)
         Identity
         ())
-&gt; EquivT
     s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Int -&gt; RawMonoidData -&gt; [[Permutation]]
</span><a href="MonoidGen.html#stabilizingPermutations"><span class="hs-identifier hs-var">stabilizingPermutations</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679203211"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679203212"><span class="hs-identifier hs-var">mon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([Permutation]
  -&gt; EquivT
       s
       (FactorTable, FactorTable)
       (FactorTable, FactorTable)
       Identity
       ())
 -&gt; EquivT
      s
      (FactorTable, FactorTable)
      (FactorTable, FactorTable)
      Identity
      ())
-&gt; ([Permutation]
    -&gt; EquivT
         s
         (FactorTable, FactorTable)
         (FactorTable, FactorTable)
         Identity
         ())
-&gt; EquivT
     s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679203253"><span class="annot"><span class="annottext">[Permutation]
</span><a href="#local-6989586621679203253"><span class="hs-identifier hs-var">perms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-451"></span><span>      </span><span class="annot"><span class="annottext">[(FactorTable, FactorTable)]
-&gt; EquivT
     s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity ()
forall c v d (m :: * -&gt; *). MonadEquiv c v d m =&gt; [v] -&gt; m ()
</span><span class="hs-identifier hs-var">equateAll</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Permutation
-&gt; (FactorTable, FactorTable) -&gt; (FactorTable, FactorTable)
</span><a href="ApplicativeGen.html#applyShapePermutation"><span class="hs-identifier hs-var">applyShapePermutation</span></a></span><span> </span><span class="annot"><span class="annottext">(Permutation
 -&gt; (FactorTable, FactorTable) -&gt; (FactorTable, FactorTable))
-&gt; [Permutation]
-&gt; [(FactorTable, FactorTable) -&gt; (FactorTable, FactorTable)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Permutation]
</span><a href="#local-6989586621679203253"><span class="hs-identifier hs-var">perms</span></a></span><span> </span><span class="annot"><span class="annottext">[(FactorTable, FactorTable) -&gt; (FactorTable, FactorTable)]
-&gt; [(FactorTable, FactorTable)] -&gt; [(FactorTable, FactorTable)]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(FactorTable, FactorTable)
</span><a href="#local-6989586621679203252"><span class="hs-identifier hs-var">mm</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>    </span><span class="annot"><span class="annottext">[(FactorTable, FactorTable)]
-&gt; EquivT
     s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity ()
forall c v d (m :: * -&gt; *). MonadEquiv c v d m =&gt; [v] -&gt; m ()
</span><span class="hs-identifier hs-var">equateAll</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FactorTable, FactorTable)
</span><a href="#local-6989586621679203252"><span class="hs-identifier hs-var">mm</span></a></span><span> </span><span class="annot"><span class="annottext">(FactorTable, FactorTable)
-&gt; [(FactorTable, FactorTable)] -&gt; [(FactorTable, FactorTable)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int)
-&gt; Transposition
-&gt; (FactorTable, FactorTable)
-&gt; (FactorTable, FactorTable)
</span><a href="ApplicativeGen.html#applyTransposition"><span class="hs-identifier hs-var">applyTransposition</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679203257"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">(Transposition
 -&gt; (FactorTable, FactorTable) -&gt; (FactorTable, FactorTable))
-&gt; [Transposition]
-&gt; [(FactorTable, FactorTable) -&gt; (FactorTable, FactorTable)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; [Transposition]
</span><a href="ApplicativeGen.html#isoGenerators"><span class="hs-identifier hs-var">isoGenerators</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679203211"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">[(FactorTable, FactorTable) -&gt; (FactorTable, FactorTable)]
-&gt; [(FactorTable, FactorTable)] -&gt; [(FactorTable, FactorTable)]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(FactorTable, FactorTable)
</span><a href="#local-6989586621679203252"><span class="hs-identifier hs-var">mm</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>  </span><span class="annot"><span class="annottext">EquivT
  s
  (FactorTable, FactorTable)
  (FactorTable, FactorTable)
  Identity
  [Class s (FactorTable, FactorTable) (FactorTable, FactorTable)]
forall c v d (m :: * -&gt; *). MonadEquiv c v d m =&gt; m [c]
</span><span class="hs-identifier hs-var">classes</span></span><span> </span><span class="annot"><span class="annottext">EquivT
  s
  (FactorTable, FactorTable)
  (FactorTable, FactorTable)
  Identity
  [Class s (FactorTable, FactorTable) (FactorTable, FactorTable)]
-&gt; ([Class s (FactorTable, FactorTable) (FactorTable, FactorTable)]
    -&gt; EquivT
         s
         (FactorTable, FactorTable)
         (FactorTable, FactorTable)
         Identity
         [(FactorTable, FactorTable)])
-&gt; EquivT
     s
     (FactorTable, FactorTable)
     (FactorTable, FactorTable)
     Identity
     [(FactorTable, FactorTable)]
forall a b.
EquivT
  s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity a
-&gt; (a
    -&gt; EquivT
         s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity b)
-&gt; EquivT
     s (FactorTable, FactorTable) (FactorTable, FactorTable) Identity b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(Class s (FactorTable, FactorTable) (FactorTable, FactorTable)
 -&gt; EquivT
      s
      (FactorTable, FactorTable)
      (FactorTable, FactorTable)
      Identity
      (FactorTable, FactorTable))
-&gt; [Class s (FactorTable, FactorTable) (FactorTable, FactorTable)]
-&gt; EquivT
     s
     (FactorTable, FactorTable)
     (FactorTable, FactorTable)
     Identity
     [(FactorTable, FactorTable)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Class s (FactorTable, FactorTable) (FactorTable, FactorTable)
-&gt; EquivT
     s
     (FactorTable, FactorTable)
     (FactorTable, FactorTable)
     Identity
     (FactorTable, FactorTable)
forall c v d (m :: * -&gt; *). MonadEquiv c v d m =&gt; c -&gt; m d
</span><span class="hs-identifier hs-var">desc</span></span><span>
</span><span id="line-454"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-455"></span><span>    </span><span id="local-6989586621679203257"><span class="annot"><span class="annottext">op :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679203257"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679203264"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203264"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679203265"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203265"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawMonoidData -&gt; Array (Int, Int) Int
</span><a href="MonoidGen.html#_multTable"><span class="hs-identifier hs-var">_multTable</span></a></span><span> </span><span class="annot"><span class="annottext">RawMonoidData
</span><a href="#local-6989586621679203212"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) Int -&gt; (Int, Int) -&gt; Int
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203264"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203265"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="annot"><a href="ApplicativeGen.html#applyShapePermutation"><span class="hs-identifier hs-type">applyShapePermutation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonoidGen.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span id="applyShapePermutation"><span class="annot"><span class="annottext">applyShapePermutation :: Permutation
-&gt; (FactorTable, FactorTable) -&gt; (FactorTable, FactorTable)
</span><a href="ApplicativeGen.html#applyShapePermutation"><span class="hs-identifier hs-var hs-var">applyShapePermutation</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonoidGen.html#MkPermutation"><span class="hs-identifier hs-type">MkPermutation</span></a></span><span> </span><span id="local-6989586621679203267"><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679203267"><span class="hs-identifier hs-var">permVector</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FactorTable, FactorTable) -&gt; (FactorTable, FactorTable)
forall {e} {e}.
(Array (Int, Int) e, Array (Int, Int) e)
-&gt; (Array (Int, Int) e, Array (Int, Int) e)
</span><a href="#local-6989586621679203268"><span class="hs-identifier hs-var">applyBoth</span></a></span><span>
</span><span id="line-459"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-460"></span><span>    </span><span id="local-6989586621679203269"><span class="annot"><span class="annottext">p :: Int -&gt; Int
</span><a href="#local-6989586621679203269"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679203267"><span class="hs-identifier hs-var">permVector</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>    </span><span id="local-6989586621679203274"><span class="annot"><span class="annottext">apply :: Array (Int, Int) e -&gt; Array (Int, Int) e
</span><a href="#local-6989586621679203274"><span class="hs-identifier hs-var hs-var">apply</span></a></span></span><span> </span><span id="local-6989586621679203275"><span class="annot"><span class="annottext">Array (Int, Int) e
</span><a href="#local-6989586621679203275"><span class="hs-identifier hs-var">tab</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Int), (Int, Int)) -&gt; [((Int, Int), e)] -&gt; Array (Int, Int) e
forall i e. Ix i =&gt; (i, i) -&gt; [(i, e)] -&gt; Array i e
</span><span class="hs-identifier hs-var">Array.array</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Array (Int, Int) e -&gt; ((Int, Int), (Int, Int))
forall i e. Array i e -&gt; (i, i)
</span><span class="hs-identifier hs-var">Array.bounds</span></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) e
</span><a href="#local-6989586621679203275"><span class="hs-identifier hs-var">tab</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679203269"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203278"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679203269"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203279"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679203280"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679203278"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203278"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679203279"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203279"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679203280"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679203280"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) e -&gt; [((Int, Int), e)]
forall i e. Ix i =&gt; Array i e -&gt; [(i, e)]
</span><span class="hs-identifier hs-var">Array.assocs</span></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) e
</span><a href="#local-6989586621679203275"><span class="hs-identifier hs-var">tab</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-462"></span><span>    </span><span id="local-6989586621679203268"><span class="annot"><span class="annottext">applyBoth :: (Array (Int, Int) e, Array (Int, Int) e)
-&gt; (Array (Int, Int) e, Array (Int, Int) e)
</span><a href="#local-6989586621679203268"><span class="hs-identifier hs-var hs-var">applyBoth</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679203281"><span class="annot"><span class="annottext">Array (Int, Int) e
</span><a href="#local-6989586621679203281"><span class="hs-identifier hs-var">tabL</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679203282"><span class="annot"><span class="annottext">Array (Int, Int) e
</span><a href="#local-6989586621679203282"><span class="hs-identifier hs-var">tabR</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Array (Int, Int) e -&gt; Array (Int, Int) e
forall {e}. Array (Int, Int) e -&gt; Array (Int, Int) e
</span><a href="#local-6989586621679203274"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) e
</span><a href="#local-6989586621679203281"><span class="hs-identifier hs-var">tabL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) e -&gt; Array (Int, Int) e
forall {e}. Array (Int, Int) e -&gt; Array (Int, Int) e
</span><a href="#local-6989586621679203274"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">Array (Int, Int) e
</span><a href="#local-6989586621679203282"><span class="hs-identifier hs-var">tabR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span class="hs-keyword">data</span><span> </span><span id="Transposition"><span class="annot"><a href="ApplicativeGen.html#Transposition"><span class="hs-identifier hs-var">Transposition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Transpose"><span class="annot"><a href="ApplicativeGen.html#Transpose"><span class="hs-identifier hs-var">Transpose</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-465"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679203285"><span id="local-6989586621679203291"><span id="local-6989586621679203295"><span class="annot"><span class="annottext">Int -&gt; Transposition -&gt; String -&gt; String
[Transposition] -&gt; String -&gt; String
Transposition -&gt; String
(Int -&gt; Transposition -&gt; String -&gt; String)
-&gt; (Transposition -&gt; String)
-&gt; ([Transposition] -&gt; String -&gt; String)
-&gt; Show Transposition
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
$cshowsPrec :: Int -&gt; Transposition -&gt; String -&gt; String
showsPrec :: Int -&gt; Transposition -&gt; String -&gt; String
$cshow :: Transposition -&gt; String
show :: Transposition -&gt; String
$cshowList :: [Transposition] -&gt; String -&gt; String
showList :: [Transposition] -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span class="annot"><a href="ApplicativeGen.html#isoGenerators"><span class="hs-identifier hs-type">isoGenerators</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonoidGen.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApplicativeGen.html#Transposition"><span class="hs-identifier hs-type">Transposition</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-468"></span><span id="isoGenerators"><span class="annot"><span class="annottext">isoGenerators :: Vector Int -&gt; [Transposition]
</span><a href="ApplicativeGen.html#isoGenerators"><span class="hs-identifier hs-var hs-var">isoGenerators</span></a></span></span><span> </span><span id="local-6989586621679203297"><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679203297"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-469"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Transposition
</span><a href="ApplicativeGen.html#Transpose"><span class="hs-identifier hs-var">Transpose</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203298"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203299"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203299"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679203298"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203298"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679203301"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203301"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679203302"><span class="hs-identifier hs-var">lengths</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679203299"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203299"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203301"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-470"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-471"></span><span>    </span><span id="local-6989586621679203302"><span class="annot"><span class="annottext">lengths :: [(Int, Int)]
</span><a href="#local-6989586621679203302"><span class="hs-identifier hs-var hs-var">lengths</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Int, Int) -&gt; [(Int, Int)]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Int, Int) -&gt; [(Int, Int)])
-&gt; Vector (Int, Int) -&gt; [(Int, Int)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Vector (Int, Int)
forall a. Vector a -&gt; Vector (Int, a)
</span><span class="hs-identifier hs-var">V.indexed</span></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679203297"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span class="annot"><a href="ApplicativeGen.html#applyTransposition"><span class="hs-identifier hs-type">applyTransposition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#Transposition"><span class="hs-identifier hs-type">Transposition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApplicativeGen.html#FactorTable"><span class="hs-identifier hs-type">FactorTable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span id="applyTransposition"><span class="annot"><span class="annottext">applyTransposition :: (Int -&gt; Int -&gt; Int)
-&gt; Transposition
-&gt; (FactorTable, FactorTable)
-&gt; (FactorTable, FactorTable)
</span><a href="ApplicativeGen.html#applyTransposition"><span class="hs-identifier hs-var hs-var">applyTransposition</span></a></span></span><span> </span><span id="local-6989586621679203303"><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679203303"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#Transpose"><span class="hs-identifier hs-type">Transpose</span></a></span><span> </span><span id="local-6989586621679203304"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203304"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679203305"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203305"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679203306"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203306"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679203307"><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679203307"><span class="hs-identifier hs-var">leftTable</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679203308"><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679203308"><span class="hs-identifier hs-var">rightTable</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679203309"><span class="hs-identifier hs-var">leftTable'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679203310"><span class="hs-identifier hs-var">rightTable'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-476"></span><span>    </span><span id="local-6989586621679203313"><span class="annot"><span class="annottext">tr :: Int -&gt; Int
</span><a href="#local-6989586621679203313"><span class="hs-identifier hs-var hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679203314"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203314"><span class="hs-identifier hs-var">z</span></a></span></span><span>
</span><span id="line-477"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203314"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203305"><span class="hs-identifier hs-var">x</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203306"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-478"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203314"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203306"><span class="hs-identifier hs-var">y</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203305"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-479"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203314"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-480"></span><span>    </span><span id="local-6989586621679203315"><span class="annot"><span class="annottext">swapVector :: Vector a -&gt; Vector a
</span><a href="#local-6989586621679203315"><span class="hs-identifier hs-var hs-var">swapVector</span></a></span></span><span> </span><span id="local-6989586621679203316"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679203316"><span class="hs-identifier hs-var">vec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679203316"><span class="hs-identifier hs-var">vec</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; [(Int, a)] -&gt; Vector a
forall a. Vector a -&gt; [(Int, a)] -&gt; Vector a
</span><span class="hs-operator hs-var">V.//</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203305"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679203316"><span class="hs-identifier hs-var">vec</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Int -&gt; a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203306"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203306"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679203316"><span class="hs-identifier hs-var">vec</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Int -&gt; a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203305"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span>    </span><span id="local-6989586621679203318"><span class="annot"><span class="annottext">leftTrans :: (Int, Int) -&gt; Vector Int -&gt; Vector Int
</span><a href="#local-6989586621679203318"><span class="hs-identifier hs-var hs-var">leftTrans</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679203319"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203319"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679203320"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203320"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Vector Int
</span><a href="#local-6989586621679203321"><span class="hs-identifier hs-var">onRange</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector Int -&gt; Vector Int)
-&gt; (Vector Int -&gt; Vector Int) -&gt; Vector Int -&gt; Vector Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Vector Int
forall {a}. Vector a -&gt; Vector a
</span><a href="#local-6989586621679203322"><span class="hs-identifier hs-var">onDomain</span></a></span><span>
</span><span id="line-483"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-484"></span><span>        </span><span id="local-6989586621679203322"><span class="annot"><span class="annottext">onDomain :: Vector a -&gt; Vector a
</span><a href="#local-6989586621679203322"><span class="hs-identifier hs-var hs-var">onDomain</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679203303"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203319"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203320"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203304"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Vector a
forall {a}. Vector a -&gt; Vector a
</span><a href="#local-6989586621679203315"><span class="hs-identifier hs-var">swapVector</span></a></span><span>
</span><span id="line-485"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Vector a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-486"></span><span>        </span><span id="local-6989586621679203321"><span class="annot"><span class="annottext">onRange :: Vector Int -&gt; Vector Int
</span><a href="#local-6989586621679203321"><span class="hs-identifier hs-var hs-var">onRange</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203319"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203304"><span class="hs-identifier hs-var">k</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Vector Int -&gt; Vector Int
forall a b. (a -&gt; b) -&gt; Vector a -&gt; Vector b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679203313"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-487"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Vector Int
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-488"></span><span>    </span><span>
</span><span id="line-489"></span><span>    </span><span id="local-6989586621679203326"><span class="annot"><span class="annottext">rightTrans :: (Int, Int) -&gt; Vector Int -&gt; Vector Int
</span><a href="#local-6989586621679203326"><span class="hs-identifier hs-var hs-var">rightTrans</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679203327"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203327"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679203328"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203328"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Vector Int
</span><a href="#local-6989586621679203329"><span class="hs-identifier hs-var">onRange</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector Int -&gt; Vector Int)
-&gt; (Vector Int -&gt; Vector Int) -&gt; Vector Int -&gt; Vector Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Vector Int
forall {a}. Vector a -&gt; Vector a
</span><a href="#local-6989586621679203330"><span class="hs-identifier hs-var">onDomain</span></a></span><span>
</span><span id="line-490"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-491"></span><span>        </span><span id="local-6989586621679203330"><span class="annot"><span class="annottext">onDomain :: Vector a -&gt; Vector a
</span><a href="#local-6989586621679203330"><span class="hs-identifier hs-var hs-var">onDomain</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679203303"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203327"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203328"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203304"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Vector a
forall {a}. Vector a -&gt; Vector a
</span><a href="#local-6989586621679203315"><span class="hs-identifier hs-var">swapVector</span></a></span><span>
</span><span id="line-492"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Vector a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-493"></span><span>        </span><span id="local-6989586621679203329"><span class="annot"><span class="annottext">onRange :: Vector Int -&gt; Vector Int
</span><a href="#local-6989586621679203329"><span class="hs-identifier hs-var hs-var">onRange</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203328"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679203304"><span class="hs-identifier hs-var">k</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Vector Int -&gt; Vector Int
forall a b. (a -&gt; b) -&gt; Vector a -&gt; Vector b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679203313"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-494"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Vector Int
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-495"></span><span>    </span><span id="local-6989586621679203309"><span class="annot"><span class="annottext">leftTable' :: FactorTable
</span><a href="#local-6989586621679203309"><span class="hs-identifier hs-var hs-var">leftTable'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Vector Int -&gt; Vector Int)
-&gt; FactorTable -&gt; FactorTable
forall i a b. Ix i =&gt; (i -&gt; a -&gt; b) -&gt; Array i a -&gt; Array i b
</span><a href="Data.Array.Extra.html#imap"><span class="hs-identifier hs-var">Array.imap</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Vector Int -&gt; Vector Int
</span><a href="#local-6989586621679203318"><span class="hs-identifier hs-var">leftTrans</span></a></span><span> </span><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679203307"><span class="hs-identifier hs-var">leftTable</span></a></span><span>
</span><span id="line-496"></span><span>    </span><span id="local-6989586621679203310"><span class="annot"><span class="annottext">rightTable' :: FactorTable
</span><a href="#local-6989586621679203310"><span class="hs-identifier hs-var hs-var">rightTable'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Vector Int -&gt; Vector Int)
-&gt; FactorTable -&gt; FactorTable
forall i a b. Ix i =&gt; (i -&gt; a -&gt; b) -&gt; Array i a -&gt; Array i b
</span><a href="Data.Array.Extra.html#imap"><span class="hs-identifier hs-var">Array.imap</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Vector Int -&gt; Vector Int
</span><a href="#local-6989586621679203326"><span class="hs-identifier hs-var">rightTrans</span></a></span><span> </span><span class="annot"><span class="annottext">FactorTable
</span><a href="#local-6989586621679203308"><span class="hs-identifier hs-var">rightTable</span></a></span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span id="local-6989586621679202091"><span class="annot"><a href="ApplicativeGen.html#stabilizingIsomorphisms"><span class="hs-identifier hs-type">stabilizingIsomorphisms</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679202091"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeDict"><span class="hs-identifier hs-type">ApplicativeDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202091"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Isomorphism.html#Iso"><span class="hs-identifier hs-type">Iso</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202091"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-499"></span><span id="stabilizingIsomorphisms"><span class="annot"><span class="annottext">stabilizingIsomorphisms :: forall (f :: * -&gt; *).
PTraversable f =&gt;
ApplicativeDict f -&gt; [Iso f]
</span><a href="ApplicativeGen.html#stabilizingIsomorphisms"><span class="hs-identifier hs-var hs-var">stabilizingIsomorphisms</span></a></span></span><span> </span><span id="local-6989586621679203349"><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679203349"><span class="hs-identifier hs-var">apDict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Iso f]
</span><a href="#local-6989586621679203350"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-500"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-501"></span><span>    </span><span id="local-6989586621679203351"><span class="annot"><span class="annottext">pureData :: f ()
</span><a href="#local-6989586621679203351"><span class="hs-identifier hs-var hs-var">pureData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f -&gt; forall a. a -&gt; f a
forall (f :: * -&gt; *). ApplicativeDict f -&gt; forall a. a -&gt; f a
</span><a href="ApplicativeGen.html#_applicativePure"><span class="hs-identifier hs-var">_applicativePure</span></a></span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679203349"><span class="hs-identifier hs-var">apDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>    </span><span id="local-6989586621679203364"><span class="annot"><span class="annottext">fk :: [f Int]
</span><a href="#local-6989586621679203364"><span class="hs-identifier hs-var hs-var">fk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[f Int] -&gt; [f Int]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (f Int) -&gt; [f Int]
forall a. Vector a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">Vector (f Int)
forall (m :: * -&gt; *). PTraversable m =&gt; Vector (m Int)
</span><a href="Data.PTraversable.Extra.html#skolem"><span class="hs-identifier hs-var">skolem</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>    </span><span class="hs-comment">-- lhs is sorted, since fk is sorted</span><span>
</span><span id="line-504"></span><span>    </span><span id="local-6989586621679203367"><span class="annot"><span class="annottext">lhs :: [(f Int, f Int)]
</span><a href="#local-6989586621679203367"><span class="hs-identifier hs-var hs-var">lhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(f Int -&gt; f Int -&gt; (f Int, f Int))
-&gt; [f Int] -&gt; [f Int -&gt; (f Int, f Int)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[f Int]
</span><a href="#local-6989586621679203364"><span class="hs-identifier hs-var">fk</span></a></span><span> </span><span class="annot"><span class="annottext">[f Int -&gt; (f Int, f Int)] -&gt; [f Int] -&gt; [(f Int, f Int)]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[f Int]
</span><a href="#local-6989586621679203364"><span class="hs-identifier hs-var">fk</span></a></span><span>
</span><span id="line-505"></span><span>    </span><span id="local-6989586621679203369"><span class="annot"><span class="annottext">rhs :: [f (Int, Int)]
</span><a href="#local-6989586621679203369"><span class="hs-identifier hs-var hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(f Int -&gt; f Int -&gt; f (Int, Int)) -&gt; (f Int, f Int) -&gt; f (Int, Int)
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApplicativeDict f
-&gt; forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
forall (f :: * -&gt; *).
ApplicativeDict f
-&gt; forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><a href="ApplicativeGen.html#_applicativeLiftA2"><span class="hs-identifier hs-var">_applicativeLiftA2</span></a></span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679203349"><span class="hs-identifier hs-var">apDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((f Int, f Int) -&gt; f (Int, Int))
-&gt; [(f Int, f Int)] -&gt; [f (Int, Int)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(f Int, f Int)]
</span><a href="#local-6989586621679203367"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span>    </span><span id="local-6989586621679203380"><span class="annot"><span class="annottext">isFixing :: Iso f -&gt; Bool
</span><a href="#local-6989586621679203380"><span class="hs-identifier hs-var hs-var">isFixing</span></a></span></span><span> </span><span id="local-6989586621679203381"><span class="annot"><span class="annottext">Iso f
</span><a href="#local-6989586621679203381"><span class="hs-identifier hs-var">iso</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Iso f -&gt; forall a. f a -&gt; f a
forall (f :: * -&gt; *). Iso f -&gt; forall a. f a -&gt; f a
</span><a href="Isomorphism.html#iso1"><span class="hs-identifier hs-var">iso1</span></a></span><span> </span><span class="annot"><span class="annottext">Iso f
</span><a href="#local-6989586621679203381"><span class="hs-identifier hs-var">iso</span></a></span><span> </span><span class="annot"><span class="annottext">f ()
</span><a href="#local-6989586621679203351"><span class="hs-identifier hs-var">pureData</span></a></span><span> </span><span class="annot"><span class="annottext">f () -&gt; f () -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">f ()
</span><a href="#local-6989586621679203351"><span class="hs-identifier hs-var">pureData</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[f (Int, Int)]
</span><a href="#local-6989586621679203369"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">[f (Int, Int)] -&gt; [f (Int, Int)] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[f (Int, Int)]
</span><a href="#local-6989586621679203383"><span class="hs-identifier hs-var">rhs'</span></a></span><span>
</span><span id="line-508"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-509"></span><span>        </span><span id="local-6989586621679203383"><span class="annot"><span class="annottext">rhs' :: [f (Int, Int)]
</span><a href="#local-6989586621679203383"><span class="hs-identifier hs-var hs-var">rhs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(f Int, f Int) -&gt; f (Int, Int)
forall {a} {b}. (f a, f b) -&gt; f (a, b)
</span><a href="#local-6989586621679203385"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="annot"><span class="annottext">((f Int, f Int) -&gt; f (Int, Int))
-&gt; [(f Int, f Int)] -&gt; [f (Int, Int)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(f Int, f Int)]
</span><a href="#local-6989586621679203367"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-510"></span><span>        </span><span id="local-6989586621679203385"><span class="annot"><span class="annottext">op' :: (f a, f b) -&gt; f (a, b)
</span><a href="#local-6989586621679203385"><span class="hs-identifier hs-var hs-var">op'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679203386"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679203386"><span class="hs-identifier hs-var">fa</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679203387"><span class="annot"><span class="annottext">f b
</span><a href="#local-6989586621679203387"><span class="hs-identifier hs-var">fb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Iso f -&gt; forall a. f a -&gt; f a
forall (f :: * -&gt; *). Iso f -&gt; forall a. f a -&gt; f a
</span><a href="Isomorphism.html#iso2"><span class="hs-identifier hs-var">iso2</span></a></span><span> </span><span class="annot"><span class="annottext">Iso f
</span><a href="#local-6989586621679203381"><span class="hs-identifier hs-var">iso</span></a></span><span> </span><span class="annot"><span class="annottext">(f (a, b) -&gt; f (a, b)) -&gt; f (a, b) -&gt; f (a, b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f
-&gt; forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
forall (f :: * -&gt; *).
ApplicativeDict f
-&gt; forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><a href="ApplicativeGen.html#_applicativeLiftA2"><span class="hs-identifier hs-var">_applicativeLiftA2</span></a></span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679203349"><span class="hs-identifier hs-var">apDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Iso f -&gt; forall a. f a -&gt; f a
forall (f :: * -&gt; *). Iso f -&gt; forall a. f a -&gt; f a
</span><a href="Isomorphism.html#iso1"><span class="hs-identifier hs-var">iso1</span></a></span><span> </span><span class="annot"><span class="annottext">Iso f
</span><a href="#local-6989586621679203381"><span class="hs-identifier hs-var">iso</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679203386"><span class="hs-identifier hs-var">fa</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Iso f -&gt; forall a. f a -&gt; f a
forall (f :: * -&gt; *). Iso f -&gt; forall a. f a -&gt; f a
</span><a href="Isomorphism.html#iso1"><span class="hs-identifier hs-var">iso1</span></a></span><span> </span><span class="annot"><span class="annottext">Iso f
</span><a href="#local-6989586621679203381"><span class="hs-identifier hs-var">iso</span></a></span><span> </span><span class="annot"><span class="annottext">f b
</span><a href="#local-6989586621679203387"><span class="hs-identifier hs-var">fb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span>    </span><span id="local-6989586621679203398"><span class="annot"><span class="annottext">allSubIsos :: [[Iso f]]
</span><a href="#local-6989586621679203398"><span class="hs-identifier hs-var hs-var">allSubIsos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Iso f]]
forall (f :: * -&gt; *). PTraversable f =&gt; [[Iso f]]
</span><a href="Isomorphism.html#makePositionIso"><span class="hs-identifier hs-var">makePositionIso</span></a></span><span> </span><span class="annot"><span class="annottext">[[Iso f]] -&gt; [[Iso f]] -&gt; [[Iso f]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[[Iso f]]
forall (f :: * -&gt; *). PTraversable f =&gt; [[Iso f]]
</span><a href="Isomorphism.html#makeShapeIso"><span class="hs-identifier hs-var">makeShapeIso</span></a></span><span>
</span><span id="line-513"></span><span>    </span><span id="local-6989586621679203407"><span class="annot"><span class="annottext">allIsos :: [Iso f]
</span><a href="#local-6989586621679203407"><span class="hs-identifier hs-var hs-var">allIsos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Iso f] -&gt; [Iso f] -&gt; [Iso f]) -&gt; [Iso f] -&gt; [[Iso f]] -&gt; [Iso f]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Iso f -&gt; Iso f -&gt; Iso f) -&gt; [Iso f] -&gt; [Iso f] -&gt; [Iso f]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><span class="hs-identifier hs-var">liftA2</span></span><span> </span><span class="annot"><span class="annottext">Iso f -&gt; Iso f -&gt; Iso f
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Iso f
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[[Iso f]]
</span><a href="#local-6989586621679203398"><span class="hs-identifier hs-var">allSubIsos</span></a></span><span>
</span><span id="line-514"></span><span>    </span><span class="hs-comment">-- numAllIsos = product (length &lt;$&gt; allSubIsos)</span><span>
</span><span id="line-515"></span><span>    </span><span id="local-6989586621679203350"><span class="annot"><span class="annottext">result :: [Iso f]
</span><a href="#local-6989586621679203350"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Iso f -&gt; Bool) -&gt; [Iso f] -&gt; [Iso f]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Iso f -&gt; Bool
</span><a href="#local-6989586621679203380"><span class="hs-identifier hs-var">isFixing</span></a></span><span> </span><span class="annot"><span class="annottext">[Iso f]
</span><a href="#local-6989586621679203407"><span class="hs-identifier hs-var">allIsos</span></a></span></pre></body></html>