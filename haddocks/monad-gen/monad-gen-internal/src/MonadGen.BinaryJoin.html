<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DerivingVia #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE QuantifiedConstraints #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE DeriveTraversable #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE InstanceSigs #-}</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="MonadGen.BinaryJoin.html"><span class="hs-identifier">MonadGen.BinaryJoin</span></a></span><span class="hs-special">(</span><span>
</span><span id="line-15"></span><span>  </span><span class="annot"><a href="MonadGen.BinaryJoin.html#BinaryJoin"><span class="hs-identifier">BinaryJoin</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><a href="MonadGen.BinaryJoin.html#genFromApplicative"><span class="hs-identifier">genFromApplicative</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>  </span><span class="annot"><a href="MonadGen.BinaryJoin.html#gen"><span class="hs-identifier">gen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><a href="MonadGen.BinaryJoin.html#binaryJoinToJoin"><span class="hs-identifier">binaryJoinToJoin</span></a></span><span>
</span><span id="line-19"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">guard</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Foldable</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bool</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.PreNatMap</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PNM</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.PreNatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PreNatMap</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.FunctorShape</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">ModelFinder.Model</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Model</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">ModelFinder.Term</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">ModelFinder.Solver</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">solveEqs</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.PTraversable.Extra.html"><span class="hs-identifier">Data.PTraversable.Extra</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PTraversable.Extra.html#_indices"><span class="hs-identifier">_indices</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PTraversable.Extra.html#shapes"><span class="hs-identifier">shapes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PTraversable.Extra.html#skolem"><span class="hs-identifier">skolem</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(:.:)</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="ApplicativeGen.html"><span class="hs-identifier">ApplicativeGen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#ApplicativeDict"><span class="hs-identifier">ApplicativeDict</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.PTraversable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PTraversable</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">enum1</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="ModelFinder.Model.PreNatMapModel.html"><span class="hs-identifier">ModelFinder.Model.PreNatMapModel</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Bifunctor</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="annot"><span class="hs-comment">-- * BinaryJoin operation</span></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="annot"><span class="hs-comment">-- * Signature of join</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">data</span><span> </span><span id="J"><span class="annot"><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-var">J</span></a></span></span><span> </span><span id="local-6989586621679206148"><span class="annot"><a href="#local-6989586621679206148"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="J"><span class="annot"><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-var">J</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679206148"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206148"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206148"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679206385"><span id="local-6989586621679206392"><span id="local-6989586621679206396"><span class="annot"><span class="annottext">Int -&gt; J x -&gt; ShowS
[J x] -&gt; ShowS
J x -&gt; String
(Int -&gt; J x -&gt; ShowS)
-&gt; (J x -&gt; String) -&gt; ([J x] -&gt; ShowS) -&gt; Show (J x)
forall x. Show x =&gt; Int -&gt; J x -&gt; ShowS
forall x. Show x =&gt; [J x] -&gt; ShowS
forall x. Show x =&gt; J x -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall x. Show x =&gt; Int -&gt; J x -&gt; ShowS
showsPrec :: Int -&gt; J x -&gt; ShowS
$cshow :: forall x. Show x =&gt; J x -&gt; String
show :: J x -&gt; String
$cshowList :: forall x. Show x =&gt; [J x] -&gt; ShowS
showList :: [J x] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679206402"><span id="local-6989586621679206407"><span class="annot"><span class="annottext">J x -&gt; J x -&gt; Bool
(J x -&gt; J x -&gt; Bool) -&gt; (J x -&gt; J x -&gt; Bool) -&gt; Eq (J x)
forall x. Eq x =&gt; J x -&gt; J x -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall x. Eq x =&gt; J x -&gt; J x -&gt; Bool
== :: J x -&gt; J x -&gt; Bool
$c/= :: forall x. Eq x =&gt; J x -&gt; J x -&gt; Bool
/= :: J x -&gt; J x -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679206416"><span id="local-6989586621679206421"><span id="local-6989586621679206426"><span id="local-6989586621679206430"><span id="local-6989586621679206433"><span id="local-6989586621679206436"><span id="local-6989586621679206439"><span class="annot"><span class="annottext">Eq (J x)
Eq (J x) =&gt;
(J x -&gt; J x -&gt; Ordering)
-&gt; (J x -&gt; J x -&gt; Bool)
-&gt; (J x -&gt; J x -&gt; Bool)
-&gt; (J x -&gt; J x -&gt; Bool)
-&gt; (J x -&gt; J x -&gt; Bool)
-&gt; (J x -&gt; J x -&gt; J x)
-&gt; (J x -&gt; J x -&gt; J x)
-&gt; Ord (J x)
J x -&gt; J x -&gt; Bool
J x -&gt; J x -&gt; Ordering
J x -&gt; J x -&gt; J x
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall x. Ord x =&gt; Eq (J x)
forall x. Ord x =&gt; J x -&gt; J x -&gt; Bool
forall x. Ord x =&gt; J x -&gt; J x -&gt; Ordering
forall x. Ord x =&gt; J x -&gt; J x -&gt; J x
$ccompare :: forall x. Ord x =&gt; J x -&gt; J x -&gt; Ordering
compare :: J x -&gt; J x -&gt; Ordering
$c&lt; :: forall x. Ord x =&gt; J x -&gt; J x -&gt; Bool
&lt; :: J x -&gt; J x -&gt; Bool
$c&lt;= :: forall x. Ord x =&gt; J x -&gt; J x -&gt; Bool
&lt;= :: J x -&gt; J x -&gt; Bool
$c&gt; :: forall x. Ord x =&gt; J x -&gt; J x -&gt; Bool
&gt; :: J x -&gt; J x -&gt; Bool
$c&gt;= :: forall x. Ord x =&gt; J x -&gt; J x -&gt; Bool
&gt;= :: J x -&gt; J x -&gt; Bool
$cmax :: forall x. Ord x =&gt; J x -&gt; J x -&gt; J x
max :: J x -&gt; J x -&gt; J x
$cmin :: forall x. Ord x =&gt; J x -&gt; J x -&gt; J x
min :: J x -&gt; J x -&gt; J x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679206448"><span id="local-6989586621679206450"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; J a -&gt; J b)
-&gt; (forall a b. a -&gt; J b -&gt; J a) -&gt; Functor J
forall a b. a -&gt; J b -&gt; J a
forall a b. (a -&gt; b) -&gt; J a -&gt; J b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; J a -&gt; J b
fmap :: forall a b. (a -&gt; b) -&gt; J a -&gt; J b
$c&lt;$ :: forall a b. a -&gt; J b -&gt; J a
&lt;$ :: forall a b. a -&gt; J b -&gt; J a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679206455"><span id="local-6989586621679206461"><span id="local-6989586621679206466"><span id="local-6989586621679206471"><span id="local-6989586621679206473"><span id="local-6989586621679206476"><span id="local-6989586621679206479"><span id="local-6989586621679206482"><span id="local-6989586621679206485"><span id="local-6989586621679206488"><span id="local-6989586621679206491"><span id="local-6989586621679206493"><span id="local-6989586621679206496"><span id="local-6989586621679206501"><span id="local-6989586621679206506"><span id="local-6989586621679206511"><span id="local-6989586621679206516"><span class="annot"><span class="annottext">(forall m. Monoid m =&gt; J m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; J a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; J a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; J a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; J a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; J a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; J a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; J a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; J a -&gt; a)
-&gt; (forall a. J a -&gt; [a])
-&gt; (forall a. J a -&gt; Bool)
-&gt; (forall a. J a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; J a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; J a -&gt; a)
-&gt; (forall a. Ord a =&gt; J a -&gt; a)
-&gt; (forall a. Num a =&gt; J a -&gt; a)
-&gt; (forall a. Num a =&gt; J a -&gt; a)
-&gt; Foldable J
forall a. Eq a =&gt; a -&gt; J a -&gt; Bool
forall a. Num a =&gt; J a -&gt; a
forall a. Ord a =&gt; J a -&gt; a
forall m. Monoid m =&gt; J m -&gt; m
forall a. J a -&gt; Bool
forall a. J a -&gt; Int
forall a. J a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; J a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; J a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; J a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; J a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
$cfold :: forall m. Monoid m =&gt; J m -&gt; m
fold :: forall m. Monoid m =&gt; J m -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; J a -&gt; m
foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; J a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; J a -&gt; m
foldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; J a -&gt; m
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; J a -&gt; b
foldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; J a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; J a -&gt; b
foldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; J a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; J a -&gt; b
foldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; J a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; J a -&gt; b
foldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; J a -&gt; b
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; J a -&gt; a
foldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; J a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; J a -&gt; a
foldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; J a -&gt; a
$ctoList :: forall a. J a -&gt; [a]
toList :: forall a. J a -&gt; [a]
$cnull :: forall a. J a -&gt; Bool
null :: forall a. J a -&gt; Bool
$clength :: forall a. J a -&gt; Int
length :: forall a. J a -&gt; Int
$celem :: forall a. Eq a =&gt; a -&gt; J a -&gt; Bool
elem :: forall a. Eq a =&gt; a -&gt; J a -&gt; Bool
$cmaximum :: forall a. Ord a =&gt; J a -&gt; a
maximum :: forall a. Ord a =&gt; J a -&gt; a
$cminimum :: forall a. Ord a =&gt; J a -&gt; a
minimum :: forall a. Ord a =&gt; J a -&gt; a
$csum :: forall a. Num a =&gt; J a -&gt; a
sum :: forall a. Num a =&gt; J a -&gt; a
$cproduct :: forall a. Num a =&gt; J a -&gt; a
product :: forall a. Num a =&gt; J a -&gt; a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679206529"><span id="local-6989586621679206534"><span id="local-6989586621679206540"><span id="local-6989586621679206545"><span class="annot"><span class="annottext">Functor J
Foldable J
(Functor J, Foldable J) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; J a -&gt; f (J b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; J (f a) -&gt; f (J a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; J a -&gt; m (J b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; J (m a) -&gt; m (J a))
-&gt; Traversable J
forall (t :: * -&gt; *).
(Functor t, Foldable t) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a. Monad m =&gt; J (m a) -&gt; m (J a)
forall (f :: * -&gt; *) a. Applicative f =&gt; J (f a) -&gt; f (J a)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; J a -&gt; m (J b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; J a -&gt; f (J b)
$ctraverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; J a -&gt; f (J b)
traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; J a -&gt; f (J b)
$csequenceA :: forall (f :: * -&gt; *) a. Applicative f =&gt; J (f a) -&gt; f (J a)
sequenceA :: forall (f :: * -&gt; *) a. Applicative f =&gt; J (f a) -&gt; f (J a)
$cmapM :: forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; J a -&gt; m (J b)
mapM :: forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; J a -&gt; m (J b)
$csequence :: forall (m :: * -&gt; *) a. Monad m =&gt; J (m a) -&gt; m (J a)
sequence :: forall (m :: * -&gt; *) a. Monad m =&gt; J (m a) -&gt; m (J a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span id="local-6989586621679206143"><span class="annot"><a href="MonadGen.BinaryJoin.html#j"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206143"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206143"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206143"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206143"><span class="hs-identifier hs-type">x</span></a></span></span><span>
</span><span id="line-52"></span><span id="j"><span class="annot"><span class="annottext">j :: forall x. Term J x -&gt; Term J x -&gt; Term J x -&gt; Term J x
</span><a href="MonadGen.BinaryJoin.html#j"><span class="hs-identifier hs-var hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679206552"><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206552"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679206553"><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206553"><span class="hs-identifier hs-var">y0</span></a></span></span><span> </span><span id="local-6989586621679206554"><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206554"><span class="hs-identifier hs-var">y1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">J (Term J x) -&gt; Term J x
forall (f :: * -&gt; *) a. f (Term f a) -&gt; Term f a
</span><span class="hs-identifier hs-var">fun</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term J x -&gt; Term J x -&gt; Term J x -&gt; J (Term J x)
forall x. x -&gt; x -&gt; x -&gt; J x
</span><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-var">J</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206552"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206553"><span class="hs-identifier hs-var">y0</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206554"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- Associativity of j</span><span>
</span><span id="line-55"></span><span id="local-6989586621679206149"><span class="annot"><a href="MonadGen.BinaryJoin.html#assocEqs"><span class="hs-identifier hs-type">assocEqs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679206149"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206149"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206149"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-56"></span><span id="assocEqs"><span class="annot"><span class="annottext">assocEqs :: forall (f :: * -&gt; *).
PTraversable f =&gt;
[(Term J (f Bool), Term J (f Bool))]
</span><a href="MonadGen.BinaryJoin.html#assocEqs"><span class="hs-identifier hs-var hs-var">assocEqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term J (f Bool)
-&gt; Term J (f Bool)
-&gt; Term J (f Bool)
-&gt; Term J (f Bool)
-&gt; Term J (f Bool)
-&gt; (Term J (f Bool), Term J (f Bool))
forall {x}.
Term J x
-&gt; Term J x
-&gt; Term J x
-&gt; Term J x
-&gt; Term J x
-&gt; (Term J x, Term J x)
</span><a href="#local-6989586621679206579"><span class="hs-identifier hs-var">assocEq</span></a></span><span> </span><span class="annot"><span class="annottext">(Term J (f Bool)
 -&gt; Term J (f Bool)
 -&gt; Term J (f Bool)
 -&gt; Term J (f Bool)
 -&gt; Term J (f Bool)
 -&gt; (Term J (f Bool), Term J (f Bool)))
-&gt; [Term J (f Bool)]
-&gt; [Term J (f Bool)
    -&gt; Term J (f Bool)
    -&gt; Term J (f Bool)
    -&gt; Term J (f Bool)
    -&gt; (Term J (f Bool), Term J (f Bool))]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Term J (f Bool)]
forall {f :: * -&gt; *}. [Term f (f Bool)]
</span><a href="#local-6989586621679206581"><span class="hs-identifier hs-var">f2</span></a></span><span> </span><span class="annot"><span class="annottext">[Term J (f Bool)
 -&gt; Term J (f Bool)
 -&gt; Term J (f Bool)
 -&gt; Term J (f Bool)
 -&gt; (Term J (f Bool), Term J (f Bool))]
-&gt; [Term J (f Bool)]
-&gt; [Term J (f Bool)
    -&gt; Term J (f Bool)
    -&gt; Term J (f Bool)
    -&gt; (Term J (f Bool), Term J (f Bool))]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Term J (f Bool)]
forall {f :: * -&gt; *}. [Term f (f Bool)]
</span><a href="#local-6989586621679206581"><span class="hs-identifier hs-var">f2</span></a></span><span> </span><span class="annot"><span class="annottext">[Term J (f Bool)
 -&gt; Term J (f Bool)
 -&gt; Term J (f Bool)
 -&gt; (Term J (f Bool), Term J (f Bool))]
-&gt; [Term J (f Bool)]
-&gt; [Term J (f Bool)
    -&gt; Term J (f Bool) -&gt; (Term J (f Bool), Term J (f Bool))]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Term J (f Bool)]
forall {f :: * -&gt; *}. [Term f (f Bool)]
</span><a href="#local-6989586621679206581"><span class="hs-identifier hs-var">f2</span></a></span><span> </span><span class="annot"><span class="annottext">[Term J (f Bool)
 -&gt; Term J (f Bool) -&gt; (Term J (f Bool), Term J (f Bool))]
-&gt; [Term J (f Bool)]
-&gt; [Term J (f Bool) -&gt; (Term J (f Bool), Term J (f Bool))]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Term J (f Bool)]
forall {f :: * -&gt; *}. [Term f (f Bool)]
</span><a href="#local-6989586621679206581"><span class="hs-identifier hs-var">f2</span></a></span><span> </span><span class="annot"><span class="annottext">[Term J (f Bool) -&gt; (Term J (f Bool), Term J (f Bool))]
-&gt; [Term J (f Bool)] -&gt; [(Term J (f Bool), Term J (f Bool))]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Term J (f Bool)]
forall {f :: * -&gt; *}. [Term f (f Bool)]
</span><a href="#local-6989586621679206581"><span class="hs-identifier hs-var">f2</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-58"></span><span>    </span><span id="local-6989586621679206581"><span class="annot"><span class="annottext">f2 :: [Term f (f Bool)]
</span><a href="#local-6989586621679206581"><span class="hs-identifier hs-var hs-var">f2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f Bool -&gt; Term f (f Bool)
forall a (f :: * -&gt; *). a -&gt; Term f a
</span><span class="hs-identifier hs-var">con</span></span><span> </span><span class="annot"><span class="annottext">(f Bool -&gt; Term f (f Bool)) -&gt; [f Bool] -&gt; [Term f (f Bool)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; [f Bool]
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(PTraversable t, Alternative f) =&gt;
f a -&gt; f (t a)
</span><span class="hs-identifier hs-var">enum1</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">]</span><span>
</span><span id="line-59"></span><span>    </span><span id="local-6989586621679206579"><span class="annot"><span class="annottext">assocEq :: Term J x
-&gt; Term J x
-&gt; Term J x
-&gt; Term J x
-&gt; Term J x
-&gt; (Term J x, Term J x)
</span><a href="#local-6989586621679206579"><span class="hs-identifier hs-var hs-var">assocEq</span></a></span></span><span> </span><span id="local-6989586621679206594"><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206594"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679206595"><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206595"><span class="hs-identifier hs-var">y0</span></a></span></span><span> </span><span id="local-6989586621679206596"><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206596"><span class="hs-identifier hs-var">y1</span></a></span></span><span> </span><span id="local-6989586621679206597"><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206597"><span class="hs-identifier hs-var">z0</span></a></span></span><span> </span><span id="local-6989586621679206598"><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206598"><span class="hs-identifier hs-var">z1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206599"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206600"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-61"></span><span>        </span><span id="local-6989586621679206599"><span class="annot"><span class="annottext">lhs :: Term J x
</span><a href="#local-6989586621679206599"><span class="hs-identifier hs-var hs-var">lhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term J x -&gt; Term J x -&gt; Term J x -&gt; Term J x
forall x. Term J x -&gt; Term J x -&gt; Term J x -&gt; Term J x
</span><a href="MonadGen.BinaryJoin.html#j"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term J x -&gt; Term J x -&gt; Term J x -&gt; Term J x
forall x. Term J x -&gt; Term J x -&gt; Term J x -&gt; Term J x
</span><a href="MonadGen.BinaryJoin.html#j"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206594"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206595"><span class="hs-identifier hs-var">y0</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206596"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206597"><span class="hs-identifier hs-var">z0</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206598"><span class="hs-identifier hs-var">z1</span></a></span><span>
</span><span id="line-62"></span><span>        </span><span id="local-6989586621679206600"><span class="annot"><span class="annottext">rhs :: Term J x
</span><a href="#local-6989586621679206600"><span class="hs-identifier hs-var hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term J x -&gt; Term J x -&gt; Term J x -&gt; Term J x
forall x. Term J x -&gt; Term J x -&gt; Term J x -&gt; Term J x
</span><a href="MonadGen.BinaryJoin.html#j"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206594"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term J x -&gt; Term J x -&gt; Term J x -&gt; Term J x
forall x. Term J x -&gt; Term J x -&gt; Term J x -&gt; Term J x
</span><a href="MonadGen.BinaryJoin.html#j"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206595"><span class="hs-identifier hs-var">y0</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206597"><span class="hs-identifier hs-var">z0</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206598"><span class="hs-identifier hs-var">z1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term J x -&gt; Term J x -&gt; Term J x -&gt; Term J x
forall x. Term J x -&gt; Term J x -&gt; Term J x -&gt; Term J x
</span><a href="MonadGen.BinaryJoin.html#j"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206596"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206597"><span class="hs-identifier hs-var">z0</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206598"><span class="hs-identifier hs-var">z1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- naturality w.r.t. not</span><span>
</span><span id="line-65"></span><span id="local-6989586621679206601"><span class="annot"><a href="MonadGen.BinaryJoin.html#notEqs"><span class="hs-identifier hs-type">notEqs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679206601"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206601"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206601"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-66"></span><span id="notEqs"><span class="annot"><span class="annottext">notEqs :: forall (f :: * -&gt; *).
PTraversable f =&gt;
[(Term J (f Bool), Term J (f Bool))]
</span><a href="MonadGen.BinaryJoin.html#notEqs"><span class="hs-identifier hs-var hs-var">notEqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-67"></span><span>  </span><span id="local-6989586621679206622"><span class="annot"><a href="#local-6989586621679206622"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[f Bool]
</span><a href="#local-6989586621679206623"><span class="hs-identifier hs-var">f2</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679206625"><span class="annot"><a href="#local-6989586621679206625"><span class="hs-identifier hs-var hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; f Bool -&gt; f Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679206622"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206622"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679206625"><span class="hs-identifier hs-type">x'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><a href="#local-6989586621679206627"><span class="hs-identifier hs-type">notEq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">con</span></span><span> </span><span class="annot"><a href="#local-6989586621679206622"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">con</span></span><span> </span><span class="annot"><a href="#local-6989586621679206625"><span class="hs-identifier hs-type">x'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">con</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679206623"><span class="hs-identifier hs-type">f2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">con</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679206623"><span class="hs-identifier hs-type">f2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-72"></span><span>    </span><span id="local-6989586621679206623"><span class="annot"><span class="annottext">f2 :: [f Bool]
</span><a href="#local-6989586621679206623"><span class="hs-identifier hs-var hs-var">f2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; [f Bool]
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(PTraversable t, Alternative f) =&gt;
f a -&gt; f (t a)
</span><span class="hs-identifier hs-var">enum1</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">]</span><span>
</span><span id="line-73"></span><span>    </span><span id="local-6989586621679206627"><span class="annot"><span class="annottext">notEq :: Term J x
-&gt; Term J x -&gt; Term J x -&gt; Term J x -&gt; (Term J x, Term J x)
</span><a href="#local-6989586621679206627"><span class="hs-identifier hs-var hs-var">notEq</span></a></span></span><span> </span><span id="local-6989586621679206637"><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206637"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679206638"><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206638"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679206639"><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206639"><span class="hs-identifier hs-var">y0</span></a></span></span><span> </span><span id="local-6989586621679206640"><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206640"><span class="hs-identifier hs-var">y1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term J x -&gt; Term J x -&gt; Term J x -&gt; Term J x
forall x. Term J x -&gt; Term J x -&gt; Term J x -&gt; Term J x
</span><a href="MonadGen.BinaryJoin.html#j"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206637"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206639"><span class="hs-identifier hs-var">y0</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206640"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term J x -&gt; Term J x -&gt; Term J x -&gt; Term J x
forall x. Term J x -&gt; Term J x -&gt; Term J x -&gt; Term J x
</span><a href="MonadGen.BinaryJoin.html#j"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206638"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206640"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206639"><span class="hs-identifier hs-var">y0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- naturality w.r.t. constant join</span><span>
</span><span id="line-76"></span><span id="local-6989586621679206641"><span class="annot"><a href="MonadGen.BinaryJoin.html#constEqs"><span class="hs-identifier hs-type">constEqs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679206641"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206641"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206641"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-77"></span><span id="constEqs"><span class="annot"><span class="annottext">constEqs :: forall (f :: * -&gt; *).
PTraversable f =&gt;
[(Term J (f Bool), Term J (f Bool))]
</span><a href="MonadGen.BinaryJoin.html#constEqs"><span class="hs-identifier hs-var hs-var">constEqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term J (f Bool)
-&gt; Term J (f Bool)
-&gt; Term J (f Bool)
-&gt; (Term J (f Bool), Term J (f Bool))
forall {x}.
Term J x -&gt; Term J x -&gt; Term J x -&gt; (Term J x, Term J x)
</span><a href="#local-6989586621679206654"><span class="hs-identifier hs-var">constEq</span></a></span><span> </span><span class="annot"><span class="annottext">(Term J (f Bool)
 -&gt; Term J (f Bool)
 -&gt; Term J (f Bool)
 -&gt; (Term J (f Bool), Term J (f Bool)))
-&gt; [Term J (f Bool)]
-&gt; [Term J (f Bool)
    -&gt; Term J (f Bool) -&gt; (Term J (f Bool), Term J (f Bool))]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Term J (f Bool)]
forall {f :: * -&gt; *}. [Term f (f Bool)]
</span><a href="#local-6989586621679206655"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">[Term J (f Bool)
 -&gt; Term J (f Bool) -&gt; (Term J (f Bool), Term J (f Bool))]
-&gt; [Term J (f Bool)]
-&gt; [Term J (f Bool) -&gt; (Term J (f Bool), Term J (f Bool))]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Term J (f Bool)]
forall {f :: * -&gt; *}. [Term f (f Bool)]
</span><a href="#local-6989586621679206656"><span class="hs-identifier hs-var">f2</span></a></span><span> </span><span class="annot"><span class="annottext">[Term J (f Bool) -&gt; (Term J (f Bool), Term J (f Bool))]
-&gt; [Term J (f Bool)] -&gt; [(Term J (f Bool), Term J (f Bool))]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Term J (f Bool)]
forall {f :: * -&gt; *}. [Term f (f Bool)]
</span><a href="#local-6989586621679206656"><span class="hs-identifier hs-var">f2</span></a></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621679206655"><span class="annot"><span class="annottext">f1 :: [Term f (f Bool)]
</span><a href="#local-6989586621679206655"><span class="hs-identifier hs-var hs-var">f1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f Bool -&gt; Term f (f Bool)
forall a (f :: * -&gt; *). a -&gt; Term f a
</span><span class="hs-identifier hs-var">con</span></span><span> </span><span class="annot"><span class="annottext">(f Bool -&gt; Term f (f Bool)) -&gt; [f Bool] -&gt; [Term f (f Bool)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; [f Bool]
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(PTraversable t, Alternative f) =&gt;
f a -&gt; f (t a)
</span><span class="hs-identifier hs-var">enum1</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">]</span><span>
</span><span id="line-80"></span><span>    </span><span id="local-6989586621679206656"><span class="annot"><span class="annottext">f2 :: [Term f (f Bool)]
</span><a href="#local-6989586621679206656"><span class="hs-identifier hs-var hs-var">f2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f Bool -&gt; Term f (f Bool)
forall a (f :: * -&gt; *). a -&gt; Term f a
</span><span class="hs-identifier hs-var">con</span></span><span> </span><span class="annot"><span class="annottext">(f Bool -&gt; Term f (f Bool)) -&gt; [f Bool] -&gt; [Term f (f Bool)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; [f Bool]
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(PTraversable t, Alternative f) =&gt;
f a -&gt; f (t a)
</span><span class="hs-identifier hs-var">enum1</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">]</span><span>
</span><span id="line-81"></span><span>    </span><span id="local-6989586621679206654"><span class="annot"><span class="annottext">constEq :: Term J x -&gt; Term J x -&gt; Term J x -&gt; (Term J x, Term J x)
</span><a href="#local-6989586621679206654"><span class="hs-identifier hs-var hs-var">constEq</span></a></span></span><span> </span><span id="local-6989586621679206677"><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206677"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679206678"><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206678"><span class="hs-identifier hs-var">y0</span></a></span></span><span> </span><span id="local-6989586621679206679"><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206679"><span class="hs-identifier hs-var">y1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term J x -&gt; Term J x -&gt; Term J x -&gt; Term J x
forall x. Term J x -&gt; Term J x -&gt; Term J x -&gt; Term J x
</span><a href="MonadGen.BinaryJoin.html#j"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206677"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206678"><span class="hs-identifier hs-var">y0</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206679"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term J x -&gt; Term J x -&gt; Term J x -&gt; Term J x
forall x. Term J x -&gt; Term J x -&gt; Term J x -&gt; Term J x
</span><a href="MonadGen.BinaryJoin.html#j"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206677"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206678"><span class="hs-identifier hs-var">y0</span></a></span><span> </span><span class="annot"><span class="annottext">Term J x
</span><a href="#local-6989586621679206678"><span class="hs-identifier hs-var">y0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">-- left unit law</span><span>
</span><span id="line-84"></span><span id="local-6989586621679206180"><span class="annot"><a href="MonadGen.BinaryJoin.html#unitLeftDefs"><span class="hs-identifier hs-type">unitLeftDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679206180"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span class="annot"><a href="#local-6989586621679206180"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206180"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206180"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-85"></span><span id="unitLeftDefs"><span class="annot"><span class="annottext">unitLeftDefs :: forall (f :: * -&gt; *).
PTraversable f =&gt;
Shape f -&gt; Map (J (f Bool)) (f Bool)
</span><a href="MonadGen.BinaryJoin.html#unitLeftDefs"><span class="hs-identifier hs-var hs-var">unitLeftDefs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span id="local-6989586621679206695"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679206695"><span class="hs-identifier hs-var">u_</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(J (f Bool), f Bool)] -&gt; Map (J (f Bool)) (f Bool)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(J (f Bool), f Bool)] -&gt; Map (J (f Bool)) (f Bool))
-&gt; [(J (f Bool), f Bool)] -&gt; Map (J (f Bool)) (f Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f Bool -&gt; f Bool -&gt; (J (f Bool), f Bool)
</span><a href="#local-6989586621679206697"><span class="hs-identifier hs-var">unitLeftDef</span></a></span><span> </span><span class="annot"><span class="annottext">(f Bool -&gt; f Bool -&gt; (J (f Bool), f Bool))
-&gt; [f Bool] -&gt; [f Bool -&gt; (J (f Bool), f Bool)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[f Bool]
</span><a href="#local-6989586621679206698"><span class="hs-identifier hs-var">f2</span></a></span><span> </span><span class="annot"><span class="annottext">[f Bool -&gt; (J (f Bool), f Bool)]
-&gt; [f Bool] -&gt; [(J (f Bool), f Bool)]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[f Bool]
</span><a href="#local-6989586621679206698"><span class="hs-identifier hs-var">f2</span></a></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-87"></span><span>    </span><span id="local-6989586621679206700"><span class="annot"><span class="annottext">u :: f Bool
</span><a href="#local-6989586621679206700"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; f a -&gt; f Bool
forall a b. a -&gt; f b -&gt; f a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679206695"><span class="hs-identifier hs-var">u_</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span id="local-6989586621679206698"><span class="annot"><span class="annottext">f2 :: [f Bool]
</span><a href="#local-6989586621679206698"><span class="hs-identifier hs-var hs-var">f2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; [f Bool]
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(PTraversable t, Alternative f) =&gt;
f a -&gt; f (t a)
</span><span class="hs-identifier hs-var">enum1</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">]</span><span>
</span><span id="line-89"></span><span>    </span><span id="local-6989586621679206697"><span class="annot"><span class="annottext">unitLeftDef :: f Bool -&gt; f Bool -&gt; (J (f Bool), f Bool)
</span><a href="#local-6989586621679206697"><span class="hs-identifier hs-var hs-var">unitLeftDef</span></a></span></span><span> </span><span id="local-6989586621679206710"><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679206710"><span class="hs-identifier hs-var">y0</span></a></span></span><span> </span><span id="local-6989586621679206711"><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679206711"><span class="hs-identifier hs-var">y1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f Bool -&gt; f Bool -&gt; f Bool -&gt; J (f Bool)
forall x. x -&gt; x -&gt; x -&gt; J x
</span><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-var">J</span></a></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679206700"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679206710"><span class="hs-identifier hs-var">y0</span></a></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679206711"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679206710"><span class="hs-identifier hs-var">y0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- right unit law</span><span>
</span><span id="line-92"></span><span id="local-6989586621679206712"><span class="annot"><a href="MonadGen.BinaryJoin.html#unitRightDefs"><span class="hs-identifier hs-type">unitRightDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679206712"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span class="annot"><a href="#local-6989586621679206712"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206712"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206712"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-93"></span><span id="unitRightDefs"><span class="annot"><span class="annottext">unitRightDefs :: forall (f :: * -&gt; *).
PTraversable f =&gt;
Shape f -&gt; Map (J (f Bool)) (f Bool)
</span><a href="MonadGen.BinaryJoin.html#unitRightDefs"><span class="hs-identifier hs-var hs-var">unitRightDefs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span id="local-6989586621679206726"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679206726"><span class="hs-identifier hs-var">u_</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(J (f Bool), f Bool)] -&gt; Map (J (f Bool)) (f Bool)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(J (f Bool), f Bool)] -&gt; Map (J (f Bool)) (f Bool))
-&gt; [(J (f Bool), f Bool)] -&gt; Map (J (f Bool)) (f Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f Bool -&gt; (J (f Bool), f Bool)
</span><a href="#local-6989586621679206727"><span class="hs-identifier hs-var">unitRightDef</span></a></span><span> </span><span class="annot"><span class="annottext">(f Bool -&gt; (J (f Bool), f Bool))
-&gt; [f Bool] -&gt; [(J (f Bool), f Bool)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[f Bool]
</span><a href="#local-6989586621679206728"><span class="hs-identifier hs-var">f2</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-95"></span><span>    </span><span id="local-6989586621679206730"><span class="annot"><span class="annottext">u0 :: f Bool
</span><a href="#local-6989586621679206730"><span class="hs-identifier hs-var hs-var">u0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; f a -&gt; f Bool
forall a b. a -&gt; f b -&gt; f a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679206726"><span class="hs-identifier hs-var">u_</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span id="local-6989586621679206732"><span class="annot"><span class="annottext">u1 :: f Bool
</span><a href="#local-6989586621679206732"><span class="hs-identifier hs-var hs-var">u1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; f a -&gt; f Bool
forall a b. a -&gt; f b -&gt; f a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679206726"><span class="hs-identifier hs-var">u_</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span id="local-6989586621679206728"><span class="annot"><span class="annottext">f2 :: [f Bool]
</span><a href="#local-6989586621679206728"><span class="hs-identifier hs-var hs-var">f2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; [f Bool]
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(PTraversable t, Alternative f) =&gt;
f a -&gt; f (t a)
</span><span class="hs-identifier hs-var">enum1</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">]</span><span>
</span><span id="line-98"></span><span>    </span><span id="local-6989586621679206727"><span class="annot"><span class="annottext">unitRightDef :: f Bool -&gt; (J (f Bool), f Bool)
</span><a href="#local-6989586621679206727"><span class="hs-identifier hs-var hs-var">unitRightDef</span></a></span></span><span> </span><span id="local-6989586621679206742"><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679206742"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f Bool -&gt; f Bool -&gt; f Bool -&gt; J (f Bool)
forall x. x -&gt; x -&gt; x -&gt; J x
</span><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-var">J</span></a></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679206742"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679206730"><span class="hs-identifier hs-var">u0</span></a></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679206732"><span class="hs-identifier hs-var">u1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679206742"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- Special case for an empty value</span><span>
</span><span id="line-101"></span><span id="local-6989586621679206193"><span class="annot"><a href="MonadGen.BinaryJoin.html#zeroDefs"><span class="hs-identifier hs-type">zeroDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679206193"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206193"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206193"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-102"></span><span id="zeroDefs"><span class="annot"><span class="annottext">zeroDefs :: forall (f :: * -&gt; *). PTraversable f =&gt; Map (J (f Bool)) (f Bool)
</span><a href="MonadGen.BinaryJoin.html#zeroDefs"><span class="hs-identifier hs-var hs-var">zeroDefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(J (f Bool), f Bool)] -&gt; Map (J (f Bool)) (f Bool)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(J (f Bool), f Bool)] -&gt; Map (J (f Bool)) (f Bool))
-&gt; [(J (f Bool), f Bool)] -&gt; Map (J (f Bool)) (f Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f Bool -&gt; f Bool -&gt; f Bool -&gt; (J (f Bool), f Bool)
forall {b}. b -&gt; b -&gt; b -&gt; (J b, b)
</span><a href="#local-6989586621679206758"><span class="hs-identifier hs-var">zeroDef</span></a></span><span> </span><span class="annot"><span class="annottext">(f Bool -&gt; f Bool -&gt; f Bool -&gt; (J (f Bool), f Bool))
-&gt; [f Bool] -&gt; [f Bool -&gt; f Bool -&gt; (J (f Bool), f Bool)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[f Bool]
forall {a}. [f a]
</span><a href="#local-6989586621679206759"><span class="hs-identifier hs-var">f0</span></a></span><span> </span><span class="annot"><span class="annottext">[f Bool -&gt; f Bool -&gt; (J (f Bool), f Bool)]
-&gt; [f Bool] -&gt; [f Bool -&gt; (J (f Bool), f Bool)]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[f Bool]
</span><a href="#local-6989586621679206760"><span class="hs-identifier hs-var">f2</span></a></span><span> </span><span class="annot"><span class="annottext">[f Bool -&gt; (J (f Bool), f Bool)]
-&gt; [f Bool] -&gt; [(J (f Bool), f Bool)]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[f Bool]
</span><a href="#local-6989586621679206760"><span class="hs-identifier hs-var">f2</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-104"></span><span>    </span><span id="local-6989586621679206759"><span class="annot"><span class="annottext">f0 :: [f a]
</span><a href="#local-6989586621679206759"><span class="hs-identifier hs-var hs-var">f0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [f a]
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(PTraversable t, Alternative f) =&gt;
f a -&gt; f (t a)
</span><span class="hs-identifier hs-var">enum1</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-105"></span><span>    </span><span id="local-6989586621679206760"><span class="annot"><span class="annottext">f2 :: [f Bool]
</span><a href="#local-6989586621679206760"><span class="hs-identifier hs-var hs-var">f2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; [f Bool]
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(PTraversable t, Alternative f) =&gt;
f a -&gt; f (t a)
</span><span class="hs-identifier hs-var">enum1</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">]</span><span>
</span><span id="line-106"></span><span>    </span><span id="local-6989586621679206758"><span class="annot"><span class="annottext">zeroDef :: b -&gt; b -&gt; b -&gt; (J b, b)
</span><a href="#local-6989586621679206758"><span class="hs-identifier hs-var hs-var">zeroDef</span></a></span></span><span> </span><span id="local-6989586621679206779"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679206779"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679206780"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679206780"><span class="hs-identifier hs-var">y0</span></a></span></span><span> </span><span id="local-6989586621679206781"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679206781"><span class="hs-identifier hs-var">y1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; b -&gt; b -&gt; J b
forall x. x -&gt; x -&gt; x -&gt; J x
</span><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-var">J</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679206779"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679206780"><span class="hs-identifier hs-var">y0</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679206781"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679206779"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="annot"><a href="MonadGen.BinaryJoin.html#apDefs"><span class="hs-identifier hs-type">apDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679206198"><span class="annot"><a href="#local-6989586621679206198"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679206198"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeDict"><span class="hs-identifier hs-type">ApplicativeDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206198"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206198"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206198"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span id="apDefs"><span class="annot"><span class="annottext">apDefs :: forall (f :: * -&gt; *).
PTraversable f =&gt;
ApplicativeDict f -&gt; Map (J (f Bool)) (f Bool)
</span><a href="MonadGen.BinaryJoin.html#apDefs"><span class="hs-identifier hs-var hs-var">apDefs</span></a></span></span><span> </span><span id="local-6989586621679206798"><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679206798"><span class="hs-identifier hs-var">apDict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(J (f Bool), f Bool)] -&gt; Map (J (f Bool)) (f Bool)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(J (f Bool), f Bool)] -&gt; Map (J (f Bool)) (f Bool))
-&gt; [(J (f Bool), f Bool)] -&gt; Map (J (f Bool)) (f Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[(J (f Bool), f Bool)]] -&gt; [(J (f Bool), f Bool)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[(J (f Bool), f Bool)]] -&gt; [(J (f Bool), f Bool)])
-&gt; [[(J (f Bool), f Bool)]] -&gt; [(J (f Bool), f Bool)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f Bool -&gt; f Int -&gt; [(J (f Bool), f Bool)]
</span><a href="#local-6989586621679206800"><span class="hs-identifier hs-var">jAp</span></a></span><span> </span><span class="annot"><span class="annottext">(f Bool -&gt; f Int -&gt; [(J (f Bool), f Bool)])
-&gt; [f Bool] -&gt; [f Int -&gt; [(J (f Bool), f Bool)]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[f Bool]
</span><a href="#local-6989586621679206801"><span class="hs-identifier hs-var">f2</span></a></span><span> </span><span class="annot"><span class="annottext">[f Int -&gt; [(J (f Bool), f Bool)]]
-&gt; [f Int] -&gt; [[(J (f Bool), f Bool)]]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[f Int]
</span><a href="#local-6989586621679206802"><span class="hs-identifier hs-var">fi</span></a></span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-111"></span><span>    </span><span id="local-6989586621679206801"><span class="annot"><span class="annottext">f2 :: [f Bool]
</span><a href="#local-6989586621679206801"><span class="hs-identifier hs-var hs-var">f2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; [f Bool]
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(PTraversable t, Alternative f) =&gt;
f a -&gt; f (t a)
</span><span class="hs-identifier hs-var">enum1</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">]</span><span>
</span><span id="line-112"></span><span>    </span><span id="local-6989586621679206802"><span class="annot"><span class="annottext">fi :: [f Int]
</span><a href="#local-6989586621679206802"><span class="hs-identifier hs-var hs-var">fi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (f Int) -&gt; [f Int]
forall a. Vector a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">Vector (f Int)
forall (m :: * -&gt; *). PTraversable m =&gt; Vector (m Int)
</span><a href="Data.PTraversable.Extra.html#skolem"><span class="hs-identifier hs-var">skolem</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><a href="#local-6989586621679206822"><span class="hs-identifier hs-type">_liftA2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679206205"><span class="annot"><a href="#local-6989586621679206205"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679206206"><span class="annot"><a href="#local-6989586621679206206"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679206207"><span class="annot"><a href="#local-6989586621679206207"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206205"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679206206"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679206207"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679206198"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206205"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679206198"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206206"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679206198"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206207"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span id="local-6989586621679206822"><span class="annot"><span class="annottext">_liftA2 :: forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><a href="#local-6989586621679206822"><span class="hs-identifier hs-var hs-var">_liftA2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f
-&gt; forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
forall (f :: * -&gt; *).
ApplicativeDict f
-&gt; forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><a href="ApplicativeGen.html#_applicativeLiftA2"><span class="hs-identifier hs-var">_applicativeLiftA2</span></a></span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679206798"><span class="hs-identifier hs-var">apDict</span></a></span><span> </span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span>    </span><span id="local-6989586621679206800"><span class="annot"><span class="annottext">jAp :: f Bool -&gt; f Int -&gt; [(J (f Bool), f Bool)]
</span><a href="#local-6989586621679206800"><span class="hs-identifier hs-var hs-var">jAp</span></a></span></span><span> </span><span id="local-6989586621679206830"><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679206830"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679206831"><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679206831"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-118"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679206832"><span class="annot"><a href="#local-6989586621679206832"><span class="hs-identifier hs-var">bitmap0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679206833"><span class="annot"><a href="#local-6989586621679206833"><span class="hs-identifier hs-var">y0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f Int -&gt; [(Bitmap, f Bool)]
forall (f :: * -&gt; *) any.
Traversable f =&gt;
f any -&gt; [(Bitmap, f Bool)]
</span><a href="MonadGen.BinaryJoin.html#boolTable"><span class="hs-identifier hs-var">boolTable</span></a></span><span> </span><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679206831"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-119"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679206835"><span class="annot"><a href="#local-6989586621679206835"><span class="hs-identifier hs-var">bitmap1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679206836"><span class="annot"><a href="#local-6989586621679206836"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="MonadGen.BinaryJoin.html#boolTable"><span class="hs-identifier hs-type">boolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206831"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-120"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679206839"><span class="annot"><a href="#local-6989586621679206839"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679206840"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679206840"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bitmap -&gt; Int -&gt; Bool
forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><span class="hs-identifier hs-var">testBit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bitmap -&gt; Bitmap -&gt; Bool -&gt; Bitmap
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="annot"><span class="annottext">Bitmap
</span><a href="#local-6989586621679206832"><span class="hs-identifier hs-var">bitmap0</span></a></span><span> </span><span class="annot"><span class="annottext">Bitmap
</span><a href="#local-6989586621679206835"><span class="hs-identifier hs-var">bitmap1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679206840"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>          </span><span id="local-6989586621679206842"><span class="annot"><a href="#local-6989586621679206842"><span class="hs-identifier hs-var hs-var">lhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f Bool -&gt; f Bool -&gt; f Bool -&gt; J (f Bool)
forall x. x -&gt; x -&gt; x -&gt; J x
</span><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-var">J</span></a></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679206830"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679206833"><span class="hs-identifier hs-var">y0</span></a></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679206836"><span class="hs-identifier hs-var">y1</span></a></span><span>
</span><span id="line-122"></span><span>          </span><span id="local-6989586621679206843"><span class="annot"><a href="#local-6989586621679206843"><span class="hs-identifier hs-var hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Int -&gt; Bool) -&gt; f Bool -&gt; f Int -&gt; f Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><a href="#local-6989586621679206822"><span class="hs-identifier hs-var">_liftA2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; Bool
</span><a href="#local-6989586621679206839"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679206830"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679206831"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-123"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206842"><span class="hs-identifier hs-type">lhs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679206843"><span class="hs-identifier hs-type">rhs</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">-- Known definitions from Applicative</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-keyword">data</span><span> </span><span id="BinaryJoin"><span class="annot"><a href="MonadGen.BinaryJoin.html#BinaryJoin"><span class="hs-identifier hs-var">BinaryJoin</span></a></span></span><span> </span><span id="local-6989586621679206255"><span class="annot"><a href="#local-6989586621679206255"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679206256"><span class="annot"><a href="#local-6989586621679206256"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BJ"><span class="annot"><a href="MonadGen.BinaryJoin.html#BJ"><span class="hs-identifier hs-var">BJ</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206255"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206255"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206256"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206255"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206256"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679206847"><span id="local-6989586621679206851"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; BinaryJoin f a -&gt; BinaryJoin f b)
-&gt; (forall a b. a -&gt; BinaryJoin f b -&gt; BinaryJoin f a)
-&gt; Functor (BinaryJoin f)
forall a b. a -&gt; BinaryJoin f b -&gt; BinaryJoin f a
forall a b. (a -&gt; b) -&gt; BinaryJoin f a -&gt; BinaryJoin f b
forall (f :: * -&gt; *) a b.
Functor f =&gt;
a -&gt; BinaryJoin f b -&gt; BinaryJoin f a
forall (f :: * -&gt; *) a b.
Functor f =&gt;
(a -&gt; b) -&gt; BinaryJoin f a -&gt; BinaryJoin f b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall (f :: * -&gt; *) a b.
Functor f =&gt;
(a -&gt; b) -&gt; BinaryJoin f a -&gt; BinaryJoin f b
fmap :: forall a b. (a -&gt; b) -&gt; BinaryJoin f a -&gt; BinaryJoin f b
$c&lt;$ :: forall (f :: * -&gt; *) a b.
Functor f =&gt;
a -&gt; BinaryJoin f b -&gt; BinaryJoin f a
&lt;$ :: forall a b. a -&gt; BinaryJoin f b -&gt; BinaryJoin f a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679206857"><span id="local-6989586621679206863"><span id="local-6989586621679206871"><span id="local-6989586621679206876"><span id="local-6989586621679206880"><span id="local-6989586621679206883"><span id="local-6989586621679206886"><span id="local-6989586621679206889"><span id="local-6989586621679206892"><span id="local-6989586621679206895"><span id="local-6989586621679206898"><span id="local-6989586621679206902"><span id="local-6989586621679206905"><span id="local-6989586621679206910"><span id="local-6989586621679206915"><span id="local-6989586621679206920"><span id="local-6989586621679206925"><span class="annot"><span class="annottext">(forall m. Monoid m =&gt; BinaryJoin f m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; BinaryJoin f a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; BinaryJoin f a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; BinaryJoin f a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; BinaryJoin f a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; BinaryJoin f a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; BinaryJoin f a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; BinaryJoin f a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; BinaryJoin f a -&gt; a)
-&gt; (forall a. BinaryJoin f a -&gt; [a])
-&gt; (forall a. BinaryJoin f a -&gt; Bool)
-&gt; (forall a. BinaryJoin f a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; BinaryJoin f a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; BinaryJoin f a -&gt; a)
-&gt; (forall a. Ord a =&gt; BinaryJoin f a -&gt; a)
-&gt; (forall a. Num a =&gt; BinaryJoin f a -&gt; a)
-&gt; (forall a. Num a =&gt; BinaryJoin f a -&gt; a)
-&gt; Foldable (BinaryJoin f)
forall a. Eq a =&gt; a -&gt; BinaryJoin f a -&gt; Bool
forall a. Num a =&gt; BinaryJoin f a -&gt; a
forall a. Ord a =&gt; BinaryJoin f a -&gt; a
forall m. Monoid m =&gt; BinaryJoin f m -&gt; m
forall a. BinaryJoin f a -&gt; Bool
forall a. BinaryJoin f a -&gt; Int
forall a. BinaryJoin f a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; BinaryJoin f a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; BinaryJoin f a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; BinaryJoin f a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; BinaryJoin f a -&gt; b
forall (f :: * -&gt; *) a.
(Foldable f, Eq a) =&gt;
a -&gt; BinaryJoin f a -&gt; Bool
forall (f :: * -&gt; *) a. (Foldable f, Num a) =&gt; BinaryJoin f a -&gt; a
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; BinaryJoin f a -&gt; a
forall (f :: * -&gt; *) m.
(Foldable f, Monoid m) =&gt;
BinaryJoin f m -&gt; m
forall (f :: * -&gt; *) a. Foldable f =&gt; BinaryJoin f a -&gt; Bool
forall (f :: * -&gt; *) a. Foldable f =&gt; BinaryJoin f a -&gt; Int
forall (f :: * -&gt; *) a. Foldable f =&gt; BinaryJoin f a -&gt; [a]
forall (f :: * -&gt; *) a.
Foldable f =&gt;
(a -&gt; a -&gt; a) -&gt; BinaryJoin f a -&gt; a
forall (f :: * -&gt; *) m a.
(Foldable f, Monoid m) =&gt;
(a -&gt; m) -&gt; BinaryJoin f a -&gt; m
forall (f :: * -&gt; *) b a.
Foldable f =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; BinaryJoin f a -&gt; b
forall (f :: * -&gt; *) a b.
Foldable f =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; BinaryJoin f a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
$cfold :: forall (f :: * -&gt; *) m.
(Foldable f, Monoid m) =&gt;
BinaryJoin f m -&gt; m
fold :: forall m. Monoid m =&gt; BinaryJoin f m -&gt; m
$cfoldMap :: forall (f :: * -&gt; *) m a.
(Foldable f, Monoid m) =&gt;
(a -&gt; m) -&gt; BinaryJoin f a -&gt; m
foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; BinaryJoin f a -&gt; m
$cfoldMap' :: forall (f :: * -&gt; *) m a.
(Foldable f, Monoid m) =&gt;
(a -&gt; m) -&gt; BinaryJoin f a -&gt; m
foldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; BinaryJoin f a -&gt; m
$cfoldr :: forall (f :: * -&gt; *) a b.
Foldable f =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; BinaryJoin f a -&gt; b
foldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; BinaryJoin f a -&gt; b
$cfoldr' :: forall (f :: * -&gt; *) a b.
Foldable f =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; BinaryJoin f a -&gt; b
foldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; BinaryJoin f a -&gt; b
$cfoldl :: forall (f :: * -&gt; *) b a.
Foldable f =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; BinaryJoin f a -&gt; b
foldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; BinaryJoin f a -&gt; b
$cfoldl' :: forall (f :: * -&gt; *) b a.
Foldable f =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; BinaryJoin f a -&gt; b
foldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; BinaryJoin f a -&gt; b
$cfoldr1 :: forall (f :: * -&gt; *) a.
Foldable f =&gt;
(a -&gt; a -&gt; a) -&gt; BinaryJoin f a -&gt; a
foldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; BinaryJoin f a -&gt; a
$cfoldl1 :: forall (f :: * -&gt; *) a.
Foldable f =&gt;
(a -&gt; a -&gt; a) -&gt; BinaryJoin f a -&gt; a
foldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; BinaryJoin f a -&gt; a
$ctoList :: forall (f :: * -&gt; *) a. Foldable f =&gt; BinaryJoin f a -&gt; [a]
toList :: forall a. BinaryJoin f a -&gt; [a]
$cnull :: forall (f :: * -&gt; *) a. Foldable f =&gt; BinaryJoin f a -&gt; Bool
null :: forall a. BinaryJoin f a -&gt; Bool
$clength :: forall (f :: * -&gt; *) a. Foldable f =&gt; BinaryJoin f a -&gt; Int
length :: forall a. BinaryJoin f a -&gt; Int
$celem :: forall (f :: * -&gt; *) a.
(Foldable f, Eq a) =&gt;
a -&gt; BinaryJoin f a -&gt; Bool
elem :: forall a. Eq a =&gt; a -&gt; BinaryJoin f a -&gt; Bool
$cmaximum :: forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; BinaryJoin f a -&gt; a
maximum :: forall a. Ord a =&gt; BinaryJoin f a -&gt; a
$cminimum :: forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; BinaryJoin f a -&gt; a
minimum :: forall a. Ord a =&gt; BinaryJoin f a -&gt; a
$csum :: forall (f :: * -&gt; *) a. (Foldable f, Num a) =&gt; BinaryJoin f a -&gt; a
sum :: forall a. Num a =&gt; BinaryJoin f a -&gt; a
$cproduct :: forall (f :: * -&gt; *) a. (Foldable f, Num a) =&gt; BinaryJoin f a -&gt; a
product :: forall a. Num a =&gt; BinaryJoin f a -&gt; a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679206937"><span id="local-6989586621679206945"><span id="local-6989586621679206951"><span id="local-6989586621679206956"><span class="annot"><span class="annottext">Functor (BinaryJoin f)
Foldable (BinaryJoin f)
(Functor (BinaryJoin f), Foldable (BinaryJoin f)) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; BinaryJoin f a -&gt; f (BinaryJoin f b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    BinaryJoin f (f a) -&gt; f (BinaryJoin f a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; BinaryJoin f a -&gt; m (BinaryJoin f b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    BinaryJoin f (m a) -&gt; m (BinaryJoin f a))
-&gt; Traversable (BinaryJoin f)
forall (t :: * -&gt; *).
(Functor t, Foldable t) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (f :: * -&gt; *). Traversable f =&gt; Functor (BinaryJoin f)
forall (f :: * -&gt; *). Traversable f =&gt; Foldable (BinaryJoin f)
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable f, Monad m) =&gt;
BinaryJoin f (m a) -&gt; m (BinaryJoin f a)
forall (f :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable f, Applicative f) =&gt;
BinaryJoin f (f a) -&gt; f (BinaryJoin f a)
forall (f :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable f, Monad m) =&gt;
(a -&gt; m b) -&gt; BinaryJoin f a -&gt; m (BinaryJoin f b)
forall (f :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable f, Applicative f) =&gt;
(a -&gt; f b) -&gt; BinaryJoin f a -&gt; f (BinaryJoin f b)
forall (m :: * -&gt; *) a.
Monad m =&gt;
BinaryJoin f (m a) -&gt; m (BinaryJoin f a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
BinaryJoin f (f a) -&gt; f (BinaryJoin f a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; BinaryJoin f a -&gt; m (BinaryJoin f b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; BinaryJoin f a -&gt; f (BinaryJoin f b)
$ctraverse :: forall (f :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable f, Applicative f) =&gt;
(a -&gt; f b) -&gt; BinaryJoin f a -&gt; f (BinaryJoin f b)
traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; BinaryJoin f a -&gt; f (BinaryJoin f b)
$csequenceA :: forall (f :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable f, Applicative f) =&gt;
BinaryJoin f (f a) -&gt; f (BinaryJoin f a)
sequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
BinaryJoin f (f a) -&gt; f (BinaryJoin f a)
$cmapM :: forall (f :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable f, Monad m) =&gt;
(a -&gt; m b) -&gt; BinaryJoin f a -&gt; m (BinaryJoin f b)
mapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; BinaryJoin f a -&gt; m (BinaryJoin f b)
$csequence :: forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable f, Monad m) =&gt;
BinaryJoin f (m a) -&gt; m (BinaryJoin f a)
sequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
BinaryJoin f (m a) -&gt; m (BinaryJoin f a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span id="local-6989586621679206242"><span id="local-6989586621679206243"><span id="local-6989586621679206963"><span id="local-6989586621679206969"><span id="local-6989586621679206973"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206242"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206242"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206243"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#BinaryJoin"><span class="hs-identifier hs-type">BinaryJoin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206242"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206243"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-131"></span><span id="local-6989586621679206246"><span id="local-6989586621679206247"><span id="local-6989586621679206978"><span id="local-6989586621679206983"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206246"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206246"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206247"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#BinaryJoin"><span class="hs-identifier hs-type">BinaryJoin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206246"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206247"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-132"></span><span id="local-6989586621679206250"><span id="local-6989586621679206251"><span id="local-6989586621679206993"><span id="local-6989586621679206998"><span id="local-6989586621679207003"><span id="local-6989586621679207007"><span id="local-6989586621679207010"><span id="local-6989586621679207013"><span id="local-6989586621679207016"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206250"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206250"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206251"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#BinaryJoin"><span class="hs-identifier hs-type">BinaryJoin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206250"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206251"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="annot"><a href="MonadGen.BinaryJoin.html#b2i"><span class="hs-identifier hs-type">b2i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-135"></span><span id="b2i"><span class="annot"><span class="annottext">b2i :: Bool -&gt; Int
</span><a href="MonadGen.BinaryJoin.html#b2i"><span class="hs-identifier hs-var hs-var">b2i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool -&gt; Int
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="annot"><a href="MonadGen.BinaryJoin.html#i2b"><span class="hs-identifier hs-type">i2b</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-138"></span><span id="i2b"><span class="annot"><span class="annottext">i2b :: Int -&gt; Bool
</span><a href="MonadGen.BinaryJoin.html#i2b"><span class="hs-identifier hs-var hs-var">i2b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span id="local-6989586621679206253"><span class="annot"><a href="MonadGen.BinaryJoin.html#fromJ"><span class="hs-identifier hs-type">fromJ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679206253"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206253"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonadGen.BinaryJoin.html#BinaryJoin"><span class="hs-identifier hs-type">BinaryJoin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206253"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-141"></span><span id="fromJ"><span class="annot"><span class="annottext">fromJ :: forall (f :: * -&gt; *). Functor f =&gt; J (f Bool) -&gt; BinaryJoin f Int
</span><a href="MonadGen.BinaryJoin.html#fromJ"><span class="hs-identifier hs-var hs-var">fromJ</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span id="local-6989586621679207024"><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679207024"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679207025"><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679207025"><span class="hs-identifier hs-var">y0</span></a></span></span><span> </span><span id="local-6989586621679207026"><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679207026"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int
</span><a href="MonadGen.BinaryJoin.html#b2i"><span class="hs-identifier hs-var">b2i</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Int) -&gt; BinaryJoin f Bool -&gt; BinaryJoin f Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f Bool -&gt; f Bool -&gt; f Bool -&gt; BinaryJoin f Bool
forall (f :: * -&gt; *) a. f Bool -&gt; f a -&gt; f a -&gt; BinaryJoin f a
</span><a href="MonadGen.BinaryJoin.html#BJ"><span class="hs-identifier hs-var">BJ</span></a></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679207024"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679207025"><span class="hs-identifier hs-var">y0</span></a></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679207026"><span class="hs-identifier hs-var">y1</span></a></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="annot"><span class="hs-comment">-- * Model for BinaryJoin</span></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-keyword">newtype</span><span> </span><span id="BinaryJoinModel"><span class="annot"><a href="MonadGen.BinaryJoin.html#BinaryJoinModel"><span class="hs-identifier hs-var">BinaryJoinModel</span></a></span></span><span> </span><span id="local-6989586621679206257"><span class="annot"><a href="#local-6989586621679206257"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BinaryJoinModel"><span class="annot"><a href="MonadGen.BinaryJoin.html#BinaryJoinModel"><span class="hs-identifier hs-var">BinaryJoinModel</span></a></span></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-special">{</span><span>
</span><span id="line-147"></span><span>    </span><span id="joinPreNatMapModel"><span class="annot"><span class="annottext">forall (f :: * -&gt; *).
BinaryJoinModel f -&gt; PreNatMapModel (BinaryJoin f) f
</span><a href="MonadGen.BinaryJoin.html#joinPreNatMapModel"><span class="hs-identifier hs-var hs-var">joinPreNatMapModel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ModelFinder.Model.PreNatMapModel.html#PreNatMapModel"><span class="hs-identifier hs-type">PreNatMapModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#BinaryJoin"><span class="hs-identifier hs-type">BinaryJoin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206257"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679206257"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span id="local-6989586621679206266"><span id="local-6989586621679207032"><span id="local-6989586621679207042"><span id="local-6989586621679207047"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679206262"><span class="annot"><a href="#local-6989586621679206262"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679206262"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206266"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206262"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679206266"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#BinaryJoinModel"><span class="hs-identifier hs-type">BinaryJoinModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206266"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679206273"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679206273"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679206272"><span class="annot"><a href="#local-6989586621679206272"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679206272"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206273"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206272"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Model</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206273"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206273"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#BinaryJoinModel"><span class="hs-identifier hs-type">BinaryJoinModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206273"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>  </span><span id="local-6989586621679207075"><span class="annot"><span class="annottext">guess :: J (f Bool) -&gt; BinaryJoinModel f -&gt; [f Bool]
</span><a href="#local-6989586621679207075"><span class="hs-identifier hs-var hs-var hs-var">guess</span></a></span></span><span> </span><span id="local-6989586621679207077"><span class="annot"><span class="annottext">J (f Bool)
</span><a href="#local-6989586621679207077"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#BinaryJoinModel"><span class="hs-identifier hs-type">BinaryJoinModel</span></a></span><span> </span><span id="local-6989586621679207078"><span class="annot"><span class="annottext">PreNatMapModel (BinaryJoin f) f
</span><a href="#local-6989586621679207078"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; f Int -&gt; f Bool
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="MonadGen.BinaryJoin.html#i2b"><span class="hs-identifier hs-var">i2b</span></a></span><span> </span><span class="annot"><span class="annottext">(f Int -&gt; f Bool) -&gt; [f Int] -&gt; [f Bool]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">BinaryJoin f Int -&gt; PreNatMapModel (BinaryJoin f) f -&gt; [f Int]
forall k a model. Model k a model =&gt; k -&gt; model -&gt; [a]
</span><span class="hs-identifier hs-var">guess</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">J (f Bool) -&gt; BinaryJoin f Int
forall (f :: * -&gt; *). Functor f =&gt; J (f Bool) -&gt; BinaryJoin f Int
</span><a href="MonadGen.BinaryJoin.html#fromJ"><span class="hs-identifier hs-var">fromJ</span></a></span><span> </span><span class="annot"><span class="annottext">J (f Bool)
</span><a href="#local-6989586621679207077"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PreNatMapModel (BinaryJoin f) f
</span><a href="#local-6989586621679207078"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>  </span><span id="local-6989586621679207085"><span class="annot"><span class="annottext">enterDef :: [J (f Bool)]
-&gt; f Bool
-&gt; BinaryJoinModel f
-&gt; Maybe (BinaryJoinModel f, [(J (f Bool), f Bool)])
</span><a href="#local-6989586621679207085"><span class="hs-identifier hs-var hs-var hs-var">enterDef</span></a></span></span><span> </span><span id="local-6989586621679207087"><span class="annot"><span class="annottext">[J (f Bool)]
</span><a href="#local-6989586621679207087"><span class="hs-identifier hs-var">js</span></a></span></span><span> </span><span id="local-6989586621679207088"><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679207088"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#BinaryJoinModel"><span class="hs-identifier hs-type">BinaryJoinModel</span></a></span><span> </span><span id="local-6989586621679207089"><span class="annot"><span class="annottext">PreNatMapModel (BinaryJoin f) f
</span><a href="#local-6989586621679207089"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PreNatMapModel (BinaryJoin f) f, [(BinaryJoin f Int, f Int)])
-&gt; (BinaryJoinModel f, [(J (f Bool), f Bool)])
forall {f :: * -&gt; *} {any}.
(PreNatMapModel (BinaryJoin f) f, [(BinaryJoin f any, f Int)])
-&gt; (BinaryJoinModel f, [(J (f Bool), f Bool)])
</span><a href="#local-6989586621679207090"><span class="hs-identifier hs-var">postproc</span></a></span><span> </span><span class="annot"><span class="annottext">((PreNatMapModel (BinaryJoin f) f, [(BinaryJoin f Int, f Int)])
 -&gt; (BinaryJoinModel f, [(J (f Bool), f Bool)]))
-&gt; Maybe
     (PreNatMapModel (BinaryJoin f) f, [(BinaryJoin f Int, f Int)])
-&gt; Maybe (BinaryJoinModel f, [(J (f Bool), f Bool)])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[BinaryJoin f Int]
-&gt; f Int
-&gt; PreNatMapModel (BinaryJoin f) f
-&gt; Maybe
     (PreNatMapModel (BinaryJoin f) f, [(BinaryJoin f Int, f Int)])
forall k a model.
Model k a model =&gt;
[k] -&gt; a -&gt; model -&gt; Maybe (model, [(k, a)])
</span><span class="hs-identifier hs-var">enterDef</span></span><span> </span><span class="annot"><span class="annottext">[BinaryJoin f Int]
</span><a href="#local-6989586621679207091"><span class="hs-identifier hs-var">js'</span></a></span><span> </span><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679207092"><span class="hs-identifier hs-var">rhs'</span></a></span><span> </span><span class="annot"><span class="annottext">PreNatMapModel (BinaryJoin f) f
</span><a href="#local-6989586621679207089"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-157"></span><span>      </span><span id="local-6989586621679207091"><span class="annot"><span class="annottext">js' :: [BinaryJoin f Int]
</span><a href="#local-6989586621679207091"><span class="hs-identifier hs-var hs-var">js'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">J (f Bool) -&gt; BinaryJoin f Int
forall (f :: * -&gt; *). Functor f =&gt; J (f Bool) -&gt; BinaryJoin f Int
</span><a href="MonadGen.BinaryJoin.html#fromJ"><span class="hs-identifier hs-var">fromJ</span></a></span><span> </span><span class="annot"><span class="annottext">(J (f Bool) -&gt; BinaryJoin f Int)
-&gt; [J (f Bool)] -&gt; [BinaryJoin f Int]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[J (f Bool)]
</span><a href="#local-6989586621679207087"><span class="hs-identifier hs-var">js</span></a></span><span>
</span><span id="line-158"></span><span>      </span><span id="local-6989586621679207092"><span class="annot"><span class="annottext">rhs' :: f Int
</span><a href="#local-6989586621679207092"><span class="hs-identifier hs-var hs-var">rhs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int
</span><a href="MonadGen.BinaryJoin.html#b2i"><span class="hs-identifier hs-var">b2i</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Int) -&gt; f Bool -&gt; f Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679207088"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-159"></span><span>      </span><span id="local-6989586621679207090"><span class="annot"><span class="annottext">postproc :: (PreNatMapModel (BinaryJoin f) f, [(BinaryJoin f any, f Int)])
-&gt; (BinaryJoinModel f, [(J (f Bool), f Bool)])
</span><a href="#local-6989586621679207090"><span class="hs-identifier hs-var hs-var">postproc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PreNatMapModel (BinaryJoin f) f -&gt; BinaryJoinModel f)
-&gt; ([(BinaryJoin f any, f Int)] -&gt; [(J (f Bool), f Bool)])
-&gt; (PreNatMapModel (BinaryJoin f) f, [(BinaryJoin f any, f Int)])
-&gt; (BinaryJoinModel f, [(J (f Bool), f Bool)])
forall a b c d. (a -&gt; b) -&gt; (c -&gt; d) -&gt; (a, c) -&gt; (b, d)
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">PreNatMapModel (BinaryJoin f) f -&gt; BinaryJoinModel f
forall (f :: * -&gt; *).
PreNatMapModel (BinaryJoin f) f -&gt; BinaryJoinModel f
</span><a href="MonadGen.BinaryJoin.html#BinaryJoinModel"><span class="hs-identifier hs-var">BinaryJoinModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(BinaryJoin f any, f Int)]
-&gt; ((BinaryJoin f any, f Int) -&gt; [(J (f Bool), f Bool)])
-&gt; [(J (f Bool), f Bool)]
forall a b. [a] -&gt; (a -&gt; [b]) -&gt; [b]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(BinaryJoin f any, f Int) -&gt; [(J (f Bool), f Bool)]
forall (f :: * -&gt; *) any.
Traversable f =&gt;
(BinaryJoin f any, f Int) -&gt; [(J (f Bool), f Bool)]
</span><a href="MonadGen.BinaryJoin.html#makeBinaryJoinDefs"><span class="hs-identifier hs-var">makeBinaryJoinDefs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span>  </span><span id="local-6989586621679207110"><span class="annot"><span class="annottext">enterEqs :: [J (f Bool)]
-&gt; BinaryJoinModel f
-&gt; Maybe (BinaryJoinModel f, [(J (f Bool), f Bool)])
</span><a href="#local-6989586621679207110"><span class="hs-identifier hs-var hs-var hs-var">enterEqs</span></a></span></span><span> </span><span id="local-6989586621679207112"><span class="annot"><span class="annottext">[J (f Bool)]
</span><a href="#local-6989586621679207112"><span class="hs-identifier hs-var">js</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#BinaryJoinModel"><span class="hs-identifier hs-type">BinaryJoinModel</span></a></span><span> </span><span id="local-6989586621679207113"><span class="annot"><span class="annottext">PreNatMapModel (BinaryJoin f) f
</span><a href="#local-6989586621679207113"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PreNatMapModel (BinaryJoin f) f, [(BinaryJoin f Int, f Int)])
-&gt; (BinaryJoinModel f, [(J (f Bool), f Bool)])
forall {f :: * -&gt; *} {any}.
(PreNatMapModel (BinaryJoin f) f, [(BinaryJoin f any, f Int)])
-&gt; (BinaryJoinModel f, [(J (f Bool), f Bool)])
</span><a href="#local-6989586621679207114"><span class="hs-identifier hs-var">postproc</span></a></span><span> </span><span class="annot"><span class="annottext">((PreNatMapModel (BinaryJoin f) f, [(BinaryJoin f Int, f Int)])
 -&gt; (BinaryJoinModel f, [(J (f Bool), f Bool)]))
-&gt; Maybe
     (PreNatMapModel (BinaryJoin f) f, [(BinaryJoin f Int, f Int)])
-&gt; Maybe (BinaryJoinModel f, [(J (f Bool), f Bool)])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[BinaryJoin f Int]
-&gt; PreNatMapModel (BinaryJoin f) f
-&gt; Maybe
     (PreNatMapModel (BinaryJoin f) f, [(BinaryJoin f Int, f Int)])
forall k a model.
Model k a model =&gt;
[k] -&gt; model -&gt; Maybe (model, [(k, a)])
</span><span class="hs-identifier hs-var">enterEqs</span></span><span> </span><span class="annot"><span class="annottext">[BinaryJoin f Int]
</span><a href="#local-6989586621679207115"><span class="hs-identifier hs-var">js'</span></a></span><span> </span><span class="annot"><span class="annottext">PreNatMapModel (BinaryJoin f) f
</span><a href="#local-6989586621679207113"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-163"></span><span>      </span><span id="local-6989586621679207115"><span class="annot"><span class="annottext">js' :: [BinaryJoin f Int]
</span><a href="#local-6989586621679207115"><span class="hs-identifier hs-var hs-var">js'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">J (f Bool) -&gt; BinaryJoin f Int
forall (f :: * -&gt; *). Functor f =&gt; J (f Bool) -&gt; BinaryJoin f Int
</span><a href="MonadGen.BinaryJoin.html#fromJ"><span class="hs-identifier hs-var">fromJ</span></a></span><span> </span><span class="annot"><span class="annottext">(J (f Bool) -&gt; BinaryJoin f Int)
-&gt; [J (f Bool)] -&gt; [BinaryJoin f Int]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[J (f Bool)]
</span><a href="#local-6989586621679207112"><span class="hs-identifier hs-var">js</span></a></span><span>
</span><span id="line-164"></span><span>      </span><span id="local-6989586621679207114"><span class="annot"><span class="annottext">postproc :: (PreNatMapModel (BinaryJoin f) f, [(BinaryJoin f any, f Int)])
-&gt; (BinaryJoinModel f, [(J (f Bool), f Bool)])
</span><a href="#local-6989586621679207114"><span class="hs-identifier hs-var hs-var">postproc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PreNatMapModel (BinaryJoin f) f -&gt; BinaryJoinModel f)
-&gt; ([(BinaryJoin f any, f Int)] -&gt; [(J (f Bool), f Bool)])
-&gt; (PreNatMapModel (BinaryJoin f) f, [(BinaryJoin f any, f Int)])
-&gt; (BinaryJoinModel f, [(J (f Bool), f Bool)])
forall a b c d. (a -&gt; b) -&gt; (c -&gt; d) -&gt; (a, c) -&gt; (b, d)
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">PreNatMapModel (BinaryJoin f) f -&gt; BinaryJoinModel f
forall (f :: * -&gt; *).
PreNatMapModel (BinaryJoin f) f -&gt; BinaryJoinModel f
</span><a href="MonadGen.BinaryJoin.html#BinaryJoinModel"><span class="hs-identifier hs-var">BinaryJoinModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(BinaryJoin f any, f Int)]
-&gt; ((BinaryJoin f any, f Int) -&gt; [(J (f Bool), f Bool)])
-&gt; [(J (f Bool), f Bool)]
forall a b. [a] -&gt; (a -&gt; [b]) -&gt; [b]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(BinaryJoin f any, f Int) -&gt; [(J (f Bool), f Bool)]
forall (f :: * -&gt; *) any.
Traversable f =&gt;
(BinaryJoin f any, f Int) -&gt; [(J (f Bool), f Bool)]
</span><a href="MonadGen.BinaryJoin.html#makeBinaryJoinDefs"><span class="hs-identifier hs-var">makeBinaryJoinDefs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span id="local-6989586621679206290"><span id="local-6989586621679206291"><span class="annot"><a href="MonadGen.BinaryJoin.html#makeBinaryJoinDefs"><span class="hs-identifier hs-type">makeBinaryJoinDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679206290"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#BinaryJoin"><span class="hs-identifier hs-type">BinaryJoin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206290"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206291"><span class="hs-identifier hs-type">any</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679206290"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206290"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679206290"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-167"></span><span id="makeBinaryJoinDefs"><span class="annot"><span class="annottext">makeBinaryJoinDefs :: forall (f :: * -&gt; *) any.
Traversable f =&gt;
(BinaryJoin f any, f Int) -&gt; [(J (f Bool), f Bool)]
</span><a href="MonadGen.BinaryJoin.html#makeBinaryJoinDefs"><span class="hs-identifier hs-var hs-var">makeBinaryJoinDefs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679207129"><span class="annot"><span class="annottext">BinaryJoin f any
</span><a href="#local-6989586621679207129"><span class="hs-identifier hs-var">bj</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679207130"><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679207130"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679207131"><span class="annot"><a href="#local-6989586621679207131"><span class="hs-identifier hs-var">bitmap</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonadGen.BinaryJoin.html#BJ"><span class="hs-identifier hs-type">BJ</span></a></span><span> </span><span id="local-6989586621679207132"><span class="annot"><a href="#local-6989586621679207132"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679207133"><span class="annot"><a href="#local-6989586621679207133"><span class="hs-identifier hs-var">y0</span></a></span></span><span> </span><span id="local-6989586621679207134"><span class="annot"><a href="#local-6989586621679207134"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BinaryJoin f any -&gt; [(Bitmap, BinaryJoin f Bool)]
forall (f :: * -&gt; *) any.
Traversable f =&gt;
f any -&gt; [(Bitmap, f Bool)]
</span><a href="MonadGen.BinaryJoin.html#boolTable"><span class="hs-identifier hs-var">boolTable</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryJoin f any
</span><a href="#local-6989586621679207129"><span class="hs-identifier hs-var">bj</span></a></span><span>
</span><span id="line-169"></span><span>     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679207137"><span class="annot"><a href="#local-6989586621679207137"><span class="hs-identifier hs-var hs-var">rhsBool</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bitmap -&gt; Int -&gt; Bool
forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><span class="hs-identifier hs-var">testBit</span></span><span> </span><span class="annot"><span class="annottext">Bitmap
</span><a href="#local-6989586621679207131"><span class="hs-identifier hs-var">bitmap</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; f Int -&gt; f Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679207130"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-170"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679207132"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679207133"><span class="hs-identifier hs-type">y0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679207134"><span class="hs-identifier hs-type">y1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679207137"><span class="hs-identifier hs-type">rhsBool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="annot"><span class="hs-comment">-- * Generation logic</span></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- &gt;&gt;&gt; genFromPure (Shape (Just ()))</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- [make [PreEntry (BJ Nothing Nothing Nothing) Nothing,PreEntry (BJ Nothing Nothing (Just 0)) Nothing,PreEntry (BJ Nothing (Just 0) Nothing) Nothing,PreEntry (BJ Nothing (Just 0) (Just 1)) Nothing,PreEntry (BJ (Just False) Nothing Nothing) Nothing,PreEntry (BJ (Just False) Nothing (Just 0)) Nothing,PreEntry (BJ (Just False) (Just 0) Nothing) (Just 0),PreEntry (BJ (Just False) (Just 0) (Just 1)) (Just 0),PreEntry (BJ (Just True) Nothing Nothing) Nothing,PreEntry (BJ (Just True) Nothing (Just 0)) (Just 0),PreEntry (BJ (Just True) (Just 0) Nothing) Nothing,PreEntry (BJ (Just True) (Just 0) (Just 1)) (Just 1)]]</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="annot"><a href="MonadGen.BinaryJoin.html#genFromPure"><span class="hs-identifier hs-type">genFromPure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679206297"><span class="annot"><a href="#local-6989586621679206297"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679206297"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Shape</span></span><span> </span><span class="annot"><a href="#local-6989586621679206297"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">PreNatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#BinaryJoin"><span class="hs-identifier hs-type">BinaryJoin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206297"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679206297"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-178"></span><span id="genFromPure"><span class="annot"><span class="annottext">genFromPure :: forall (f :: * -&gt; *).
PTraversable f =&gt;
Shape f -&gt; [PreNatMap (BinaryJoin f) f]
</span><a href="MonadGen.BinaryJoin.html#genFromPure"><span class="hs-identifier hs-var hs-var">genFromPure</span></a></span></span><span> </span><span id="local-6989586621679207156"><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679207156"><span class="hs-identifier hs-var">pureShape</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PreNatMapModel (BinaryJoin f) f -&gt; PreNatMap (BinaryJoin f) f
forall (f :: * -&gt; *) (g :: * -&gt; *).
PreNatMapModel f g -&gt; PreNatMap f g
</span><a href="ModelFinder.Model.PreNatMapModel.html#pnmGuesses"><span class="hs-identifier hs-var">pnmGuesses</span></a></span><span> </span><span class="annot"><span class="annottext">(PreNatMapModel (BinaryJoin f) f -&gt; PreNatMap (BinaryJoin f) f)
-&gt; (BinaryJoinModel f -&gt; PreNatMapModel (BinaryJoin f) f)
-&gt; BinaryJoinModel f
-&gt; PreNatMap (BinaryJoin f) f
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BinaryJoinModel f -&gt; PreNatMapModel (BinaryJoin f) f
forall (f :: * -&gt; *).
BinaryJoinModel f -&gt; PreNatMapModel (BinaryJoin f) f
</span><a href="MonadGen.BinaryJoin.html#joinPreNatMapModel"><span class="hs-identifier hs-var">joinPreNatMapModel</span></a></span><span> </span><span class="annot"><span class="annottext">(BinaryJoinModel f -&gt; PreNatMap (BinaryJoin f) f)
-&gt; [BinaryJoinModel f] -&gt; [PreNatMap (BinaryJoin f) f]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Term J (f Bool), Term J (f Bool))]
-&gt; Map (J (f Bool)) (f Bool)
-&gt; BinaryJoinModel f
-&gt; [BinaryJoinModel f]
forall a (f :: * -&gt; *) model.
(Ord a, Language f, Model (f a) a model) =&gt;
[(Term f a, Term f a)] -&gt; Map (f a) a -&gt; model -&gt; [model]
</span><span class="hs-identifier hs-var">solveEqs</span></span><span> </span><span class="annot"><span class="annottext">[(Term J (f Bool), Term J (f Bool))]
</span><a href="#local-6989586621679207159"><span class="hs-identifier hs-var">allEqs</span></a></span><span> </span><span class="annot"><span class="annottext">Map (J (f Bool)) (f Bool)
</span><a href="#local-6989586621679207160"><span class="hs-identifier hs-var">allDefs</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryJoinModel f
</span><a href="#local-6989586621679207161"><span class="hs-identifier hs-var">model0</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>    </span><span id="local-6989586621679207171"><span class="annot"><span class="annottext">fShapes :: [Shape f]
</span><a href="#local-6989586621679207171"><span class="hs-identifier hs-var hs-var">fShapes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f () -&gt; Shape f
forall (f :: * -&gt; *) a. f a -&gt; Shape f
</span><span class="hs-identifier hs-var">Shape</span></span><span> </span><span class="annot"><span class="annottext">(f () -&gt; Shape f) -&gt; [f ()] -&gt; [Shape f]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[f ()]
forall (f :: * -&gt; *). PTraversable f =&gt; [f ()]
</span><a href="Data.PTraversable.Extra.html#shapes"><span class="hs-identifier hs-var">shapes</span></a></span><span>
</span><span id="line-181"></span><span>    </span><span id="local-6989586621679207161"><span class="annot"><span class="annottext">model0 :: BinaryJoinModel f
</span><a href="#local-6989586621679207161"><span class="hs-identifier hs-var hs-var">model0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PreNatMapModel (BinaryJoin f) f -&gt; BinaryJoinModel f
forall (f :: * -&gt; *).
PreNatMapModel (BinaryJoin f) f -&gt; BinaryJoinModel f
</span><a href="MonadGen.BinaryJoin.html#BinaryJoinModel"><span class="hs-identifier hs-var">BinaryJoinModel</span></a></span><span> </span><span class="annot"><span class="annottext">(PreNatMapModel (BinaryJoin f) f -&gt; BinaryJoinModel f)
-&gt; PreNatMapModel (BinaryJoin f) f -&gt; BinaryJoinModel f
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><a href="ModelFinder.Model.PreNatMapModel.html#PreNatMapModel"><span class="hs-identifier hs-type">PreNatMapModel</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">allShapes :: Set (Shape f)
</span><a href="ModelFinder.Model.PreNatMapModel.html#allShapes"><span class="hs-identifier hs-var">allShapes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Shape f] -&gt; Set (Shape f)
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">[Shape f]
</span><a href="#local-6989586621679207171"><span class="hs-identifier hs-var">fShapes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pnmGuesses :: PreNatMap (BinaryJoin f) f
</span><a href="ModelFinder.Model.PreNatMapModel.html#pnmGuesses"><span class="hs-identifier hs-var">pnmGuesses</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PreNatMap (BinaryJoin f) f
forall (f :: * -&gt; *) (g :: * -&gt; *). PreNatMap f g
</span><span class="hs-identifier hs-var">PNM.empty</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621679207159"><span class="annot"><span class="annottext">allEqs :: [(Term J (f Bool), Term J (f Bool))]
</span><a href="#local-6989586621679207159"><span class="hs-identifier hs-var hs-var">allEqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Term J (f Bool), Term J (f Bool))]
forall (f :: * -&gt; *).
PTraversable f =&gt;
[(Term J (f Bool), Term J (f Bool))]
</span><a href="MonadGen.BinaryJoin.html#constEqs"><span class="hs-identifier hs-var">constEqs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Term J (f Bool), Term J (f Bool))]
-&gt; [(Term J (f Bool), Term J (f Bool))]
-&gt; [(Term J (f Bool), Term J (f Bool))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(Term J (f Bool), Term J (f Bool))]
forall (f :: * -&gt; *).
PTraversable f =&gt;
[(Term J (f Bool), Term J (f Bool))]
</span><a href="MonadGen.BinaryJoin.html#notEqs"><span class="hs-identifier hs-var">notEqs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Term J (f Bool), Term J (f Bool))]
-&gt; [(Term J (f Bool), Term J (f Bool))]
-&gt; [(Term J (f Bool), Term J (f Bool))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(Term J (f Bool), Term J (f Bool))]
forall (f :: * -&gt; *).
PTraversable f =&gt;
[(Term J (f Bool), Term J (f Bool))]
</span><a href="MonadGen.BinaryJoin.html#assocEqs"><span class="hs-identifier hs-var">assocEqs</span></a></span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621679207160"><span class="annot"><span class="annottext">allDefs :: Map (J (f Bool)) (f Bool)
</span><a href="#local-6989586621679207160"><span class="hs-identifier hs-var hs-var">allDefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Map (J (f Bool)) (f Bool)] -&gt; Map (J (f Bool)) (f Bool)
forall (f :: * -&gt; *) k a.
(Foldable f, Ord k) =&gt;
f (Map k a) -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.unions</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Shape f -&gt; Map (J (f Bool)) (f Bool)
forall (f :: * -&gt; *).
PTraversable f =&gt;
Shape f -&gt; Map (J (f Bool)) (f Bool)
</span><a href="MonadGen.BinaryJoin.html#unitLeftDefs"><span class="hs-identifier hs-var">unitLeftDefs</span></a></span><span> </span><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679207156"><span class="hs-identifier hs-var">pureShape</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Shape f -&gt; Map (J (f Bool)) (f Bool)
forall (f :: * -&gt; *).
PTraversable f =&gt;
Shape f -&gt; Map (J (f Bool)) (f Bool)
</span><a href="MonadGen.BinaryJoin.html#unitRightDefs"><span class="hs-identifier hs-var">unitRightDefs</span></a></span><span> </span><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679207156"><span class="hs-identifier hs-var">pureShape</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (J (f Bool)) (f Bool)
forall (f :: * -&gt; *). PTraversable f =&gt; Map (J (f Bool)) (f Bool)
</span><a href="MonadGen.BinaryJoin.html#zeroDefs"><span class="hs-identifier hs-var">zeroDefs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="annot"><a href="MonadGen.BinaryJoin.html#gen"><span class="hs-identifier hs-type">gen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679206324"><span class="annot"><a href="#local-6989586621679206324"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679206324"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">PreNatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#BinaryJoin"><span class="hs-identifier hs-type">BinaryJoin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206324"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679206324"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-186"></span><span id="gen"><span class="annot"><span class="annottext">gen :: forall (f :: * -&gt; *).
PTraversable f =&gt;
[PreNatMap (BinaryJoin f) f]
</span><a href="MonadGen.BinaryJoin.html#gen"><span class="hs-identifier hs-var hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[f ()]
forall (f :: * -&gt; *). PTraversable f =&gt; [f ()]
</span><a href="Data.PTraversable.Extra.html#shapes"><span class="hs-identifier hs-var">shapes</span></a></span><span> </span><span class="annot"><span class="annottext">[f ()]
-&gt; (f () -&gt; [PreNatMap (BinaryJoin f) f])
-&gt; [PreNatMap (BinaryJoin f) f]
forall a b. [a] -&gt; (a -&gt; [b]) -&gt; [b]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Shape f -&gt; [PreNatMap (BinaryJoin f) f]
forall (f :: * -&gt; *).
PTraversable f =&gt;
Shape f -&gt; [PreNatMap (BinaryJoin f) f]
</span><a href="MonadGen.BinaryJoin.html#genFromPure"><span class="hs-identifier hs-var">genFromPure</span></a></span><span> </span><span class="annot"><span class="annottext">(Shape f -&gt; [PreNatMap (BinaryJoin f) f])
-&gt; (f () -&gt; Shape f) -&gt; f () -&gt; [PreNatMap (BinaryJoin f) f]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">f () -&gt; Shape f
forall (f :: * -&gt; *) a. f a -&gt; Shape f
</span><span class="hs-identifier hs-var">Shape</span></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="annot"><a href="MonadGen.BinaryJoin.html#genFromApplicative"><span class="hs-identifier hs-type">genFromApplicative</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679206326"><span class="annot"><a href="#local-6989586621679206326"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679206326"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeDict"><span class="hs-identifier hs-type">ApplicativeDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206326"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">PreNatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#BinaryJoin"><span class="hs-identifier hs-type">BinaryJoin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206326"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679206326"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-189"></span><span id="genFromApplicative"><span class="annot"><span class="annottext">genFromApplicative :: forall (f :: * -&gt; *).
PTraversable f =&gt;
ApplicativeDict f -&gt; [PreNatMap (BinaryJoin f) f]
</span><a href="MonadGen.BinaryJoin.html#genFromApplicative"><span class="hs-identifier hs-var hs-var">genFromApplicative</span></a></span></span><span> </span><span id="local-6989586621679207231"><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679207231"><span class="hs-identifier hs-var">apDict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PreNatMapModel (BinaryJoin f) f -&gt; PreNatMap (BinaryJoin f) f
forall (f :: * -&gt; *) (g :: * -&gt; *).
PreNatMapModel f g -&gt; PreNatMap f g
</span><a href="ModelFinder.Model.PreNatMapModel.html#pnmGuesses"><span class="hs-identifier hs-var">pnmGuesses</span></a></span><span> </span><span class="annot"><span class="annottext">(PreNatMapModel (BinaryJoin f) f -&gt; PreNatMap (BinaryJoin f) f)
-&gt; (BinaryJoinModel f -&gt; PreNatMapModel (BinaryJoin f) f)
-&gt; BinaryJoinModel f
-&gt; PreNatMap (BinaryJoin f) f
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BinaryJoinModel f -&gt; PreNatMapModel (BinaryJoin f) f
forall (f :: * -&gt; *).
BinaryJoinModel f -&gt; PreNatMapModel (BinaryJoin f) f
</span><a href="MonadGen.BinaryJoin.html#joinPreNatMapModel"><span class="hs-identifier hs-var">joinPreNatMapModel</span></a></span><span> </span><span class="annot"><span class="annottext">(BinaryJoinModel f -&gt; PreNatMap (BinaryJoin f) f)
-&gt; [BinaryJoinModel f] -&gt; [PreNatMap (BinaryJoin f) f]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Term J (f Bool), Term J (f Bool))]
-&gt; Map (J (f Bool)) (f Bool)
-&gt; BinaryJoinModel f
-&gt; [BinaryJoinModel f]
forall a (f :: * -&gt; *) model.
(Ord a, Language f, Model (f a) a model) =&gt;
[(Term f a, Term f a)] -&gt; Map (f a) a -&gt; model -&gt; [model]
</span><span class="hs-identifier hs-var">solveEqs</span></span><span> </span><span class="annot"><span class="annottext">[(Term J (f Bool), Term J (f Bool))]
</span><a href="#local-6989586621679207232"><span class="hs-identifier hs-var">allEqs</span></a></span><span> </span><span class="annot"><span class="annottext">Map (J (f Bool)) (f Bool)
</span><a href="#local-6989586621679207233"><span class="hs-identifier hs-var">allDefs</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryJoinModel f
</span><a href="#local-6989586621679207234"><span class="hs-identifier hs-var">model0</span></a></span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621679207244"><span class="annot"><span class="annottext">fShapes :: [Shape f]
</span><a href="#local-6989586621679207244"><span class="hs-identifier hs-var hs-var">fShapes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f () -&gt; Shape f
forall (f :: * -&gt; *) a. f a -&gt; Shape f
</span><span class="hs-identifier hs-var">Shape</span></span><span> </span><span class="annot"><span class="annottext">(f () -&gt; Shape f) -&gt; [f ()] -&gt; [Shape f]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[f ()]
forall (f :: * -&gt; *). PTraversable f =&gt; [f ()]
</span><a href="Data.PTraversable.Extra.html#shapes"><span class="hs-identifier hs-var">shapes</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span id="local-6989586621679207234"><span class="annot"><span class="annottext">model0 :: BinaryJoinModel f
</span><a href="#local-6989586621679207234"><span class="hs-identifier hs-var hs-var">model0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PreNatMapModel (BinaryJoin f) f -&gt; BinaryJoinModel f
forall (f :: * -&gt; *).
PreNatMapModel (BinaryJoin f) f -&gt; BinaryJoinModel f
</span><a href="MonadGen.BinaryJoin.html#BinaryJoinModel"><span class="hs-identifier hs-var">BinaryJoinModel</span></a></span><span> </span><span class="annot"><span class="annottext">(PreNatMapModel (BinaryJoin f) f -&gt; BinaryJoinModel f)
-&gt; PreNatMapModel (BinaryJoin f) f -&gt; BinaryJoinModel f
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><a href="ModelFinder.Model.PreNatMapModel.html#PreNatMapModel"><span class="hs-identifier hs-type">PreNatMapModel</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">allShapes :: Set (Shape f)
</span><a href="ModelFinder.Model.PreNatMapModel.html#allShapes"><span class="hs-identifier hs-var">allShapes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Shape f] -&gt; Set (Shape f)
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">[Shape f]
</span><a href="#local-6989586621679207244"><span class="hs-identifier hs-var">fShapes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pnmGuesses :: PreNatMap (BinaryJoin f) f
</span><a href="ModelFinder.Model.PreNatMapModel.html#pnmGuesses"><span class="hs-identifier hs-var">pnmGuesses</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PreNatMap (BinaryJoin f) f
forall (f :: * -&gt; *) (g :: * -&gt; *). PreNatMap f g
</span><span class="hs-identifier hs-var">PNM.empty</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-193"></span><span>    </span><span id="local-6989586621679207232"><span class="annot"><span class="annottext">allEqs :: [(Term J (f Bool), Term J (f Bool))]
</span><a href="#local-6989586621679207232"><span class="hs-identifier hs-var hs-var">allEqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Term J (f Bool), Term J (f Bool))]
forall (f :: * -&gt; *).
PTraversable f =&gt;
[(Term J (f Bool), Term J (f Bool))]
</span><a href="MonadGen.BinaryJoin.html#constEqs"><span class="hs-identifier hs-var">constEqs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Term J (f Bool), Term J (f Bool))]
-&gt; [(Term J (f Bool), Term J (f Bool))]
-&gt; [(Term J (f Bool), Term J (f Bool))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(Term J (f Bool), Term J (f Bool))]
forall (f :: * -&gt; *).
PTraversable f =&gt;
[(Term J (f Bool), Term J (f Bool))]
</span><a href="MonadGen.BinaryJoin.html#notEqs"><span class="hs-identifier hs-var">notEqs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Term J (f Bool), Term J (f Bool))]
-&gt; [(Term J (f Bool), Term J (f Bool))]
-&gt; [(Term J (f Bool), Term J (f Bool))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(Term J (f Bool), Term J (f Bool))]
forall (f :: * -&gt; *).
PTraversable f =&gt;
[(Term J (f Bool), Term J (f Bool))]
</span><a href="MonadGen.BinaryJoin.html#assocEqs"><span class="hs-identifier hs-var">assocEqs</span></a></span><span>
</span><span id="line-194"></span><span>    </span><span id="local-6989586621679207233"><span class="annot"><span class="annottext">allDefs :: Map (J (f Bool)) (f Bool)
</span><a href="#local-6989586621679207233"><span class="hs-identifier hs-var hs-var">allDefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Map (J (f Bool)) (f Bool)] -&gt; Map (J (f Bool)) (f Bool)
forall (f :: * -&gt; *) k a.
(Foldable f, Ord k) =&gt;
f (Map k a) -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.unions</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ApplicativeDict f -&gt; Map (J (f Bool)) (f Bool)
forall (f :: * -&gt; *).
PTraversable f =&gt;
ApplicativeDict f -&gt; Map (J (f Bool)) (f Bool)
</span><a href="MonadGen.BinaryJoin.html#apDefs"><span class="hs-identifier hs-var">apDefs</span></a></span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679207231"><span class="hs-identifier hs-var">apDict</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (J (f Bool)) (f Bool)
forall (f :: * -&gt; *). PTraversable f =&gt; Map (J (f Bool)) (f Bool)
</span><a href="MonadGen.BinaryJoin.html#zeroDefs"><span class="hs-identifier hs-var">zeroDefs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span id="local-6989586621679206328"><span class="annot"><a href="MonadGen.BinaryJoin.html#binaryJoinToJoin"><span class="hs-identifier hs-type">binaryJoinToJoin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679206328"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679206329"><span class="annot"><a href="#local-6989586621679206329"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679206329"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206328"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206329"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PreNatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#BinaryJoin"><span class="hs-identifier hs-type">BinaryJoin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206328"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679206328"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PreNatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679206328"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621679206328"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679206328"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-197"></span><span id="binaryJoinToJoin"><span class="annot"><span class="annottext">binaryJoinToJoin :: forall (f :: * -&gt; *).
(Traversable f, forall a. Ord a =&gt; Ord (f a)) =&gt;
PreNatMap (BinaryJoin f) f -&gt; PreNatMap (f :.: f) f
</span><a href="MonadGen.BinaryJoin.html#binaryJoinToJoin"><span class="hs-identifier hs-var hs-var">binaryJoinToJoin</span></a></span></span><span> </span><span id="local-6989586621679207292"><span class="annot"><span class="annottext">PreNatMap (BinaryJoin f) f
</span><a href="#local-6989586621679207292"><span class="hs-identifier hs-var">binaryJoinData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PreEntry (f :.: f) f] -&gt; PreNatMap (f :.: f) f
forall (f :: * -&gt; *) (g :: * -&gt; *).
(Ord (f Ignored), Eq (g Ignored), Foldable f, Traversable g) =&gt;
[PreEntry f g] -&gt; PreNatMap f g
</span><span class="hs-identifier hs-var">PNM.make</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PreEntry (BinaryJoin f) f -&gt; PreEntry (f :.: f) f
forall {f :: * -&gt; *} {g :: * -&gt; *}.
Functor f =&gt;
PreEntry (BinaryJoin f) g -&gt; PreEntry (f :.: f) g
</span><a href="#local-6989586621679207294"><span class="hs-identifier hs-var">buildEntry</span></a></span><span> </span><span class="annot"><span class="annottext">(PreEntry (BinaryJoin f) f -&gt; PreEntry (f :.: f) f)
-&gt; [PreEntry (BinaryJoin f) f] -&gt; [PreEntry (f :.: f) f]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PreNatMap (BinaryJoin f) f -&gt; [PreEntry (BinaryJoin f) f]
forall (f :: * -&gt; *) (g :: * -&gt; *).
(Traversable f, Functor g) =&gt;
PreNatMap f g -&gt; [PreEntry f g]
</span><span class="hs-identifier hs-var">PNM.toEntries</span></span><span> </span><span class="annot"><span class="annottext">PreNatMap (BinaryJoin f) f
</span><a href="#local-6989586621679207292"><span class="hs-identifier hs-var">binaryJoinData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-199"></span><span>    </span><span id="local-6989586621679207294"><span class="annot"><span class="annottext">buildEntry :: PreEntry (BinaryJoin f) g -&gt; PreEntry (f :.: f) g
</span><a href="#local-6989586621679207294"><span class="hs-identifier hs-var hs-var">buildEntry</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PNM.PreEntry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#BJ"><span class="hs-identifier hs-type">BJ</span></a></span><span> </span><span id="local-6989586621679207299"><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679207299"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679207300"><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679207300"><span class="hs-identifier hs-var">y0</span></a></span></span><span> </span><span id="local-6989586621679207301"><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679207301"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679207302"><span class="annot"><span class="annottext">g Int
</span><a href="#local-6989586621679207302"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(:.:) f f Int -&gt; g Int -&gt; PreEntry (f :.: f) g
forall (f :: * -&gt; *) (g :: * -&gt; *). f Int -&gt; g Int -&gt; PreEntry f g
</span><span class="hs-identifier hs-var">PNM.PreEntry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f (f Int) -&gt; (:.:) f f Int
forall k2 k1 (f :: k2 -&gt; *) (g :: k1 -&gt; k2) (p :: k1).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f Int -&gt; f Int -&gt; Bool -&gt; f Int
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679207300"><span class="hs-identifier hs-var">y0</span></a></span><span> </span><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679207301"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; f Int) -&gt; f Bool -&gt; f (f Int)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679207299"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g Int
</span><a href="#local-6989586621679207302"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- Utilities</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-keyword">type</span><span> </span><span id="Bitmap"><span class="annot"><a href="MonadGen.BinaryJoin.html#Bitmap"><span class="hs-identifier hs-var">Bitmap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span id="local-6989586621679206216"><span id="local-6989586621679206217"><span class="annot"><a href="MonadGen.BinaryJoin.html#boolTable"><span class="hs-identifier hs-type">boolTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679206216"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679206216"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206217"><span class="hs-identifier hs-type">any</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="MonadGen.BinaryJoin.html#Bitmap"><span class="hs-identifier hs-type">Bitmap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679206216"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-206"></span><span id="boolTable"><span class="annot"><span class="annottext">boolTable :: forall (f :: * -&gt; *) any.
Traversable f =&gt;
f any -&gt; [(Bitmap, f Bool)]
</span><a href="MonadGen.BinaryJoin.html#boolTable"><span class="hs-identifier hs-var hs-var">boolTable</span></a></span></span><span> </span><span id="local-6989586621679207324"><span class="annot"><span class="annottext">f any
</span><a href="#local-6989586621679207324"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679207325"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679207326"><span class="hs-identifier hs-var">lenMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bitmap -&gt; (Bitmap, f Bool)
forall {a}. Bits a =&gt; a -&gt; (a, f Bool)
</span><a href="#local-6989586621679207327"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="annot"><span class="annottext">(Bitmap -&gt; (Bitmap, f Bool)) -&gt; [Bitmap] -&gt; [(Bitmap, f Bool)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Bitmap
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Bitmap
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Bitmap -&gt; Int -&gt; Bitmap
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679207325"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Bitmap -&gt; Bitmap -&gt; Bitmap
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Bitmap
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [(Bitmap, f Bool)]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [(Bitmap, f Bool)]) -&gt; String -&gt; [(Bitmap, f Bool)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;too long: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679207325"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &gt;= &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679207326"><span class="hs-identifier hs-var">lenMax</span></a></span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-210"></span><span>    </span><span id="local-6989586621679207326"><span class="annot"><span class="annottext">lenMax :: Int
</span><a href="#local-6989586621679207326"><span class="hs-identifier hs-var hs-var">lenMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bitmap -&gt; Int
forall b. FiniteBits b =&gt; b -&gt; Int
</span><span class="hs-identifier hs-var">finiteBitSize</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bitmap
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-211"></span><span>    </span><span id="local-6989586621679207325"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679207325"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f any -&gt; Int
forall a. f a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">f any
</span><a href="#local-6989586621679207324"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span id="local-6989586621679207342"><span class="annot"><span class="annottext">fi :: f Int
</span><a href="#local-6989586621679207342"><span class="hs-identifier hs-var hs-var">fi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f any -&gt; f Int
forall (t :: * -&gt; *) a. Traversable t =&gt; t a -&gt; t Int
</span><a href="Data.PTraversable.Extra.html#_indices"><span class="hs-identifier hs-var">_indices</span></a></span><span> </span><span class="annot"><span class="annottext">f any
</span><a href="#local-6989586621679207324"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621679207327"><span class="annot"><span class="annottext">mk :: a -&gt; (a, f Bool)
</span><a href="#local-6989586621679207327"><span class="hs-identifier hs-var hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679207349"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679207349"><span class="hs-identifier hs-var">bitmap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679207349"><span class="hs-identifier hs-var">bitmap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; Bool
forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><span class="hs-identifier hs-var">testBit</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679207349"><span class="hs-identifier hs-var">bitmap</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; f Int -&gt; f Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679207342"><span class="hs-identifier hs-var">fi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span></pre></body></html>