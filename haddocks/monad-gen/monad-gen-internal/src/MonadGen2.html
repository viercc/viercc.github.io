<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DerivingVia #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE QuantifiedConstraints #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE DeriveTraversable #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE InstanceSigs #-}</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="MonadGen2.html"><span class="hs-identifier">MonadGen2</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="MonadData.html"><span class="hs-identifier">MonadData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="MonadGen2.html#prepareGenFromApplicative"><span class="hs-identifier">prepareGenFromApplicative</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="MonadGen2.html#genFromApplicative"><span class="hs-identifier">genFromApplicative</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="MonadGen2.html#moduloIso"><span class="hs-identifier">moduloIso</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="MonadGen2.html#groupsIso"><span class="hs-identifier">groupsIso</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">where</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.PTraversable</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.PTraversable.Extra.html"><span class="hs-identifier">Data.PTraversable.Extra</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Traversable.Extra.html"><span class="hs-identifier">Data.Traversable.Extra</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Traversable.Extra.html#indices"><span class="hs-identifier">indices</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Traversable.Extra.html#imap"><span class="hs-identifier">imap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.FunctorShape</span></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="ApplicativeGen.html"><span class="hs-identifier">ApplicativeGen</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.PreNatMap</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PNM</span></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="MonadData.html"><span class="hs-identifier">MonadData</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="ModelFinder.Model.PreNatMapModel.html"><span class="hs-identifier">ModelFinder.Model.PreNatMapModel</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">ModelFinder.Term</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">ModelFinder.Solver</span></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(:.:)</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Finitary.Enum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">enum</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Coerce</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">coerce</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Coercible</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.NatMap</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NM</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">guard</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- Generation</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="annot"><a href="MonadGen2.html#prepareGenFromApplicative"><span class="hs-identifier hs-type">prepareGenFromApplicative</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679197480"><span class="annot"><a href="#local-6989586621679197480"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679197479"><span class="annot"><a href="#local-6989586621679197479"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679197479"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197480"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197479"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679197480"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ApplicativeGen.html#ApplicativeDict"><span class="hs-identifier hs-type">ApplicativeDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197480"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MonadData.html#MonadData"><span class="hs-identifier hs-type">MonadData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197480"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span id="prepareGenFromApplicative"><span class="annot"><span class="annottext">prepareGenFromApplicative :: forall (f :: * -&gt; *).
(forall a. Show a =&gt; Show (f a), PTraversable f) =&gt;
Maybe (ApplicativeDict f -&gt; [MonadData f])
</span><a href="MonadGen2.html#prepareGenFromApplicative"><span class="hs-identifier hs-var hs-var">prepareGenFromApplicative</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-58"></span><span>  </span><span id="local-6989586621679197905"><span class="annot"><a href="#local-6989586621679197905"><span class="hs-identifier hs-var">snapshot</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Term (LHS f (f Int)) (f Int), Term (LHS f (f Int)) (f Int))]
-&gt; Map (J f Int) (f Int)
-&gt; JoinModel f
-&gt; Maybe (Snapshot (LHS f (f Int)) (f Int) (J f Int) (JoinModel f))
forall a (f :: * -&gt; *) k model.
(Ord a, Language f, Ord k, NormalForm (f a) k, Model k a model,
 DebugConstraint f a) =&gt;
[(Term f a, Term f a)]
-&gt; Map k a -&gt; model -&gt; Maybe (Snapshot f a k model)
</span><span class="hs-identifier hs-var">preInitialize</span></span><span> </span><span class="annot"><span class="annottext">[(Term (LHS f (f Int)) (f Int), Term (LHS f (f Int)) (f Int))]
forall (f :: * -&gt; *). PTraversable f =&gt; [(JTerm f, JTerm f)]
</span><a href="MonadGen2.html#associativityEqs"><span class="hs-identifier hs-var">associativityEqs</span></a></span><span> </span><span class="annot"><span class="annottext">Map (J f Int) (f Int)
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span> </span><span class="annot"><span class="annottext">JoinModel f
forall (f :: * -&gt; *). PTraversable f =&gt; JoinModel f
</span><a href="MonadGen2.html#newJoinModel"><span class="hs-identifier hs-var">newJoinModel</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679197910"><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679197910"><span class="hs-identifier hs-var">apDict</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-60"></span><span>    </span><span id="local-6989586621679197911"><span class="annot"><a href="#local-6989586621679197911"><span class="hs-identifier hs-var">apDefs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (PreNatMap (J f) f) -&gt; [PreNatMap (J f) f]
forall a. Maybe a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (PreNatMap (J f) f) -&gt; [PreNatMap (J f) f])
-&gt; Maybe (PreNatMap (J f) f) -&gt; [PreNatMap (J f) f]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f -&gt; Maybe (PreNatMap (J f) f)
forall (f :: * -&gt; *).
PTraversable f =&gt;
ApplicativeDict f -&gt; Maybe (PreNatMap (J f) f)
</span><a href="MonadGen2.html#applicativeDefs"><span class="hs-identifier hs-var">applicativeDefs</span></a></span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679197910"><span class="hs-identifier hs-var">apDict</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679197926"><span class="annot"><a href="#local-6989586621679197926"><span class="hs-identifier hs-var hs-var">def0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(J f Int, f Int)] -&gt; Map (J f Int) (f Int)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(J f Int, f Int)] -&gt; Map (J f Int) (f Int))
-&gt; [(J f Int, f Int)] -&gt; Map (J f Int) (f Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PreNatMap (J f) f -&gt; [(J f Int, f Int)]
forall (f :: * -&gt; *) (g :: * -&gt; *).
(Traversable f, Functor g) =&gt;
PreNatMap f g -&gt; [(f Int, g Int)]
</span><span class="hs-identifier hs-var">PNM.toEntries</span></span><span> </span><span class="annot"><span class="annottext">PreNatMap (J f) f
</span><a href="#local-6989586621679197911"><span class="hs-identifier hs-var">apDefs</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span id="local-6989586621679197929"><span class="annot"><a href="#local-6989586621679197929"><span class="hs-identifier hs-var">model</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">solveFromSnapshot</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679197926"><span class="hs-identifier hs-type">def0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197905"><span class="hs-identifier hs-type">snapshot</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="MonadGen2.html#postprocess"><span class="hs-identifier hs-type">postprocess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197910"><span class="hs-identifier hs-type">apDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197929"><span class="hs-identifier hs-type">model</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="annot"><a href="MonadGen2.html#genFromApplicative"><span class="hs-identifier hs-type">genFromApplicative</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679197556"><span class="annot"><a href="#local-6989586621679197556"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679197555"><span class="annot"><a href="#local-6989586621679197555"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679197555"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197556"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197555"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679197556"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeDict"><span class="hs-identifier hs-type">ApplicativeDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197556"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MonadData.html#MonadData"><span class="hs-identifier hs-type">MonadData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197556"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-66"></span><span id="genFromApplicative"><span class="annot"><span class="annottext">genFromApplicative :: forall (f :: * -&gt; *).
(forall a. Show a =&gt; Show (f a), PTraversable f) =&gt;
ApplicativeDict f -&gt; [MonadData f]
</span><a href="MonadGen2.html#genFromApplicative"><span class="hs-identifier hs-var hs-var">genFromApplicative</span></a></span></span><span> </span><span id="local-6989586621679197980"><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679197980"><span class="hs-identifier hs-var">apDict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-67"></span><span>  </span><span id="local-6989586621679197981"><span class="annot"><a href="#local-6989586621679197981"><span class="hs-identifier hs-var">apDefs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (PreNatMap (J f) f) -&gt; [PreNatMap (J f) f]
forall a. Maybe a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (PreNatMap (J f) f) -&gt; [PreNatMap (J f) f])
-&gt; Maybe (PreNatMap (J f) f) -&gt; [PreNatMap (J f) f]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f -&gt; Maybe (PreNatMap (J f) f)
forall (f :: * -&gt; *).
PTraversable f =&gt;
ApplicativeDict f -&gt; Maybe (PreNatMap (J f) f)
</span><a href="MonadGen2.html#applicativeDefs"><span class="hs-identifier hs-var">applicativeDefs</span></a></span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679197980"><span class="hs-identifier hs-var">apDict</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679197993"><span class="annot"><a href="#local-6989586621679197993"><span class="hs-identifier hs-var hs-var">def0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(J f Int, f Int)] -&gt; Map (J f Int) (f Int)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(J f Int, f Int)] -&gt; Map (J f Int) (f Int))
-&gt; [(J f Int, f Int)] -&gt; Map (J f Int) (f Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PreNatMap (J f) f -&gt; [(J f Int, f Int)]
forall (f :: * -&gt; *) (g :: * -&gt; *).
(Traversable f, Functor g) =&gt;
PreNatMap f g -&gt; [(f Int, g Int)]
</span><span class="hs-identifier hs-var">PNM.toEntries</span></span><span> </span><span class="annot"><span class="annottext">PreNatMap (J f) f
</span><a href="#local-6989586621679197981"><span class="hs-identifier hs-var">apDefs</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-comment">-- traceM $ &quot;def0.size = &quot; ++ show (Map.size def0)</span><span>
</span><span id="line-70"></span><span>  </span><span id="local-6989586621679197994"><span class="annot"><a href="#local-6989586621679197994"><span class="hs-identifier hs-var">eqs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">F.toList</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="MonadGen2.html#associativityEqsReduced"><span class="hs-identifier hs-type">associativityEqsReduced</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197981"><span class="hs-identifier hs-type">apDefs</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span id="local-6989586621679197996"><span class="annot"><a href="#local-6989586621679197996"><span class="hs-identifier hs-var">model</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">solveEqs'</span></span><span> </span><span class="annot"><a href="#local-6989586621679197994"><span class="hs-identifier hs-type">eqs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197993"><span class="hs-identifier hs-type">def0</span></a></span><span> </span><span class="annot"><a href="MonadGen2.html#newJoinModel"><span class="hs-identifier hs-type">newJoinModel</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="MonadGen2.html#postprocess"><span class="hs-identifier hs-type">postprocess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197980"><span class="hs-identifier hs-type">apDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197996"><span class="hs-identifier hs-type">model</span></a></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span id="local-6989586621679197554"><span class="annot"><a href="MonadGen2.html#postprocess"><span class="hs-identifier hs-type">postprocess</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679197554"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeDict"><span class="hs-identifier hs-type">ApplicativeDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197554"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonadGen2.html#JoinModel"><span class="hs-identifier hs-type">JoinModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197554"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonadData.html#MonadData"><span class="hs-identifier hs-type">MonadData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197554"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-75"></span><span id="postprocess"><span class="annot"><span class="annottext">postprocess :: forall (f :: * -&gt; *).
PTraversable f =&gt;
ApplicativeDict f -&gt; JoinModel f -&gt; MonadData f
</span><a href="MonadGen2.html#postprocess"><span class="hs-identifier hs-var hs-var">postprocess</span></a></span></span><span> </span><span id="local-6989586621679198006"><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679198006"><span class="hs-identifier hs-var">apDict</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ModelFinder.Model.PreNatMapModel.html#PreNatMapModel"><span class="hs-identifier hs-type">PreNatMapModel</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Shape f)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679198008"><span class="annot"><span class="annottext">PreNatMap (J f) f
</span><a href="#local-6989586621679198008"><span class="hs-identifier hs-var">pnm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Shape f -&gt; NatMap (f :.: f) f -&gt; MonadData f
forall (f :: * -&gt; *). Shape f -&gt; NatMap (f :.: f) f -&gt; MonadData f
</span><a href="MonadData.html#MonadData"><span class="hs-identifier hs-var">MonadData</span></a></span><span> </span><span class="annot"><span class="annottext">Shape f
</span><a href="#local-6989586621679198010"><span class="hs-identifier hs-var">pureShape</span></a></span><span> </span><span class="annot"><span class="annottext">NatMap (f :.: f) f
</span><a href="#local-6989586621679198011"><span class="hs-identifier hs-var">joinMap</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-77"></span><span>    </span><span id="local-6989586621679198010"><span class="annot"><span class="annottext">pureShape :: Shape f
</span><a href="#local-6989586621679198010"><span class="hs-identifier hs-var hs-var">pureShape</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f () -&gt; Shape f
forall (f :: * -&gt; *) a. f a -&gt; Shape f
</span><span class="hs-identifier hs-var">Shape</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApplicativeDict f -&gt; forall a. a -&gt; f a
forall (f :: * -&gt; *). ApplicativeDict f -&gt; forall a. a -&gt; f a
</span><a href="ApplicativeGen.html#_applicativePure"><span class="hs-identifier hs-var">_applicativePure</span></a></span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679198006"><span class="hs-identifier hs-var">apDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>    </span><span id="local-6989586621679198011"><span class="annot"><span class="annottext">joinMap :: NatMap (f :.: f) f
</span><a href="#local-6989586621679198011"><span class="hs-identifier hs-var hs-var">joinMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NatMap (J f) f -&gt; NatMap (f :.: f) f
forall (f :: * -&gt; *) (f' :: * -&gt; *) (g :: * -&gt; *).
(forall a. Coercible (f a) (f' a), WeakOrd f') =&gt;
NatMap f g -&gt; NatMap f' g
</span><a href="MonadGen2.html#coerceNatMapKeys"><span class="hs-identifier hs-var">coerceNatMapKeys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PreNatMap (J f) f -&gt; NatMap (J f) f
forall (f :: * -&gt; *) (g :: * -&gt; *).
(Ord (f Ignored), Traversable f, Functor g) =&gt;
PreNatMap f g -&gt; NatMap f g
</span><span class="hs-identifier hs-var">PNM.toNatMap</span></span><span> </span><span class="annot"><span class="annottext">PreNatMap (J f) f
</span><a href="#local-6989586621679198008"><span class="hs-identifier hs-var">pnm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span id="local-6989586621679197585"><span id="local-6989586621679197586"><span id="local-6989586621679197587"><span class="annot"><a href="MonadGen2.html#coerceNatMapKeys"><span class="hs-identifier hs-type">coerceNatMapKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679197572"><span class="annot"><a href="#local-6989586621679197572"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Coercible</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197585"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197572"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197586"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197572"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WeakOrd</span></span><span> </span><span class="annot"><a href="#local-6989586621679197586"><span class="hs-identifier hs-type">f'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NM.NatMap</span></span><span> </span><span class="annot"><a href="#local-6989586621679197585"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197587"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NM.NatMap</span></span><span> </span><span class="annot"><a href="#local-6989586621679197586"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197587"><span class="hs-identifier hs-type">g</span></a></span></span></span></span><span>
</span><span id="line-81"></span><span id="coerceNatMapKeys"><span class="annot"><span class="annottext">coerceNatMapKeys :: forall (f :: * -&gt; *) (f' :: * -&gt; *) (g :: * -&gt; *).
(forall a. Coercible (f a) (f' a), WeakOrd f') =&gt;
NatMap f g -&gt; NatMap f' g
</span><a href="MonadGen2.html#coerceNatMapKeys"><span class="hs-identifier hs-var hs-var">coerceNatMapKeys</span></a></span></span><span> </span><span id="local-6989586621679198044"><span class="annot"><span class="annottext">NatMap f g
</span><a href="#local-6989586621679198044"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Entry f' g] -&gt; NatMap f' g
forall (f :: * -&gt; *) (g :: * -&gt; *).
WeakOrd f =&gt;
[Entry f g] -&gt; NatMap f g
</span><span class="hs-identifier hs-var">NM.fromEntries</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Shape f -&gt; Shape f')
-&gt; (forall x. g x -&gt; g x) -&gt; Entry f g -&gt; Entry f' g
forall (f :: * -&gt; *) (f' :: * -&gt; *) (g :: * -&gt; *) (g' :: * -&gt; *).
(Shape f -&gt; Shape f')
-&gt; (forall x. g x -&gt; g' x) -&gt; Entry f g -&gt; Entry f' g'
</span><span class="hs-identifier hs-var">NM.bimapEntry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall a. f a -&gt; f' a) -&gt; Shape f -&gt; Shape f'
forall (f :: * -&gt; *) (g :: * -&gt; *).
(forall a. f a -&gt; g a) -&gt; Shape f -&gt; Shape g
</span><span class="hs-identifier hs-var">mapShape</span></span><span> </span><span class="annot"><span class="annottext">f a -&gt; f' a
forall a. f a -&gt; f' a
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g x -&gt; g x
forall a. a -&gt; a
forall x. g x -&gt; g x
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(Entry f g -&gt; Entry f' g) -&gt; [Entry f g] -&gt; [Entry f' g]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NatMap f g -&gt; [Entry f g]
forall (f :: * -&gt; *) (g :: * -&gt; *). NatMap f g -&gt; [Entry f g]
</span><span class="hs-identifier hs-var">NM.toEntries</span></span><span> </span><span class="annot"><span class="annottext">NatMap f g
</span><a href="#local-6989586621679198044"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="annot"><a href="MonadGen2.html#moduloIso"><span class="hs-identifier hs-type">moduloIso</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679197614"><span class="annot"><a href="#local-6989586621679197614"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679197613"><span class="annot"><a href="#local-6989586621679197613"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679197613"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197614"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197613"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679197614"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeDict"><span class="hs-identifier hs-type">ApplicativeDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197614"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MonadData.html#MonadData"><span class="hs-identifier hs-type">MonadData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197614"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MonadData.html#MonadData"><span class="hs-identifier hs-type">MonadData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197614"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-84"></span><span id="moduloIso"><span class="annot"><span class="annottext">moduloIso :: forall (f :: * -&gt; *).
(forall a. Show a =&gt; Show (f a), PTraversable f) =&gt;
ApplicativeDict f -&gt; [MonadData f] -&gt; [MonadData f]
</span><a href="MonadGen2.html#moduloIso"><span class="hs-identifier hs-var hs-var">moduloIso</span></a></span></span><span> </span><span id="local-6989586621679198065"><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679198065"><span class="hs-identifier hs-var">apDict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Iso f] -&gt; [MonadData f] -&gt; [MonadData f]
forall (f :: * -&gt; *).
(PTraversable f, forall a. Show a =&gt; Show (f a),
 forall a. Ord a =&gt; Ord (f a)) =&gt;
[Iso f] -&gt; [MonadData f] -&gt; [MonadData f]
</span><a href="MonadData.html#uniqueByIso"><span class="hs-identifier hs-var">uniqueByIso</span></a></span><span> </span><span class="annot"><span class="annottext">[Iso f]
</span><a href="#local-6989586621679198067"><span class="hs-identifier hs-var">isoGenerators</span></a></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-86"></span><span>    </span><span id="local-6989586621679198067"><span class="annot"><span class="annottext">isoGenerators :: [Iso f]
</span><a href="#local-6989586621679198067"><span class="hs-identifier hs-var hs-var">isoGenerators</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f -&gt; [Iso f]
forall (f :: * -&gt; *).
PTraversable f =&gt;
ApplicativeDict f -&gt; [Iso f]
</span><a href="ApplicativeGen.html#stabilizingIsomorphisms"><span class="hs-identifier hs-var">stabilizingIsomorphisms</span></a></span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679198065"><span class="hs-identifier hs-var">apDict</span></a></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="annot"><a href="MonadGen2.html#groupsIso"><span class="hs-identifier hs-type">groupsIso</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679197622"><span class="annot"><a href="#local-6989586621679197622"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679197621"><span class="annot"><a href="#local-6989586621679197621"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679197621"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197622"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197621"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679197622"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeDict"><span class="hs-identifier hs-type">ApplicativeDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197622"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MonadData.html#MonadData"><span class="hs-identifier hs-type">MonadData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197622"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadData.html#MonadData"><span class="hs-identifier hs-type">MonadData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197622"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-89"></span><span id="groupsIso"><span class="annot"><span class="annottext">groupsIso :: forall (f :: * -&gt; *).
(forall a. Show a =&gt; Show (f a), PTraversable f) =&gt;
ApplicativeDict f -&gt; [MonadData f] -&gt; [Set (MonadData f)]
</span><a href="MonadGen2.html#groupsIso"><span class="hs-identifier hs-var hs-var">groupsIso</span></a></span></span><span> </span><span id="local-6989586621679198089"><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679198089"><span class="hs-identifier hs-var">apDict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Iso f] -&gt; [MonadData f] -&gt; [Set (MonadData f)]
forall (f :: * -&gt; *).
(PTraversable f, forall a. Show a =&gt; Show (f a),
 forall a. Ord a =&gt; Ord (f a)) =&gt;
[Iso f] -&gt; [MonadData f] -&gt; [Set (MonadData f)]
</span><a href="MonadData.html#groupByIso"><span class="hs-identifier hs-var">groupByIso</span></a></span><span> </span><span class="annot"><span class="annottext">[Iso f]
</span><a href="#local-6989586621679198091"><span class="hs-identifier hs-var">isoGenerators</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>    </span><span id="local-6989586621679198091"><span class="annot"><span class="annottext">isoGenerators :: [Iso f]
</span><a href="#local-6989586621679198091"><span class="hs-identifier hs-var hs-var">isoGenerators</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f -&gt; [Iso f]
forall (f :: * -&gt; *).
PTraversable f =&gt;
ApplicativeDict f -&gt; [Iso f]
</span><a href="ApplicativeGen.html#stabilizingIsomorphisms"><span class="hs-identifier hs-var">stabilizingIsomorphisms</span></a></span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679198089"><span class="hs-identifier hs-var">apDict</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">-- Model</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-keyword">data</span><span> </span><span id="LHS"><span class="annot"><a href="MonadGen2.html#LHS"><span class="hs-identifier hs-var">LHS</span></a></span></span><span> </span><span id="local-6989586621679197732"><span class="annot"><a href="#local-6989586621679197732"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679197734"><span class="annot"><a href="#local-6989586621679197734"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679197733"><span class="annot"><a href="#local-6989586621679197733"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-96"></span><span>    </span><span id="Join"><span class="annot"><a href="MonadGen2.html#Join"><span class="hs-identifier hs-var">Join</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197732"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197733"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Bind"><span class="annot"><a href="MonadGen2.html#Bind"><span class="hs-identifier hs-var">Bind</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679197734"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679197733"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679198106"><span id="local-6989586621679198114"><span id="local-6989586621679198117"><span class="annot"><span class="annottext">Int -&gt; LHS f k r -&gt; ShowS
[LHS f k r] -&gt; ShowS
LHS f k r -&gt; String
(Int -&gt; LHS f k r -&gt; ShowS)
-&gt; (LHS f k r -&gt; String)
-&gt; ([LHS f k r] -&gt; ShowS)
-&gt; Show (LHS f k r)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall (f :: * -&gt; *) k r.
(Show k, Show r, Show (f r)) =&gt;
Int -&gt; LHS f k r -&gt; ShowS
forall (f :: * -&gt; *) k r.
(Show k, Show r, Show (f r)) =&gt;
[LHS f k r] -&gt; ShowS
forall (f :: * -&gt; *) k r.
(Show k, Show r, Show (f r)) =&gt;
LHS f k r -&gt; String
$cshowsPrec :: forall (f :: * -&gt; *) k r.
(Show k, Show r, Show (f r)) =&gt;
Int -&gt; LHS f k r -&gt; ShowS
showsPrec :: Int -&gt; LHS f k r -&gt; ShowS
$cshow :: forall (f :: * -&gt; *) k r.
(Show k, Show r, Show (f r)) =&gt;
LHS f k r -&gt; String
show :: LHS f k r -&gt; String
$cshowList :: forall (f :: * -&gt; *) k r.
(Show k, Show r, Show (f r)) =&gt;
[LHS f k r] -&gt; ShowS
showList :: [LHS f k r] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679198125"><span id="local-6989586621679198134"><span class="annot"><span class="annottext">LHS f k r -&gt; LHS f k r -&gt; Bool
(LHS f k r -&gt; LHS f k r -&gt; Bool)
-&gt; (LHS f k r -&gt; LHS f k r -&gt; Bool) -&gt; Eq (LHS f k r)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall (f :: * -&gt; *) k r.
(Eq k, Eq r, Eq (f r)) =&gt;
LHS f k r -&gt; LHS f k r -&gt; Bool
$c== :: forall (f :: * -&gt; *) k r.
(Eq k, Eq r, Eq (f r)) =&gt;
LHS f k r -&gt; LHS f k r -&gt; Bool
== :: LHS f k r -&gt; LHS f k r -&gt; Bool
$c/= :: forall (f :: * -&gt; *) k r.
(Eq k, Eq r, Eq (f r)) =&gt;
LHS f k r -&gt; LHS f k r -&gt; Bool
/= :: LHS f k r -&gt; LHS f k r -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679198147"><span id="local-6989586621679198153"><span id="local-6989586621679198158"><span id="local-6989586621679198162"><span id="local-6989586621679198165"><span id="local-6989586621679198168"><span id="local-6989586621679198171"><span class="annot"><span class="annottext">Eq (LHS f k r)
Eq (LHS f k r) =&gt;
(LHS f k r -&gt; LHS f k r -&gt; Ordering)
-&gt; (LHS f k r -&gt; LHS f k r -&gt; Bool)
-&gt; (LHS f k r -&gt; LHS f k r -&gt; Bool)
-&gt; (LHS f k r -&gt; LHS f k r -&gt; Bool)
-&gt; (LHS f k r -&gt; LHS f k r -&gt; Bool)
-&gt; (LHS f k r -&gt; LHS f k r -&gt; LHS f k r)
-&gt; (LHS f k r -&gt; LHS f k r -&gt; LHS f k r)
-&gt; Ord (LHS f k r)
LHS f k r -&gt; LHS f k r -&gt; Bool
LHS f k r -&gt; LHS f k r -&gt; Ordering
LHS f k r -&gt; LHS f k r -&gt; LHS f k r
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall (f :: * -&gt; *) k r.
(Ord k, Ord r, Ord (f r)) =&gt;
Eq (LHS f k r)
forall (f :: * -&gt; *) k r.
(Ord k, Ord r, Ord (f r)) =&gt;
LHS f k r -&gt; LHS f k r -&gt; Bool
forall (f :: * -&gt; *) k r.
(Ord k, Ord r, Ord (f r)) =&gt;
LHS f k r -&gt; LHS f k r -&gt; Ordering
forall (f :: * -&gt; *) k r.
(Ord k, Ord r, Ord (f r)) =&gt;
LHS f k r -&gt; LHS f k r -&gt; LHS f k r
$ccompare :: forall (f :: * -&gt; *) k r.
(Ord k, Ord r, Ord (f r)) =&gt;
LHS f k r -&gt; LHS f k r -&gt; Ordering
compare :: LHS f k r -&gt; LHS f k r -&gt; Ordering
$c&lt; :: forall (f :: * -&gt; *) k r.
(Ord k, Ord r, Ord (f r)) =&gt;
LHS f k r -&gt; LHS f k r -&gt; Bool
&lt; :: LHS f k r -&gt; LHS f k r -&gt; Bool
$c&lt;= :: forall (f :: * -&gt; *) k r.
(Ord k, Ord r, Ord (f r)) =&gt;
LHS f k r -&gt; LHS f k r -&gt; Bool
&lt;= :: LHS f k r -&gt; LHS f k r -&gt; Bool
$c&gt; :: forall (f :: * -&gt; *) k r.
(Ord k, Ord r, Ord (f r)) =&gt;
LHS f k r -&gt; LHS f k r -&gt; Bool
&gt; :: LHS f k r -&gt; LHS f k r -&gt; Bool
$c&gt;= :: forall (f :: * -&gt; *) k r.
(Ord k, Ord r, Ord (f r)) =&gt;
LHS f k r -&gt; LHS f k r -&gt; Bool
&gt;= :: LHS f k r -&gt; LHS f k r -&gt; Bool
$cmax :: forall (f :: * -&gt; *) k r.
(Ord k, Ord r, Ord (f r)) =&gt;
LHS f k r -&gt; LHS f k r -&gt; LHS f k r
max :: LHS f k r -&gt; LHS f k r -&gt; LHS f k r
$cmin :: forall (f :: * -&gt; *) k r.
(Ord k, Ord r, Ord (f r)) =&gt;
LHS f k r -&gt; LHS f k r -&gt; LHS f k r
min :: LHS f k r -&gt; LHS f k r -&gt; LHS f k r
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679198181"><span id="local-6989586621679198184"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; LHS f k a -&gt; LHS f k b)
-&gt; (forall a b. a -&gt; LHS f k b -&gt; LHS f k a) -&gt; Functor (LHS f k)
forall a b. a -&gt; LHS f k b -&gt; LHS f k a
forall a b. (a -&gt; b) -&gt; LHS f k a -&gt; LHS f k b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
forall (f :: * -&gt; *) k a b.
Functor f =&gt;
a -&gt; LHS f k b -&gt; LHS f k a
forall (f :: * -&gt; *) k a b.
Functor f =&gt;
(a -&gt; b) -&gt; LHS f k a -&gt; LHS f k b
$cfmap :: forall (f :: * -&gt; *) k a b.
Functor f =&gt;
(a -&gt; b) -&gt; LHS f k a -&gt; LHS f k b
fmap :: forall a b. (a -&gt; b) -&gt; LHS f k a -&gt; LHS f k b
$c&lt;$ :: forall (f :: * -&gt; *) k a b.
Functor f =&gt;
a -&gt; LHS f k b -&gt; LHS f k a
&lt;$ :: forall a b. a -&gt; LHS f k b -&gt; LHS f k a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679198191"><span id="local-6989586621679198197"><span id="local-6989586621679198202"><span id="local-6989586621679198207"><span id="local-6989586621679198210"><span id="local-6989586621679198213"><span id="local-6989586621679198216"><span id="local-6989586621679198219"><span id="local-6989586621679198222"><span id="local-6989586621679198225"><span id="local-6989586621679198228"><span id="local-6989586621679198231"><span id="local-6989586621679198234"><span id="local-6989586621679198239"><span id="local-6989586621679198244"><span id="local-6989586621679198249"><span id="local-6989586621679198254"><span class="annot"><span class="annottext">(forall m. Monoid m =&gt; LHS f k m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; LHS f k a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; LHS f k a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LHS f k a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LHS f k a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LHS f k a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LHS f k a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; LHS f k a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; LHS f k a -&gt; a)
-&gt; (forall a. LHS f k a -&gt; [a])
-&gt; (forall a. LHS f k a -&gt; Bool)
-&gt; (forall a. LHS f k a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; LHS f k a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; LHS f k a -&gt; a)
-&gt; (forall a. Ord a =&gt; LHS f k a -&gt; a)
-&gt; (forall a. Num a =&gt; LHS f k a -&gt; a)
-&gt; (forall a. Num a =&gt; LHS f k a -&gt; a)
-&gt; Foldable (LHS f k)
forall a. Eq a =&gt; a -&gt; LHS f k a -&gt; Bool
forall a. Num a =&gt; LHS f k a -&gt; a
forall a. Ord a =&gt; LHS f k a -&gt; a
forall m. Monoid m =&gt; LHS f k m -&gt; m
forall a. LHS f k a -&gt; Bool
forall a. LHS f k a -&gt; Int
forall a. LHS f k a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; LHS f k a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; LHS f k a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LHS f k a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LHS f k a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
forall (f :: * -&gt; *) k a.
(Foldable f, Eq a) =&gt;
a -&gt; LHS f k a -&gt; Bool
forall (f :: * -&gt; *) k a. (Foldable f, Num a) =&gt; LHS f k a -&gt; a
forall (f :: * -&gt; *) k a. (Foldable f, Ord a) =&gt; LHS f k a -&gt; a
forall (f :: * -&gt; *) k m. (Foldable f, Monoid m) =&gt; LHS f k m -&gt; m
forall (f :: * -&gt; *) k a. Foldable f =&gt; LHS f k a -&gt; Bool
forall (f :: * -&gt; *) k a. Foldable f =&gt; LHS f k a -&gt; Int
forall (f :: * -&gt; *) k a. Foldable f =&gt; LHS f k a -&gt; [a]
forall (f :: * -&gt; *) k a.
Foldable f =&gt;
(a -&gt; a -&gt; a) -&gt; LHS f k a -&gt; a
forall (f :: * -&gt; *) k m a.
(Foldable f, Monoid m) =&gt;
(a -&gt; m) -&gt; LHS f k a -&gt; m
forall (f :: * -&gt; *) k b a.
Foldable f =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; LHS f k a -&gt; b
forall (f :: * -&gt; *) k a b.
Foldable f =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; LHS f k a -&gt; b
$cfold :: forall (f :: * -&gt; *) k m. (Foldable f, Monoid m) =&gt; LHS f k m -&gt; m
fold :: forall m. Monoid m =&gt; LHS f k m -&gt; m
$cfoldMap :: forall (f :: * -&gt; *) k m a.
(Foldable f, Monoid m) =&gt;
(a -&gt; m) -&gt; LHS f k a -&gt; m
foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; LHS f k a -&gt; m
$cfoldMap' :: forall (f :: * -&gt; *) k m a.
(Foldable f, Monoid m) =&gt;
(a -&gt; m) -&gt; LHS f k a -&gt; m
foldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; LHS f k a -&gt; m
$cfoldr :: forall (f :: * -&gt; *) k a b.
Foldable f =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; LHS f k a -&gt; b
foldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LHS f k a -&gt; b
$cfoldr' :: forall (f :: * -&gt; *) k a b.
Foldable f =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; LHS f k a -&gt; b
foldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LHS f k a -&gt; b
$cfoldl :: forall (f :: * -&gt; *) k b a.
Foldable f =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; LHS f k a -&gt; b
foldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LHS f k a -&gt; b
$cfoldl' :: forall (f :: * -&gt; *) k b a.
Foldable f =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; LHS f k a -&gt; b
foldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LHS f k a -&gt; b
$cfoldr1 :: forall (f :: * -&gt; *) k a.
Foldable f =&gt;
(a -&gt; a -&gt; a) -&gt; LHS f k a -&gt; a
foldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; LHS f k a -&gt; a
$cfoldl1 :: forall (f :: * -&gt; *) k a.
Foldable f =&gt;
(a -&gt; a -&gt; a) -&gt; LHS f k a -&gt; a
foldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; LHS f k a -&gt; a
$ctoList :: forall (f :: * -&gt; *) k a. Foldable f =&gt; LHS f k a -&gt; [a]
toList :: forall a. LHS f k a -&gt; [a]
$cnull :: forall (f :: * -&gt; *) k a. Foldable f =&gt; LHS f k a -&gt; Bool
null :: forall a. LHS f k a -&gt; Bool
$clength :: forall (f :: * -&gt; *) k a. Foldable f =&gt; LHS f k a -&gt; Int
length :: forall a. LHS f k a -&gt; Int
$celem :: forall (f :: * -&gt; *) k a.
(Foldable f, Eq a) =&gt;
a -&gt; LHS f k a -&gt; Bool
elem :: forall a. Eq a =&gt; a -&gt; LHS f k a -&gt; Bool
$cmaximum :: forall (f :: * -&gt; *) k a. (Foldable f, Ord a) =&gt; LHS f k a -&gt; a
maximum :: forall a. Ord a =&gt; LHS f k a -&gt; a
$cminimum :: forall (f :: * -&gt; *) k a. (Foldable f, Ord a) =&gt; LHS f k a -&gt; a
minimum :: forall a. Ord a =&gt; LHS f k a -&gt; a
$csum :: forall (f :: * -&gt; *) k a. (Foldable f, Num a) =&gt; LHS f k a -&gt; a
sum :: forall a. Num a =&gt; LHS f k a -&gt; a
$cproduct :: forall (f :: * -&gt; *) k a. (Foldable f, Num a) =&gt; LHS f k a -&gt; a
product :: forall a. Num a =&gt; LHS f k a -&gt; a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679198270"><span id="local-6989586621679198278"><span id="local-6989586621679198283"><span id="local-6989586621679198288"><span class="annot"><span class="annottext">Functor (LHS f k)
Foldable (LHS f k)
(Functor (LHS f k), Foldable (LHS f k)) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; LHS f k a -&gt; f (LHS f k b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    LHS f k (f a) -&gt; f (LHS f k a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; LHS f k a -&gt; m (LHS f k b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    LHS f k (m a) -&gt; m (LHS f k a))
-&gt; Traversable (LHS f k)
forall (t :: * -&gt; *).
(Functor t, Foldable t) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a. Monad m =&gt; LHS f k (m a) -&gt; m (LHS f k a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
LHS f k (f a) -&gt; f (LHS f k a)
forall (f :: * -&gt; *) k. Traversable f =&gt; Functor (LHS f k)
forall (f :: * -&gt; *) k. Traversable f =&gt; Foldable (LHS f k)
forall (f :: * -&gt; *) k (m :: * -&gt; *) a.
(Traversable f, Monad m) =&gt;
LHS f k (m a) -&gt; m (LHS f k a)
forall (f :: * -&gt; *) k (f :: * -&gt; *) a.
(Traversable f, Applicative f) =&gt;
LHS f k (f a) -&gt; f (LHS f k a)
forall (f :: * -&gt; *) k (m :: * -&gt; *) a b.
(Traversable f, Monad m) =&gt;
(a -&gt; m b) -&gt; LHS f k a -&gt; m (LHS f k b)
forall (f :: * -&gt; *) k (f :: * -&gt; *) a b.
(Traversable f, Applicative f) =&gt;
(a -&gt; f b) -&gt; LHS f k a -&gt; f (LHS f k b)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; LHS f k a -&gt; m (LHS f k b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; LHS f k a -&gt; f (LHS f k b)
$ctraverse :: forall (f :: * -&gt; *) k (f :: * -&gt; *) a b.
(Traversable f, Applicative f) =&gt;
(a -&gt; f b) -&gt; LHS f k a -&gt; f (LHS f k b)
traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; LHS f k a -&gt; f (LHS f k b)
$csequenceA :: forall (f :: * -&gt; *) k (f :: * -&gt; *) a.
(Traversable f, Applicative f) =&gt;
LHS f k (f a) -&gt; f (LHS f k a)
sequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
LHS f k (f a) -&gt; f (LHS f k a)
$cmapM :: forall (f :: * -&gt; *) k (m :: * -&gt; *) a b.
(Traversable f, Monad m) =&gt;
(a -&gt; m b) -&gt; LHS f k a -&gt; m (LHS f k b)
mapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; LHS f k a -&gt; m (LHS f k b)
$csequence :: forall (f :: * -&gt; *) k (m :: * -&gt; *) a.
(Traversable f, Monad m) =&gt;
LHS f k (m a) -&gt; m (LHS f k a)
sequence :: forall (m :: * -&gt; *) a. Monad m =&gt; LHS f k (m a) -&gt; m (LHS f k a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-keyword">newtype</span><span> </span><span id="J"><span class="annot"><a href="MonadGen2.html#J"><span class="hs-identifier hs-var">J</span></a></span></span><span> </span><span id="local-6989586621679197739"><span class="annot"><a href="#local-6989586621679197739"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679197740"><span class="annot"><a href="#local-6989586621679197740"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="J"><span class="annot"><a href="MonadGen2.html#J"><span class="hs-identifier hs-var">J</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197739"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197739"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197740"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679198298"><span id="local-6989586621679198302"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; J f a -&gt; J f b)
-&gt; (forall a b. a -&gt; J f b -&gt; J f a) -&gt; Functor (J f)
forall a b. a -&gt; J f b -&gt; J f a
forall a b. (a -&gt; b) -&gt; J f a -&gt; J f b
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; J f b -&gt; J f a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; J f a -&gt; J f b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; J f a -&gt; J f b
fmap :: forall a b. (a -&gt; b) -&gt; J f a -&gt; J f b
$c&lt;$ :: forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; J f b -&gt; J f a
&lt;$ :: forall a b. a -&gt; J f b -&gt; J f a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679198308"><span id="local-6989586621679198314"><span id="local-6989586621679198321"><span id="local-6989586621679198326"><span id="local-6989586621679198330"><span id="local-6989586621679198333"><span id="local-6989586621679198336"><span id="local-6989586621679198339"><span id="local-6989586621679198342"><span id="local-6989586621679198345"><span id="local-6989586621679198348"><span id="local-6989586621679198352"><span id="local-6989586621679198355"><span id="local-6989586621679198360"><span id="local-6989586621679198365"><span id="local-6989586621679198370"><span id="local-6989586621679198375"><span class="annot"><span class="annottext">(forall m. Monoid m =&gt; J f m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; J f a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; J f a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; J f a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; J f a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; J f a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; J f a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; J f a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; J f a -&gt; a)
-&gt; (forall a. J f a -&gt; [a])
-&gt; (forall a. J f a -&gt; Bool)
-&gt; (forall a. J f a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; J f a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; J f a -&gt; a)
-&gt; (forall a. Ord a =&gt; J f a -&gt; a)
-&gt; (forall a. Num a =&gt; J f a -&gt; a)
-&gt; (forall a. Num a =&gt; J f a -&gt; a)
-&gt; Foldable (J f)
forall a. Eq a =&gt; a -&gt; J f a -&gt; Bool
forall a. Num a =&gt; J f a -&gt; a
forall a. Ord a =&gt; J f a -&gt; a
forall m. Monoid m =&gt; J f m -&gt; m
forall a. J f a -&gt; Bool
forall a. J f a -&gt; Int
forall a. J f a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; J f a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; J f a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; J f a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; J f a -&gt; b
forall (f :: * -&gt; *) a. (Foldable f, Eq a) =&gt; a -&gt; J f a -&gt; Bool
forall (f :: * -&gt; *) a. (Foldable f, Num a) =&gt; J f a -&gt; a
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; J f a -&gt; a
forall (f :: * -&gt; *) m. (Foldable f, Monoid m) =&gt; J f m -&gt; m
forall (f :: * -&gt; *) a. Foldable f =&gt; J f a -&gt; Bool
forall (f :: * -&gt; *) a. Foldable f =&gt; J f a -&gt; Int
forall (f :: * -&gt; *) a. Foldable f =&gt; J f a -&gt; [a]
forall (f :: * -&gt; *) a. Foldable f =&gt; (a -&gt; a -&gt; a) -&gt; J f a -&gt; a
forall (f :: * -&gt; *) m a.
(Foldable f, Monoid m) =&gt;
(a -&gt; m) -&gt; J f a -&gt; m
forall (f :: * -&gt; *) b a.
Foldable f =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; J f a -&gt; b
forall (f :: * -&gt; *) a b.
Foldable f =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; J f a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
$cfold :: forall (f :: * -&gt; *) m. (Foldable f, Monoid m) =&gt; J f m -&gt; m
fold :: forall m. Monoid m =&gt; J f m -&gt; m
$cfoldMap :: forall (f :: * -&gt; *) m a.
(Foldable f, Monoid m) =&gt;
(a -&gt; m) -&gt; J f a -&gt; m
foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; J f a -&gt; m
$cfoldMap' :: forall (f :: * -&gt; *) m a.
(Foldable f, Monoid m) =&gt;
(a -&gt; m) -&gt; J f a -&gt; m
foldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; J f a -&gt; m
$cfoldr :: forall (f :: * -&gt; *) a b.
Foldable f =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; J f a -&gt; b
foldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; J f a -&gt; b
$cfoldr' :: forall (f :: * -&gt; *) a b.
Foldable f =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; J f a -&gt; b
foldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; J f a -&gt; b
$cfoldl :: forall (f :: * -&gt; *) b a.
Foldable f =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; J f a -&gt; b
foldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; J f a -&gt; b
$cfoldl' :: forall (f :: * -&gt; *) b a.
Foldable f =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; J f a -&gt; b
foldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; J f a -&gt; b
$cfoldr1 :: forall (f :: * -&gt; *) a. Foldable f =&gt; (a -&gt; a -&gt; a) -&gt; J f a -&gt; a
foldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; J f a -&gt; a
$cfoldl1 :: forall (f :: * -&gt; *) a. Foldable f =&gt; (a -&gt; a -&gt; a) -&gt; J f a -&gt; a
foldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; J f a -&gt; a
$ctoList :: forall (f :: * -&gt; *) a. Foldable f =&gt; J f a -&gt; [a]
toList :: forall a. J f a -&gt; [a]
$cnull :: forall (f :: * -&gt; *) a. Foldable f =&gt; J f a -&gt; Bool
null :: forall a. J f a -&gt; Bool
$clength :: forall (f :: * -&gt; *) a. Foldable f =&gt; J f a -&gt; Int
length :: forall a. J f a -&gt; Int
$celem :: forall (f :: * -&gt; *) a. (Foldable f, Eq a) =&gt; a -&gt; J f a -&gt; Bool
elem :: forall a. Eq a =&gt; a -&gt; J f a -&gt; Bool
$cmaximum :: forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; J f a -&gt; a
maximum :: forall a. Ord a =&gt; J f a -&gt; a
$cminimum :: forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; J f a -&gt; a
minimum :: forall a. Ord a =&gt; J f a -&gt; a
$csum :: forall (f :: * -&gt; *) a. (Foldable f, Num a) =&gt; J f a -&gt; a
sum :: forall a. Num a =&gt; J f a -&gt; a
$cproduct :: forall (f :: * -&gt; *) a. (Foldable f, Num a) =&gt; J f a -&gt; a
product :: forall a. Num a =&gt; J f a -&gt; a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679198387"><span id="local-6989586621679198396"><span id="local-6989586621679198401"><span id="local-6989586621679198406"><span class="annot"><span class="annottext">Functor (J f)
Foldable (J f)
(Functor (J f), Foldable (J f)) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; J f a -&gt; f (J f b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    J f (f a) -&gt; f (J f a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; J f a -&gt; m (J f b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; J f (m a) -&gt; m (J f a))
-&gt; Traversable (J f)
forall (t :: * -&gt; *).
(Functor t, Foldable t) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (f :: * -&gt; *). Traversable f =&gt; Functor (J f)
forall (f :: * -&gt; *). Traversable f =&gt; Foldable (J f)
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable f, Monad m) =&gt;
J f (m a) -&gt; m (J f a)
forall (f :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable f, Applicative f) =&gt;
J f (f a) -&gt; f (J f a)
forall (f :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable f, Monad m) =&gt;
(a -&gt; m b) -&gt; J f a -&gt; m (J f b)
forall (f :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable f, Applicative f) =&gt;
(a -&gt; f b) -&gt; J f a -&gt; f (J f b)
forall (m :: * -&gt; *) a. Monad m =&gt; J f (m a) -&gt; m (J f a)
forall (f :: * -&gt; *) a. Applicative f =&gt; J f (f a) -&gt; f (J f a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; J f a -&gt; m (J f b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; J f a -&gt; f (J f b)
$ctraverse :: forall (f :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable f, Applicative f) =&gt;
(a -&gt; f b) -&gt; J f a -&gt; f (J f b)
traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; J f a -&gt; f (J f b)
$csequenceA :: forall (f :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable f, Applicative f) =&gt;
J f (f a) -&gt; f (J f a)
sequenceA :: forall (f :: * -&gt; *) a. Applicative f =&gt; J f (f a) -&gt; f (J f a)
$cmapM :: forall (f :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable f, Monad m) =&gt;
(a -&gt; m b) -&gt; J f a -&gt; m (J f b)
mapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; J f a -&gt; m (J f b)
$csequence :: forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable f, Monad m) =&gt;
J f (m a) -&gt; m (J f a)
sequence :: forall (m :: * -&gt; *) a. Monad m =&gt; J f (m a) -&gt; m (J f a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span id="local-6989586621679197721"><span id="local-6989586621679197722"><span id="local-6989586621679198412"><span id="local-6989586621679198416"><span id="local-6989586621679198420"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197721"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197721"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197722"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen2.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197721"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197722"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-104"></span><span id="local-6989586621679197725"><span id="local-6989586621679197726"><span id="local-6989586621679198424"><span id="local-6989586621679198428"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197725"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197725"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197726"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen2.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197725"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197726"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-105"></span><span id="local-6989586621679197523"><span id="local-6989586621679197524"><span id="local-6989586621679198438"><span id="local-6989586621679198442"><span id="local-6989586621679198446"><span id="local-6989586621679198450"><span id="local-6989586621679198454"><span id="local-6989586621679198458"><span id="local-6989586621679198462"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197523"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197523"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197524"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen2.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197523"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197524"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679197516"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679197516"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NormalForm</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen2.html#LHS"><span class="hs-identifier hs-type">LHS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197516"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197516"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197516"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen2.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197516"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>  </span><span id="local-6989586621679198472"><span class="annot"><span class="annottext">normalize :: LHS f (f Int) (f Int) -&gt; J f Int
</span><a href="#local-6989586621679198472"><span class="hs-identifier hs-var hs-var hs-var">normalize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHS f (f Int) (f Int) -&gt; J f Int
forall (f :: * -&gt; *). Functor f =&gt; LHS f (f Int) (f Int) -&gt; J f Int
</span><a href="MonadGen2.html#toComp"><span class="hs-identifier hs-var">toComp</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621679198476"><span class="annot"><span class="annottext">reify :: J f Int -&gt; LHS f (f Int) (f Int)
</span><a href="#local-6989586621679198476"><span class="hs-identifier hs-var hs-var hs-var">reify</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (f Int) -&gt; LHS f (f Int) (f Int)
forall (f :: * -&gt; *) k r. f r -&gt; LHS f k r
</span><a href="MonadGen2.html#Join"><span class="hs-identifier hs-var">Join</span></a></span><span> </span><span class="annot"><span class="annottext">(f (f Int) -&gt; LHS f (f Int) (f Int))
-&gt; (J f Int -&gt; f (f Int)) -&gt; J f Int -&gt; LHS f (f Int) (f Int)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">J f Int -&gt; f (f Int)
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-keyword">type</span><span> </span><span id="JoinModel"><span class="annot"><a href="MonadGen2.html#JoinModel"><span class="hs-identifier hs-var">JoinModel</span></a></span></span><span> </span><span id="local-6989586621679198479"><span class="annot"><a href="#local-6989586621679198479"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="ModelFinder.Model.PreNatMapModel.html#PreNatMapModel"><span class="hs-identifier hs-type">PreNatMapModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen2.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679198479"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679198479"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span id="local-6989586621679198480"><span class="annot"><a href="MonadGen2.html#toComp"><span class="hs-identifier hs-type">toComp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679198480"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MonadGen2.html#LHS"><span class="hs-identifier hs-type">LHS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679198480"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679198480"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679198480"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonadGen2.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679198480"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-114"></span><span id="toComp"><span class="annot"><span class="annottext">toComp :: forall (f :: * -&gt; *). Functor f =&gt; LHS f (f Int) (f Int) -&gt; J f Int
</span><a href="MonadGen2.html#toComp"><span class="hs-identifier hs-var hs-var">toComp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen2.html#Join"><span class="hs-identifier hs-type">Join</span></a></span><span> </span><span id="local-6989586621679198483"><span class="annot"><span class="annottext">f (f Int)
</span><a href="#local-6989586621679198483"><span class="hs-identifier hs-var">ffr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (f Int) -&gt; J f Int
forall (f :: * -&gt; *) x. f (f x) -&gt; J f x
</span><a href="MonadGen2.html#J"><span class="hs-identifier hs-var">J</span></a></span><span> </span><span class="annot"><span class="annottext">f (f Int)
</span><a href="#local-6989586621679198483"><span class="hs-identifier hs-var">ffr</span></a></span><span>
</span><span id="line-115"></span><span class="annot"><a href="MonadGen2.html#toComp"><span class="hs-identifier hs-var">toComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen2.html#Bind"><span class="hs-identifier hs-type">Bind</span></a></span><span> </span><span id="local-6989586621679198484"><span class="annot"><span class="annottext">Vector (f Int)
</span><a href="#local-6989586621679198484"><span class="hs-identifier hs-var">fxs</span></a></span></span><span> </span><span id="local-6989586621679198485"><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679198485"><span class="hs-identifier hs-var">fi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (f Int) -&gt; J f Int
forall (f :: * -&gt; *) x. f (f x) -&gt; J f x
</span><a href="MonadGen2.html#J"><span class="hs-identifier hs-var">J</span></a></span><span> </span><span class="annot"><span class="annottext">(f (f Int) -&gt; J f Int) -&gt; f (f Int) -&gt; J f Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (f Int)
</span><a href="#local-6989586621679198484"><span class="hs-identifier hs-var">fxs</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (f Int) -&gt; Int -&gt; f Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; f Int) -&gt; f Int -&gt; f (f Int)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679198485"><span class="hs-identifier hs-var">fi</span></a></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span id="local-6989586621679197535"><span class="annot"><a href="MonadGen2.html#newJoinModel"><span class="hs-identifier hs-type">newJoinModel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679197535"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MonadGen2.html#JoinModel"><span class="hs-identifier hs-type">JoinModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197535"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-118"></span><span id="newJoinModel"><span class="annot"><span class="annottext">newJoinModel :: forall (f :: * -&gt; *). PTraversable f =&gt; JoinModel f
</span><a href="MonadGen2.html#newJoinModel"><span class="hs-identifier hs-var hs-var">newJoinModel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="ModelFinder.Model.PreNatMapModel.html#PreNatMapModel"><span class="hs-identifier hs-type">PreNatMapModel</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><span class="annottext">allShapes :: Set (Shape f)
</span><a href="ModelFinder.Model.PreNatMapModel.html#allShapes"><span class="hs-identifier hs-var">allShapes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Shape f] -&gt; Set (Shape f)
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">[Shape f]
forall x (f :: * -&gt; *). (Enum x, Alternative f) =&gt; f x
</span><span class="hs-identifier hs-var">enum</span></span><span class="hs-special">,</span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><span class="annottext">pnmGuesses :: PreNatMap (J f) f
</span><a href="ModelFinder.Model.PreNatMapModel.html#pnmGuesses"><span class="hs-identifier hs-var">pnmGuesses</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PreNatMap (J f) f
forall (f :: * -&gt; *) (g :: * -&gt; *). PreNatMap f g
</span><span class="hs-identifier hs-var">PNM.empty</span></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="annot"><span class="hs-comment">-- * Equations</span></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-keyword">type</span><span> </span><span id="JTerm"><span class="annot"><a href="MonadGen2.html#JTerm"><span class="hs-identifier hs-var">JTerm</span></a></span></span><span> </span><span id="local-6989586621679198502"><span class="annot"><a href="#local-6989586621679198502"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen2.html#LHS"><span class="hs-identifier hs-type">LHS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679198502"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679198502"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679198502"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span id="local-6989586621679197752"><span class="annot"><a href="MonadGen2.html#rightAssocTerm"><span class="hs-identifier hs-type">rightAssocTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679197752"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679197752"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197752"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197752"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonadGen2.html#JTerm"><span class="hs-identifier hs-type">JTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197752"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-128"></span><span id="rightAssocTerm"><span class="annot"><span class="annottext">rightAssocTerm :: forall (f :: * -&gt; *). Functor f =&gt; f (f (f Int)) -&gt; JTerm f
</span><a href="MonadGen2.html#rightAssocTerm"><span class="hs-identifier hs-var hs-var">rightAssocTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHS f (f Int) (Term (LHS f (f Int)) (f Int))
-&gt; Term (LHS f (f Int)) (f Int)
forall (f :: * -&gt; *) a. f (Term f a) -&gt; Term f a
</span><span class="hs-identifier hs-var">fun</span></span><span> </span><span class="annot"><span class="annottext">(LHS f (f Int) (Term (LHS f (f Int)) (f Int))
 -&gt; Term (LHS f (f Int)) (f Int))
-&gt; (f (f (f Int)) -&gt; LHS f (f Int) (Term (LHS f (f Int)) (f Int)))
-&gt; f (f (f Int))
-&gt; Term (LHS f (f Int)) (f Int)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">f (Term (LHS f (f Int)) (f Int))
-&gt; LHS f (f Int) (Term (LHS f (f Int)) (f Int))
forall (f :: * -&gt; *) k r. f r -&gt; LHS f k r
</span><a href="MonadGen2.html#Join"><span class="hs-identifier hs-var">Join</span></a></span><span> </span><span class="annot"><span class="annottext">(f (Term (LHS f (f Int)) (f Int))
 -&gt; LHS f (f Int) (Term (LHS f (f Int)) (f Int)))
-&gt; (f (f (f Int)) -&gt; f (Term (LHS f (f Int)) (f Int)))
-&gt; f (f (f Int))
-&gt; LHS f (f Int) (Term (LHS f (f Int)) (f Int))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(f (f Int) -&gt; Term (LHS f (f Int)) (f Int))
-&gt; f (f (f Int)) -&gt; f (Term (LHS f (f Int)) (f Int))
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHS f (f Int) (Term (LHS f (f Int)) (f Int))
-&gt; Term (LHS f (f Int)) (f Int)
forall (f :: * -&gt; *) a. f (Term f a) -&gt; Term f a
</span><span class="hs-identifier hs-var">fun</span></span><span> </span><span class="annot"><span class="annottext">(LHS f (f Int) (Term (LHS f (f Int)) (f Int))
 -&gt; Term (LHS f (f Int)) (f Int))
-&gt; (f (f Int) -&gt; LHS f (f Int) (Term (LHS f (f Int)) (f Int)))
-&gt; f (f Int)
-&gt; Term (LHS f (f Int)) (f Int)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">f (Term (LHS f (f Int)) (f Int))
-&gt; LHS f (f Int) (Term (LHS f (f Int)) (f Int))
forall (f :: * -&gt; *) k r. f r -&gt; LHS f k r
</span><a href="MonadGen2.html#Join"><span class="hs-identifier hs-var">Join</span></a></span><span> </span><span class="annot"><span class="annottext">(f (Term (LHS f (f Int)) (f Int))
 -&gt; LHS f (f Int) (Term (LHS f (f Int)) (f Int)))
-&gt; (f (f Int) -&gt; f (Term (LHS f (f Int)) (f Int)))
-&gt; f (f Int)
-&gt; LHS f (f Int) (Term (LHS f (f Int)) (f Int))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(f Int -&gt; Term (LHS f (f Int)) (f Int))
-&gt; f (f Int) -&gt; f (Term (LHS f (f Int)) (f Int))
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">f Int -&gt; Term (LHS f (f Int)) (f Int)
forall a (f :: * -&gt; *). a -&gt; Term f a
</span><span class="hs-identifier hs-var">con</span></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span id="local-6989586621679197758"><span class="annot"><a href="MonadGen2.html#leftAssocTerm"><span class="hs-identifier hs-type">leftAssocTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679197758"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197758"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679197758"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197758"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197758"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonadGen2.html#JTerm"><span class="hs-identifier hs-type">JTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197758"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-131"></span><span id="leftAssocTerm"><span class="annot"><span class="annottext">leftAssocTerm :: forall (f :: * -&gt; *).
(Traversable f, Ord (f Int)) =&gt;
f (f (f Int)) -&gt; JTerm f
</span><a href="MonadGen2.html#leftAssocTerm"><span class="hs-identifier hs-var hs-var">leftAssocTerm</span></a></span></span><span> </span><span id="local-6989586621679198517"><span class="annot"><span class="annottext">f (f (f Int))
</span><a href="#local-6989586621679198517"><span class="hs-identifier hs-var">fffi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(:.:) f f (f Int) -&gt; (Vector (f Int), (:.:) f f Int)
forall (g :: * -&gt; *) a.
(Traversable g, Ord a) =&gt;
g a -&gt; (Vector a, g Int)
</span><a href="MonadGen2.html#separateFunctor"><span class="hs-identifier hs-var">separateFunctor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f (f (f Int)) -&gt; (:.:) f f (f Int)
forall k2 k1 (f :: k2 -&gt; *) (g :: k1 -&gt; k2) (p :: k1).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp1</span></span><span> </span><span class="annot"><span class="annottext">f (f (f Int))
</span><a href="#local-6989586621679198517"><span class="hs-identifier hs-var">fffi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679198520"><span class="annot"><span class="annottext">Vector (f Int)
</span><a href="#local-6989586621679198520"><span class="hs-identifier hs-var">vec</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Comp1</span></span><span> </span><span id="local-6989586621679198521"><span class="annot"><span class="annottext">f (f Int)
</span><a href="#local-6989586621679198521"><span class="hs-identifier hs-var">ffj</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LHS f (f Int) (JTerm f) -&gt; JTerm f
forall (f :: * -&gt; *) a. f (Term f a) -&gt; Term f a
</span><span class="hs-identifier hs-var">fun</span></span><span> </span><span class="annot"><span class="annottext">(LHS f (f Int) (JTerm f) -&gt; JTerm f)
-&gt; LHS f (f Int) (JTerm f) -&gt; JTerm f
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (f Int) -&gt; JTerm f -&gt; LHS f (f Int) (JTerm f)
forall (f :: * -&gt; *) k r. Vector k -&gt; r -&gt; LHS f k r
</span><a href="MonadGen2.html#Bind"><span class="hs-identifier hs-var">Bind</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (f Int)
</span><a href="#local-6989586621679198520"><span class="hs-identifier hs-var">vec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHS f (f Int) (JTerm f) -&gt; JTerm f
forall (f :: * -&gt; *) a. f (Term f a) -&gt; Term f a
</span><span class="hs-identifier hs-var">fun</span></span><span> </span><span class="annot"><span class="annottext">(LHS f (f Int) (JTerm f) -&gt; JTerm f)
-&gt; (f (f Int) -&gt; LHS f (f Int) (JTerm f)) -&gt; f (f Int) -&gt; JTerm f
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">f (JTerm f) -&gt; LHS f (f Int) (JTerm f)
forall (f :: * -&gt; *) k r. f r -&gt; LHS f k r
</span><a href="MonadGen2.html#Join"><span class="hs-identifier hs-var">Join</span></a></span><span> </span><span class="annot"><span class="annottext">(f (JTerm f) -&gt; LHS f (f Int) (JTerm f))
-&gt; (f (f Int) -&gt; f (JTerm f))
-&gt; f (f Int)
-&gt; LHS f (f Int) (JTerm f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(f Int -&gt; JTerm f) -&gt; f (f Int) -&gt; f (JTerm f)
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">f Int -&gt; JTerm f
forall a (f :: * -&gt; *). a -&gt; Term f a
</span><span class="hs-identifier hs-var">con</span></span><span> </span><span class="annot"><span class="annottext">(f (f Int) -&gt; JTerm f) -&gt; f (f Int) -&gt; JTerm f
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f (f Int)
</span><a href="#local-6989586621679198521"><span class="hs-identifier hs-var">ffj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span id="local-6989586621679197769"><span class="annot"><a href="MonadGen2.html#makeAssociativity"><span class="hs-identifier hs-type">makeAssociativity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679197769"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197769"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679197769"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197769"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197769"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen2.html#JTerm"><span class="hs-identifier hs-type">JTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197769"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonadGen2.html#JTerm"><span class="hs-identifier hs-type">JTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197769"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-135"></span><span id="makeAssociativity"><span class="annot"><span class="annottext">makeAssociativity :: forall (f :: * -&gt; *).
(Traversable f, Ord (f Int)) =&gt;
f (f (f Int)) -&gt; (JTerm f, JTerm f)
</span><a href="MonadGen2.html#makeAssociativity"><span class="hs-identifier hs-var hs-var">makeAssociativity</span></a></span></span><span> </span><span id="local-6989586621679198529"><span class="annot"><span class="annottext">f (f (f Int))
</span><a href="#local-6989586621679198529"><span class="hs-identifier hs-var">f3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f (f (f Int)) -&gt; JTerm f
forall (f :: * -&gt; *).
(Traversable f, Ord (f Int)) =&gt;
f (f (f Int)) -&gt; JTerm f
</span><a href="MonadGen2.html#leftAssocTerm"><span class="hs-identifier hs-var">leftAssocTerm</span></a></span><span> </span><span class="annot"><span class="annottext">f (f (f Int))
</span><a href="#local-6989586621679198529"><span class="hs-identifier hs-var">f3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">f (f (f Int)) -&gt; JTerm f
forall (f :: * -&gt; *). Functor f =&gt; f (f (f Int)) -&gt; JTerm f
</span><a href="MonadGen2.html#rightAssocTerm"><span class="hs-identifier hs-var">rightAssocTerm</span></a></span><span> </span><span class="annot"><span class="annottext">f (f (f Int))
</span><a href="#local-6989586621679198529"><span class="hs-identifier hs-var">f3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- associativityEqs :: (PTraversable f) =&gt; [(JTerm f, JTerm f)]</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- associativityEqs = makeAssociativity &lt;$&gt; V.toList skolem3</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span id="local-6989586621679197531"><span class="annot"><a href="MonadGen2.html#associativityEqs"><span class="hs-identifier hs-type">associativityEqs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679197531"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="MonadGen2.html#JTerm"><span class="hs-identifier hs-type">JTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197531"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonadGen2.html#JTerm"><span class="hs-identifier hs-type">JTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197531"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-141"></span><span id="associativityEqs"><span class="annot"><span class="annottext">associativityEqs :: forall (f :: * -&gt; *). PTraversable f =&gt; [(JTerm f, JTerm f)]
</span><a href="MonadGen2.html#associativityEqs"><span class="hs-identifier hs-var hs-var">associativityEqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f (f (f Int)) -&gt; (JTerm f, JTerm f)
forall (f :: * -&gt; *).
(Traversable f, Ord (f Int)) =&gt;
f (f (f Int)) -&gt; (JTerm f, JTerm f)
</span><a href="MonadGen2.html#makeAssociativity"><span class="hs-identifier hs-var">makeAssociativity</span></a></span><span> </span><span class="annot"><span class="annottext">(f (f (f Int)) -&gt; (JTerm f, JTerm f))
-&gt; (f (f (f ())) -&gt; f (f (f Int)))
-&gt; f (f (f ()))
-&gt; (JTerm f, JTerm f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((f (f (f ())) -&gt; f (f (f Int)))
 -&gt; f (f (f ())) -&gt; (JTerm f, JTerm f))
-&gt; [f (f (f ())) -&gt; f (f (f Int))]
-&gt; [f (f (f ())) -&gt; (JTerm f, JTerm f)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">f (f (f ())) -&gt; f (f (f Int))
forall (f :: * -&gt; *) any.
Traversable f =&gt;
f (f (f any)) -&gt; f (f (f Int))
</span><a href="MonadGen2.html#outerIx"><span class="hs-identifier hs-var">outerIx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">f (f (f ())) -&gt; f (f (f Int))
forall (f :: * -&gt; *) any.
Traversable f =&gt;
f (f (f any)) -&gt; f (f (f Int))
</span><a href="MonadGen2.html#innerIx"><span class="hs-identifier hs-var">innerIx</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[f (f (f ())) -&gt; (JTerm f, JTerm f)]
-&gt; [f (f (f ()))] -&gt; [(JTerm f, JTerm f)]
forall a b. [a -&gt; b] -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[f (f ())] -&gt; [f (f (f ()))]
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(PTraversable t, Alternative f) =&gt;
f a -&gt; f (t a)
</span><span class="hs-identifier hs-var">enum1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[f ()] -&gt; [f (f ())]
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(PTraversable t, Alternative f) =&gt;
f a -&gt; f (t a)
</span><span class="hs-identifier hs-var">enum1</span></span><span> </span><span class="annot"><span class="annottext">[f ()]
forall (f :: * -&gt; *). PTraversable f =&gt; [f ()]
</span><a href="Data.PTraversable.Extra.html#shapes"><span class="hs-identifier hs-var">shapes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span id="local-6989586621679197558"><span class="annot"><a href="MonadGen2.html#associativityEqsReduced"><span class="hs-identifier hs-type">associativityEqsReduced</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679197558"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PNM.PreNatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen2.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197558"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679197558"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="MonadGen2.html#JTerm"><span class="hs-identifier hs-type">JTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197558"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonadGen2.html#JTerm"><span class="hs-identifier hs-type">JTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197558"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-144"></span><span id="associativityEqsReduced"><span class="annot"><span class="annottext">associativityEqsReduced :: forall (f :: * -&gt; *).
PTraversable f =&gt;
PreNatMap (J f) f -&gt; Maybe [(JTerm f, JTerm f)]
</span><a href="MonadGen2.html#associativityEqsReduced"><span class="hs-identifier hs-var hs-var">associativityEqsReduced</span></a></span></span><span> </span><span id="local-6989586621679198566"><span class="annot"><span class="annottext">PreNatMap (J f) f
</span><a href="#local-6989586621679198566"><span class="hs-identifier hs-var">pnm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[(JTerm f, JTerm f)]] -&gt; [(JTerm f, JTerm f)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[(JTerm f, JTerm f)]] -&gt; [(JTerm f, JTerm f)])
-&gt; Maybe [[(JTerm f, JTerm f)]] -&gt; Maybe [(JTerm f, JTerm f)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">((JTerm f, JTerm f) -&gt; Maybe [(JTerm f, JTerm f)])
-&gt; [(JTerm f, JTerm f)] -&gt; Maybe [[(JTerm f, JTerm f)]]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">(JTerm f, JTerm f) -&gt; Maybe [(JTerm f, JTerm f)]
</span><a href="#local-6989586621679198568"><span class="hs-identifier hs-var">checkAndRemove</span></a></span><span> </span><span class="annot"><span class="annottext">[(JTerm f, JTerm f)]
forall (f :: * -&gt; *). PTraversable f =&gt; [(JTerm f, JTerm f)]
</span><a href="MonadGen2.html#associativityEqs"><span class="hs-identifier hs-var">associativityEqs</span></a></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-146"></span><span>    </span><span id="local-6989586621679198577"><span class="annot"><span class="annottext">red :: JTerm f -&gt; JTerm f
</span><a href="#local-6989586621679198577"><span class="hs-identifier hs-var hs-var">red</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PreNatMap (J f) f -&gt; JTerm f -&gt; JTerm f
forall (f :: * -&gt; *).
PTraversable f =&gt;
PreNatMap (J f) f -&gt; JTerm f -&gt; JTerm f
</span><a href="MonadGen2.html#reduceJTerm"><span class="hs-identifier hs-var">reduceJTerm</span></a></span><span> </span><span class="annot"><span class="annottext">PreNatMap (J f) f
</span><a href="#local-6989586621679198566"><span class="hs-identifier hs-var">pnm</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span id="local-6989586621679198568"><span class="annot"><span class="annottext">checkAndRemove :: (JTerm f, JTerm f) -&gt; Maybe [(JTerm f, JTerm f)]
</span><a href="#local-6989586621679198568"><span class="hs-identifier hs-var hs-var">checkAndRemove</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679198584"><span class="annot"><span class="annottext">JTerm f
</span><a href="#local-6989586621679198584"><span class="hs-identifier hs-var">lhs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679198585"><span class="annot"><span class="annottext">JTerm f
</span><a href="#local-6989586621679198585"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JTerm f -&gt; JTerm f
</span><a href="#local-6989586621679198577"><span class="hs-identifier hs-var">red</span></a></span><span> </span><span class="annot"><span class="annottext">JTerm f
</span><a href="#local-6989586621679198584"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">JTerm f -&gt; JTerm f
</span><a href="#local-6989586621679198577"><span class="hs-identifier hs-var">red</span></a></span><span> </span><span class="annot"><span class="annottext">JTerm f
</span><a href="#local-6989586621679198585"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-148"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span> </span><span id="local-6989586621679198588"><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679198588"><span class="hs-identifier hs-var">lhsCon</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span> </span><span id="local-6989586621679198589"><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679198589"><span class="hs-identifier hs-var">rhsCon</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(JTerm f, JTerm f)] -&gt; Maybe () -&gt; Maybe [(JTerm f, JTerm f)]
forall a b. a -&gt; Maybe b -&gt; Maybe a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679198588"><span class="hs-identifier hs-var">lhsCon</span></a></span><span> </span><span class="annot"><span class="annottext">f Int -&gt; f Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679198589"><span class="hs-identifier hs-var">rhsCon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679198590"><span class="annot"><span class="annottext">JTerm f
</span><a href="#local-6989586621679198590"><span class="hs-identifier hs-var">lhs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679198591"><span class="annot"><span class="annottext">JTerm f
</span><a href="#local-6989586621679198591"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(JTerm f, JTerm f)] -&gt; Maybe [(JTerm f, JTerm f)]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">JTerm f
</span><a href="#local-6989586621679198590"><span class="hs-identifier hs-var">lhs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">JTerm f
</span><a href="#local-6989586621679198591"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span id="local-6989586621679197772"><span id="local-6989586621679197773"><span class="annot"><a href="MonadGen2.html#outerIx"><span class="hs-identifier hs-type">outerIx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonadGen2.html#innerIx"><span class="hs-identifier hs-type">innerIx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679197772"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679197772"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197772"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197772"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197773"><span class="hs-identifier hs-type">any</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679197772"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197772"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197772"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-152"></span><span id="outerIx"><span class="annot"><span class="annottext">outerIx :: forall (f :: * -&gt; *) any.
Traversable f =&gt;
f (f (f any)) -&gt; f (f (f Int))
</span><a href="MonadGen2.html#outerIx"><span class="hs-identifier hs-var hs-var">outerIx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; f (f any) -&gt; f (f Int)) -&gt; f (f (f any)) -&gt; f (f (f Int))
forall (t :: * -&gt; *) a b.
Traversable t =&gt;
(Int -&gt; a -&gt; b) -&gt; t a -&gt; t b
</span><a href="Data.Traversable.Extra.html#imap"><span class="hs-identifier hs-var">imap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679198597"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679198597"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(f any -&gt; f Int) -&gt; f (f any) -&gt; f (f Int)
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679198597"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; f any -&gt; f Int
forall a b. a -&gt; f b -&gt; f a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span id="innerIx"><span class="annot"><span class="annottext">innerIx :: forall (f :: * -&gt; *) any.
Traversable f =&gt;
f (f (f any)) -&gt; f (f (f Int))
</span><a href="MonadGen2.html#innerIx"><span class="hs-identifier hs-var hs-var">innerIx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(f (f any) -&gt; f (f Int)) -&gt; f (f (f any)) -&gt; f (f (f Int))
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(:.:) f f Int -&gt; f (f Int)
forall k2 k1 (f :: k2 -&gt; *) (g :: k1 -&gt; k2) (p :: k1).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp1</span></span><span> </span><span class="annot"><span class="annottext">((:.:) f f Int -&gt; f (f Int))
-&gt; (f (f any) -&gt; (:.:) f f Int) -&gt; f (f any) -&gt; f (f Int)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(:.:) f f any -&gt; (:.:) f f Int
forall (t :: * -&gt; *) a. Traversable t =&gt; t a -&gt; t Int
</span><a href="Data.Traversable.Extra.html#indices"><span class="hs-identifier hs-var">indices</span></a></span><span> </span><span class="annot"><span class="annottext">((:.:) f f any -&gt; (:.:) f f Int)
-&gt; (f (f any) -&gt; (:.:) f f any) -&gt; f (f any) -&gt; (:.:) f f Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">f (f any) -&gt; (:.:) f f any
forall k2 k1 (f :: k2 -&gt; *) (g :: k1 -&gt; k2) (p :: k1).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp1</span></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span id="local-6989586621679197545"><span class="annot"><a href="MonadGen2.html#applicativeDefs"><span class="hs-identifier hs-type">applicativeDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679197545"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="ApplicativeGen.html#ApplicativeDict"><span class="hs-identifier hs-type">ApplicativeDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197545"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PNM.PreNatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen2.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197545"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679197545"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-156"></span><span id="applicativeDefs"><span class="annot"><span class="annottext">applicativeDefs :: forall (f :: * -&gt; *).
PTraversable f =&gt;
ApplicativeDict f -&gt; Maybe (PreNatMap (J f) f)
</span><a href="MonadGen2.html#applicativeDefs"><span class="hs-identifier hs-var hs-var">applicativeDefs</span></a></span></span><span> </span><span id="local-6989586621679198626"><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679198626"><span class="hs-identifier hs-var">apDict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(J f (Int, Int), f (Int, Int))] -&gt; Maybe (PreNatMap (J f) f)
forall (f :: * -&gt; *) (g :: * -&gt; *) a.
(Ord (f Ignored), Eq (g Ignored), Foldable f, Traversable g,
 Ord a) =&gt;
[(f a, g a)] -&gt; Maybe (PreNatMap f g)
</span><span class="hs-identifier hs-var">PNM.fromEntries</span></span><span> </span><span class="annot"><span class="annottext">([(J f (Int, Int), f (Int, Int))] -&gt; Maybe (PreNatMap (J f) f))
-&gt; [(J f (Int, Int), f (Int, Int))] -&gt; Maybe (PreNatMap (J f) f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-157"></span><span>  </span><span id="local-6989586621679198628"><span class="annot"><a href="#local-6989586621679198628"><span class="hs-identifier hs-var">fi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[f Int]
</span><a href="#local-6989586621679198629"><span class="hs-identifier hs-var">f1</span></a></span><span>
</span><span id="line-158"></span><span>  </span><span id="local-6989586621679198630"><span class="annot"><a href="#local-6989586621679198630"><span class="hs-identifier hs-var">fj</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679198629"><span class="hs-identifier hs-type">f1</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679198633"><span class="annot"><a href="#local-6989586621679198633"><span class="hs-identifier hs-var hs-var">lhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (f (Int, Int)) -&gt; J f (Int, Int)
forall (f :: * -&gt; *) x. f (f x) -&gt; J f x
</span><a href="MonadGen2.html#J"><span class="hs-identifier hs-var">J</span></a></span><span> </span><span class="annot"><span class="annottext">(f (f (Int, Int)) -&gt; J f (Int, Int))
-&gt; f (f (Int, Int)) -&gt; J f (Int, Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; f (Int, Int)) -&gt; f Int -&gt; f (f (Int, Int))
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679198634"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679198634"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679198634"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; (Int, Int)) -&gt; f Int -&gt; f (Int, Int)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679198630"><span class="hs-identifier hs-var">fj</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679198628"><span class="hs-identifier hs-var">fi</span></a></span><span>
</span><span id="line-160"></span><span>      </span><span id="local-6989586621679198635"><span class="annot"><a href="#local-6989586621679198635"><span class="hs-identifier hs-var hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f
-&gt; forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
forall (f :: * -&gt; *).
ApplicativeDict f
-&gt; forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><a href="ApplicativeGen.html#_applicativeLiftA2"><span class="hs-identifier hs-var">_applicativeLiftA2</span></a></span><span> </span><span class="annot"><span class="annottext">ApplicativeDict f
</span><a href="#local-6989586621679198626"><span class="hs-identifier hs-var">apDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679198628"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679198630"><span class="hs-identifier hs-var">fj</span></a></span><span>
</span><span id="line-161"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679198633"><span class="hs-identifier hs-type">lhs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679198635"><span class="hs-identifier hs-type">rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-163"></span><span>    </span><span id="local-6989586621679198629"><span class="annot"><span class="annottext">f1 :: [f Int]
</span><a href="#local-6989586621679198629"><span class="hs-identifier hs-var hs-var">f1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (f Int) -&gt; [f Int]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">Vector (f Int)
forall (m :: * -&gt; *). PTraversable m =&gt; Vector (m Int)
</span><a href="Data.PTraversable.Extra.html#skolem"><span class="hs-identifier hs-var">skolem</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="annot"><a href="MonadGen2.html#reduceJTerm"><span class="hs-identifier hs-type">reduceJTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679197783"><span class="annot"><a href="#local-6989586621679197783"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PTraversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679197783"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PNM.PreNatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen2.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197783"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679197783"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonadGen2.html#JTerm"><span class="hs-identifier hs-type">JTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197783"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonadGen2.html#JTerm"><span class="hs-identifier hs-type">JTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197783"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-166"></span><span id="reduceJTerm"><span class="annot"><span class="annottext">reduceJTerm :: forall (f :: * -&gt; *).
PTraversable f =&gt;
PreNatMap (J f) f -&gt; JTerm f -&gt; JTerm f
</span><a href="MonadGen2.html#reduceJTerm"><span class="hs-identifier hs-var hs-var">reduceJTerm</span></a></span></span><span> </span><span id="local-6989586621679198663"><span class="annot"><span class="annottext">PreNatMap (J f) f
</span><a href="#local-6989586621679198663"><span class="hs-identifier hs-var">pnm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">JTerm f -&gt; JTerm f
</span><a href="#local-6989586621679198664"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-168"></span><span>    </span><span id="local-6989586621679198678"><span class="annot"><span class="annottext">tryReduceJ :: J f a -&gt; Term (LHS f k) (f a)
</span><a href="#local-6989586621679198678"><span class="hs-identifier hs-var hs-var">tryReduceJ</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen2.html#J"><span class="hs-identifier hs-type">J</span></a></span><span> </span><span id="local-6989586621679198679"><span class="annot"><span class="annottext">f (f a)
</span><a href="#local-6989586621679198679"><span class="hs-identifier hs-var">ffx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">J f a -&gt; PreNatMap (J f) f -&gt; Maybe (f a)
forall a (f :: * -&gt; *) (g :: * -&gt; *).
(Eq a, Ord (f Ignored), Foldable f, Functor g) =&gt;
f a -&gt; PreNatMap f g -&gt; Maybe (g a)
</span><span class="hs-identifier hs-var">PNM.match</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f (f a) -&gt; J f a
forall (f :: * -&gt; *) x. f (f x) -&gt; J f x
</span><a href="MonadGen2.html#J"><span class="hs-identifier hs-var">J</span></a></span><span> </span><span class="annot"><span class="annottext">f (f a)
</span><a href="#local-6989586621679198679"><span class="hs-identifier hs-var">ffx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PreNatMap (J f) f
</span><a href="#local-6989586621679198663"><span class="hs-identifier hs-var">pnm</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-169"></span><span>      </span><span class="annot"><span class="annottext">Maybe (f a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LHS f k (Term (LHS f k) (f a)) -&gt; Term (LHS f k) (f a)
forall (f :: * -&gt; *) a. f (Term f a) -&gt; Term f a
</span><span class="hs-identifier hs-var">fun</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f (Term (LHS f k) (f a)) -&gt; LHS f k (Term (LHS f k) (f a))
forall (f :: * -&gt; *) k r. f r -&gt; LHS f k r
</span><a href="MonadGen2.html#Join"><span class="hs-identifier hs-var">Join</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a -&gt; Term (LHS f k) (f a)
forall a (f :: * -&gt; *). a -&gt; Term f a
</span><span class="hs-identifier hs-var">con</span></span><span> </span><span class="annot"><span class="annottext">(f a -&gt; Term (LHS f k) (f a))
-&gt; f (f a) -&gt; f (Term (LHS f k) (f a))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (f a)
</span><a href="#local-6989586621679198679"><span class="hs-identifier hs-var">ffx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679198681"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679198681"><span class="hs-identifier hs-var">fx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f a -&gt; Term (LHS f k) (f a)
forall a (f :: * -&gt; *). a -&gt; Term f a
</span><span class="hs-identifier hs-var">con</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679198681"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-171"></span><span>    </span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><a href="#local-6989586621679198682"><span class="hs-identifier hs-type">getCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonadGen2.html#JTerm"><span class="hs-identifier hs-type">JTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197783"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679197783"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>    </span><span id="local-6989586621679198682"><span class="annot"><span class="annottext">getCon :: JTerm f -&gt; Maybe (f Int)
</span><a href="#local-6989586621679198682"><span class="hs-identifier hs-var hs-var">getCon</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span> </span><span id="local-6989586621679198683"><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679198683"><span class="hs-identifier hs-var">fi</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f Int -&gt; Maybe (f Int)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679198683"><span class="hs-identifier hs-var">fi</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><a href="#local-6989586621679198682"><span class="hs-identifier hs-var">getCon</span></a></span><span> </span><span class="annot"><span class="annottext">JTerm f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (f Int)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><a href="#local-6989586621679198664"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonadGen2.html#JTerm"><span class="hs-identifier hs-type">JTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197783"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonadGen2.html#JTerm"><span class="hs-identifier hs-type">JTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197783"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span id="local-6989586621679198664"><span class="annot"><span class="annottext">go :: JTerm f -&gt; JTerm f
</span><a href="#local-6989586621679198664"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fix</span></span><span> </span><span id="local-6989586621679198684"><span class="annot"><span class="annottext">L (LHS f (f Int)) (f Int) (JTerm f)
</span><a href="#local-6989586621679198684"><span class="hs-identifier hs-var">lt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">JTerm f -&gt; JTerm f
</span><a href="#local-6989586621679198664"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(JTerm f -&gt; JTerm f)
-&gt; L (LHS f (f Int)) (f Int) (JTerm f)
-&gt; L (LHS f (f Int)) (f Int) (JTerm f)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">L (LHS f (f Int)) (f Int) (JTerm f)
</span><a href="#local-6989586621679198684"><span class="hs-identifier hs-var">lt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-178"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span> </span><span id="local-6989586621679198685"><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679198685"><span class="hs-identifier hs-var">fi</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f Int -&gt; JTerm f
forall a (f :: * -&gt; *). a -&gt; Term f a
</span><span class="hs-identifier hs-var">con</span></span><span> </span><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679198685"><span class="hs-identifier hs-var">fi</span></a></span><span>
</span><span id="line-179"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Fun</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen2.html#Bind"><span class="hs-identifier hs-type">Bind</span></a></span><span> </span><span id="local-6989586621679198687"><span class="annot"><span class="annottext">Vector (f Int)
</span><a href="#local-6989586621679198687"><span class="hs-identifier hs-var">vec</span></a></span></span><span> </span><span id="local-6989586621679198688"><span class="annot"><span class="annottext">JTerm f
</span><a href="#local-6989586621679198688"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">JTerm f -&gt; Maybe (f Int)
</span><a href="#local-6989586621679198682"><span class="hs-identifier hs-var">getCon</span></a></span><span> </span><span class="annot"><span class="annottext">JTerm f
</span><a href="#local-6989586621679198688"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-180"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679198689"><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679198689"><span class="hs-identifier hs-var">fi</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">J f Int -&gt; JTerm f
forall {a} {k}. Eq a =&gt; J f a -&gt; Term (LHS f k) (f a)
</span><a href="#local-6989586621679198678"><span class="hs-identifier hs-var">tryReduceJ</span></a></span><span> </span><span class="annot"><span class="annottext">(J f Int -&gt; JTerm f) -&gt; J f Int -&gt; JTerm f
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f (f Int) -&gt; J f Int
forall (f :: * -&gt; *) x. f (f x) -&gt; J f x
</span><a href="MonadGen2.html#J"><span class="hs-identifier hs-var">J</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (f Int)
</span><a href="#local-6989586621679198687"><span class="hs-identifier hs-var">vec</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (f Int) -&gt; Int -&gt; f Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; f Int) -&gt; f Int -&gt; f (f Int)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f Int
</span><a href="#local-6989586621679198689"><span class="hs-identifier hs-var">fi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>        </span><span class="annot"><span class="annottext">Maybe (f Int)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LHS f (f Int) (JTerm f) -&gt; JTerm f
forall (f :: * -&gt; *) a. f (Term f a) -&gt; Term f a
</span><span class="hs-identifier hs-var">fun</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (f Int) -&gt; JTerm f -&gt; LHS f (f Int) (JTerm f)
forall (f :: * -&gt; *) k r. Vector k -&gt; r -&gt; LHS f k r
</span><a href="MonadGen2.html#Bind"><span class="hs-identifier hs-var">Bind</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (f Int)
</span><a href="#local-6989586621679198687"><span class="hs-identifier hs-var">vec</span></a></span><span> </span><span class="annot"><span class="annottext">JTerm f
</span><a href="#local-6989586621679198688"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Fun</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonadGen2.html#Join"><span class="hs-identifier hs-type">Join</span></a></span><span> </span><span id="local-6989586621679198690"><span class="annot"><span class="annottext">f (JTerm f)
</span><a href="#local-6989586621679198690"><span class="hs-identifier hs-var">fr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(JTerm f -&gt; Maybe (f Int)) -&gt; f (JTerm f) -&gt; Maybe (f (f Int))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; f a -&gt; f (f b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">JTerm f -&gt; Maybe (f Int)
</span><a href="#local-6989586621679198682"><span class="hs-identifier hs-var">getCon</span></a></span><span> </span><span class="annot"><span class="annottext">f (JTerm f)
</span><a href="#local-6989586621679198690"><span class="hs-identifier hs-var">fr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679198691"><span class="annot"><span class="annottext">f (f Int)
</span><a href="#local-6989586621679198691"><span class="hs-identifier hs-var">ffi</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">J f Int -&gt; JTerm f
forall {a} {k}. Eq a =&gt; J f a -&gt; Term (LHS f k) (f a)
</span><a href="#local-6989586621679198678"><span class="hs-identifier hs-var">tryReduceJ</span></a></span><span> </span><span class="annot"><span class="annottext">(J f Int -&gt; JTerm f) -&gt; J f Int -&gt; JTerm f
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f (f Int) -&gt; J f Int
forall (f :: * -&gt; *) x. f (f x) -&gt; J f x
</span><a href="MonadGen2.html#J"><span class="hs-identifier hs-var">J</span></a></span><span> </span><span class="annot"><span class="annottext">f (f Int)
</span><a href="#local-6989586621679198691"><span class="hs-identifier hs-var">ffi</span></a></span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><span class="annottext">Maybe (f (f Int))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LHS f (f Int) (JTerm f) -&gt; JTerm f
forall (f :: * -&gt; *) a. f (Term f a) -&gt; Term f a
</span><span class="hs-identifier hs-var">fun</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f (JTerm f) -&gt; LHS f (f Int) (JTerm f)
forall (f :: * -&gt; *) k r. f r -&gt; LHS f k r
</span><a href="MonadGen2.html#Join"><span class="hs-identifier hs-var">Join</span></a></span><span> </span><span class="annot"><span class="annottext">f (JTerm f)
</span><a href="#local-6989586621679198690"><span class="hs-identifier hs-var">fr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span id="local-6989586621679197762"><span id="local-6989586621679197763"><span class="annot"><a href="MonadGen2.html#separateFunctor"><span class="hs-identifier hs-type">separateFunctor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679197762"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679197763"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679197762"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197763"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679197763"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679197762"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-187"></span><span id="separateFunctor"><span class="annot"><span class="annottext">separateFunctor :: forall (g :: * -&gt; *) a.
(Traversable g, Ord a) =&gt;
g a -&gt; (Vector a, g Int)
</span><a href="MonadGen2.html#separateFunctor"><span class="hs-identifier hs-var hs-var">separateFunctor</span></a></span></span><span> </span><span id="local-6989586621679198697"><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679198697"><span class="hs-identifier hs-var">ga</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Vector a
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g a -&gt; [a]
forall a. g a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679198697"><span class="hs-identifier hs-var">ga</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">g a -&gt; g Int
forall (t :: * -&gt; *) a. Traversable t =&gt; t a -&gt; t Int
</span><a href="Data.Traversable.Extra.html#indices"><span class="hs-identifier hs-var">indices</span></a></span><span> </span><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679198697"><span class="hs-identifier hs-var">ga</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span></pre></body></html>