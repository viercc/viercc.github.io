<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE NoStarIsType #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE EmptyCase #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE InstanceSigs #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE PolyKinds #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeSynonymInstances #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE DerivingVia #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE EmptyDataDeriving #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# OPTIONS_GHC -fplugin GHC.TypeLits.Normalise #-}</span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Functor.Polynomial.Class</span><span class="hs-special">(</span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier">Polynomial</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Identity</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Identity</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Const</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Sum</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Product</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Compose</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Day</span></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Coerce</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">coerce</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Type.Equality</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(:~:)</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Finitary</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector.Sized</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SV</span></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Functor.Pow.html"><span class="hs-identifier">Data.Functor.Pow</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html"><span class="hs-identifier">Data.Functor.Polynomial.Tag</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.html"><span class="hs-identifier">Data.Functor.Polynomial</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Void</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.GADT.HasFinitary.html"><span class="hs-identifier">Data.GADT.HasFinitary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GADT.HasFinitary.html#toInhabitants"><span class="hs-identifier">toInhabitants</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeNats.Extra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SNat</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SNat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-comment">-- | A class for 'Functor' which can be represented as 'Poly'.</span><span>
</span><span id="line-46"></span><span class="hs-comment">--   </span><span>
</span><span id="line-47"></span><span class="hs-comment">--   'toPoly' and 'fromPoly' are isomorphisms.</span><span>
</span><span id="line-48"></span><span class="hs-comment">--   </span><span>
</span><span id="line-49"></span><span class="hs-comment">--   &gt; toPoly . fromPoly = id</span><span>
</span><span id="line-50"></span><span class="hs-comment">--   &gt; fromPoly . toPoly = id</span><span>
</span><span id="line-51"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679134140"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="Polynomial"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-var">Polynomial</span></a></span></span><span> </span><span id="local-6989586621679134140"><span class="annot"><a href="#local-6989586621679134140"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span id="local-6989586621679134140"><span class="annot"><a href="#local-6989586621679134140"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span>  </span><span id="toPoly"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-type">toPoly</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679134143"><span class="annot"><a href="#local-6989586621679134140"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134143"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134140"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679134143"><span class="hs-identifier hs-type">x</span></a></span></span><span>
</span><span id="line-55"></span><span>  </span><span id="fromPoly"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-type">fromPoly</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679134146"><span class="annot"><a href="Data.Functor.Polynomial.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134140"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679134146"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679134140"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134146"><span class="hs-identifier hs-type">x</span></a></span></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679134147"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-&gt;</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679134147"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-&gt;</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679134147"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-operator hs-type">(:~:)</span></span><span> </span><span class="annot"><a href="#local-6989586621679134147"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span>  </span><span id="local-6989586621679134544"><span class="annot"><span class="annottext">toPoly :: forall x. (r -&gt; x) -&gt; Poly (Tag ((-&gt;) r)) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(r :~: r) -&gt; (r -&gt; x) -&gt; Poly ((:~:) r) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">r :~: r
forall {k} (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span>
</span><span id="line-61"></span><span>  </span><span id="local-6989586621679134547"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly (Tag ((-&gt;) r)) x -&gt; r -&gt; x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><span class="annottext">r :~: n
Tag ((-&gt;) r) n
</span><span class="hs-identifier hs-var">Refl</span></span><span> </span><span id="local-6989586621679134549"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134549"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; x
n -&gt; x
</span><a href="#local-6989586621679134549"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">---- Instances ----</span><span>
</span><span id="line-64"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagMaybe"><span class="hs-identifier hs-type">TagMaybe</span></a></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>  </span><span id="local-6989586621679134556"><span class="annot"><span class="annottext">toPoly :: forall x. Maybe x -&gt; Poly (Tag Maybe) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span id="local-6989586621679134557"><span class="annot"><span class="annottext">Maybe x
</span><a href="#local-6989586621679134557"><span class="hs-identifier hs-var">mx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe x
</span><a href="#local-6989586621679134557"><span class="hs-identifier hs-var">mx</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="annottext">Maybe x
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TagMaybe Void -&gt; (Void -&gt; x) -&gt; Poly TagMaybe x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">TagMaybe Void
</span><a href="Data.Functor.Polynomial.Tag.html#TagNothing"><span class="hs-identifier hs-var">TagNothing</span></a></span><span> </span><span class="annot"><span class="annottext">Void -&gt; x
forall a. Void -&gt; a
</span><span class="hs-identifier hs-var">absurd</span></span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679134560"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679134560"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TagMaybe () -&gt; (() -&gt; x) -&gt; Poly TagMaybe x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">TagMaybe ()
</span><a href="Data.Functor.Polynomial.Tag.html#TagJust"><span class="hs-identifier hs-var">TagJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; () -&gt; x
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679134560"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>  </span><span id="local-6989586621679134563"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly (Tag Maybe) x -&gt; Maybe x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679134564"><span class="annot"><span class="annottext">Tag Maybe n
</span><a href="#local-6989586621679134564"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621679134565"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134565"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Tag Maybe n
</span><a href="#local-6989586621679134564"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><span class="annottext">TagMaybe n
Tag Maybe n
</span><a href="Data.Functor.Polynomial.Tag.html#TagNothing"><span class="hs-identifier hs-var">TagNothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe x
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><span class="annottext">TagMaybe n
Tag Maybe n
</span><a href="Data.Functor.Polynomial.Tag.html#TagJust"><span class="hs-identifier hs-var">TagJust</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x -&gt; Maybe x
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134565"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagList"><span class="hs-identifier hs-type">TagList</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span>  </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-type">toPoly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679134165"><span class="annot"><a href="#local-6989586621679134165"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679134165"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagList"><span class="hs-identifier hs-type">TagList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134165"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-78"></span><span>  </span><span id="local-6989586621679134574"><span class="annot"><span class="annottext">toPoly :: forall x. [x] -&gt; Poly TagList x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span id="local-6989586621679134575"><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679134575"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[x]
-&gt; (forall {n :: Nat}. KnownNat n =&gt; Vector n x -&gt; Poly TagList x)
-&gt; Poly TagList x
forall a r.
[a] -&gt; (forall (n :: Nat). KnownNat n =&gt; Vector n a -&gt; r) -&gt; r
</span><span class="hs-identifier hs-var">SV.withSizedList</span></span><span> </span><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679134575"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">((forall {n :: Nat}. KnownNat n =&gt; Vector n x -&gt; Poly TagList x)
 -&gt; Poly TagList x)
-&gt; (forall {n :: Nat}. KnownNat n =&gt; Vector n x -&gt; Poly TagList x)
-&gt; Poly TagList x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679134579"><span class="annot"><span class="annottext">Vector n x
</span><a href="#local-6989586621679134579"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TagList (Finite Integer n)
-&gt; (Finite Integer n -&gt; x) -&gt; Poly TagList x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">TagList (Finite Integer n)
forall (n :: Nat). KnownNat n =&gt; TagList (Finite Integer n)
</span><a href="Data.Functor.Polynomial.Tag.html#TagList"><span class="hs-identifier hs-var">TagList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector n x -&gt; Finite Integer n -&gt; x
forall (n :: Nat) a. Vector n a -&gt; Finite n -&gt; a
</span><span class="hs-identifier hs-var">SV.index</span></span><span> </span><span class="annot"><span class="annottext">Vector n x
</span><a href="#local-6989586621679134579"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-type">fromPoly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679134184"><span class="annot"><a href="#local-6989586621679134184"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagList"><span class="hs-identifier hs-type">TagList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134184"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679134184"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-81"></span><span>  </span><span id="local-6989586621679134582"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly TagList x -&gt; [x]
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679134586"><span class="annot"><span class="annottext">TagList n
</span><a href="#local-6989586621679134586"><span class="hs-identifier hs-var">sn</span></a></span></span><span> </span><span id="local-6989586621679134587"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134587"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134587"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(n -&gt; x) -&gt; [n] -&gt; [x]
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TagList n -&gt; [n]
forall (tag :: Type -&gt; Type) a. HasFinitary tag =&gt; tag a -&gt; [a]
</span><a href="Data.GADT.HasFinitary.html#toInhabitants"><span class="hs-identifier hs-var">toInhabitants</span></a></span><span> </span><span class="annot"><span class="annottext">TagList n
</span><a href="#local-6989586621679134586"><span class="hs-identifier hs-var">sn</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">V1</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">V1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagV"><span class="hs-identifier hs-type">TagV</span></a></span><span>
</span><span id="line-85"></span><span>  </span><span id="local-6989586621679134596"><span class="annot"><span class="annottext">toPoly :: forall x. V1 x -&gt; Poly (Tag V1) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span id="local-6989586621679134597"><span class="annot"><span class="annottext">V1 x
</span><a href="#local-6989586621679134597"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">V1 x
</span><a href="#local-6989586621679134597"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-86"></span><span>  </span><span id="local-6989586621679134598"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly (Tag V1) x -&gt; V1 x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679134599"><span class="annot"><span class="annottext">Tag V1 n
</span><a href="#local-6989586621679134599"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Tag V1 n
</span><a href="#local-6989586621679134599"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">U1</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">U1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagFn"><span class="hs-identifier hs-type">TagFn</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span>  </span><span id="local-6989586621679134607"><span class="annot"><span class="annottext">toPoly :: forall x. U1 x -&gt; Poly (Tag U1) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span class="annot"><span class="annottext">U1 x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Void :~: Void) -&gt; (Void -&gt; x) -&gt; Poly ((:~:) Void) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">Void :~: Void
forall {k} (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span> </span><span class="annot"><span class="annottext">Void -&gt; x
forall a. Void -&gt; a
</span><span class="hs-identifier hs-var">absurd</span></span><span>
</span><span id="line-92"></span><span>  </span><span id="local-6989586621679134608"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly (Tag U1) x -&gt; U1 x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span class="annot"><span class="annottext">Poly (Tag U1) x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">U1 x
forall k (p :: k). U1 p
</span><span class="hs-identifier hs-var">U1</span></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagFn"><span class="hs-identifier hs-type">TagFn</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>  </span><span id="local-6989586621679134616"><span class="annot"><span class="annottext">toPoly :: forall x. Proxy x -&gt; Poly (Tag Proxy) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Void :~: Void) -&gt; (Void -&gt; x) -&gt; Poly ((:~:) Void) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">Void :~: Void
forall {k} (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span> </span><span class="annot"><span class="annottext">Void -&gt; x
forall a. Void -&gt; a
</span><span class="hs-identifier hs-var">absurd</span></span><span>
</span><span id="line-98"></span><span>  </span><span id="local-6989586621679134617"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly (Tag Proxy) x -&gt; Proxy x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span class="annot"><span class="annottext">Poly (Tag Proxy) x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy x
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679134207"><span id="local-6989586621679134208"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><a href="#local-6989586621679134207"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134208"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><a href="#local-6989586621679134207"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134208"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagK"><span class="hs-identifier hs-type">TagK</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134208"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span>  </span><span id="local-6989586621679134625"><span class="annot"><span class="annottext">toPoly :: forall x. K1 i c x -&gt; Poly (Tag (K1 i c)) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span id="local-6989586621679134627"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679134627"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TagK c Void -&gt; (Void -&gt; x) -&gt; Poly (TagK c) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; TagK c Void
forall c. c -&gt; TagK c Void
</span><a href="Data.Functor.Polynomial.Tag.html#TagK"><span class="hs-identifier hs-var">TagK</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679134627"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Void -&gt; x
forall a. Void -&gt; a
</span><span class="hs-identifier hs-var">absurd</span></span><span>
</span><span id="line-104"></span><span>  </span><span id="local-6989586621679134629"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly (Tag (K1 i c)) x -&gt; K1 i c x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagK"><span class="hs-identifier hs-type">TagK</span></a></span><span> </span><span id="local-6989586621679134631"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679134631"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">c -&gt; K1 i c x
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679134631"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679134220"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="annot"><a href="#local-6989586621679134220"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="annot"><a href="#local-6989586621679134220"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagK"><span class="hs-identifier hs-type">TagK</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134220"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621679134638"><span class="annot"><span class="annottext">toPoly :: forall x. Const c x -&gt; Poly (Tag (Const c)) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span id="local-6989586621679134640"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679134640"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TagK c Void -&gt; (Void -&gt; x) -&gt; Poly (TagK c) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; TagK c Void
forall c. c -&gt; TagK c Void
</span><a href="Data.Functor.Polynomial.Tag.html#TagK"><span class="hs-identifier hs-var">TagK</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679134640"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Void -&gt; x
forall a. Void -&gt; a
</span><span class="hs-identifier hs-var">absurd</span></span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621679134641"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly (Tag (Const c)) x -&gt; Const c x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagK"><span class="hs-identifier hs-type">TagK</span></a></span><span> </span><span id="local-6989586621679134643"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679134643"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">c -&gt; Const c x
forall {k} a (b :: k). a -&gt; Const a b
</span><span class="hs-identifier hs-var">Const</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679134643"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679134234"><span id="local-6989586621679134235"><span id="local-6989586621679134236"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134234"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M1</span></span><span> </span><span class="annot"><a href="#local-6989586621679134235"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134236"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134234"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M1</span></span><span> </span><span class="annot"><a href="#local-6989586621679134235"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134236"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134234"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134234"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-114"></span><span>  </span><span id="local-6989586621679134653"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly (Tag (M1 i c f)) x -&gt; M1 i c f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f x -&gt; M1 i c f x
forall k i (c :: Meta) (f :: k -&gt; Type) (p :: k). f p -&gt; M1 i c f p
</span><span class="hs-identifier hs-var">M1</span></span><span> </span><span class="annot"><span class="annottext">(f x -&gt; M1 i c f x)
-&gt; (Poly (Tag f) x -&gt; f x) -&gt; Poly (Tag f) x -&gt; M1 i c f x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Poly (Tag f) x -&gt; f x
forall x. Poly (Tag f) x -&gt; f x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; Poly (Tag f) x -&gt; f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var">fromPoly</span></a></span><span>
</span><span id="line-115"></span><span>  </span><span id="local-6989586621679134657"><span class="annot"><span class="annottext">toPoly :: forall x. M1 i c f x -&gt; Poly (Tag (M1 i c f)) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f x -&gt; Poly (Tag f) x
forall x. f x -&gt; Poly (Tag f) x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; f x -&gt; Poly (Tag f) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="annot"><span class="annottext">(f x -&gt; Poly (Tag f) x)
-&gt; (M1 i c f x -&gt; f x) -&gt; M1 i c f x -&gt; Poly (Tag f) x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">M1 i c f x -&gt; f x
forall k i (c :: Meta) (f :: k -&gt; Type) (p :: k). M1 i c f p -&gt; f p
</span><span class="hs-identifier hs-var">unM1</span></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679134254"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134254"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rec1</span></span><span> </span><span class="annot"><a href="#local-6989586621679134254"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rec1</span></span><span> </span><span class="annot"><a href="#local-6989586621679134254"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134254"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-119"></span><span>  </span><span id="local-6989586621679134668"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly (Tag (Rec1 f)) x -&gt; Rec1 f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f x -&gt; Rec1 f x
forall k (f :: k -&gt; Type) (p :: k). f p -&gt; Rec1 f p
</span><span class="hs-identifier hs-var">Rec1</span></span><span> </span><span class="annot"><span class="annottext">(f x -&gt; Rec1 f x)
-&gt; (Poly (Tag f) x -&gt; f x) -&gt; Poly (Tag f) x -&gt; Rec1 f x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Poly (Tag f) x -&gt; f x
forall x. Poly (Tag f) x -&gt; f x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; Poly (Tag f) x -&gt; f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var">fromPoly</span></a></span><span>
</span><span id="line-120"></span><span>  </span><span id="local-6989586621679134671"><span class="annot"><span class="annottext">toPoly :: forall x. Rec1 f x -&gt; Poly (Tag (Rec1 f)) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f x -&gt; Poly (Tag f) x
forall x. f x -&gt; Poly (Tag f) x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; f x -&gt; Poly (Tag f) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="annot"><span class="annottext">(f x -&gt; Poly (Tag f) x)
-&gt; (Rec1 f x -&gt; f x) -&gt; Rec1 f x -&gt; Poly (Tag f) x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rec1 f x -&gt; f x
forall k (f :: k -&gt; Type) (p :: k). Rec1 f p -&gt; f p
</span><span class="hs-identifier hs-var">unRec1</span></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Par1</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Par1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagFn"><span class="hs-identifier hs-type">TagFn</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621679134679"><span class="annot"><span class="annottext">toPoly :: forall x. Par1 x -&gt; Poly (Tag Par1) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Par1</span></span><span> </span><span id="local-6989586621679134681"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679134681"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :~: ()) -&gt; (() -&gt; x) -&gt; Poly ((:~:) ()) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">() :~: ()
forall {k} (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; () -&gt; x
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679134681"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>  </span><span id="local-6989586621679134682"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly (Tag Par1) x -&gt; Par1 x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><span class="annottext">() :~: n
Tag Par1 n
</span><span class="hs-identifier hs-var">Refl</span></span><span> </span><span id="local-6989586621679134684"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134684"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">x -&gt; Par1 x
forall p. p -&gt; Par1 p
</span><span class="hs-identifier hs-var">Par1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134684"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagFn"><span class="hs-identifier hs-type">TagFn</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span>  </span><span id="local-6989586621679134691"><span class="annot"><span class="annottext">toPoly :: forall x. Identity x -&gt; Poly (Tag Identity) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span id="local-6989586621679134693"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679134693"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :~: ()) -&gt; (() -&gt; x) -&gt; Poly ((:~:) ()) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">() :~: ()
forall {k} (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; () -&gt; x
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679134693"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>  </span><span id="local-6989586621679134694"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly (Tag Identity) x -&gt; Identity x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><span class="annottext">() :~: n
Tag Identity n
</span><span class="hs-identifier hs-var">Refl</span></span><span> </span><span id="local-6989586621679134696"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134696"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">x -&gt; Identity x
forall a. a -&gt; Identity a
</span><span class="hs-identifier hs-var">Identity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134696"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679134276"><span id="local-6989586621679134277"><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134276"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134277"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679134276"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+:</span></span><span> </span><span class="annot"><a href="#local-6989586621679134277"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679134276"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+:</span></span><span> </span><span class="annot"><a href="#local-6989586621679134277"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagSum"><span class="hs-identifier hs-type">TagSum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134276"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134277"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span>  </span><span id="local-6989586621679134709"><span class="annot"><span class="annottext">toPoly :: forall x. (:+:) f g x -&gt; Poly (Tag (f :+: g)) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">L1</span></span><span> </span><span id="local-6989586621679134711"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679134711"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">f x -&gt; Poly (Tag f) x
forall x. f x -&gt; Poly (Tag f) x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; f x -&gt; Poly (Tag f) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679134711"><span class="hs-identifier hs-var">fx</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679134712"><span class="annot"><span class="annottext">Tag f n
</span><a href="#local-6989586621679134712"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621679134713"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134713"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(:+:) (Tag f) (Tag g) n -&gt; (n -&gt; x) -&gt; Poly (Tag f :+: Tag g) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tag f n -&gt; (:+:) (Tag f) (Tag g) n
forall k (f :: k -&gt; Type) (g :: k -&gt; Type) (p :: k).
f p -&gt; (:+:) f g p
</span><span class="hs-identifier hs-var">L1</span></span><span> </span><span class="annot"><span class="annottext">Tag f n
</span><a href="#local-6989586621679134712"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134713"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">R1</span></span><span> </span><span id="local-6989586621679134715"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679134715"><span class="hs-identifier hs-var">gx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">g x -&gt; Poly (Tag g) x
forall x. g x -&gt; Poly (Tag g) x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; f x -&gt; Poly (Tag f) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679134715"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679134716"><span class="annot"><span class="annottext">Tag g n
</span><a href="#local-6989586621679134716"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621679134717"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134717"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(:+:) (Tag f) (Tag g) n -&gt; (n -&gt; x) -&gt; Poly (Tag f :+: Tag g) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tag g n -&gt; (:+:) (Tag f) (Tag g) n
forall k (f :: k -&gt; Type) (g :: k -&gt; Type) (p :: k).
g p -&gt; (:+:) f g p
</span><span class="hs-identifier hs-var">R1</span></span><span> </span><span class="annot"><span class="annottext">Tag g n
</span><a href="#local-6989586621679134716"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134717"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621679134718"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly (Tag (f :+: g)) x -&gt; (:+:) f g x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">L1</span></span><span> </span><span id="local-6989586621679134720"><span class="annot"><span class="annottext">Tag f n
</span><a href="#local-6989586621679134720"><span class="hs-identifier hs-var">tag</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679134721"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134721"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f x -&gt; (:+:) f g x
forall k (f :: k -&gt; Type) (g :: k -&gt; Type) (p :: k).
f p -&gt; (:+:) f g p
</span><span class="hs-identifier hs-var">L1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly (Tag f) x -&gt; f x
forall x. Poly (Tag f) x -&gt; f x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; Poly (Tag f) x -&gt; f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var">fromPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tag f n -&gt; (n -&gt; x) -&gt; Poly (Tag f) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">Tag f n
</span><a href="#local-6989586621679134720"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134721"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var">fromPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">R1</span></span><span> </span><span id="local-6989586621679134723"><span class="annot"><span class="annottext">Tag g n
</span><a href="#local-6989586621679134723"><span class="hs-identifier hs-var">tag</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679134724"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134724"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g x -&gt; (:+:) f g x
forall k (f :: k -&gt; Type) (g :: k -&gt; Type) (p :: k).
g p -&gt; (:+:) f g p
</span><span class="hs-identifier hs-var">R1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly (Tag g) x -&gt; g x
forall x. Poly (Tag g) x -&gt; g x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; Poly (Tag f) x -&gt; f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var">fromPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tag g n -&gt; (n -&gt; x) -&gt; Poly (Tag g) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">Tag g n
</span><a href="#local-6989586621679134723"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134724"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679134293"><span id="local-6989586621679134294"><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134293"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134294"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Sum</span></span><span> </span><span class="annot"><a href="#local-6989586621679134293"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134294"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Sum</span></span><span> </span><span class="annot"><a href="#local-6989586621679134293"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134294"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagSum"><span class="hs-identifier hs-type">TagSum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134293"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134294"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span>  </span><span id="local-6989586621679134736"><span class="annot"><span class="annottext">toPoly :: forall x. Sum f g x -&gt; Poly (Tag (Sum f g)) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(:+:) f g x -&gt; Poly (TagSum (Tag f) (Tag g)) x
(:+:) f g x -&gt; Poly (Tag (f :+: g)) x
forall x. (:+:) f g x -&gt; Poly (Tag (f :+: g)) x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; f x -&gt; Poly (Tag f) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="annot"><span class="annottext">((:+:) f g x -&gt; Poly (TagSum (Tag f) (Tag g)) x)
-&gt; (Sum f g x -&gt; (:+:) f g x)
-&gt; Sum f g x
-&gt; Poly (TagSum (Tag f) (Tag g)) x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Sum f g x -&gt; (:+:) f g x
forall {k} {f :: k -&gt; Type} {g :: k -&gt; Type} {p :: k}.
Sum f g p -&gt; (:+:) f g p
</span><a href="#local-6989586621679134737"><span class="hs-identifier hs-var">toGenerics</span></a></span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-150"></span><span>      </span><span id="local-6989586621679134737"><span class="annot"><span class="annottext">toGenerics :: Sum f g p -&gt; (:+:) f g p
</span><a href="#local-6989586621679134737"><span class="hs-identifier hs-var hs-var">toGenerics</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InL</span></span><span> </span><span id="local-6989586621679134739"><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679134739"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f p -&gt; (:+:) f g p
forall k (f :: k -&gt; Type) (g :: k -&gt; Type) (p :: k).
f p -&gt; (:+:) f g p
</span><span class="hs-identifier hs-var">L1</span></span><span> </span><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679134739"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-151"></span><span>      </span><span class="annot"><a href="#local-6989586621679134737"><span class="hs-identifier hs-var">toGenerics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InR</span></span><span> </span><span id="local-6989586621679134741"><span class="annot"><span class="annottext">g p
</span><a href="#local-6989586621679134741"><span class="hs-identifier hs-var">gx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g p -&gt; (:+:) f g p
forall k (f :: k -&gt; Type) (g :: k -&gt; Type) (p :: k).
g p -&gt; (:+:) f g p
</span><span class="hs-identifier hs-var">R1</span></span><span> </span><span class="annot"><span class="annottext">g p
</span><a href="#local-6989586621679134741"><span class="hs-identifier hs-var">gx</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span>  </span><span id="local-6989586621679134743"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly (Tag (Sum f g)) x -&gt; Sum f g x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(:+:) f g x -&gt; Sum f g x
forall {k} {f :: k -&gt; Type} {g :: k -&gt; Type} {a :: k}.
(:+:) f g a -&gt; Sum f g a
</span><a href="#local-6989586621679134744"><span class="hs-identifier hs-var">fromGenerics</span></a></span><span> </span><span class="annot"><span class="annottext">((:+:) f g x -&gt; Sum f g x)
-&gt; (Poly (TagSum (Tag f) (Tag g)) x -&gt; (:+:) f g x)
-&gt; Poly (TagSum (Tag f) (Tag g)) x
-&gt; Sum f g x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Poly (TagSum (Tag f) (Tag g)) x -&gt; (:+:) f g x
Poly (Tag (f :+: g)) x -&gt; (:+:) f g x
forall x. Poly (Tag (f :+: g)) x -&gt; (:+:) f g x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; Poly (Tag f) x -&gt; f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var">fromPoly</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-155"></span><span>      </span><span id="local-6989586621679134744"><span class="annot"><span class="annottext">fromGenerics :: (:+:) f g a -&gt; Sum f g a
</span><a href="#local-6989586621679134744"><span class="hs-identifier hs-var hs-var">fromGenerics</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">L1</span></span><span> </span><span id="local-6989586621679134745"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679134745"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f a -&gt; Sum f g a
forall {k} (f :: k -&gt; Type) (g :: k -&gt; Type) (a :: k).
f a -&gt; Sum f g a
</span><span class="hs-identifier hs-var">InL</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679134745"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-156"></span><span>      </span><span class="annot"><a href="#local-6989586621679134744"><span class="hs-identifier hs-var">fromGenerics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">R1</span></span><span> </span><span id="local-6989586621679134746"><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679134746"><span class="hs-identifier hs-var">gx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g a -&gt; Sum f g a
forall {k} (f :: k -&gt; Type) (g :: k -&gt; Type) (a :: k).
g a -&gt; Sum f g a
</span><span class="hs-identifier hs-var">InR</span></span><span> </span><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679134746"><span class="hs-identifier hs-var">gx</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679134314"><span id="local-6989586621679134315"><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134314"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134315"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679134314"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span class="annot"><a href="#local-6989586621679134315"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679134314"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span class="annot"><a href="#local-6989586621679134315"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagMul"><span class="hs-identifier hs-type">TagMul</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134314"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134315"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span>  </span><span id="local-6989586621679134759"><span class="annot"><span class="annottext">toPoly :: forall x. (:*:) f g x -&gt; Poly (Tag (f :*: g)) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679134760"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679134760"><span class="hs-identifier hs-var">fx</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span id="local-6989586621679134762"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679134762"><span class="hs-identifier hs-var">gx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f x -&gt; Poly (Tag f) x
forall x. f x -&gt; Poly (Tag f) x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; f x -&gt; Poly (Tag f) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679134760"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">g x -&gt; Poly (Tag g) x
forall x. g x -&gt; Poly (Tag g) x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; f x -&gt; Poly (Tag f) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679134762"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-163"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679134763"><span class="annot"><span class="annottext">Tag f n
</span><a href="#local-6989586621679134763"><span class="hs-identifier hs-var">tagF</span></a></span></span><span> </span><span id="local-6989586621679134764"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134764"><span class="hs-identifier hs-var">repF</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679134765"><span class="annot"><span class="annottext">Tag g n
</span><a href="#local-6989586621679134765"><span class="hs-identifier hs-var">tagG</span></a></span></span><span> </span><span id="local-6989586621679134766"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134766"><span class="hs-identifier hs-var">repG</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-164"></span><span>        </span><span class="annot"><span class="annottext">TagMul (Tag f) (Tag g) (Either n n)
-&gt; (Either n n -&gt; x) -&gt; Poly (TagMul (Tag f) (Tag g)) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tag f n -&gt; Tag g n -&gt; TagMul (Tag f) (Tag g) (Either n n)
forall (f :: Type -&gt; Type) x1 (g :: Type -&gt; Type) y.
f x1 -&gt; g y -&gt; TagMul f g (Either x1 y)
</span><a href="Data.Functor.Polynomial.Tag.html#TagMul"><span class="hs-identifier hs-var">TagMul</span></a></span><span> </span><span class="annot"><span class="annottext">Tag f n
</span><a href="#local-6989586621679134763"><span class="hs-identifier hs-var">tagF</span></a></span><span> </span><span class="annot"><span class="annottext">Tag g n
</span><a href="#local-6989586621679134765"><span class="hs-identifier hs-var">tagG</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(n -&gt; x) -&gt; (n -&gt; x) -&gt; Either n n -&gt; x
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134764"><span class="hs-identifier hs-var">repF</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134766"><span class="hs-identifier hs-var">repG</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>  </span><span id="local-6989586621679134769"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly (Tag (f :*: g)) x -&gt; (:*:) f g x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagMul"><span class="hs-identifier hs-type">TagMul</span></a></span><span> </span><span id="local-6989586621679134773"><span class="annot"><span class="annottext">Tag f x1
</span><a href="#local-6989586621679134773"><span class="hs-identifier hs-var">tagF</span></a></span></span><span> </span><span id="local-6989586621679134774"><span class="annot"><span class="annottext">Tag g y
</span><a href="#local-6989586621679134774"><span class="hs-identifier hs-var">tagG</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679134775"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134775"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679134776"><span class="annot"><span class="annottext">pf :: Poly (Tag f) x
</span><a href="#local-6989586621679134776"><span class="hs-identifier hs-var hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tag f x1 -&gt; (x1 -&gt; x) -&gt; Poly (Tag f) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">Tag f x1
</span><a href="#local-6989586621679134773"><span class="hs-identifier hs-var">tagF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134775"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">(n -&gt; x) -&gt; (x1 -&gt; n) -&gt; x1 -&gt; x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">x1 -&gt; n
x1 -&gt; Either x1 y
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>        </span><span id="local-6989586621679134777"><span class="annot"><span class="annottext">pg :: Poly (Tag g) x
</span><a href="#local-6989586621679134777"><span class="hs-identifier hs-var hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tag g y -&gt; (y -&gt; x) -&gt; Poly (Tag g) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">Tag g y
</span><a href="#local-6989586621679134774"><span class="hs-identifier hs-var">tagG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134775"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">(n -&gt; x) -&gt; (y -&gt; n) -&gt; y -&gt; x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">y -&gt; n
y -&gt; Either x1 y
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Poly (Tag f) x -&gt; f x
forall x. Poly (Tag f) x -&gt; f x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; Poly (Tag f) x -&gt; f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var">fromPoly</span></a></span><span> </span><span class="annot"><span class="annottext">Poly (Tag f) x
</span><a href="#local-6989586621679134776"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="annot"><span class="annottext">f x -&gt; g x -&gt; (:*:) f g x
forall k (f :: k -&gt; Type) (g :: k -&gt; Type) (p :: k).
f p -&gt; g p -&gt; (:*:) f g p
</span><span class="hs-operator hs-var">:*:</span></span><span> </span><span class="annot"><span class="annottext">Poly (Tag g) x -&gt; g x
forall x. Poly (Tag g) x -&gt; g x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; Poly (Tag f) x -&gt; f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var">fromPoly</span></a></span><span> </span><span class="annot"><span class="annottext">Poly (Tag g) x
</span><a href="#local-6989586621679134777"><span class="hs-identifier hs-var">pg</span></a></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679134342"><span id="local-6989586621679134343"><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134342"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134343"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Product</span></span><span> </span><span class="annot"><a href="#local-6989586621679134342"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134343"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Product</span></span><span> </span><span class="annot"><a href="#local-6989586621679134342"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134343"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagMul"><span class="hs-identifier hs-type">TagMul</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134342"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134343"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span>  </span><span id="local-6989586621679134789"><span class="annot"><span class="annottext">toPoly :: forall x. Product f g x -&gt; Poly (Tag (Product f g)) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(:*:) f g x -&gt; Poly (TagMul (Tag f) (Tag g)) x
(:*:) f g x -&gt; Poly (Tag (f :*: g)) x
forall x. (:*:) f g x -&gt; Poly (Tag (f :*: g)) x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; f x -&gt; Poly (Tag f) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="annot"><span class="annottext">((:*:) f g x -&gt; Poly (TagMul (Tag f) (Tag g)) x)
-&gt; (Product f g x -&gt; (:*:) f g x)
-&gt; Product f g x
-&gt; Poly (TagMul (Tag f) (Tag g)) x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Product f g x -&gt; (:*:) f g x
forall {k} {f :: k -&gt; Type} {g :: k -&gt; Type} {p :: k}.
Product f g p -&gt; (:*:) f g p
</span><a href="#local-6989586621679134790"><span class="hs-identifier hs-var">toGenerics</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-176"></span><span>      </span><span id="local-6989586621679134790"><span class="annot"><span class="annottext">toGenerics :: Product f g p -&gt; (:*:) f g p
</span><a href="#local-6989586621679134790"><span class="hs-identifier hs-var hs-var">toGenerics</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pair</span></span><span> </span><span id="local-6989586621679134792"><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679134792"><span class="hs-identifier hs-var">fx</span></a></span></span><span> </span><span id="local-6989586621679134793"><span class="annot"><span class="annottext">g p
</span><a href="#local-6989586621679134793"><span class="hs-identifier hs-var">gx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679134792"><span class="hs-identifier hs-var">fx</span></a></span><span> </span><span class="annot"><span class="annottext">f p -&gt; g p -&gt; (:*:) f g p
forall k (f :: k -&gt; Type) (g :: k -&gt; Type) (p :: k).
f p -&gt; g p -&gt; (:*:) f g p
</span><span class="hs-operator hs-var">:*:</span></span><span> </span><span class="annot"><span class="annottext">g p
</span><a href="#local-6989586621679134793"><span class="hs-identifier hs-var">gx</span></a></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span>  </span><span id="local-6989586621679134795"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly (Tag (Product f g)) x -&gt; Product f g x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(:*:) f g x -&gt; Product f g x
forall {k} {f :: k -&gt; Type} {g :: k -&gt; Type} {a :: k}.
(:*:) f g a -&gt; Product f g a
</span><a href="#local-6989586621679134796"><span class="hs-identifier hs-var">fromGenerics</span></a></span><span> </span><span class="annot"><span class="annottext">((:*:) f g x -&gt; Product f g x)
-&gt; (Poly (TagMul (Tag f) (Tag g)) x -&gt; (:*:) f g x)
-&gt; Poly (TagMul (Tag f) (Tag g)) x
-&gt; Product f g x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Poly (TagMul (Tag f) (Tag g)) x -&gt; (:*:) f g x
Poly (Tag (f :*: g)) x -&gt; (:*:) f g x
forall x. Poly (Tag (f :*: g)) x -&gt; (:*:) f g x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; Poly (Tag f) x -&gt; f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var">fromPoly</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>      </span><span id="local-6989586621679134796"><span class="annot"><span class="annottext">fromGenerics :: (:*:) f g a -&gt; Product f g a
</span><a href="#local-6989586621679134796"><span class="hs-identifier hs-var hs-var">fromGenerics</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679134797"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679134797"><span class="hs-identifier hs-var">fx</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span id="local-6989586621679134798"><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679134798"><span class="hs-identifier hs-var">gx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f a -&gt; g a -&gt; Product f g a
forall {k} (f :: k -&gt; Type) (g :: k -&gt; Type) (a :: k).
f a -&gt; g a -&gt; Product f g a
</span><span class="hs-identifier hs-var">Pair</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679134797"><span class="hs-identifier hs-var">fx</span></a></span><span> </span><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679134798"><span class="hs-identifier hs-var">gx</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679134363"><span id="local-6989586621679134364"><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134363"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Pow.html#Pow"><span class="hs-identifier hs-type">Pow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134364"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134363"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Pow.html#Pow"><span class="hs-identifier hs-type">Pow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134364"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134363"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Functor.Pow.html#TagPow"><span class="hs-identifier hs-type">TagPow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134364"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134363"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span>  </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-type">toPoly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679134365"><span class="annot"><a href="#local-6989586621679134365"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.Functor.Pow.html#Pow"><span class="hs-identifier hs-type">Pow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134364"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134363"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134365"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Pow.html#TagPow"><span class="hs-identifier hs-type">TagPow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134364"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134363"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679134365"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span id="local-6989586621679134809"><span class="annot"><span class="annottext">toPoly :: forall x. Pow n f x -&gt; Poly (TagPow n (Tag f)) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span class="annot"><span class="annottext">Pow n f x
</span><a href="Data.Functor.Pow.html#Pow0"><span class="hs-identifier hs-var">Pow0</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TagPow 0 (Tag f) Void -&gt; (Void -&gt; x) -&gt; Poly (TagPow 0 (Tag f)) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">TagPow 0 (Tag f) Void
forall (t :: Type -&gt; Type). TagPow 0 t Void
</span><a href="Data.Functor.Pow.html#TagPow0"><span class="hs-identifier hs-var">TagPow0</span></a></span><span> </span><span class="annot"><span class="annottext">Void -&gt; x
forall a. Void -&gt; a
</span><span class="hs-identifier hs-var">absurd</span></span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Pow.html#PowNZ"><span class="hs-identifier hs-type">PowNZ</span></a></span><span> </span><span id="local-6989586621679134814"><span class="annot"><span class="annottext">Pow' n f x
</span><a href="#local-6989586621679134814"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pow' n f x -&gt; Poly (Tag (Pow' n f)) x
forall x. Pow' n f x -&gt; Poly (Tag (Pow' n f)) x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; f x -&gt; Poly (Tag f) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="annot"><span class="annottext">Pow' n f x
</span><a href="#local-6989586621679134814"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-188"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679134815"><span class="annot"><span class="annottext">Tag (Pow' n f) n
</span><a href="#local-6989586621679134815"><span class="hs-identifier hs-var">tagF</span></a></span></span><span> </span><span id="local-6989586621679134816"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134816"><span class="hs-identifier hs-var">repF</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TagPow n (Tag f) n -&gt; (n -&gt; x) -&gt; Poly (TagPow n (Tag f)) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TagPow' n (Tag f) n -&gt; TagPow n (Tag f) n
forall (n :: Nat) (t :: Type -&gt; Type) xs.
TagPow' n t xs -&gt; TagPow n t xs
</span><a href="Data.Functor.Pow.html#TagPowNZ"><span class="hs-identifier hs-var">TagPowNZ</span></a></span><span> </span><span class="annot"><span class="annottext">TagPow' n (Tag f) n
Tag (Pow' n f) n
</span><a href="#local-6989586621679134815"><span class="hs-identifier hs-var">tagF</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134816"><span class="hs-identifier hs-var">repF</span></a></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-type">fromPoly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679134376"><span class="annot"><a href="#local-6989586621679134376"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Pow.html#TagPow"><span class="hs-identifier hs-type">TagPow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134364"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134363"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679134376"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Pow.html#Pow"><span class="hs-identifier hs-type">Pow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134364"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134363"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134376"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-191"></span><span>  </span><span id="local-6989586621679134818"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly (TagPow n (Tag f)) x -&gt; Pow n f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679134820"><span class="annot"><span class="annottext">TagPow n (Tag f) n
</span><a href="#local-6989586621679134820"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621679134821"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134821"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TagPow n (Tag f) n
</span><a href="#local-6989586621679134820"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><span class="annottext">TagPow n (Tag f) n
</span><a href="Data.Functor.Pow.html#TagPow0"><span class="hs-identifier hs-var">TagPow0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pow n f x
Pow 0 f x
forall {k} (f :: k -&gt; Type) (x :: k). Pow 0 f x
</span><a href="Data.Functor.Pow.html#Pow0"><span class="hs-identifier hs-var">Pow0</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><a href="Data.Functor.Pow.html#TagPowNZ"><span class="hs-identifier hs-type">TagPowNZ</span></a></span><span> </span><span id="local-6989586621679134824"><span class="annot"><span class="annottext">TagPow' n (Tag f) n
</span><a href="#local-6989586621679134824"><span class="hs-identifier hs-var">tagFs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pow' n f x -&gt; Pow n f x
forall {k} (n :: Nat) (f :: k -&gt; Type) (x :: k).
Pow' n f x -&gt; Pow n f x
</span><a href="Data.Functor.Pow.html#PowNZ"><span class="hs-identifier hs-var">PowNZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly (Tag (Pow' n f)) x -&gt; Pow' n f x
forall x. Poly (Tag (Pow' n f)) x -&gt; Pow' n f x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; Poly (Tag f) x -&gt; f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var">fromPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TagPow' n (Tag f) n -&gt; (n -&gt; x) -&gt; Poly (TagPow' n (Tag f)) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">TagPow' n (Tag f) n
</span><a href="#local-6989586621679134824"><span class="hs-identifier hs-var">tagFs</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134821"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679134368"><span id="local-6989586621679134369"><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134368"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Pow.html#Pow%27"><span class="hs-identifier hs-type">Pow'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134369"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134368"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Pow.html#Pow%27"><span class="hs-identifier hs-type">Pow'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134369"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134368"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Functor.Pow.html#TagPow%27"><span class="hs-identifier hs-type">TagPow'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134369"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134368"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-type">toPoly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679134387"><span class="annot"><a href="#local-6989586621679134387"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.Functor.Pow.html#Pow%27"><span class="hs-identifier hs-type">Pow'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134369"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134368"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134387"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Pow.html#TagPow%27"><span class="hs-identifier hs-type">TagPow'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134369"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134368"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679134387"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-199"></span><span>  </span><span id="local-6989586621679134832"><span class="annot"><span class="annottext">toPoly :: forall x. Pow' n f x -&gt; Poly (TagPow' n (Tag f)) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Pow.html#Pow1"><span class="hs-identifier hs-type">Pow1</span></a></span><span> </span><span id="local-6989586621679134836"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679134836"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">f x -&gt; Poly (Tag f) x
forall x. f x -&gt; Poly (Tag f) x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; f x -&gt; Poly (Tag f) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679134836"><span class="hs-identifier hs-var">fx</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679134837"><span class="annot"><span class="annottext">Tag f n
</span><a href="#local-6989586621679134837"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621679134838"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134838"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TagPow' 1 (Tag f) n -&gt; (n -&gt; x) -&gt; Poly (TagPow' 1 (Tag f)) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tag f n -&gt; TagPow' 1 (Tag f) n
forall (t :: Type -&gt; Type) xs. t xs -&gt; TagPow' 1 t xs
</span><a href="Data.Functor.Pow.html#TagPow1"><span class="hs-identifier hs-var">TagPow1</span></a></span><span> </span><span class="annot"><span class="annottext">Tag f n
</span><a href="#local-6989586621679134837"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134838"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Pow.html#PowEven"><span class="hs-identifier hs-type">PowEven</span></a></span><span> </span><span id="local-6989586621679134847"><span class="annot"><span class="annottext">Pow' m f x
</span><a href="#local-6989586621679134847"><span class="hs-identifier hs-var">fs1</span></a></span></span><span> </span><span id="local-6989586621679134848"><span class="annot"><span class="annottext">Pow' m f x
</span><a href="#local-6989586621679134848"><span class="hs-identifier hs-var">fs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pow' m f x -&gt; Poly (Tag (Pow' m f)) x
forall x. Pow' m f x -&gt; Poly (Tag (Pow' m f)) x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; f x -&gt; Poly (Tag f) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="annot"><span class="annottext">Pow' m f x
</span><a href="#local-6989586621679134847"><span class="hs-identifier hs-var">fs1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pow' m f x -&gt; Poly (Tag (Pow' m f)) x
forall x. Pow' m f x -&gt; Poly (Tag (Pow' m f)) x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; f x -&gt; Poly (Tag f) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="annot"><span class="annottext">Pow' m f x
</span><a href="#local-6989586621679134848"><span class="hs-identifier hs-var">fs2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679134849"><span class="annot"><span class="annottext">TagPow' m (Tag f) n
</span><a href="#local-6989586621679134849"><span class="hs-identifier hs-var">tag1</span></a></span></span><span> </span><span id="local-6989586621679134850"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134850"><span class="hs-identifier hs-var">rep1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679134853"><span class="annot"><span class="annottext">TagPow' m (Tag f) n
</span><a href="#local-6989586621679134853"><span class="hs-identifier hs-var">tag2</span></a></span></span><span> </span><span id="local-6989586621679134854"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134854"><span class="hs-identifier hs-var">rep2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TagPow' n (Tag f) (Either n n)
-&gt; (Either n n -&gt; x) -&gt; Poly (TagPow' n (Tag f)) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TagPow' m (Tag f) n
-&gt; TagPow' m (Tag f) n -&gt; TagPow' n (Tag f) (Either n n)
forall (n :: Nat) (m :: Nat) (t :: Type -&gt; Type) xs1 xs2.
(KnownNat n, n ~ (m * 2)) =&gt;
TagPow' m t xs1 -&gt; TagPow' m t xs2 -&gt; TagPow' n t (Either xs1 xs2)
</span><a href="Data.Functor.Pow.html#TagPowEven"><span class="hs-identifier hs-var">TagPowEven</span></a></span><span> </span><span class="annot"><span class="annottext">TagPow' m (Tag f) n
</span><a href="#local-6989586621679134849"><span class="hs-identifier hs-var">tag1</span></a></span><span> </span><span class="annot"><span class="annottext">TagPow' m (Tag f) n
</span><a href="#local-6989586621679134853"><span class="hs-identifier hs-var">tag2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(n -&gt; x) -&gt; (n -&gt; x) -&gt; Either n n -&gt; x
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134850"><span class="hs-identifier hs-var">rep1</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134854"><span class="hs-identifier hs-var">rep2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Pow.html#PowOdd"><span class="hs-identifier hs-type">PowOdd</span></a></span><span> </span><span id="local-6989586621679134864"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679134864"><span class="hs-identifier hs-var">fx</span></a></span></span><span> </span><span id="local-6989586621679134865"><span class="annot"><span class="annottext">Pow' m f x
</span><a href="#local-6989586621679134865"><span class="hs-identifier hs-var">fs1</span></a></span></span><span> </span><span id="local-6989586621679134866"><span class="annot"><span class="annottext">Pow' m f x
</span><a href="#local-6989586621679134866"><span class="hs-identifier hs-var">fs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f x -&gt; Poly (Tag f) x
forall x. f x -&gt; Poly (Tag f) x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; f x -&gt; Poly (Tag f) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679134864"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pow' m f x -&gt; Poly (Tag (Pow' m f)) x
forall x. Pow' m f x -&gt; Poly (Tag (Pow' m f)) x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; f x -&gt; Poly (Tag f) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="annot"><span class="annottext">Pow' m f x
</span><a href="#local-6989586621679134865"><span class="hs-identifier hs-var">fs1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pow' m f x -&gt; Poly (Tag (Pow' m f)) x
forall x. Pow' m f x -&gt; Poly (Tag (Pow' m f)) x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; f x -&gt; Poly (Tag f) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="annot"><span class="annottext">Pow' m f x
</span><a href="#local-6989586621679134866"><span class="hs-identifier hs-var">fs2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679134867"><span class="annot"><span class="annottext">Tag f n
</span><a href="#local-6989586621679134867"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621679134868"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134868"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679134869"><span class="annot"><span class="annottext">TagPow' m (Tag f) n
</span><a href="#local-6989586621679134869"><span class="hs-identifier hs-var">tag1</span></a></span></span><span> </span><span id="local-6989586621679134870"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134870"><span class="hs-identifier hs-var">rep1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679134873"><span class="annot"><span class="annottext">TagPow' m (Tag f) n
</span><a href="#local-6989586621679134873"><span class="hs-identifier hs-var">tag2</span></a></span></span><span> </span><span id="local-6989586621679134874"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134874"><span class="hs-identifier hs-var">rep2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TagPow' n (Tag f) (Either n (Either n n))
-&gt; (Either n (Either n n) -&gt; x) -&gt; Poly (TagPow' n (Tag f)) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tag f n
-&gt; TagPow' m (Tag f) n
-&gt; TagPow' m (Tag f) n
-&gt; TagPow' n (Tag f) (Either n (Either n n))
forall (n :: Nat) (m :: Nat) (t :: Type -&gt; Type) x xs1 xs2.
(KnownNat n, n ~ ((m * 2) + 1)) =&gt;
t x
-&gt; TagPow' m t xs1
-&gt; TagPow' m t xs2
-&gt; TagPow' n t (Either x (Either xs1 xs2))
</span><a href="Data.Functor.Pow.html#TagPowOdd"><span class="hs-identifier hs-var">TagPowOdd</span></a></span><span> </span><span class="annot"><span class="annottext">Tag f n
</span><a href="#local-6989586621679134867"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">TagPow' m (Tag f) n
</span><a href="#local-6989586621679134869"><span class="hs-identifier hs-var">tag1</span></a></span><span> </span><span class="annot"><span class="annottext">TagPow' m (Tag f) n
</span><a href="#local-6989586621679134873"><span class="hs-identifier hs-var">tag2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(n -&gt; x) -&gt; (Either n n -&gt; x) -&gt; Either n (Either n n) -&gt; x
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134868"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(n -&gt; x) -&gt; (n -&gt; x) -&gt; Either n n -&gt; x
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134870"><span class="hs-identifier hs-var">rep1</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134874"><span class="hs-identifier hs-var">rep2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span>  </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-type">fromPoly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679134409"><span class="annot"><a href="#local-6989586621679134409"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Pow.html#TagPow%27"><span class="hs-identifier hs-type">TagPow'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134369"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134368"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679134409"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Pow.html#Pow%27"><span class="hs-identifier hs-type">Pow'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134369"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134368"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134409"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-207"></span><span>  </span><span id="local-6989586621679134876"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly (TagPow' n (Tag f)) x -&gt; Pow' n f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679134877"><span class="annot"><span class="annottext">TagPow' n (Tag f) n
</span><a href="#local-6989586621679134877"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621679134878"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134878"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TagPow' n (Tag f) n
</span><a href="#local-6989586621679134877"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><a href="Data.Functor.Pow.html#TagPow1"><span class="hs-identifier hs-type">TagPow1</span></a></span><span> </span><span id="local-6989586621679134881"><span class="annot"><span class="annottext">Tag f n
</span><a href="#local-6989586621679134881"><span class="hs-identifier hs-var">tag'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f x -&gt; Pow' 1 f x
forall {k} (f :: k -&gt; Type) (x :: k). f x -&gt; Pow' 1 f x
</span><a href="Data.Functor.Pow.html#Pow1"><span class="hs-identifier hs-var">Pow1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly (Tag f) x -&gt; f x
forall x. Poly (Tag f) x -&gt; f x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; Poly (Tag f) x -&gt; f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var">fromPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tag f n -&gt; (n -&gt; x) -&gt; Poly (Tag f) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">Tag f n
</span><a href="#local-6989586621679134881"><span class="hs-identifier hs-var">tag'</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134878"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><a href="Data.Functor.Pow.html#TagPowEven"><span class="hs-identifier hs-type">TagPowEven</span></a></span><span> </span><span id="local-6989586621679134891"><span class="annot"><span class="annottext">TagPow' m (Tag f) xs1
</span><a href="#local-6989586621679134891"><span class="hs-identifier hs-var">tag1</span></a></span></span><span> </span><span id="local-6989586621679134892"><span class="annot"><span class="annottext">TagPow' m (Tag f) xs2
</span><a href="#local-6989586621679134892"><span class="hs-identifier hs-var">tag2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pow' m f x -&gt; Pow' m f x -&gt; Pow' n f x
forall {k} (n :: Nat) (m :: Nat) (f :: k -&gt; Type) (x :: k).
(KnownNat n, n ~ (m * 2)) =&gt;
Pow' m f x -&gt; Pow' m f x -&gt; Pow' n f x
</span><a href="Data.Functor.Pow.html#PowEven"><span class="hs-identifier hs-var">PowEven</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly (Tag (Pow' m f)) x -&gt; Pow' m f x
forall x. Poly (Tag (Pow' m f)) x -&gt; Pow' m f x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; Poly (Tag f) x -&gt; f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var">fromPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TagPow' m (Tag f) xs1 -&gt; (xs1 -&gt; x) -&gt; Poly (TagPow' m (Tag f)) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">TagPow' m (Tag f) xs1
</span><a href="#local-6989586621679134891"><span class="hs-identifier hs-var">tag1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134878"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">(n -&gt; x) -&gt; (xs1 -&gt; n) -&gt; xs1 -&gt; x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">xs1 -&gt; n
xs1 -&gt; Either xs1 xs2
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly (Tag (Pow' m f)) x -&gt; Pow' m f x
forall x. Poly (Tag (Pow' m f)) x -&gt; Pow' m f x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; Poly (Tag f) x -&gt; f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var">fromPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TagPow' m (Tag f) xs2 -&gt; (xs2 -&gt; x) -&gt; Poly (TagPow' m (Tag f)) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">TagPow' m (Tag f) xs2
</span><a href="#local-6989586621679134892"><span class="hs-identifier hs-var">tag2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134878"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">(n -&gt; x) -&gt; (xs2 -&gt; n) -&gt; xs2 -&gt; x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">xs2 -&gt; n
xs2 -&gt; Either xs1 xs2
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><a href="Data.Functor.Pow.html#TagPowOdd"><span class="hs-identifier hs-type">TagPowOdd</span></a></span><span> </span><span id="local-6989586621679134903"><span class="annot"><span class="annottext">Tag f x
</span><a href="#local-6989586621679134903"><span class="hs-identifier hs-var">tag'</span></a></span></span><span> </span><span id="local-6989586621679134904"><span class="annot"><span class="annottext">TagPow' m (Tag f) xs1
</span><a href="#local-6989586621679134904"><span class="hs-identifier hs-var">tag1</span></a></span></span><span> </span><span id="local-6989586621679134905"><span class="annot"><span class="annottext">TagPow' m (Tag f) xs2
</span><a href="#local-6989586621679134905"><span class="hs-identifier hs-var">tag2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-211"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679134906"><span class="annot"><span class="annottext">rep' :: x -&gt; x
</span><a href="#local-6989586621679134906"><span class="hs-identifier hs-var hs-var">rep'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134878"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">(n -&gt; x) -&gt; (x -&gt; n) -&gt; x -&gt; x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">x -&gt; n
x -&gt; Either x (Either xs1 xs2)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span>
</span><span id="line-212"></span><span>          </span><span id="local-6989586621679134907"><span class="annot"><span class="annottext">rep1 :: xs1 -&gt; x
</span><a href="#local-6989586621679134907"><span class="hs-identifier hs-var hs-var">rep1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134878"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">(n -&gt; x) -&gt; (xs1 -&gt; n) -&gt; xs1 -&gt; x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either xs1 xs2 -&gt; n
Either xs1 xs2 -&gt; Either x (Either xs1 xs2)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Either xs1 xs2 -&gt; n) -&gt; (xs1 -&gt; Either xs1 xs2) -&gt; xs1 -&gt; n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">xs1 -&gt; Either xs1 xs2
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span>
</span><span id="line-213"></span><span>          </span><span id="local-6989586621679134908"><span class="annot"><span class="annottext">rep2 :: xs2 -&gt; x
</span><a href="#local-6989586621679134908"><span class="hs-identifier hs-var hs-var">rep2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134878"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">(n -&gt; x) -&gt; (xs2 -&gt; n) -&gt; xs2 -&gt; x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either xs1 xs2 -&gt; n
Either xs1 xs2 -&gt; Either x (Either xs1 xs2)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Either xs1 xs2 -&gt; n) -&gt; (xs2 -&gt; Either xs1 xs2) -&gt; xs2 -&gt; n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">xs2 -&gt; Either xs1 xs2
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span>
</span><span id="line-214"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">f x -&gt; Pow' m f x -&gt; Pow' m f x -&gt; Pow' n f x
forall {k} (n :: Nat) (m :: Nat) (f :: k -&gt; Type) (x :: k).
(KnownNat n, n ~ ((m * 2) + 1)) =&gt;
f x -&gt; Pow' m f x -&gt; Pow' m f x -&gt; Pow' n f x
</span><a href="Data.Functor.Pow.html#PowOdd"><span class="hs-identifier hs-var">PowOdd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly (Tag f) x -&gt; f x
forall x. Poly (Tag f) x -&gt; f x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; Poly (Tag f) x -&gt; f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var">fromPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tag f x -&gt; (x -&gt; x) -&gt; Poly (Tag f) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">Tag f x
</span><a href="#local-6989586621679134903"><span class="hs-identifier hs-var">tag'</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; x
</span><a href="#local-6989586621679134906"><span class="hs-identifier hs-var">rep'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly (Tag (Pow' m f)) x -&gt; Pow' m f x
forall x. Poly (Tag (Pow' m f)) x -&gt; Pow' m f x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; Poly (Tag f) x -&gt; f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var">fromPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TagPow' m (Tag f) xs1 -&gt; (xs1 -&gt; x) -&gt; Poly (TagPow' m (Tag f)) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">TagPow' m (Tag f) xs1
</span><a href="#local-6989586621679134904"><span class="hs-identifier hs-var">tag1</span></a></span><span> </span><span class="annot"><span class="annottext">xs1 -&gt; x
</span><a href="#local-6989586621679134907"><span class="hs-identifier hs-var">rep1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly (Tag (Pow' m f)) x -&gt; Pow' m f x
forall x. Poly (Tag (Pow' m f)) x -&gt; Pow' m f x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; Poly (Tag f) x -&gt; f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var">fromPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TagPow' m (Tag f) xs2 -&gt; (xs2 -&gt; x) -&gt; Poly (TagPow' m (Tag f)) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">TagPow' m (Tag f) xs2
</span><a href="#local-6989586621679134905"><span class="hs-identifier hs-var">tag2</span></a></span><span> </span><span class="annot"><span class="annottext">xs2 -&gt; x
</span><a href="#local-6989586621679134908"><span class="hs-identifier hs-var">rep2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679134429"><span id="local-6989586621679134430"><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134429"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GADT.HasFinitary.html#HasFinitary"><span class="hs-identifier hs-type">HasFinitary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134429"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134430"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679134429"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621679134430"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679134429"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621679134430"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagComp"><span class="hs-identifier hs-type">TagComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134429"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134430"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-type">toPoly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679134431"><span class="annot"><a href="#local-6989586621679134431"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679134429"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621679134430"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679134431"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagComp"><span class="hs-identifier hs-type">TagComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134429"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134430"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679134431"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-220"></span><span>  </span><span id="local-6989586621679134921"><span class="annot"><span class="annottext">toPoly :: forall x. (:.:) f g x -&gt; Poly (TagComp (Tag f) (Tag g)) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Comp1</span></span><span> </span><span id="local-6989586621679134923"><span class="annot"><span class="annottext">f (g x)
</span><a href="#local-6989586621679134923"><span class="hs-identifier hs-var">fgy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">f (g x) -&gt; Poly (Tag f) (g x)
forall x. f x -&gt; Poly (Tag f) x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; f x -&gt; Poly (Tag f) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="annot"><span class="annottext">f (g x)
</span><a href="#local-6989586621679134923"><span class="hs-identifier hs-var">fgy</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679134925"><span class="annot"><span class="annottext">Tag f n
</span><a href="#local-6989586621679134925"><span class="hs-identifier hs-var">tagF</span></a></span></span><span> </span><span id="local-6989586621679134926"><span class="annot"><span class="annottext">n -&gt; g x
</span><a href="#local-6989586621679134926"><span class="hs-identifier hs-var">repF</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-222"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Tag f n
-&gt; (Finitary n =&gt; Poly (TagPow (Cardinality n) (Tag g)) x)
-&gt; Poly (TagPow (Cardinality n) (Tag g)) x
forall n r. Tag f n -&gt; (Finitary n =&gt; r) -&gt; r
forall (tag :: Type -&gt; Type) n r.
HasFinitary tag =&gt;
tag n -&gt; (Finitary n =&gt; r) -&gt; r
</span><a href="Data.GADT.HasFinitary.html#withFinitary"><span class="hs-identifier hs-var">withFinitary</span></a></span><span> </span><span class="annot"><span class="annottext">Tag f n
</span><a href="#local-6989586621679134925"><span class="hs-identifier hs-var">tagF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pow (Cardinality n) g x -&gt; Poly (Tag (Pow (Cardinality n) g)) x
forall x.
Pow (Cardinality n) g x -&gt; Poly (Tag (Pow (Cardinality n) g)) x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; f x -&gt; Poly (Tag f) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SNat (Cardinality n)
-&gt; (Finite (Cardinality n) -&gt; g x) -&gt; Pow (Cardinality n) g x
forall {k} (n :: Nat) (f :: k -&gt; Type) (x :: k).
SNat n -&gt; (Finite n -&gt; f x) -&gt; Pow n f x
</span><a href="Data.Functor.Pow.html#functionToPow"><span class="hs-identifier hs-var">functionToPow</span></a></span><span> </span><span class="annot"><span class="annottext">SNat (Cardinality n)
forall (n :: Nat). KnownNat n =&gt; SNat n
</span><span class="hs-identifier hs-var">SNat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; g x
</span><a href="#local-6989586621679134926"><span class="hs-identifier hs-var">repF</span></a></span><span> </span><span class="annot"><span class="annottext">(n -&gt; g x)
-&gt; (Finite (Cardinality n) -&gt; n) -&gt; Finite (Cardinality n) -&gt; g x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Finite (Cardinality n) -&gt; n
forall a. Finitary a =&gt; Finite (Cardinality a) -&gt; a
</span><span class="hs-identifier hs-var">fromFinite</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-223"></span><span>        </span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679134936"><span class="annot"><span class="annottext">TagPow (Cardinality n) (Tag g) n
</span><a href="#local-6989586621679134936"><span class="hs-identifier hs-var">tagPowG</span></a></span></span><span> </span><span id="local-6989586621679134937"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134937"><span class="hs-identifier hs-var">repPow</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TagComp (Tag f) (Tag g) n
-&gt; (n -&gt; x) -&gt; Poly (TagComp (Tag f) (Tag g)) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tag f n
-&gt; TagPow (Cardinality n) (Tag g) n -&gt; TagComp (Tag f) (Tag g) n
forall (t :: Type -&gt; Type) a (u :: Type -&gt; Type) n.
t a -&gt; TagPow (Cardinality a) u n -&gt; TagComp t u n
</span><a href="Data.Functor.Polynomial.Tag.html#TagComp"><span class="hs-identifier hs-var">TagComp</span></a></span><span> </span><span class="annot"><span class="annottext">Tag f n
</span><a href="#local-6989586621679134925"><span class="hs-identifier hs-var">tagF</span></a></span><span> </span><span class="annot"><span class="annottext">TagPow (Cardinality n) (Tag g) n
</span><a href="#local-6989586621679134936"><span class="hs-identifier hs-var">tagPowG</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134937"><span class="hs-identifier hs-var">repPow</span></a></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span>  </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-type">fromPoly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679134452"><span class="annot"><a href="#local-6989586621679134452"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagComp"><span class="hs-identifier hs-type">TagComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134429"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134430"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679134452"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679134429"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621679134430"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679134452"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-226"></span><span>  </span><span id="local-6989586621679134939"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly (TagComp (Tag f) (Tag g)) x -&gt; (:.:) f g x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagComp"><span class="hs-identifier hs-type">TagComp</span></a></span><span> </span><span id="local-6989586621679134943"><span class="annot"><span class="annottext">Tag f a
</span><a href="#local-6989586621679134943"><span class="hs-identifier hs-var">tagF</span></a></span></span><span> </span><span id="local-6989586621679134944"><span class="annot"><span class="annottext">TagPow (Cardinality a) (Tag g) n
</span><a href="#local-6989586621679134944"><span class="hs-identifier hs-var">tagPowG</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679134945"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134945"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679134946"><span class="annot"><span class="annottext">repF :: Finite (Cardinality a) -&gt; g x
</span><a href="#local-6989586621679134946"><span class="hs-identifier hs-var hs-var">repF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pow (Cardinality a) g x -&gt; Finite (Cardinality a) -&gt; g x
forall {k} (n :: Nat) (f :: k -&gt; Type) (x :: k).
Pow n f x -&gt; Finite n -&gt; f x
</span><a href="Data.Functor.Pow.html#powToFunction"><span class="hs-identifier hs-var">powToFunction</span></a></span><span> </span><span class="annot"><span class="annottext">(Pow (Cardinality a) g x -&gt; Finite (Cardinality a) -&gt; g x)
-&gt; Pow (Cardinality a) g x -&gt; Finite (Cardinality a) -&gt; g x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Poly (Tag (Pow (Cardinality a) g)) x -&gt; Pow (Cardinality a) g x
forall x.
Poly (Tag (Pow (Cardinality a) g)) x -&gt; Pow (Cardinality a) g x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; Poly (Tag f) x -&gt; f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var">fromPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TagPow (Cardinality a) (Tag g) n
-&gt; (n -&gt; x) -&gt; Poly (TagPow (Cardinality a) (Tag g)) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">TagPow (Cardinality a) (Tag g) n
</span><a href="#local-6989586621679134944"><span class="hs-identifier hs-var">tagPowG</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679134945"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Tag f a -&gt; (Finitary a =&gt; (:.:) f g x) -&gt; (:.:) f g x
forall n r. Tag f n -&gt; (Finitary n =&gt; r) -&gt; r
forall (tag :: Type -&gt; Type) n r.
HasFinitary tag =&gt;
tag n -&gt; (Finitary n =&gt; r) -&gt; r
</span><a href="Data.GADT.HasFinitary.html#withFinitary"><span class="hs-identifier hs-var">withFinitary</span></a></span><span> </span><span class="annot"><span class="annottext">Tag f a
</span><a href="#local-6989586621679134943"><span class="hs-identifier hs-var">tagF</span></a></span><span> </span><span class="annot"><span class="annottext">((Finitary a =&gt; (:.:) f g x) -&gt; (:.:) f g x)
-&gt; (Finitary a =&gt; (:.:) f g x) -&gt; (:.:) f g x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f (g x) -&gt; (:.:) f g x
forall k2 k1 (f :: k2 -&gt; Type) (g :: k1 -&gt; k2) (p :: k1).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp1</span></span><span> </span><span class="annot"><span class="annottext">(f (g x) -&gt; (:.:) f g x) -&gt; f (g x) -&gt; (:.:) f g x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Poly (Tag f) (g x) -&gt; f (g x)
forall x. Poly (Tag f) x -&gt; f x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; Poly (Tag f) x -&gt; f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var">fromPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tag f a -&gt; (a -&gt; g x) -&gt; Poly (Tag f) (g x)
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">Tag f a
</span><a href="#local-6989586621679134943"><span class="hs-identifier hs-var">tagF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Finite (Cardinality a) -&gt; g x
</span><a href="#local-6989586621679134946"><span class="hs-identifier hs-var">repF</span></a></span><span> </span><span class="annot"><span class="annottext">(Finite (Cardinality a) -&gt; g x)
-&gt; (a -&gt; Finite (Cardinality a)) -&gt; a -&gt; g x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Finite (Cardinality a)
forall a. Finitary a =&gt; a -&gt; Finite (Cardinality a)
</span><span class="hs-identifier hs-var">toFinite</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679134470"><span id="local-6989586621679134471"><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134470"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GADT.HasFinitary.html#HasFinitary"><span class="hs-identifier hs-type">HasFinitary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134470"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134471"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="#local-6989586621679134470"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134471"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="#local-6989586621679134470"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134471"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagComp"><span class="hs-identifier hs-type">TagComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134470"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134471"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span>  </span><span id="local-6989586621679134964"><span class="annot"><span class="annottext">toPoly :: forall x. Compose f g x -&gt; Poly (Tag (Compose f g)) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(:.:) f g x -&gt; Poly (TagComp (Tag f) (Tag g)) x
(:.:) f g x -&gt; Poly (Tag (f :.: g)) x
forall x. (:.:) f g x -&gt; Poly (Tag (f :.: g)) x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; f x -&gt; Poly (Tag f) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="annot"><span class="annottext">((:.:) f g x -&gt; Poly (TagComp (Tag f) (Tag g)) x)
-&gt; (Compose f g x -&gt; (:.:) f g x)
-&gt; Compose f g x
-&gt; Poly (TagComp (Tag f) (Tag g)) x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Compose f g x -&gt; (:.:) f g x
forall x. Compose f g x -&gt; (:.:) f g x
</span><a href="#local-6989586621679134965"><span class="hs-identifier hs-var">toGenerics</span></a></span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-235"></span><span>      </span><span class="annot"><a href="#local-6989586621679134965"><span class="hs-identifier hs-type">toGenerics</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679134473"><span class="annot"><a href="#local-6989586621679134473"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="#local-6989586621679134470"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134471"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134473"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679134470"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621679134471"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679134473"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span>
</span><span id="line-236"></span><span>      </span><span id="local-6989586621679134965"><span class="annot"><span class="annottext">toGenerics :: forall x. Compose f g x -&gt; (:.:) f g x
</span><a href="#local-6989586621679134965"><span class="hs-identifier hs-var hs-var">toGenerics</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Compose f g x -&gt; (:.:) f g x
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span>  </span><span id="local-6989586621679134968"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly (Tag (Compose f g)) x -&gt; Compose f g x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(:.:) f g x -&gt; Compose f g x
forall x. (:.:) f g x -&gt; Compose f g x
</span><a href="#local-6989586621679134969"><span class="hs-identifier hs-var">fromGenerics</span></a></span><span> </span><span class="annot"><span class="annottext">((:.:) f g x -&gt; Compose f g x)
-&gt; (Poly (TagComp (Tag f) (Tag g)) x -&gt; (:.:) f g x)
-&gt; Poly (TagComp (Tag f) (Tag g)) x
-&gt; Compose f g x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Poly (TagComp (Tag f) (Tag g)) x -&gt; (:.:) f g x
Poly (Tag (f :.: g)) x -&gt; (:.:) f g x
forall x. Poly (Tag (f :.: g)) x -&gt; (:.:) f g x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; Poly (Tag f) x -&gt; f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var">fromPoly</span></a></span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-240"></span><span>      </span><span class="annot"><a href="#local-6989586621679134969"><span class="hs-identifier hs-type">fromGenerics</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679134476"><span class="annot"><a href="#local-6989586621679134476"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679134470"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621679134471"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679134476"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="#local-6989586621679134470"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134471"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134476"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-241"></span><span>      </span><span id="local-6989586621679134969"><span class="annot"><span class="annottext">fromGenerics :: forall x. (:.:) f g x -&gt; Compose f g x
</span><a href="#local-6989586621679134969"><span class="hs-identifier hs-var hs-var">fromGenerics</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(:.:) f g x -&gt; Compose f g x
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679134483"><span id="local-6989586621679134484"><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134483"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134484"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Day</span></span><span> </span><span class="annot"><a href="#local-6989586621679134483"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134484"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Day</span></span><span> </span><span class="annot"><a href="#local-6989586621679134483"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134484"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagDay"><span class="hs-identifier hs-type">TagDay</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134483"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134484"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span>    </span><span id="local-6989586621679134979"><span class="annot"><span class="annottext">toPoly :: forall x. Day f g x -&gt; Poly (Tag (Day f g)) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Day</span></span><span> </span><span id="local-6989586621679134983"><span class="annot"><span class="annottext">f b
</span><a href="#local-6989586621679134983"><span class="hs-identifier hs-var">fa</span></a></span></span><span> </span><span id="local-6989586621679134984"><span class="annot"><span class="annottext">g c
</span><a href="#local-6989586621679134984"><span class="hs-identifier hs-var">gb</span></a></span></span><span> </span><span id="local-6989586621679134985"><span class="annot"><span class="annottext">b -&gt; c -&gt; x
</span><a href="#local-6989586621679134985"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f b -&gt; Poly (Tag f) b
forall x. f x -&gt; Poly (Tag f) x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; f x -&gt; Poly (Tag f) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="annot"><span class="annottext">f b
</span><a href="#local-6989586621679134983"><span class="hs-identifier hs-var">fa</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">g c -&gt; Poly (Tag g) c
forall x. g x -&gt; Poly (Tag g) x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; f x -&gt; Poly (Tag f) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="annot"><span class="annottext">g c
</span><a href="#local-6989586621679134984"><span class="hs-identifier hs-var">gb</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-248"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679134986"><span class="annot"><span class="annottext">Tag f n
</span><a href="#local-6989586621679134986"><span class="hs-identifier hs-var">tagF</span></a></span></span><span> </span><span id="local-6989586621679134987"><span class="annot"><span class="annottext">n -&gt; b
</span><a href="#local-6989586621679134987"><span class="hs-identifier hs-var">repF</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679134988"><span class="annot"><span class="annottext">Tag g n
</span><a href="#local-6989586621679134988"><span class="hs-identifier hs-var">tagG</span></a></span></span><span> </span><span id="local-6989586621679134989"><span class="annot"><span class="annottext">n -&gt; c
</span><a href="#local-6989586621679134989"><span class="hs-identifier hs-var">repG</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-249"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679134990"><span class="annot"><span class="annottext">repFG :: (n, n) -&gt; x
</span><a href="#local-6989586621679134990"><span class="hs-identifier hs-var hs-var">repFG</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679134991"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679134991"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679134992"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679134992"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; c -&gt; x
</span><a href="#local-6989586621679134985"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; b
</span><a href="#local-6989586621679134987"><span class="hs-identifier hs-var">repF</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679134991"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; c
</span><a href="#local-6989586621679134989"><span class="hs-identifier hs-var">repG</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679134992"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-250"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">TagDay (Tag f) (Tag g) (n, n)
-&gt; ((n, n) -&gt; x) -&gt; Poly (TagDay (Tag f) (Tag g)) x
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tag f n -&gt; Tag g n -&gt; TagDay (Tag f) (Tag g) (n, n)
forall (t :: Type -&gt; Type) n1 (u :: Type -&gt; Type) m.
t n1 -&gt; u m -&gt; TagDay t u (n1, m)
</span><a href="Data.Functor.Polynomial.Tag.html#TagDay"><span class="hs-identifier hs-var">TagDay</span></a></span><span> </span><span class="annot"><span class="annottext">Tag f n
</span><a href="#local-6989586621679134986"><span class="hs-identifier hs-var">tagF</span></a></span><span> </span><span class="annot"><span class="annottext">Tag g n
</span><a href="#local-6989586621679134988"><span class="hs-identifier hs-var">tagG</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(n, n) -&gt; x
</span><a href="#local-6989586621679134990"><span class="hs-identifier hs-var">repFG</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span>    </span><span id="local-6989586621679134994"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly (Tag (Day f g)) x -&gt; Day f g x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.Tag.html#TagDay"><span class="hs-identifier hs-type">TagDay</span></a></span><span> </span><span id="local-6989586621679134998"><span class="annot"><span class="annottext">Tag f n1
</span><a href="#local-6989586621679134998"><span class="hs-identifier hs-var">tagF</span></a></span></span><span> </span><span id="local-6989586621679134999"><span class="annot"><span class="annottext">Tag g m
</span><a href="#local-6989586621679134999"><span class="hs-identifier hs-var">tagG</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679135000"><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679135000"><span class="hs-identifier hs-var">repFG</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-253"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679135001"><span class="annot"><span class="annottext">op :: n1 -&gt; m -&gt; x
</span><a href="#local-6989586621679135001"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679135002"><span class="annot"><span class="annottext">n1
</span><a href="#local-6989586621679135002"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679135003"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679135003"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; x
</span><a href="#local-6989586621679135000"><span class="hs-identifier hs-var">repFG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n1
</span><a href="#local-6989586621679135002"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679135003"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">f n1 -&gt; g m -&gt; (n1 -&gt; m -&gt; x) -&gt; Day f g x
forall (f :: Type -&gt; Type) (g :: Type -&gt; Type) a b c.
f b -&gt; g c -&gt; (b -&gt; c -&gt; a) -&gt; Day f g a
</span><span class="hs-identifier hs-var">Day</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly (Tag f) n1 -&gt; f n1
forall x. Poly (Tag f) x -&gt; f x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; Poly (Tag f) x -&gt; f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var">fromPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tag f n1 -&gt; (n1 -&gt; n1) -&gt; Poly (Tag f) n1
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">Tag f n1
</span><a href="#local-6989586621679134998"><span class="hs-identifier hs-var">tagF</span></a></span><span> </span><span class="annot"><span class="annottext">n1 -&gt; n1
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly (Tag g) m -&gt; g m
forall x. Poly (Tag g) x -&gt; g x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; Poly (Tag f) x -&gt; f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var">fromPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tag g m -&gt; (m -&gt; m) -&gt; Poly (Tag g) m
forall (tag :: Type -&gt; Type) n x. tag n -&gt; (n -&gt; x) -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">Tag g m
</span><a href="#local-6989586621679134999"><span class="hs-identifier hs-var">tagG</span></a></span><span> </span><span class="annot"><span class="annottext">m -&gt; m
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">n1 -&gt; m -&gt; x
</span><a href="#local-6989586621679135001"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="annot"><span class="hs-comment">-- | @fromPoly = toPoly = id@</span></span><span>
</span><span id="line-257"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679134506"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134506"><span class="hs-identifier hs-type">tag</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Polynomial.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134506"><span class="hs-identifier hs-type">tag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679134506"><span class="hs-identifier hs-type">tag</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span>  </span><span id="local-6989586621679135011"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly (Tag (Poly tag)) x -&gt; Poly tag x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly tag x -&gt; Poly tag x
Poly (Tag (Poly tag)) x -&gt; Poly tag x
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679135012"><span class="annot"><span class="annottext">toPoly :: forall x. Poly tag x -&gt; Poly (Tag (Poly tag)) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly tag x -&gt; Poly tag x
Poly tag x -&gt; Poly (Tag (Poly tag)) x
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="hs-comment">---- Generic definitions ----</span><span>
</span><span id="line-264"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679134512"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Generic1</span></span><span> </span><span class="annot"><a href="#local-6989586621679134512"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep1</span></span><span> </span><span class="annot"><a href="#local-6989586621679134512"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Generically1</span></span><span> </span><span class="annot"><a href="#local-6989586621679134512"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Generically1</span></span><span> </span><span class="annot"><a href="#local-6989586621679134512"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep1</span></span><span> </span><span class="annot"><a href="#local-6989586621679134512"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span>  </span><span id="local-6989586621679135024"><span class="annot"><span class="annottext">toPoly :: forall x. Generically1 f x -&gt; Poly (Tag (Generically1 f)) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Generically1</span></span><span> </span><span id="local-6989586621679135026"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679135026"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rep1 f x -&gt; Poly (Tag (Rep1 f)) x
forall x. Rep1 f x -&gt; Poly (Tag (Rep1 f)) x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; f x -&gt; Poly (Tag f) x
</span><a href="Data.Functor.Polynomial.Class.html#toPoly"><span class="hs-identifier hs-var">toPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f x -&gt; Rep1 f x
forall a. f a -&gt; Rep1 f a
forall k (f :: k -&gt; Type) (a :: k). Generic1 f =&gt; f a -&gt; Rep1 f a
</span><span class="hs-identifier hs-var">from1</span></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679135026"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>  </span><span id="local-6989586621679135030"><span class="annot"><span class="annottext">fromPoly :: forall x. Poly (Tag (Generically1 f)) x -&gt; Generically1 f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPoly</span></a></span></span><span> </span><span id="local-6989586621679135031"><span class="annot"><span class="annottext">Poly (Tag (Generically1 f)) x
</span><a href="#local-6989586621679135031"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f x -&gt; Generically1 f x
forall {k} (f :: k -&gt; Type) (a :: k). f a -&gt; Generically1 f a
</span><span class="hs-identifier hs-var">Generically1</span></span><span> </span><span class="annot"><span class="annottext">(f x -&gt; Generically1 f x) -&gt; f x -&gt; Generically1 f x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rep1 f x -&gt; f x
forall a. Rep1 f a -&gt; f a
forall k (f :: k -&gt; Type) (a :: k). Generic1 f =&gt; Rep1 f a -&gt; f a
</span><span class="hs-identifier hs-var">to1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly (Tag (Rep1 f)) x -&gt; Rep1 f x
forall x. Poly (Tag (Rep1 f)) x -&gt; Rep1 f x
forall (f :: Type -&gt; Type) x. Polynomial f =&gt; Poly (Tag f) x -&gt; f x
</span><a href="Data.Functor.Polynomial.Class.html#fromPoly"><span class="hs-identifier hs-var">fromPoly</span></a></span><span> </span><span class="annot"><span class="annottext">Poly (Tag (Rep1 f)) x
Poly (Tag (Generically1 f)) x
</span><a href="#local-6989586621679135031"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span id="local-6989586621679135037"><span id="local-6989586621679135044"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span id="local-6989586621679134526"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Generically1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679134526"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679134526"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span id="local-6989586621679135072"><span id="local-6989586621679135079"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span id="local-6989586621679134531"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Generically1</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679134531"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Functor.Polynomial.Class.html#Polynomial"><span class="hs-identifier hs-type">Polynomial</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679134531"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></pre></body></html>